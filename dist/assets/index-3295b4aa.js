var nD=Object.defineProperty;var iD=(n,e,t)=>e in n?nD(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var rt=(n,e,t)=>(iD(n,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function $y(n,e){const t=Object.create(null),i=n.split(",");for(let r=0;r<i.length;r++)t[i[r]]=!0;return e?r=>!!t[r.toLowerCase()]:r=>!!t[r]}const Zt={},bu=[],Mn=()=>{},rD=()=>!1,sD=/^on[^a-z]/,Sm=n=>sD.test(n),Yy=n=>n.startsWith("onUpdate:"),xn=Object.assign,qy=(n,e)=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)},oD=Object.prototype.hasOwnProperty,yt=(n,e)=>oD.call(n,e),$e=Array.isArray,Su=n=>Em(n)==="[object Map]",iP=n=>Em(n)==="[object Set]",je=n=>typeof n=="function",At=n=>typeof n=="string",Ky=n=>typeof n=="symbol",Rt=n=>n!==null&&typeof n=="object",rP=n=>Rt(n)&&je(n.then)&&je(n.catch),sP=Object.prototype.toString,Em=n=>sP.call(n),aD=n=>Em(n).slice(8,-1),oP=n=>Em(n)==="[object Object]",Zy=n=>At(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,vp=$y(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Tm=n=>{const e=Object.create(null);return t=>e[t]||(e[t]=n(t))},lD=/-(\w)/g,Lr=Tm(n=>n.replace(lD,(e,t)=>t?t.toUpperCase():"")),uD=/\B([A-Z])/g,vl=Tm(n=>n.replace(uD,"-$1").toLowerCase()),Mm=Tm(n=>n.charAt(0).toUpperCase()+n.slice(1)),Lg=Tm(n=>n?`on${Mm(n)}`:""),zh=(n,e)=>!Object.is(n,e),Og=(n,e)=>{for(let t=0;t<n.length;t++)n[t](e)},kp=(n,e,t)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,value:t})},cD=n=>{const e=parseFloat(n);return isNaN(e)?n:e},hD=n=>{const e=At(n)?Number(n):NaN;return isNaN(e)?n:e};let PS;const zv=()=>PS||(PS=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function $i(n){if($e(n)){const e={};for(let t=0;t<n.length;t++){const i=n[t],r=At(i)?mD(i):$i(i);if(r)for(const s in r)e[s]=r[s]}return e}else{if(At(n))return n;if(Rt(n))return n}}const dD=/;(?![^(]*\))/g,fD=/:([^]+)/,pD=/\/\*[^]*?\*\//g;function mD(n){const e={};return n.replace(pD,"").split(dD).forEach(t=>{if(t){const i=t.split(fD);i.length>1&&(e[i[0].trim()]=i[1].trim())}}),e}function qe(n){let e="";if(At(n))e=n;else if($e(n))for(let t=0;t<n.length;t++){const i=qe(n[t]);i&&(e+=i+" ")}else if(Rt(n))for(const t in n)n[t]&&(e+=t+" ");return e.trim()}const gD="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",_D=$y(gD);function aP(n){return!!n||n===""}const Fs=n=>At(n)?n:n==null?"":$e(n)||Rt(n)&&(n.toString===sP||!je(n.toString))?JSON.stringify(n,lP,2):String(n),lP=(n,e)=>e&&e.__v_isRef?lP(n,e.value):Su(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[i,r])=>(t[`${i} =>`]=r,t),{})}:iP(e)?{[`Set(${e.size})`]:[...e.values()]}:Rt(e)&&!$e(e)&&!oP(e)?String(e):e;let Ai;class uP{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Ai,!e&&Ai&&(this.index=(Ai.scopes||(Ai.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const t=Ai;try{return Ai=this,e()}finally{Ai=t}}}on(){Ai=this}off(){Ai=this.parent}stop(e){if(this._active){let t,i;for(t=0,i=this.effects.length;t<i;t++)this.effects[t].stop();for(t=0,i=this.cleanups.length;t<i;t++)this.cleanups[t]();if(this.scopes)for(t=0,i=this.scopes.length;t<i;t++)this.scopes[t].stop(!0);if(!this.detached&&this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0,this._active=!1}}}function vD(n){return new uP(n)}function yD(n,e=Ai){e&&e.active&&e.effects.push(n)}function cP(){return Ai}function hP(n){Ai&&Ai.cleanups.push(n)}const Jy=n=>{const e=new Set(n);return e.w=0,e.n=0,e},dP=n=>(n.w&Vo)>0,fP=n=>(n.n&Vo)>0,xD=({deps:n})=>{if(n.length)for(let e=0;e<n.length;e++)n[e].w|=Vo},bD=n=>{const{deps:e}=n;if(e.length){let t=0;for(let i=0;i<e.length;i++){const r=e[i];dP(r)&&!fP(r)?r.delete(n):e[t++]=r,r.w&=~Vo,r.n&=~Vo}e.length=t}},Vp=new WeakMap;let uh=0,Vo=1;const Wv=30;let Sr;const Ka=Symbol(""),Xv=Symbol("");class Qy{constructor(e,t=null,i){this.fn=e,this.scheduler=t,this.active=!0,this.deps=[],this.parent=void 0,yD(this,i)}run(){if(!this.active)return this.fn();let e=Sr,t=Io;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=Sr,Sr=this,Io=!0,Vo=1<<++uh,uh<=Wv?xD(this):CS(this),this.fn()}finally{uh<=Wv&&bD(this),Vo=1<<--uh,Sr=this.parent,Io=t,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Sr===this?this.deferStop=!0:this.active&&(CS(this),this.onStop&&this.onStop(),this.active=!1)}}function CS(n){const{deps:e}=n;if(e.length){for(let t=0;t<e.length;t++)e[t].delete(n);e.length=0}}let Io=!0;const pP=[];function pc(){pP.push(Io),Io=!1}function mc(){const n=pP.pop();Io=n===void 0?!0:n}function xi(n,e,t){if(Io&&Sr){let i=Vp.get(n);i||Vp.set(n,i=new Map);let r=i.get(t);r||i.set(t,r=Jy()),mP(r)}}function mP(n,e){let t=!1;uh<=Wv?fP(n)||(n.n|=Vo,t=!dP(n)):t=!n.has(Sr),t&&(n.add(Sr),Sr.deps.push(n))}function $s(n,e,t,i,r,s){const o=Vp.get(n);if(!o)return;let a=[];if(e==="clear")a=[...o.values()];else if(t==="length"&&$e(n)){const l=Number(i);o.forEach((u,c)=>{(c==="length"||c>=l)&&a.push(u)})}else switch(t!==void 0&&a.push(o.get(t)),e){case"add":$e(n)?Zy(t)&&a.push(o.get("length")):(a.push(o.get(Ka)),Su(n)&&a.push(o.get(Xv)));break;case"delete":$e(n)||(a.push(o.get(Ka)),Su(n)&&a.push(o.get(Xv)));break;case"set":Su(n)&&a.push(o.get(Ka));break}if(a.length===1)a[0]&&jv(a[0]);else{const l=[];for(const u of a)u&&l.push(...u);jv(Jy(l))}}function jv(n,e){const t=$e(n)?n:[...n];for(const i of t)i.computed&&RS(i);for(const i of t)i.computed||RS(i)}function RS(n,e){(n!==Sr||n.allowRecurse)&&(n.scheduler?n.scheduler():n.run())}function SD(n,e){var t;return(t=Vp.get(n))==null?void 0:t.get(e)}const ED=$y("__proto__,__v_isRef,__isVue"),gP=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(Ky)),TD=ex(),MD=ex(!1,!0),wD=ex(!0),IS=AD();function AD(){const n={};return["includes","indexOf","lastIndexOf"].forEach(e=>{n[e]=function(...t){const i=Pt(this);for(let s=0,o=this.length;s<o;s++)xi(i,"get",s+"");const r=i[e](...t);return r===-1||r===!1?i[e](...t.map(Pt)):r}}),["push","pop","shift","unshift","splice"].forEach(e=>{n[e]=function(...t){pc();const i=Pt(this)[e].apply(this,t);return mc(),i}}),n}function PD(n){const e=Pt(this);return xi(e,"has",n),e.hasOwnProperty(n)}function ex(n=!1,e=!1){return function(i,r,s){if(r==="__v_isReactive")return!n;if(r==="__v_isReadonly")return n;if(r==="__v_isShallow")return e;if(r==="__v_raw"&&s===(n?e?WD:bP:e?xP:yP).get(i))return i;const o=$e(i);if(!n){if(o&&yt(IS,r))return Reflect.get(IS,r,s);if(r==="hasOwnProperty")return PD}const a=Reflect.get(i,r,s);return(Ky(r)?gP.has(r):ED(r))||(n||xi(i,"get",r),e)?a:yn(a)?o&&Zy(r)?a:a.value:Rt(a)?n?Am(a):Zs(a):a}}const CD=_P(),RD=_P(!0);function _P(n=!1){return function(t,i,r,s){let o=t[i];if(Du(o)&&yn(o)&&!yn(r))return!1;if(!n&&(!Gp(r)&&!Du(r)&&(o=Pt(o),r=Pt(r)),!$e(t)&&yn(o)&&!yn(r)))return o.value=r,!0;const a=$e(t)&&Zy(i)?Number(i)<t.length:yt(t,i),l=Reflect.set(t,i,r,s);return t===Pt(s)&&(a?zh(r,o)&&$s(t,"set",i,r):$s(t,"add",i,r)),l}}function ID(n,e){const t=yt(n,e);n[e];const i=Reflect.deleteProperty(n,e);return i&&t&&$s(n,"delete",e,void 0),i}function LD(n,e){const t=Reflect.has(n,e);return(!Ky(e)||!gP.has(e))&&xi(n,"has",e),t}function OD(n){return xi(n,"iterate",$e(n)?"length":Ka),Reflect.ownKeys(n)}const vP={get:TD,set:CD,deleteProperty:ID,has:LD,ownKeys:OD},DD={get:wD,set(n,e){return!0},deleteProperty(n,e){return!0}},FD=xn({},vP,{get:MD,set:RD}),tx=n=>n,wm=n=>Reflect.getPrototypeOf(n);function Kd(n,e,t=!1,i=!1){n=n.__v_raw;const r=Pt(n),s=Pt(e);t||(e!==s&&xi(r,"get",e),xi(r,"get",s));const{has:o}=wm(r),a=i?tx:t?sx:Wh;if(o.call(r,e))return a(n.get(e));if(o.call(r,s))return a(n.get(s));n!==r&&n.get(e)}function Zd(n,e=!1){const t=this.__v_raw,i=Pt(t),r=Pt(n);return e||(n!==r&&xi(i,"has",n),xi(i,"has",r)),n===r?t.has(n):t.has(n)||t.has(r)}function Jd(n,e=!1){return n=n.__v_raw,!e&&xi(Pt(n),"iterate",Ka),Reflect.get(n,"size",n)}function LS(n){n=Pt(n);const e=Pt(this);return wm(e).has.call(e,n)||(e.add(n),$s(e,"add",n,n)),this}function OS(n,e){e=Pt(e);const t=Pt(this),{has:i,get:r}=wm(t);let s=i.call(t,n);s||(n=Pt(n),s=i.call(t,n));const o=r.call(t,n);return t.set(n,e),s?zh(e,o)&&$s(t,"set",n,e):$s(t,"add",n,e),this}function DS(n){const e=Pt(this),{has:t,get:i}=wm(e);let r=t.call(e,n);r||(n=Pt(n),r=t.call(e,n)),i&&i.call(e,n);const s=e.delete(n);return r&&$s(e,"delete",n,void 0),s}function FS(){const n=Pt(this),e=n.size!==0,t=n.clear();return e&&$s(n,"clear",void 0,void 0),t}function Qd(n,e){return function(i,r){const s=this,o=s.__v_raw,a=Pt(o),l=e?tx:n?sx:Wh;return!n&&xi(a,"iterate",Ka),o.forEach((u,c)=>i.call(r,l(u),l(c),s))}}function ef(n,e,t){return function(...i){const r=this.__v_raw,s=Pt(r),o=Su(s),a=n==="entries"||n===Symbol.iterator&&o,l=n==="keys"&&o,u=r[n](...i),c=t?tx:e?sx:Wh;return!e&&xi(s,"iterate",l?Xv:Ka),{next(){const{value:h,done:d}=u.next();return d?{value:h,done:d}:{value:a?[c(h[0]),c(h[1])]:c(h),done:d}},[Symbol.iterator](){return this}}}}function no(n){return function(...e){return n==="delete"?!1:this}}function ND(){const n={get(s){return Kd(this,s)},get size(){return Jd(this)},has:Zd,add:LS,set:OS,delete:DS,clear:FS,forEach:Qd(!1,!1)},e={get(s){return Kd(this,s,!1,!0)},get size(){return Jd(this)},has:Zd,add:LS,set:OS,delete:DS,clear:FS,forEach:Qd(!1,!0)},t={get(s){return Kd(this,s,!0)},get size(){return Jd(this,!0)},has(s){return Zd.call(this,s,!0)},add:no("add"),set:no("set"),delete:no("delete"),clear:no("clear"),forEach:Qd(!0,!1)},i={get(s){return Kd(this,s,!0,!0)},get size(){return Jd(this,!0)},has(s){return Zd.call(this,s,!0)},add:no("add"),set:no("set"),delete:no("delete"),clear:no("clear"),forEach:Qd(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{n[s]=ef(s,!1,!1),t[s]=ef(s,!0,!1),e[s]=ef(s,!1,!0),i[s]=ef(s,!0,!0)}),[n,t,e,i]}const[UD,BD,kD,VD]=ND();function nx(n,e){const t=e?n?VD:kD:n?BD:UD;return(i,r,s)=>r==="__v_isReactive"?!n:r==="__v_isReadonly"?n:r==="__v_raw"?i:Reflect.get(yt(t,r)&&r in i?t:i,r,s)}const GD={get:nx(!1,!1)},HD={get:nx(!1,!0)},zD={get:nx(!0,!1)},yP=new WeakMap,xP=new WeakMap,bP=new WeakMap,WD=new WeakMap;function XD(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function jD(n){return n.__v_skip||!Object.isExtensible(n)?0:XD(aD(n))}function Zs(n){return Du(n)?n:rx(n,!1,vP,GD,yP)}function ix(n){return rx(n,!1,FD,HD,xP)}function Am(n){return rx(n,!0,DD,zD,bP)}function rx(n,e,t,i,r){if(!Rt(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const s=r.get(n);if(s)return s;const o=jD(n);if(o===0)return n;const a=new Proxy(n,o===2?i:t);return r.set(n,a),a}function Eu(n){return Du(n)?Eu(n.__v_raw):!!(n&&n.__v_isReactive)}function Du(n){return!!(n&&n.__v_isReadonly)}function Gp(n){return!!(n&&n.__v_isShallow)}function SP(n){return Eu(n)||Du(n)}function Pt(n){const e=n&&n.__v_raw;return e?Pt(e):n}function EP(n){return kp(n,"__v_skip",!0),n}const Wh=n=>Rt(n)?Zs(n):n,sx=n=>Rt(n)?Am(n):n;function TP(n){Io&&Sr&&(n=Pt(n),mP(n.dep||(n.dep=Jy())))}function MP(n,e){n=Pt(n);const t=n.dep;t&&jv(t)}function yn(n){return!!(n&&n.__v_isRef===!0)}function Fe(n){return wP(n,!1)}function Za(n){return wP(n,!0)}function wP(n,e){return yn(n)?n:new $D(n,e)}class $D{constructor(e,t){this.__v_isShallow=t,this.dep=void 0,this.__v_isRef=!0,this._rawValue=t?e:Pt(e),this._value=t?e:Wh(e)}get value(){return TP(this),this._value}set value(e){const t=this.__v_isShallow||Gp(e)||Du(e);e=t?e:Pt(e),zh(e,this._rawValue)&&(this._rawValue=e,this._value=t?e:Wh(e),MP(this))}}function R(n){return yn(n)?n.value:n}const YD={get:(n,e,t)=>R(Reflect.get(n,e,t)),set:(n,e,t,i)=>{const r=n[e];return yn(r)&&!yn(t)?(r.value=t,!0):Reflect.set(n,e,t,i)}};function AP(n){return Eu(n)?n:new Proxy(n,YD)}function $v(n){const e=$e(n)?new Array(n.length):{};for(const t in n)e[t]=PP(n,t);return e}class qD{constructor(e,t,i){this._object=e,this._key=t,this._defaultValue=i,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return SD(Pt(this._object),this._key)}}class KD{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function Ns(n,e,t){return yn(n)?n:je(n)?new KD(n):Rt(n)&&arguments.length>1?PP(n,e,t):Fe(n)}function PP(n,e,t){const i=n[e];return yn(i)?i:new qD(n,e,t)}class ZD{constructor(e,t,i,r){this._setter=t,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this._dirty=!0,this.effect=new Qy(e,()=>{this._dirty||(this._dirty=!0,MP(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!r,this.__v_isReadonly=i}get value(){const e=Pt(this);return TP(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function CP(n,e,t=!1){let i,r;const s=je(n);return s?(i=n,r=Mn):(i=n.get,r=n.set),new ZD(i,r,s||!r,t)}function JD(n,...e){}function Lo(n,e,t,i){let r;try{r=i?n(...i):n()}catch(s){Pm(s,e,t)}return r}function tr(n,e,t,i){if(je(n)){const s=Lo(n,e,t,i);return s&&rP(s)&&s.catch(o=>{Pm(o,e,t)}),s}const r=[];for(let s=0;s<n.length;s++)r.push(tr(n[s],e,t,i));return r}function Pm(n,e,t,i=!0){const r=e?e.vnode:null;if(e){let s=e.parent;const o=e.proxy,a=t;for(;s;){const u=s.ec;if(u){for(let c=0;c<u.length;c++)if(u[c](n,o,a)===!1)return}s=s.parent}const l=e.appContext.config.errorHandler;if(l){Lo(l,null,10,[n,o,a]);return}}QD(n,t,r,i)}function QD(n,e,t,i=!0){console.error(n)}let Xh=!1,Yv=!1;const Zn=[];let Qr=0;const Tu=[];let Rs=null,Na=0;const RP=Promise.resolve();let ox=null;function Kn(n){const e=ox||RP;return n?e.then(this?n.bind(this):n):e}function eF(n){let e=Qr+1,t=Zn.length;for(;e<t;){const i=e+t>>>1;jh(Zn[i])<n?e=i+1:t=i}return e}function ax(n){(!Zn.length||!Zn.includes(n,Xh&&n.allowRecurse?Qr+1:Qr))&&(n.id==null?Zn.push(n):Zn.splice(eF(n.id),0,n),IP())}function IP(){!Xh&&!Yv&&(Yv=!0,ox=RP.then(OP))}function tF(n){const e=Zn.indexOf(n);e>Qr&&Zn.splice(e,1)}function nF(n){$e(n)?Tu.push(...n):(!Rs||!Rs.includes(n,n.allowRecurse?Na+1:Na))&&Tu.push(n),IP()}function NS(n,e=Xh?Qr+1:0){for(;e<Zn.length;e++){const t=Zn[e];t&&t.pre&&(Zn.splice(e,1),e--,t())}}function LP(n){if(Tu.length){const e=[...new Set(Tu)];if(Tu.length=0,Rs){Rs.push(...e);return}for(Rs=e,Rs.sort((t,i)=>jh(t)-jh(i)),Na=0;Na<Rs.length;Na++)Rs[Na]();Rs=null,Na=0}}const jh=n=>n.id==null?1/0:n.id,iF=(n,e)=>{const t=jh(n)-jh(e);if(t===0){if(n.pre&&!e.pre)return-1;if(e.pre&&!n.pre)return 1}return t};function OP(n){Yv=!1,Xh=!0,Zn.sort(iF);const e=Mn;try{for(Qr=0;Qr<Zn.length;Qr++){const t=Zn[Qr];t&&t.active!==!1&&Lo(t,null,14)}}finally{Qr=0,Zn.length=0,LP(),Xh=!1,ox=null,(Zn.length||Tu.length)&&OP()}}function rF(n,e,...t){if(n.isUnmounted)return;const i=n.vnode.props||Zt;let r=t;const s=e.startsWith("update:"),o=s&&e.slice(7);if(o&&o in i){const c=`${o==="modelValue"?"model":o}Modifiers`,{number:h,trim:d}=i[c]||Zt;d&&(r=t.map(f=>At(f)?f.trim():f)),h&&(r=t.map(cD))}let a,l=i[a=Lg(e)]||i[a=Lg(Lr(e))];!l&&s&&(l=i[a=Lg(vl(e))]),l&&tr(l,n,6,r);const u=i[a+"Once"];if(u){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,tr(u,n,6,r)}}function DP(n,e,t=!1){const i=e.emitsCache,r=i.get(n);if(r!==void 0)return r;const s=n.emits;let o={},a=!1;if(!je(n)){const l=u=>{const c=DP(u,e,!0);c&&(a=!0,xn(o,c))};!t&&e.mixins.length&&e.mixins.forEach(l),n.extends&&l(n.extends),n.mixins&&n.mixins.forEach(l)}return!s&&!a?(Rt(n)&&i.set(n,null),null):($e(s)?s.forEach(l=>o[l]=null):xn(o,s),Rt(n)&&i.set(n,o),o)}function Cm(n,e){return!n||!Sm(e)?!1:(e=e.slice(2).replace(/Once$/,""),yt(n,e[0].toLowerCase()+e.slice(1))||yt(n,vl(e))||yt(n,e))}let Wn=null,FP=null;function Hp(n){const e=Wn;return Wn=n,FP=n&&n.type.__scopeId||null,e}function Mt(n,e=Wn,t){if(!e||n._n)return n;const i=(...r)=>{i._d&&qS(-1);const s=Hp(e);let o;try{o=n(...r)}finally{Hp(s),i._d&&qS(1)}return o};return i._n=!0,i._c=!0,i._d=!0,i}function Dg(n){const{type:e,vnode:t,proxy:i,withProxy:r,props:s,propsOptions:[o],slots:a,attrs:l,emit:u,render:c,renderCache:h,data:d,setupState:f,ctx:p,inheritAttrs:_}=n;let m,g;const v=Hp(n);try{if(t.shapeFlag&4){const x=r||i;m=Yr(c.call(x,x,h,s,f,d,p)),g=l}else{const x=e;m=Yr(x.length>1?x(s,{attrs:l,slots:a,emit:u}):x(s,null)),g=e.props?l:sF(l)}}catch(x){Ph.length=0,Pm(x,n,1),m=lt(Li)}let y=m;if(g&&_!==!1){const x=Object.keys(g),{shapeFlag:b}=y;x.length&&b&7&&(o&&x.some(Yy)&&(g=oF(g,o)),y=Ys(y,g))}return t.dirs&&(y=Ys(y),y.dirs=y.dirs?y.dirs.concat(t.dirs):t.dirs),t.transition&&(y.transition=t.transition),m=y,Hp(v),m}const sF=n=>{let e;for(const t in n)(t==="class"||t==="style"||Sm(t))&&((e||(e={}))[t]=n[t]);return e},oF=(n,e)=>{const t={};for(const i in n)(!Yy(i)||!(i.slice(9)in e))&&(t[i]=n[i]);return t};function aF(n,e,t){const{props:i,children:r,component:s}=n,{props:o,children:a,patchFlag:l}=e,u=s.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return i?US(i,o,u):!!o;if(l&8){const c=e.dynamicProps;for(let h=0;h<c.length;h++){const d=c[h];if(o[d]!==i[d]&&!Cm(u,d))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:i===o?!1:i?o?US(i,o,u):!0:!!o;return!1}function US(n,e,t){const i=Object.keys(e);if(i.length!==Object.keys(n).length)return!0;for(let r=0;r<i.length;r++){const s=i[r];if(e[s]!==n[s]&&!Cm(t,s))return!0}return!1}function lF({vnode:n,parent:e},t){for(;e&&e.subTree===n;)(n=e.vnode).el=t,e=e.parent}const uF=n=>n.__isSuspense;function cF(n,e){e&&e.pendingBranch?$e(n)?e.effects.push(...n):e.effects.push(n):nF(n)}const tf={};function et(n,e,t){return NP(n,e,t)}function NP(n,e,{immediate:t,deep:i,flush:r,onTrack:s,onTrigger:o}=Zt){var a;const l=cP()===((a=Nn)==null?void 0:a.scope)?Nn:null;let u,c=!1,h=!1;if(yn(n)?(u=()=>n.value,c=Gp(n)):Eu(n)?(u=()=>n,i=!0):$e(n)?(h=!0,c=n.some(x=>Eu(x)||Gp(x)),u=()=>n.map(x=>{if(yn(x))return x.value;if(Eu(x))return za(x);if(je(x))return Lo(x,l,2)})):je(n)?e?u=()=>Lo(n,l,2):u=()=>{if(!(l&&l.isUnmounted))return d&&d(),tr(n,l,3,[f])}:u=Mn,e&&i){const x=u;u=()=>za(x())}let d,f=x=>{d=v.onStop=()=>{Lo(x,l,4)}},p;if(Yh)if(f=Mn,e?t&&tr(e,l,3,[u(),h?[]:void 0,f]):u(),r==="sync"){const x=eN();p=x.__watcherHandles||(x.__watcherHandles=[])}else return Mn;let _=h?new Array(n.length).fill(tf):tf;const m=()=>{if(v.active)if(e){const x=v.run();(i||c||(h?x.some((b,S)=>zh(b,_[S])):zh(x,_)))&&(d&&d(),tr(e,l,3,[x,_===tf?void 0:h&&_[0]===tf?[]:_,f]),_=x)}else v.run()};m.allowRecurse=!!e;let g;r==="sync"?g=m:r==="post"?g=()=>hi(m,l&&l.suspense):(m.pre=!0,l&&(m.id=l.uid),g=()=>ax(m));const v=new Qy(u,g);e?t?m():_=v.run():r==="post"?hi(v.run.bind(v),l&&l.suspense):v.run();const y=()=>{v.stop(),l&&l.scope&&qy(l.scope.effects,v)};return p&&p.push(y),y}function hF(n,e,t){const i=this.proxy,r=At(n)?n.includes(".")?UP(i,n):()=>i[n]:n.bind(i,i);let s;je(e)?s=e:(s=e.handler,t=e);const o=Nn;Nu(this);const a=NP(r,s.bind(i),t);return o?Nu(o):Ja(),a}function UP(n,e){const t=e.split(".");return()=>{let i=n;for(let r=0;r<t.length&&i;r++)i=i[t[r]];return i}}function za(n,e){if(!Rt(n)||n.__v_skip||(e=e||new Set,e.has(n)))return n;if(e.add(n),yn(n))za(n.value,e);else if($e(n))for(let t=0;t<n.length;t++)za(n[t],e);else if(iP(n)||Su(n))n.forEach(t=>{za(t,e)});else if(oP(n))for(const t in n)za(n[t],e);return n}function Go(n,e){const t=Wn;if(t===null)return n;const i=Om(t)||t.proxy,r=n.dirs||(n.dirs=[]);for(let s=0;s<e.length;s++){let[o,a,l,u=Zt]=e[s];o&&(je(o)&&(o={mounted:o,updated:o}),o.deep&&za(a),r.push({dir:o,instance:i,value:a,oldValue:void 0,arg:l,modifiers:u}))}return n}function ta(n,e,t,i){const r=n.dirs,s=e&&e.dirs;for(let o=0;o<r.length;o++){const a=r[o];s&&(a.oldValue=s[o].value);let l=a.dir[i];l&&(pc(),tr(l,t,8,[n.el,a,n,e]),mc())}}function dF(){const n={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Sn(()=>{n.isMounted=!0}),Dr(()=>{n.isUnmounting=!0}),n}const Fi=[Function,Array],BP={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Fi,onEnter:Fi,onAfterEnter:Fi,onEnterCancelled:Fi,onBeforeLeave:Fi,onLeave:Fi,onAfterLeave:Fi,onLeaveCancelled:Fi,onBeforeAppear:Fi,onAppear:Fi,onAfterAppear:Fi,onAppearCancelled:Fi},fF={name:"BaseTransition",props:BP,setup(n,{slots:e}){const t=Fr(),i=dF();let r;return()=>{const s=e.default&&VP(e.default(),!0);if(!s||!s.length)return;let o=s[0];if(s.length>1){for(const _ of s)if(_.type!==Li){o=_;break}}const a=Pt(n),{mode:l}=a;if(i.isLeaving)return Fg(o);const u=BS(o);if(!u)return Fg(o);const c=qv(u,a,i,t);Kv(u,c);const h=t.subTree,d=h&&BS(h);let f=!1;const{getTransitionKey:p}=u.type;if(p){const _=p();r===void 0?r=_:_!==r&&(r=_,f=!0)}if(d&&d.type!==Li&&(!Ua(u,d)||f)){const _=qv(d,a,i,t);if(Kv(d,_),l==="out-in")return i.isLeaving=!0,_.afterLeave=()=>{i.isLeaving=!1,t.update.active!==!1&&t.update()},Fg(o);l==="in-out"&&u.type!==Li&&(_.delayLeave=(m,g,v)=>{const y=kP(i,d);y[String(d.key)]=d,m._leaveCb=()=>{g(),m._leaveCb=void 0,delete c.delayedLeave},c.delayedLeave=v})}return o}}},pF=fF;function kP(n,e){const{leavingVNodes:t}=n;let i=t.get(e.type);return i||(i=Object.create(null),t.set(e.type,i)),i}function qv(n,e,t,i){const{appear:r,mode:s,persisted:o=!1,onBeforeEnter:a,onEnter:l,onAfterEnter:u,onEnterCancelled:c,onBeforeLeave:h,onLeave:d,onAfterLeave:f,onLeaveCancelled:p,onBeforeAppear:_,onAppear:m,onAfterAppear:g,onAppearCancelled:v}=e,y=String(n.key),x=kP(t,n),b=(P,E)=>{P&&tr(P,i,9,E)},S=(P,E)=>{const M=E[1];b(P,E),$e(P)?P.every(O=>O.length<=1)&&M():P.length<=1&&M()},T={mode:s,persisted:o,beforeEnter(P){let E=a;if(!t.isMounted)if(r)E=_||a;else return;P._leaveCb&&P._leaveCb(!0);const M=x[y];M&&Ua(n,M)&&M.el._leaveCb&&M.el._leaveCb(),b(E,[P])},enter(P){let E=l,M=u,O=c;if(!t.isMounted)if(r)E=m||l,M=g||u,O=v||c;else return;let L=!1;const C=P._enterCb=D=>{L||(L=!0,D?b(O,[P]):b(M,[P]),T.delayedLeave&&T.delayedLeave(),P._enterCb=void 0)};E?S(E,[P,C]):C()},leave(P,E){const M=String(n.key);if(P._enterCb&&P._enterCb(!0),t.isUnmounting)return E();b(h,[P]);let O=!1;const L=P._leaveCb=C=>{O||(O=!0,E(),C?b(p,[P]):b(f,[P]),P._leaveCb=void 0,x[M]===n&&delete x[M])};x[M]=n,d?S(d,[P,L]):L()},clone(P){return qv(P,e,t,i)}};return T}function Fg(n){if(Rm(n))return n=Ys(n),n.children=null,n}function BS(n){return Rm(n)?n.children?n.children[0]:void 0:n}function Kv(n,e){n.shapeFlag&6&&n.component?Kv(n.component.subTree,e):n.shapeFlag&128?(n.ssContent.transition=e.clone(n.ssContent),n.ssFallback.transition=e.clone(n.ssFallback)):n.transition=e}function VP(n,e=!1,t){let i=[],r=0;for(let s=0;s<n.length;s++){let o=n[s];const a=t==null?o.key:String(t)+String(o.key!=null?o.key:s);o.type===jt?(o.patchFlag&128&&r++,i=i.concat(VP(o.children,e,a))):(e||o.type!==Li)&&i.push(a!=null?Ys(o,{key:a}):o)}if(r>1)for(let s=0;s<i.length;s++)i[s].patchFlag=-2;return i}function dt(n,e){return je(n)?(()=>xn({name:n.name},e,{setup:n}))():n}const Mh=n=>!!n.type.__asyncLoader,Rm=n=>n.type.__isKeepAlive;function mF(n,e){HP(n,"a",e)}function GP(n,e){HP(n,"da",e)}function HP(n,e,t=Nn){const i=n.__wdc||(n.__wdc=()=>{let r=t;for(;r;){if(r.isDeactivated)return;r=r.parent}return n()});if(Im(e,i,t),t){let r=t.parent;for(;r&&r.parent;)Rm(r.parent.vnode)&&gF(i,e,t,r),r=r.parent}}function gF(n,e,t,i){const r=Im(e,n,i,!0);ux(()=>{qy(i[e],r)},t)}function Im(n,e,t=Nn,i=!1){if(t){const r=t[n]||(t[n]=[]),s=e.__weh||(e.__weh=(...o)=>{if(t.isUnmounted)return;pc(),Nu(t);const a=tr(e,t,n,o);return Ja(),mc(),a});return i?r.unshift(s):r.push(s),s}}const Js=n=>(e,t=Nn)=>(!Yh||n==="sp")&&Im(n,(...i)=>e(...i),t),lx=Js("bm"),Sn=Js("m"),_F=Js("bu"),zP=Js("u"),Dr=Js("bum"),ux=Js("um"),vF=Js("sp"),yF=Js("rtg"),xF=Js("rtc");function bF(n,e=Nn){Im("ec",n,e)}const cx="components";function ch(n,e){return XP(cx,n,!0,e)||n}const WP=Symbol.for("v-ndc");function wo(n){return At(n)?XP(cx,n,!1)||n:n||WP}function XP(n,e,t=!0,i=!1){const r=Wn||Nn;if(r){const s=r.type;if(n===cx){const a=ZF(s,!1);if(a&&(a===e||a===Lr(e)||a===Mm(Lr(e))))return s}const o=kS(r[n]||s[n],e)||kS(r.appContext[n],e);return!o&&i?s:o}}function kS(n,e){return n&&(n[e]||n[Lr(e)]||n[Mm(Lr(e))])}function Ng(n,e,t,i){let r;const s=t&&t[i];if($e(n)||At(n)){r=new Array(n.length);for(let o=0,a=n.length;o<a;o++)r[o]=e(n[o],o,void 0,s&&s[o])}else if(typeof n=="number"){r=new Array(n);for(let o=0;o<n;o++)r[o]=e(o+1,o,void 0,s&&s[o])}else if(Rt(n))if(n[Symbol.iterator])r=Array.from(n,(o,a)=>e(o,a,void 0,s&&s[a]));else{const o=Object.keys(n);r=new Array(o.length);for(let a=0,l=o.length;a<l;a++){const u=o[a];r[a]=e(n[u],u,a,s&&s[a])}}else r=[];return t&&(t[i]=r),r}function Qt(n,e,t={},i,r){if(Wn.isCE||Wn.parent&&Mh(Wn.parent)&&Wn.parent.isCE)return e!=="default"&&(t.name=e),lt("slot",t,i&&i());let s=n[e];s&&s._c&&(s._d=!1),Te();const o=s&&jP(s(t)),a=vt(jt,{key:t.key||o&&o.key||`_${e}`},o||(i?i():[]),o&&n._===1?64:-2);return!r&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),s&&s._c&&(s._d=!0),a}function jP(n){return n.some(e=>Fu(e)?!(e.type===Li||e.type===jt&&!jP(e.children)):!0)?n:null}const Zv=n=>n?oC(n)?Om(n)||n.proxy:Zv(n.parent):null,wh=xn(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>Zv(n.parent),$root:n=>Zv(n.root),$emit:n=>n.emit,$options:n=>hx(n),$forceUpdate:n=>n.f||(n.f=()=>ax(n.update)),$nextTick:n=>n.n||(n.n=Kn.bind(n.proxy)),$watch:n=>hF.bind(n)}),Ug=(n,e)=>n!==Zt&&!n.__isScriptSetup&&yt(n,e),SF={get({_:n},e){const{ctx:t,setupState:i,data:r,props:s,accessCache:o,type:a,appContext:l}=n;let u;if(e[0]!=="$"){const f=o[e];if(f!==void 0)switch(f){case 1:return i[e];case 2:return r[e];case 4:return t[e];case 3:return s[e]}else{if(Ug(i,e))return o[e]=1,i[e];if(r!==Zt&&yt(r,e))return o[e]=2,r[e];if((u=n.propsOptions[0])&&yt(u,e))return o[e]=3,s[e];if(t!==Zt&&yt(t,e))return o[e]=4,t[e];Jv&&(o[e]=0)}}const c=wh[e];let h,d;if(c)return e==="$attrs"&&xi(n,"get",e),c(n);if((h=a.__cssModules)&&(h=h[e]))return h;if(t!==Zt&&yt(t,e))return o[e]=4,t[e];if(d=l.config.globalProperties,yt(d,e))return d[e]},set({_:n},e,t){const{data:i,setupState:r,ctx:s}=n;return Ug(r,e)?(r[e]=t,!0):i!==Zt&&yt(i,e)?(i[e]=t,!0):yt(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(s[e]=t,!0)},has({_:{data:n,setupState:e,accessCache:t,ctx:i,appContext:r,propsOptions:s}},o){let a;return!!t[o]||n!==Zt&&yt(n,o)||Ug(e,o)||(a=s[0])&&yt(a,o)||yt(i,o)||yt(wh,o)||yt(r.config.globalProperties,o)},defineProperty(n,e,t){return t.get!=null?n._.accessCache[e]=0:yt(t,"value")&&this.set(n,e,t.value,null),Reflect.defineProperty(n,e,t)}};function $P(){return YP().slots}function EF(){return YP().attrs}function YP(){const n=Fr();return n.setupContext||(n.setupContext=lC(n))}function VS(n){return $e(n)?n.reduce((e,t)=>(e[t]=null,e),{}):n}let Jv=!0;function TF(n){const e=hx(n),t=n.proxy,i=n.ctx;Jv=!1,e.beforeCreate&&GS(e.beforeCreate,n,"bc");const{data:r,computed:s,methods:o,watch:a,provide:l,inject:u,created:c,beforeMount:h,mounted:d,beforeUpdate:f,updated:p,activated:_,deactivated:m,beforeDestroy:g,beforeUnmount:v,destroyed:y,unmounted:x,render:b,renderTracked:S,renderTriggered:T,errorCaptured:P,serverPrefetch:E,expose:M,inheritAttrs:O,components:L,directives:C,filters:D}=e;if(u&&MF(u,i,null),o)for(const U in o){const $=o[U];je($)&&(i[U]=$.bind(t))}if(r){const U=r.call(t,t);Rt(U)&&(n.data=Zs(U))}if(Jv=!0,s)for(const U in s){const $=s[U],J=je($)?$.bind(t,t):je($.get)?$.get.bind(t,t):Mn,j=!je($)&&je($.set)?$.set.bind(t):Mn,F=oe({get:J,set:j});Object.defineProperty(i,U,{enumerable:!0,configurable:!0,get:()=>F.value,set:X=>F.value=X})}if(a)for(const U in a)qP(a[U],i,t,U);if(l){const U=je(l)?l.call(t):l;Reflect.ownKeys(U).forEach($=>{Ii($,U[$])})}c&&GS(c,n,"c");function W(U,$){$e($)?$.forEach(J=>U(J.bind(t))):$&&U($.bind(t))}if(W(lx,h),W(Sn,d),W(_F,f),W(zP,p),W(mF,_),W(GP,m),W(bF,P),W(xF,S),W(yF,T),W(Dr,v),W(ux,x),W(vF,E),$e(M))if(M.length){const U=n.exposed||(n.exposed={});M.forEach($=>{Object.defineProperty(U,$,{get:()=>t[$],set:J=>t[$]=J})})}else n.exposed||(n.exposed={});b&&n.render===Mn&&(n.render=b),O!=null&&(n.inheritAttrs=O),L&&(n.components=L),C&&(n.directives=C)}function MF(n,e,t=Mn){$e(n)&&(n=Qv(n));for(const i in n){const r=n[i];let s;Rt(r)?"default"in r?s=Lt(r.from||i,r.default,!0):s=Lt(r.from||i):s=Lt(r),yn(s)?Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:()=>s.value,set:o=>s.value=o}):e[i]=s}}function GS(n,e,t){tr($e(n)?n.map(i=>i.bind(e.proxy)):n.bind(e.proxy),e,t)}function qP(n,e,t,i){const r=i.includes(".")?UP(t,i):()=>t[i];if(At(n)){const s=e[n];je(s)&&et(r,s)}else if(je(n))et(r,n.bind(t));else if(Rt(n))if($e(n))n.forEach(s=>qP(s,e,t,i));else{const s=je(n.handler)?n.handler.bind(t):e[n.handler];je(s)&&et(r,s,n)}}function hx(n){const e=n.type,{mixins:t,extends:i}=e,{mixins:r,optionsCache:s,config:{optionMergeStrategies:o}}=n.appContext,a=s.get(e);let l;return a?l=a:!r.length&&!t&&!i?l=e:(l={},r.length&&r.forEach(u=>zp(l,u,o,!0)),zp(l,e,o)),Rt(e)&&s.set(e,l),l}function zp(n,e,t,i=!1){const{mixins:r,extends:s}=e;s&&zp(n,s,t,!0),r&&r.forEach(o=>zp(n,o,t,!0));for(const o in e)if(!(i&&o==="expose")){const a=wF[o]||t&&t[o];n[o]=a?a(n[o],e[o]):e[o]}return n}const wF={data:HS,props:zS,emits:zS,methods:hh,computed:hh,beforeCreate:ti,created:ti,beforeMount:ti,mounted:ti,beforeUpdate:ti,updated:ti,beforeDestroy:ti,beforeUnmount:ti,destroyed:ti,unmounted:ti,activated:ti,deactivated:ti,errorCaptured:ti,serverPrefetch:ti,components:hh,directives:hh,watch:PF,provide:HS,inject:AF};function HS(n,e){return e?n?function(){return xn(je(n)?n.call(this,this):n,je(e)?e.call(this,this):e)}:e:n}function AF(n,e){return hh(Qv(n),Qv(e))}function Qv(n){if($e(n)){const e={};for(let t=0;t<n.length;t++)e[n[t]]=n[t];return e}return n}function ti(n,e){return n?[...new Set([].concat(n,e))]:e}function hh(n,e){return n?xn(Object.create(null),n,e):e}function zS(n,e){return n?$e(n)&&$e(e)?[...new Set([...n,...e])]:xn(Object.create(null),VS(n),VS(e??{})):e}function PF(n,e){if(!n)return e;if(!e)return n;const t=xn(Object.create(null),n);for(const i in e)t[i]=ti(n[i],e[i]);return t}function KP(){return{app:null,config:{isNativeTag:rD,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let CF=0;function RF(n,e){return function(i,r=null){je(i)||(i=xn({},i)),r!=null&&!Rt(r)&&(r=null);const s=KP(),o=new Set;let a=!1;const l=s.app={_uid:CF++,_component:i,_props:r,_container:null,_context:s,_instance:null,version:tN,get config(){return s.config},set config(u){},use(u,...c){return o.has(u)||(u&&je(u.install)?(o.add(u),u.install(l,...c)):je(u)&&(o.add(u),u(l,...c))),l},mixin(u){return s.mixins.includes(u)||s.mixins.push(u),l},component(u,c){return c?(s.components[u]=c,l):s.components[u]},directive(u,c){return c?(s.directives[u]=c,l):s.directives[u]},mount(u,c,h){if(!a){const d=lt(i,r);return d.appContext=s,c&&e?e(d,u):n(d,u,h),a=!0,l._container=u,u.__vue_app__=l,Om(d.component)||d.component.proxy}},unmount(){a&&(n(null,l._container),delete l._container.__vue_app__)},provide(u,c){return s.provides[u]=c,l},runWithContext(u){Wp=l;try{return u()}finally{Wp=null}}};return l}}let Wp=null;function Ii(n,e){if(Nn){let t=Nn.provides;const i=Nn.parent&&Nn.parent.provides;i===t&&(t=Nn.provides=Object.create(i)),t[n]=e}}function Lt(n,e,t=!1){const i=Nn||Wn;if(i||Wp){const r=i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:Wp._context.provides;if(r&&n in r)return r[n];if(arguments.length>1)return t&&je(e)?e.call(i&&i.proxy):e}}function IF(n,e,t,i=!1){const r={},s={};kp(s,Lm,1),n.propsDefaults=Object.create(null),ZP(n,e,r,s);for(const o in n.propsOptions[0])o in r||(r[o]=void 0);t?n.props=i?r:ix(r):n.type.props?n.props=r:n.props=s,n.attrs=s}function LF(n,e,t,i){const{props:r,attrs:s,vnode:{patchFlag:o}}=n,a=Pt(r),[l]=n.propsOptions;let u=!1;if((i||o>0)&&!(o&16)){if(o&8){const c=n.vnode.dynamicProps;for(let h=0;h<c.length;h++){let d=c[h];if(Cm(n.emitsOptions,d))continue;const f=e[d];if(l)if(yt(s,d))f!==s[d]&&(s[d]=f,u=!0);else{const p=Lr(d);r[p]=e0(l,a,p,f,n,!1)}else f!==s[d]&&(s[d]=f,u=!0)}}}else{ZP(n,e,r,s)&&(u=!0);let c;for(const h in a)(!e||!yt(e,h)&&((c=vl(h))===h||!yt(e,c)))&&(l?t&&(t[h]!==void 0||t[c]!==void 0)&&(r[h]=e0(l,a,h,void 0,n,!0)):delete r[h]);if(s!==a)for(const h in s)(!e||!yt(e,h))&&(delete s[h],u=!0)}u&&$s(n,"set","$attrs")}function ZP(n,e,t,i){const[r,s]=n.propsOptions;let o=!1,a;if(e)for(let l in e){if(vp(l))continue;const u=e[l];let c;r&&yt(r,c=Lr(l))?!s||!s.includes(c)?t[c]=u:(a||(a={}))[c]=u:Cm(n.emitsOptions,l)||(!(l in i)||u!==i[l])&&(i[l]=u,o=!0)}if(s){const l=Pt(t),u=a||Zt;for(let c=0;c<s.length;c++){const h=s[c];t[h]=e0(r,l,h,u[h],n,!yt(u,h))}}return o}function e0(n,e,t,i,r,s){const o=n[t];if(o!=null){const a=yt(o,"default");if(a&&i===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&je(l)){const{propsDefaults:u}=r;t in u?i=u[t]:(Nu(r),i=u[t]=l.call(null,e),Ja())}else i=l}o[0]&&(s&&!a?i=!1:o[1]&&(i===""||i===vl(t))&&(i=!0))}return i}function JP(n,e,t=!1){const i=e.propsCache,r=i.get(n);if(r)return r;const s=n.props,o={},a=[];let l=!1;if(!je(n)){const c=h=>{l=!0;const[d,f]=JP(h,e,!0);xn(o,d),f&&a.push(...f)};!t&&e.mixins.length&&e.mixins.forEach(c),n.extends&&c(n.extends),n.mixins&&n.mixins.forEach(c)}if(!s&&!l)return Rt(n)&&i.set(n,bu),bu;if($e(s))for(let c=0;c<s.length;c++){const h=Lr(s[c]);WS(h)&&(o[h]=Zt)}else if(s)for(const c in s){const h=Lr(c);if(WS(h)){const d=s[c],f=o[h]=$e(d)||je(d)?{type:d}:xn({},d);if(f){const p=$S(Boolean,f.type),_=$S(String,f.type);f[0]=p>-1,f[1]=_<0||p<_,(p>-1||yt(f,"default"))&&a.push(h)}}}const u=[o,a];return Rt(n)&&i.set(n,u),u}function WS(n){return n[0]!=="$"}function XS(n){const e=n&&n.toString().match(/^\s*(function|class) (\w+)/);return e?e[2]:n===null?"null":""}function jS(n,e){return XS(n)===XS(e)}function $S(n,e){return $e(e)?e.findIndex(t=>jS(t,n)):je(e)&&jS(e,n)?0:-1}const QP=n=>n[0]==="_"||n==="$stable",dx=n=>$e(n)?n.map(Yr):[Yr(n)],OF=(n,e,t)=>{if(e._n)return e;const i=Mt((...r)=>dx(e(...r)),t);return i._c=!1,i},eC=(n,e,t)=>{const i=n._ctx;for(const r in n){if(QP(r))continue;const s=n[r];if(je(s))e[r]=OF(r,s,i);else if(s!=null){const o=dx(s);e[r]=()=>o}}},tC=(n,e)=>{const t=dx(e);n.slots.default=()=>t},DF=(n,e)=>{if(n.vnode.shapeFlag&32){const t=e._;t?(n.slots=Pt(e),kp(e,"_",t)):eC(e,n.slots={})}else n.slots={},e&&tC(n,e);kp(n.slots,Lm,1)},FF=(n,e,t)=>{const{vnode:i,slots:r}=n;let s=!0,o=Zt;if(i.shapeFlag&32){const a=e._;a?t&&a===1?s=!1:(xn(r,e),!t&&a===1&&delete r._):(s=!e.$stable,eC(e,r)),o=e}else e&&(tC(n,e),o={default:1});if(s)for(const a in r)!QP(a)&&!(a in o)&&delete r[a]};function t0(n,e,t,i,r=!1){if($e(n)){n.forEach((d,f)=>t0(d,e&&($e(e)?e[f]:e),t,i,r));return}if(Mh(i)&&!r)return;const s=i.shapeFlag&4?Om(i.component)||i.component.proxy:i.el,o=r?null:s,{i:a,r:l}=n,u=e&&e.r,c=a.refs===Zt?a.refs={}:a.refs,h=a.setupState;if(u!=null&&u!==l&&(At(u)?(c[u]=null,yt(h,u)&&(h[u]=null)):yn(u)&&(u.value=null)),je(l))Lo(l,a,12,[o,c]);else{const d=At(l),f=yn(l);if(d||f){const p=()=>{if(n.f){const _=d?yt(h,l)?h[l]:c[l]:l.value;r?$e(_)&&qy(_,s):$e(_)?_.includes(s)||_.push(s):d?(c[l]=[s],yt(h,l)&&(h[l]=c[l])):(l.value=[s],n.k&&(c[n.k]=l.value))}else d?(c[l]=o,yt(h,l)&&(h[l]=o)):f&&(l.value=o,n.k&&(c[n.k]=o))};o?(p.id=-1,hi(p,t)):p()}}}const hi=cF;function NF(n){return UF(n)}function UF(n,e){const t=zv();t.__VUE__=!0;const{insert:i,remove:r,patchProp:s,createElement:o,createText:a,createComment:l,setText:u,setElementText:c,parentNode:h,nextSibling:d,setScopeId:f=Mn,insertStaticContent:p}=n,_=(w,V,H,K=null,Z=null,ee=null,ge=!1,le=null,fe=!!V.dynamicChildren)=>{if(w===V)return;w&&!Ua(w,V)&&(K=Y(w),X(w,Z,ee,!0),w=null),V.patchFlag===-2&&(fe=!1,V.dynamicChildren=null);const{type:me,ref:we,shapeFlag:I}=V;switch(me){case gc:m(w,V,H,K);break;case Li:g(w,V,H,K);break;case Bg:w==null&&v(V,H,K,ge);break;case jt:L(w,V,H,K,Z,ee,ge,le,fe);break;default:I&1?b(w,V,H,K,Z,ee,ge,le,fe):I&6?C(w,V,H,K,Z,ee,ge,le,fe):(I&64||I&128)&&me.process(w,V,H,K,Z,ee,ge,le,fe,he)}we!=null&&Z&&t0(we,w&&w.ref,ee,V||w,!V)},m=(w,V,H,K)=>{if(w==null)i(V.el=a(V.children),H,K);else{const Z=V.el=w.el;V.children!==w.children&&u(Z,V.children)}},g=(w,V,H,K)=>{w==null?i(V.el=l(V.children||""),H,K):V.el=w.el},v=(w,V,H,K)=>{[w.el,w.anchor]=p(w.children,V,H,K,w.el,w.anchor)},y=({el:w,anchor:V},H,K)=>{let Z;for(;w&&w!==V;)Z=d(w),i(w,H,K),w=Z;i(V,H,K)},x=({el:w,anchor:V})=>{let H;for(;w&&w!==V;)H=d(w),r(w),w=H;r(V)},b=(w,V,H,K,Z,ee,ge,le,fe)=>{ge=ge||V.type==="svg",w==null?S(V,H,K,Z,ee,ge,le,fe):E(w,V,Z,ee,ge,le,fe)},S=(w,V,H,K,Z,ee,ge,le)=>{let fe,me;const{type:we,props:I,shapeFlag:A,transition:G,dirs:Q}=w;if(fe=w.el=o(w.type,ee,I&&I.is,I),A&8?c(fe,w.children):A&16&&P(w.children,fe,null,K,Z,ee&&we!=="foreignObject",ge,le),Q&&ta(w,null,K,"created"),T(fe,w,w.scopeId,ge,K),I){for(const k in I)k!=="value"&&!vp(k)&&s(fe,k,null,I[k],ee,w.children,K,Z,ae);"value"in I&&s(fe,"value",null,I.value),(me=I.onVnodeBeforeMount)&&kr(me,K,w)}Q&&ta(w,null,K,"beforeMount");const ue=(!Z||Z&&!Z.pendingBranch)&&G&&!G.persisted;ue&&G.beforeEnter(fe),i(fe,V,H),((me=I&&I.onVnodeMounted)||ue||Q)&&hi(()=>{me&&kr(me,K,w),ue&&G.enter(fe),Q&&ta(w,null,K,"mounted")},Z)},T=(w,V,H,K,Z)=>{if(H&&f(w,H),K)for(let ee=0;ee<K.length;ee++)f(w,K[ee]);if(Z){let ee=Z.subTree;if(V===ee){const ge=Z.vnode;T(w,ge,ge.scopeId,ge.slotScopeIds,Z.parent)}}},P=(w,V,H,K,Z,ee,ge,le,fe=0)=>{for(let me=fe;me<w.length;me++){const we=w[me]=le?So(w[me]):Yr(w[me]);_(null,we,V,H,K,Z,ee,ge,le)}},E=(w,V,H,K,Z,ee,ge)=>{const le=V.el=w.el;let{patchFlag:fe,dynamicChildren:me,dirs:we}=V;fe|=w.patchFlag&16;const I=w.props||Zt,A=V.props||Zt;let G;H&&na(H,!1),(G=A.onVnodeBeforeUpdate)&&kr(G,H,V,w),we&&ta(V,w,H,"beforeUpdate"),H&&na(H,!0);const Q=Z&&V.type!=="foreignObject";if(me?M(w.dynamicChildren,me,le,H,K,Q,ee):ge||$(w,V,le,null,H,K,Q,ee,!1),fe>0){if(fe&16)O(le,V,I,A,H,K,Z);else if(fe&2&&I.class!==A.class&&s(le,"class",null,A.class,Z),fe&4&&s(le,"style",I.style,A.style,Z),fe&8){const ue=V.dynamicProps;for(let k=0;k<ue.length;k++){const pe=ue[k],Ee=I[pe],se=A[pe];(se!==Ee||pe==="value")&&s(le,pe,Ee,se,Z,w.children,H,K,ae)}}fe&1&&w.children!==V.children&&c(le,V.children)}else!ge&&me==null&&O(le,V,I,A,H,K,Z);((G=A.onVnodeUpdated)||we)&&hi(()=>{G&&kr(G,H,V,w),we&&ta(V,w,H,"updated")},K)},M=(w,V,H,K,Z,ee,ge)=>{for(let le=0;le<V.length;le++){const fe=w[le],me=V[le],we=fe.el&&(fe.type===jt||!Ua(fe,me)||fe.shapeFlag&70)?h(fe.el):H;_(fe,me,we,null,K,Z,ee,ge,!0)}},O=(w,V,H,K,Z,ee,ge)=>{if(H!==K){if(H!==Zt)for(const le in H)!vp(le)&&!(le in K)&&s(w,le,H[le],null,ge,V.children,Z,ee,ae);for(const le in K){if(vp(le))continue;const fe=K[le],me=H[le];fe!==me&&le!=="value"&&s(w,le,me,fe,ge,V.children,Z,ee,ae)}"value"in K&&s(w,"value",H.value,K.value)}},L=(w,V,H,K,Z,ee,ge,le,fe)=>{const me=V.el=w?w.el:a(""),we=V.anchor=w?w.anchor:a("");let{patchFlag:I,dynamicChildren:A,slotScopeIds:G}=V;G&&(le=le?le.concat(G):G),w==null?(i(me,H,K),i(we,H,K),P(V.children,H,we,Z,ee,ge,le,fe)):I>0&&I&64&&A&&w.dynamicChildren?(M(w.dynamicChildren,A,H,Z,ee,ge,le),(V.key!=null||Z&&V===Z.subTree)&&fx(w,V,!0)):$(w,V,H,we,Z,ee,ge,le,fe)},C=(w,V,H,K,Z,ee,ge,le,fe)=>{V.slotScopeIds=le,w==null?V.shapeFlag&512?Z.ctx.activate(V,H,K,ge,fe):D(V,H,K,Z,ee,ge,fe):B(w,V,fe)},D=(w,V,H,K,Z,ee,ge)=>{const le=w.component=$F(w,K,Z);if(Rm(w)&&(le.ctx.renderer=he),YF(le),le.asyncDep){if(Z&&Z.registerDep(le,W),!w.el){const fe=le.subTree=lt(Li);g(null,fe,V,H)}return}W(le,w,V,H,Z,ee,ge)},B=(w,V,H)=>{const K=V.component=w.component;if(aF(w,V,H))if(K.asyncDep&&!K.asyncResolved){U(K,V,H);return}else K.next=V,tF(K.update),K.update();else V.el=w.el,K.vnode=V},W=(w,V,H,K,Z,ee,ge)=>{const le=()=>{if(w.isMounted){let{next:we,bu:I,u:A,parent:G,vnode:Q}=w,ue=we,k;na(w,!1),we?(we.el=Q.el,U(w,we,ge)):we=Q,I&&Og(I),(k=we.props&&we.props.onVnodeBeforeUpdate)&&kr(k,G,we,Q),na(w,!0);const pe=Dg(w),Ee=w.subTree;w.subTree=pe,_(Ee,pe,h(Ee.el),Y(Ee),w,Z,ee),we.el=pe.el,ue===null&&lF(w,pe.el),A&&hi(A,Z),(k=we.props&&we.props.onVnodeUpdated)&&hi(()=>kr(k,G,we,Q),Z)}else{let we;const{el:I,props:A}=V,{bm:G,m:Q,parent:ue}=w,k=Mh(V);if(na(w,!1),G&&Og(G),!k&&(we=A&&A.onVnodeBeforeMount)&&kr(we,ue,V),na(w,!0),I&&be){const pe=()=>{w.subTree=Dg(w),be(I,w.subTree,w,Z,null)};k?V.type.__asyncLoader().then(()=>!w.isUnmounted&&pe()):pe()}else{const pe=w.subTree=Dg(w);_(null,pe,H,K,w,Z,ee),V.el=pe.el}if(Q&&hi(Q,Z),!k&&(we=A&&A.onVnodeMounted)){const pe=V;hi(()=>kr(we,ue,pe),Z)}(V.shapeFlag&256||ue&&Mh(ue.vnode)&&ue.vnode.shapeFlag&256)&&w.a&&hi(w.a,Z),w.isMounted=!0,V=H=K=null}},fe=w.effect=new Qy(le,()=>ax(me),w.scope),me=w.update=()=>fe.run();me.id=w.uid,na(w,!0),me()},U=(w,V,H)=>{V.component=w;const K=w.vnode.props;w.vnode=V,w.next=null,LF(w,V.props,K,H),FF(w,V.children,H),pc(),NS(),mc()},$=(w,V,H,K,Z,ee,ge,le,fe=!1)=>{const me=w&&w.children,we=w?w.shapeFlag:0,I=V.children,{patchFlag:A,shapeFlag:G}=V;if(A>0){if(A&128){j(me,I,H,K,Z,ee,ge,le,fe);return}else if(A&256){J(me,I,H,K,Z,ee,ge,le,fe);return}}G&8?(we&16&&ae(me,Z,ee),I!==me&&c(H,I)):we&16?G&16?j(me,I,H,K,Z,ee,ge,le,fe):ae(me,Z,ee,!0):(we&8&&c(H,""),G&16&&P(I,H,K,Z,ee,ge,le,fe))},J=(w,V,H,K,Z,ee,ge,le,fe)=>{w=w||bu,V=V||bu;const me=w.length,we=V.length,I=Math.min(me,we);let A;for(A=0;A<I;A++){const G=V[A]=fe?So(V[A]):Yr(V[A]);_(w[A],G,H,null,Z,ee,ge,le,fe)}me>we?ae(w,Z,ee,!0,!1,I):P(V,H,K,Z,ee,ge,le,fe,I)},j=(w,V,H,K,Z,ee,ge,le,fe)=>{let me=0;const we=V.length;let I=w.length-1,A=we-1;for(;me<=I&&me<=A;){const G=w[me],Q=V[me]=fe?So(V[me]):Yr(V[me]);if(Ua(G,Q))_(G,Q,H,null,Z,ee,ge,le,fe);else break;me++}for(;me<=I&&me<=A;){const G=w[I],Q=V[A]=fe?So(V[A]):Yr(V[A]);if(Ua(G,Q))_(G,Q,H,null,Z,ee,ge,le,fe);else break;I--,A--}if(me>I){if(me<=A){const G=A+1,Q=G<we?V[G].el:K;for(;me<=A;)_(null,V[me]=fe?So(V[me]):Yr(V[me]),H,Q,Z,ee,ge,le,fe),me++}}else if(me>A)for(;me<=I;)X(w[me],Z,ee,!0),me++;else{const G=me,Q=me,ue=new Map;for(me=Q;me<=A;me++){const Ce=V[me]=fe?So(V[me]):Yr(V[me]);Ce.key!=null&&ue.set(Ce.key,me)}let k,pe=0;const Ee=A-Q+1;let se=!1,De=0;const Ne=new Array(Ee);for(me=0;me<Ee;me++)Ne[me]=0;for(me=G;me<=I;me++){const Ce=w[me];if(pe>=Ee){X(Ce,Z,ee,!0);continue}let Re;if(Ce.key!=null)Re=ue.get(Ce.key);else for(k=Q;k<=A;k++)if(Ne[k-Q]===0&&Ua(Ce,V[k])){Re=k;break}Re===void 0?X(Ce,Z,ee,!0):(Ne[Re-Q]=me+1,Re>=De?De=Re:se=!0,_(Ce,V[Re],H,null,Z,ee,ge,le,fe),pe++)}const Ue=se?BF(Ne):bu;for(k=Ue.length-1,me=Ee-1;me>=0;me--){const Ce=Q+me,Re=V[Ce],Ve=Ce+1<we?V[Ce+1].el:K;Ne[me]===0?_(null,Re,H,Ve,Z,ee,ge,le,fe):se&&(k<0||me!==Ue[k]?F(Re,H,Ve,2):k--)}}},F=(w,V,H,K,Z=null)=>{const{el:ee,type:ge,transition:le,children:fe,shapeFlag:me}=w;if(me&6){F(w.component.subTree,V,H,K);return}if(me&128){w.suspense.move(V,H,K);return}if(me&64){ge.move(w,V,H,he);return}if(ge===jt){i(ee,V,H);for(let I=0;I<fe.length;I++)F(fe[I],V,H,K);i(w.anchor,V,H);return}if(ge===Bg){y(w,V,H);return}if(K!==2&&me&1&&le)if(K===0)le.beforeEnter(ee),i(ee,V,H),hi(()=>le.enter(ee),Z);else{const{leave:I,delayLeave:A,afterLeave:G}=le,Q=()=>i(ee,V,H),ue=()=>{I(ee,()=>{Q(),G&&G()})};A?A(ee,Q,ue):ue()}else i(ee,V,H)},X=(w,V,H,K=!1,Z=!1)=>{const{type:ee,props:ge,ref:le,children:fe,dynamicChildren:me,shapeFlag:we,patchFlag:I,dirs:A}=w;if(le!=null&&t0(le,null,H,w,!0),we&256){V.ctx.deactivate(w);return}const G=we&1&&A,Q=!Mh(w);let ue;if(Q&&(ue=ge&&ge.onVnodeBeforeUnmount)&&kr(ue,V,w),we&6)ve(w.component,H,K);else{if(we&128){w.suspense.unmount(H,K);return}G&&ta(w,null,V,"beforeUnmount"),we&64?w.type.remove(w,V,H,Z,he,K):me&&(ee!==jt||I>0&&I&64)?ae(me,V,H,!1,!0):(ee===jt&&I&384||!Z&&we&16)&&ae(fe,V,H),K&&re(w)}(Q&&(ue=ge&&ge.onVnodeUnmounted)||G)&&hi(()=>{ue&&kr(ue,V,w),G&&ta(w,null,V,"unmounted")},H)},re=w=>{const{type:V,el:H,anchor:K,transition:Z}=w;if(V===jt){ce(H,K);return}if(V===Bg){x(w);return}const ee=()=>{r(H),Z&&!Z.persisted&&Z.afterLeave&&Z.afterLeave()};if(w.shapeFlag&1&&Z&&!Z.persisted){const{leave:ge,delayLeave:le}=Z,fe=()=>ge(H,ee);le?le(w.el,ee,fe):fe()}else ee()},ce=(w,V)=>{let H;for(;w!==V;)H=d(w),r(w),w=H;r(V)},ve=(w,V,H)=>{const{bum:K,scope:Z,update:ee,subTree:ge,um:le}=w;K&&Og(K),Z.stop(),ee&&(ee.active=!1,X(ge,w,V,H)),le&&hi(le,V),hi(()=>{w.isUnmounted=!0},V),V&&V.pendingBranch&&!V.isUnmounted&&w.asyncDep&&!w.asyncResolved&&w.suspenseId===V.pendingId&&(V.deps--,V.deps===0&&V.resolve())},ae=(w,V,H,K=!1,Z=!1,ee=0)=>{for(let ge=ee;ge<w.length;ge++)X(w[ge],V,H,K,Z)},Y=w=>w.shapeFlag&6?Y(w.component.subTree):w.shapeFlag&128?w.suspense.next():d(w.anchor||w.el),ne=(w,V,H)=>{w==null?V._vnode&&X(V._vnode,null,null,!0):_(V._vnode||null,w,V,null,null,null,H),NS(),LP(),V._vnode=w},he={p:_,um:X,m:F,r:re,mt:D,mc:P,pc:$,pbc:M,n:Y,o:n};let xe,be;return e&&([xe,be]=e(he)),{render:ne,hydrate:xe,createApp:RF(ne,xe)}}function na({effect:n,update:e},t){n.allowRecurse=e.allowRecurse=t}function fx(n,e,t=!1){const i=n.children,r=e.children;if($e(i)&&$e(r))for(let s=0;s<i.length;s++){const o=i[s];let a=r[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[s]=So(r[s]),a.el=o.el),t||fx(o,a)),a.type===gc&&(a.el=o.el)}}function BF(n){const e=n.slice(),t=[0];let i,r,s,o,a;const l=n.length;for(i=0;i<l;i++){const u=n[i];if(u!==0){if(r=t[t.length-1],n[r]<u){e[i]=r,t.push(i);continue}for(s=0,o=t.length-1;s<o;)a=s+o>>1,n[t[a]]<u?s=a+1:o=a;u<n[t[s]]&&(s>0&&(e[i]=t[s-1]),t[s]=i)}}for(s=t.length,o=t[s-1];s-- >0;)t[s]=o,o=e[o];return t}const kF=n=>n.__isTeleport,Ah=n=>n&&(n.disabled||n.disabled===""),YS=n=>typeof SVGElement<"u"&&n instanceof SVGElement,n0=(n,e)=>{const t=n&&n.to;return At(t)?e?e(t):null:t},VF={__isTeleport:!0,process(n,e,t,i,r,s,o,a,l,u){const{mc:c,pc:h,pbc:d,o:{insert:f,querySelector:p,createText:_,createComment:m}}=u,g=Ah(e.props);let{shapeFlag:v,children:y,dynamicChildren:x}=e;if(n==null){const b=e.el=_(""),S=e.anchor=_("");f(b,t,i),f(S,t,i);const T=e.target=n0(e.props,p),P=e.targetAnchor=_("");T&&(f(P,T),o=o||YS(T));const E=(M,O)=>{v&16&&c(y,M,O,r,s,o,a,l)};g?E(t,S):T&&E(T,P)}else{e.el=n.el;const b=e.anchor=n.anchor,S=e.target=n.target,T=e.targetAnchor=n.targetAnchor,P=Ah(n.props),E=P?t:S,M=P?b:T;if(o=o||YS(S),x?(d(n.dynamicChildren,x,E,r,s,o,a),fx(n,e,!0)):l||h(n,e,E,M,r,s,o,a,!1),g)P||nf(e,t,b,u,1);else if((e.props&&e.props.to)!==(n.props&&n.props.to)){const O=e.target=n0(e.props,p);O&&nf(e,O,null,u,0)}else P&&nf(e,S,T,u,1)}iC(e)},remove(n,e,t,i,{um:r,o:{remove:s}},o){const{shapeFlag:a,children:l,anchor:u,targetAnchor:c,target:h,props:d}=n;if(h&&s(c),(o||!Ah(d))&&(s(u),a&16))for(let f=0;f<l.length;f++){const p=l[f];r(p,e,t,!0,!!p.dynamicChildren)}},move:nf,hydrate:GF};function nf(n,e,t,{o:{insert:i},m:r},s=2){s===0&&i(n.targetAnchor,e,t);const{el:o,anchor:a,shapeFlag:l,children:u,props:c}=n,h=s===2;if(h&&i(o,e,t),(!h||Ah(c))&&l&16)for(let d=0;d<u.length;d++)r(u[d],e,t,2);h&&i(a,e,t)}function GF(n,e,t,i,r,s,{o:{nextSibling:o,parentNode:a,querySelector:l}},u){const c=e.target=n0(e.props,l);if(c){const h=c._lpa||c.firstChild;if(e.shapeFlag&16)if(Ah(e.props))e.anchor=u(o(n),e,a(n),t,i,r,s),e.targetAnchor=h;else{e.anchor=o(n);let d=h;for(;d;)if(d=o(d),d&&d.nodeType===8&&d.data==="teleport anchor"){e.targetAnchor=d,c._lpa=e.targetAnchor&&o(e.targetAnchor);break}u(h,e,c,t,i,r,s)}iC(e)}return e.anchor&&o(e.anchor)}const nC=VF;function iC(n){const e=n.ctx;if(e&&e.ut){let t=n.children[0].el;for(;t!==n.targetAnchor;)t.nodeType===1&&t.setAttribute("data-v-owner",e.uid),t=t.nextSibling;e.ut()}}const jt=Symbol.for("v-fgt"),gc=Symbol.for("v-txt"),Li=Symbol.for("v-cmt"),Bg=Symbol.for("v-stc"),Ph=[];let Tr=null;function Te(n=!1){Ph.push(Tr=n?null:[])}function HF(){Ph.pop(),Tr=Ph[Ph.length-1]||null}let $h=1;function qS(n){$h+=n}function rC(n){return n.dynamicChildren=$h>0?Tr||bu:null,HF(),$h>0&&Tr&&Tr.push(n),n}function ke(n,e,t,i,r,s){return rC(ze(n,e,t,i,r,s,!0))}function vt(n,e,t,i,r){return rC(lt(n,e,t,i,r,!0))}function Fu(n){return n?n.__v_isVNode===!0:!1}function Ua(n,e){return n.type===e.type&&n.key===e.key}const Lm="__vInternal",sC=({key:n})=>n??null,yp=({ref:n,ref_key:e,ref_for:t})=>(typeof n=="number"&&(n=""+n),n!=null?At(n)||yn(n)||je(n)?{i:Wn,r:n,k:e,f:!!t}:n:null);function ze(n,e=null,t=null,i=0,r=null,s=n===jt?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&sC(e),ref:e&&yp(e),scopeId:FP,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:i,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:Wn};return a?(px(l,t),s&128&&n.normalize(l)):t&&(l.shapeFlag|=At(t)?8:16),$h>0&&!o&&Tr&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&Tr.push(l),l}const lt=zF;function zF(n,e=null,t=null,i=0,r=null,s=!1){if((!n||n===WP)&&(n=Li),Fu(n)){const a=Ys(n,e,!0);return t&&px(a,t),$h>0&&!s&&Tr&&(a.shapeFlag&6?Tr[Tr.indexOf(n)]=a:Tr.push(a)),a.patchFlag|=-2,a}if(JF(n)&&(n=n.__vccOpts),e){e=WF(e);let{class:a,style:l}=e;a&&!At(a)&&(e.class=qe(a)),Rt(l)&&(SP(l)&&!$e(l)&&(l=xn({},l)),e.style=$i(l))}const o=At(n)?1:uF(n)?128:kF(n)?64:Rt(n)?4:je(n)?2:0;return ze(n,e,t,i,r,o,s,!0)}function WF(n){return n?SP(n)||Lm in n?xn({},n):n:null}function Ys(n,e,t=!1){const{props:i,ref:r,patchFlag:s,children:o}=n,a=e?is(i||{},e):i;return{__v_isVNode:!0,__v_skip:!0,type:n.type,props:a,key:a&&sC(a),ref:e&&e.ref?t&&r?$e(r)?r.concat(yp(e)):[r,yp(e)]:yp(e):r,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:o,target:n.target,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==jt?s===-1?16:s|16:s,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:n.transition,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&Ys(n.ssContent),ssFallback:n.ssFallback&&Ys(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce}}function dh(n=" ",e=0){return lt(gc,null,n,e)}function ut(n="",e=!1){return e?(Te(),vt(Li,null,n)):lt(Li,null,n)}function Yr(n){return n==null||typeof n=="boolean"?lt(Li):$e(n)?lt(jt,null,n.slice()):typeof n=="object"?So(n):lt(gc,null,String(n))}function So(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:Ys(n)}function px(n,e){let t=0;const{shapeFlag:i}=n;if(e==null)e=null;else if($e(e))t=16;else if(typeof e=="object")if(i&65){const r=e.default;r&&(r._c&&(r._d=!1),px(n,r()),r._c&&(r._d=!0));return}else{t=32;const r=e._;!r&&!(Lm in e)?e._ctx=Wn:r===3&&Wn&&(Wn.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else je(e)?(e={default:e,_ctx:Wn},t=32):(e=String(e),i&64?(t=16,e=[dh(e)]):t=8);n.children=e,n.shapeFlag|=t}function is(...n){const e={};for(let t=0;t<n.length;t++){const i=n[t];for(const r in i)if(r==="class")e.class!==i.class&&(e.class=qe([e.class,i.class]));else if(r==="style")e.style=$i([e.style,i.style]);else if(Sm(r)){const s=e[r],o=i[r];o&&s!==o&&!($e(s)&&s.includes(o))&&(e[r]=s?[].concat(s,o):o)}else r!==""&&(e[r]=i[r])}return e}function kr(n,e,t,i=null){tr(n,e,7,[t,i])}const XF=KP();let jF=0;function $F(n,e,t){const i=n.type,r=(e?e.appContext:n.appContext)||XF,s={uid:jF++,vnode:n,type:i,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,scope:new uP(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:JP(i,r),emitsOptions:DP(i,r),emit:null,emitted:null,propsDefaults:Zt,inheritAttrs:i.inheritAttrs,ctx:Zt,data:Zt,props:Zt,attrs:Zt,slots:Zt,refs:Zt,setupState:Zt,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=rF.bind(null,s),n.ce&&n.ce(s),s}let Nn=null;const Fr=()=>Nn||Wn;let mx,Al,KS="__VUE_INSTANCE_SETTERS__";(Al=zv()[KS])||(Al=zv()[KS]=[]),Al.push(n=>Nn=n),mx=n=>{Al.length>1?Al.forEach(e=>e(n)):Al[0](n)};const Nu=n=>{mx(n),n.scope.on()},Ja=()=>{Nn&&Nn.scope.off(),mx(null)};function oC(n){return n.vnode.shapeFlag&4}let Yh=!1;function YF(n,e=!1){Yh=e;const{props:t,children:i}=n.vnode,r=oC(n);IF(n,t,r,e),DF(n,i);const s=r?qF(n,e):void 0;return Yh=!1,s}function qF(n,e){const t=n.type;n.accessCache=Object.create(null),n.proxy=EP(new Proxy(n.ctx,SF));const{setup:i}=t;if(i){const r=n.setupContext=i.length>1?lC(n):null;Nu(n),pc();const s=Lo(i,n,0,[n.props,r]);if(mc(),Ja(),rP(s)){if(s.then(Ja,Ja),e)return s.then(o=>{ZS(n,o,e)}).catch(o=>{Pm(o,n,0)});n.asyncDep=s}else ZS(n,s,e)}else aC(n,e)}function ZS(n,e,t){je(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:Rt(e)&&(n.setupState=AP(e)),aC(n,t)}let JS;function aC(n,e,t){const i=n.type;if(!n.render){if(!e&&JS&&!i.render){const r=i.template||hx(n).template;if(r){const{isCustomElement:s,compilerOptions:o}=n.appContext.config,{delimiters:a,compilerOptions:l}=i,u=xn(xn({isCustomElement:s,delimiters:a},o),l);i.render=JS(r,u)}}n.render=i.render||Mn}Nu(n),pc(),TF(n),mc(),Ja()}function KF(n){return n.attrsProxy||(n.attrsProxy=new Proxy(n.attrs,{get(e,t){return xi(n,"get","$attrs"),e[t]}}))}function lC(n){const e=t=>{n.exposed=t||{}};return{get attrs(){return KF(n)},slots:n.slots,emit:n.emit,expose:e}}function Om(n){if(n.exposed)return n.exposeProxy||(n.exposeProxy=new Proxy(AP(EP(n.exposed)),{get(e,t){if(t in e)return e[t];if(t in wh)return wh[t](n)},has(e,t){return t in e||t in wh}}))}function ZF(n,e=!0){return je(n)?n.displayName||n.name:n.name||e&&n.__name}function JF(n){return je(n)&&"__vccOpts"in n}const oe=(n,e)=>CP(n,e,Yh);function Rd(n,e,t){const i=arguments.length;return i===2?Rt(e)&&!$e(e)?Fu(e)?lt(n,null,[e]):lt(n,e):lt(n,null,e):(i>3?t=Array.prototype.slice.call(arguments,2):i===3&&Fu(t)&&(t=[t]),lt(n,e,t))}const QF=Symbol.for("v-scx"),eN=()=>Lt(QF),tN="3.3.4",nN="http://www.w3.org/2000/svg",Ba=typeof document<"u"?document:null,QS=Ba&&Ba.createElement("template"),iN={insert:(n,e,t)=>{e.insertBefore(n,t||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,t,i)=>{const r=e?Ba.createElementNS(nN,n):Ba.createElement(n,t?{is:t}:void 0);return n==="select"&&i&&i.multiple!=null&&r.setAttribute("multiple",i.multiple),r},createText:n=>Ba.createTextNode(n),createComment:n=>Ba.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>Ba.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,t,i,r,s){const o=t?t.previousSibling:e.lastChild;if(r&&(r===s||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),t),!(r===s||!(r=r.nextSibling)););else{QS.innerHTML=i?`<svg>${n}</svg>`:n;const a=QS.content;if(i){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}};function rN(n,e,t){const i=n._vtc;i&&(e=(e?[e,...i]:[...i]).join(" ")),e==null?n.removeAttribute("class"):t?n.setAttribute("class",e):n.className=e}function sN(n,e,t){const i=n.style,r=At(t);if(t&&!r){if(e&&!At(e))for(const s in e)t[s]==null&&i0(i,s,"");for(const s in t)i0(i,s,t[s])}else{const s=i.display;r?e!==t&&(i.cssText=t):e&&n.removeAttribute("style"),"_vod"in n&&(i.display=s)}}const eE=/\s*!important$/;function i0(n,e,t){if($e(t))t.forEach(i=>i0(n,e,i));else if(t==null&&(t=""),e.startsWith("--"))n.setProperty(e,t);else{const i=oN(n,e);eE.test(t)?n.setProperty(vl(i),t.replace(eE,""),"important"):n[i]=t}}const tE=["Webkit","Moz","ms"],kg={};function oN(n,e){const t=kg[e];if(t)return t;let i=Lr(e);if(i!=="filter"&&i in n)return kg[e]=i;i=Mm(i);for(let r=0;r<tE.length;r++){const s=tE[r]+i;if(s in n)return kg[e]=s}return e}const nE="http://www.w3.org/1999/xlink";function aN(n,e,t,i,r){if(i&&e.startsWith("xlink:"))t==null?n.removeAttributeNS(nE,e.slice(6,e.length)):n.setAttributeNS(nE,e,t);else{const s=_D(e);t==null||s&&!aP(t)?n.removeAttribute(e):n.setAttribute(e,s?"":t)}}function lN(n,e,t,i,r,s,o){if(e==="innerHTML"||e==="textContent"){i&&o(i,r,s),n[e]=t??"";return}const a=n.tagName;if(e==="value"&&a!=="PROGRESS"&&!a.includes("-")){n._value=t;const u=a==="OPTION"?n.getAttribute("value"):n.value,c=t??"";u!==c&&(n.value=c),t==null&&n.removeAttribute(e);return}let l=!1;if(t===""||t==null){const u=typeof n[e];u==="boolean"?t=aP(t):t==null&&u==="string"?(t="",l=!0):u==="number"&&(t=0,l=!0)}try{n[e]=t}catch{}l&&n.removeAttribute(e)}function uN(n,e,t,i){n.addEventListener(e,t,i)}function cN(n,e,t,i){n.removeEventListener(e,t,i)}function hN(n,e,t,i,r=null){const s=n._vei||(n._vei={}),o=s[e];if(i&&o)o.value=i;else{const[a,l]=dN(e);if(i){const u=s[e]=mN(i,r);uN(n,a,u,l)}else o&&(cN(n,a,o,l),s[e]=void 0)}}const iE=/(?:Once|Passive|Capture)$/;function dN(n){let e;if(iE.test(n)){e={};let i;for(;i=n.match(iE);)n=n.slice(0,n.length-i[0].length),e[i[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):vl(n.slice(2)),e]}let Vg=0;const fN=Promise.resolve(),pN=()=>Vg||(fN.then(()=>Vg=0),Vg=Date.now());function mN(n,e){const t=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=t.attached)return;tr(gN(i,t.value),e,5,[i])};return t.value=n,t.attached=pN(),t}function gN(n,e){if($e(e)){const t=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{t.call(n),n._stopped=!0},e.map(i=>r=>!r._stopped&&i&&i(r))}else return e}const rE=/^on[a-z]/,_N=(n,e,t,i,r=!1,s,o,a,l)=>{e==="class"?rN(n,i,r):e==="style"?sN(n,t,i):Sm(e)?Yy(e)||hN(n,e,t,i,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):vN(n,e,i,r))?lN(n,e,i,s,o,a,l):(e==="true-value"?n._trueValue=i:e==="false-value"&&(n._falseValue=i),aN(n,e,i,r))};function vN(n,e,t,i){return i?!!(e==="innerHTML"||e==="textContent"||e in n&&rE.test(e)&&je(t)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA"||rE.test(e)&&At(t)?!1:e in n}const io="transition",Ic="animation",_c=(n,{slots:e})=>Rd(pF,yN(n),e);_c.displayName="Transition";const uC={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};_c.props=xn({},BP,uC);const ia=(n,e=[])=>{$e(n)?n.forEach(t=>t(...e)):n&&n(...e)},sE=n=>n?$e(n)?n.some(e=>e.length>1):n.length>1:!1;function yN(n){const e={};for(const L in n)L in uC||(e[L]=n[L]);if(n.css===!1)return e;const{name:t="v",type:i,duration:r,enterFromClass:s=`${t}-enter-from`,enterActiveClass:o=`${t}-enter-active`,enterToClass:a=`${t}-enter-to`,appearFromClass:l=s,appearActiveClass:u=o,appearToClass:c=a,leaveFromClass:h=`${t}-leave-from`,leaveActiveClass:d=`${t}-leave-active`,leaveToClass:f=`${t}-leave-to`}=n,p=xN(r),_=p&&p[0],m=p&&p[1],{onBeforeEnter:g,onEnter:v,onEnterCancelled:y,onLeave:x,onLeaveCancelled:b,onBeforeAppear:S=g,onAppear:T=v,onAppearCancelled:P=y}=e,E=(L,C,D)=>{ra(L,C?c:a),ra(L,C?u:o),D&&D()},M=(L,C)=>{L._isLeaving=!1,ra(L,h),ra(L,f),ra(L,d),C&&C()},O=L=>(C,D)=>{const B=L?T:v,W=()=>E(C,L,D);ia(B,[C,W]),oE(()=>{ra(C,L?l:s),ro(C,L?c:a),sE(B)||aE(C,i,_,W)})};return xn(e,{onBeforeEnter(L){ia(g,[L]),ro(L,s),ro(L,o)},onBeforeAppear(L){ia(S,[L]),ro(L,l),ro(L,u)},onEnter:O(!1),onAppear:O(!0),onLeave(L,C){L._isLeaving=!0;const D=()=>M(L,C);ro(L,h),EN(),ro(L,d),oE(()=>{L._isLeaving&&(ra(L,h),ro(L,f),sE(x)||aE(L,i,m,D))}),ia(x,[L,D])},onEnterCancelled(L){E(L,!1),ia(y,[L])},onAppearCancelled(L){E(L,!0),ia(P,[L])},onLeaveCancelled(L){M(L),ia(b,[L])}})}function xN(n){if(n==null)return null;if(Rt(n))return[Gg(n.enter),Gg(n.leave)];{const e=Gg(n);return[e,e]}}function Gg(n){return hD(n)}function ro(n,e){e.split(/\s+/).forEach(t=>t&&n.classList.add(t)),(n._vtc||(n._vtc=new Set)).add(e)}function ra(n,e){e.split(/\s+/).forEach(i=>i&&n.classList.remove(i));const{_vtc:t}=n;t&&(t.delete(e),t.size||(n._vtc=void 0))}function oE(n){requestAnimationFrame(()=>{requestAnimationFrame(n)})}let bN=0;function aE(n,e,t,i){const r=n._endId=++bN,s=()=>{r===n._endId&&i()};if(t)return setTimeout(s,t);const{type:o,timeout:a,propCount:l}=SN(n,e);if(!o)return i();const u=o+"end";let c=0;const h=()=>{n.removeEventListener(u,d),s()},d=f=>{f.target===n&&++c>=l&&h()};setTimeout(()=>{c<l&&h()},a+1),n.addEventListener(u,d)}function SN(n,e){const t=window.getComputedStyle(n),i=p=>(t[p]||"").split(", "),r=i(`${io}Delay`),s=i(`${io}Duration`),o=lE(r,s),a=i(`${Ic}Delay`),l=i(`${Ic}Duration`),u=lE(a,l);let c=null,h=0,d=0;e===io?o>0&&(c=io,h=o,d=s.length):e===Ic?u>0&&(c=Ic,h=u,d=l.length):(h=Math.max(o,u),c=h>0?o>u?io:Ic:null,d=c?c===io?s.length:l.length:0);const f=c===io&&/\b(transform|all)(,|$)/.test(i(`${io}Property`).toString());return{type:c,timeout:h,propCount:d,hasTransform:f}}function lE(n,e){for(;n.length<e.length;)n=n.concat(n);return Math.max(...e.map((t,i)=>uE(t)+uE(n[i])))}function uE(n){return Number(n.slice(0,-1).replace(",","."))*1e3}function EN(){return document.body.offsetHeight}const TN=["ctrl","shift","alt","meta"],MN={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,e)=>TN.some(t=>n[`${t}Key`]&&!e.includes(t))},Wa=(n,e)=>(t,...i)=>{for(let r=0;r<e.length;r++){const s=MN[e[r]];if(s&&s(t,e))return}return n(t,...i)},wN={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},rf=(n,e)=>t=>{if(!("key"in t))return;const i=vl(t.key);if(e.some(r=>r===i||wN[r]===i))return n(t)},Id={beforeMount(n,{value:e},{transition:t}){n._vod=n.style.display==="none"?"":n.style.display,t&&e?t.beforeEnter(n):Lc(n,e)},mounted(n,{value:e},{transition:t}){t&&e&&t.enter(n)},updated(n,{value:e,oldValue:t},{transition:i}){!e!=!t&&(i?e?(i.beforeEnter(n),Lc(n,!0),i.enter(n)):i.leave(n,()=>{Lc(n,!1)}):Lc(n,e))},beforeUnmount(n,{value:e}){Lc(n,e)}};function Lc(n,e){n.style.display=e?n._vod:"none"}const AN=xn({patchProp:_N},iN);let cE;function cC(){return cE||(cE=NF(AN))}const hE=(...n)=>{cC().render(...n)},PN=(...n)=>{const e=cC().createApp(...n),{mount:t}=e;return e.mount=i=>{const r=CN(i);if(!r)return;const s=e._component;!je(s)&&!s.render&&!s.template&&(s.template=r.innerHTML),r.innerHTML="";const o=t(r,!1,r instanceof SVGElement);return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e};function CN(n){return At(n)?document.querySelector(n):n}function dE(n){let e=window.atob(n),t=e.length,i=new Uint8Array(t);for(let r=0;r<t;r++)i[r]=e.charCodeAt(r);return i.buffer}function RN(n){return n.reduce((e,t)=>e+t,0)}function hC(n,e){return function(){return n.apply(e,arguments)}}const{toString:IN}=Object.prototype,{getPrototypeOf:gx}=Object,Dm=(n=>e=>{const t=IN.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),hs=n=>(n=n.toLowerCase(),e=>Dm(e)===n),Fm=n=>e=>typeof e===n,{isArray:vc}=Array,qh=Fm("undefined");function LN(n){return n!==null&&!qh(n)&&n.constructor!==null&&!qh(n.constructor)&&nr(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const dC=hs("ArrayBuffer");function ON(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&dC(n.buffer),e}const DN=Fm("string"),nr=Fm("function"),fC=Fm("number"),Nm=n=>n!==null&&typeof n=="object",FN=n=>n===!0||n===!1,xp=n=>{if(Dm(n)!=="object")return!1;const e=gx(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},NN=hs("Date"),UN=hs("File"),BN=hs("Blob"),kN=hs("FileList"),VN=n=>Nm(n)&&nr(n.pipe),GN=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||nr(n.append)&&((e=Dm(n))==="formdata"||e==="object"&&nr(n.toString)&&n.toString()==="[object FormData]"))},HN=hs("URLSearchParams"),zN=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ld(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let i,r;if(typeof n!="object"&&(n=[n]),vc(n))for(i=0,r=n.length;i<r;i++)e.call(null,n[i],i,n);else{const s=t?Object.getOwnPropertyNames(n):Object.keys(n),o=s.length;let a;for(i=0;i<o;i++)a=s[i],e.call(null,n[a],a,n)}}function pC(n,e){e=e.toLowerCase();const t=Object.keys(n);let i=t.length,r;for(;i-- >0;)if(r=t[i],e===r.toLowerCase())return r;return null}const mC=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),gC=n=>!qh(n)&&n!==mC;function r0(){const{caseless:n}=gC(this)&&this||{},e={},t=(i,r)=>{const s=n&&pC(e,r)||r;xp(e[s])&&xp(i)?e[s]=r0(e[s],i):xp(i)?e[s]=r0({},i):vc(i)?e[s]=i.slice():e[s]=i};for(let i=0,r=arguments.length;i<r;i++)arguments[i]&&Ld(arguments[i],t);return e}const WN=(n,e,t,{allOwnKeys:i}={})=>(Ld(e,(r,s)=>{t&&nr(r)?n[s]=hC(r,t):n[s]=r},{allOwnKeys:i}),n),XN=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),jN=(n,e,t,i)=>{n.prototype=Object.create(e.prototype,i),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},$N=(n,e,t,i)=>{let r,s,o;const a={};if(e=e||{},n==null)return e;do{for(r=Object.getOwnPropertyNames(n),s=r.length;s-- >0;)o=r[s],(!i||i(o,n,e))&&!a[o]&&(e[o]=n[o],a[o]=!0);n=t!==!1&&gx(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},YN=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const i=n.indexOf(e,t);return i!==-1&&i===t},qN=n=>{if(!n)return null;if(vc(n))return n;let e=n.length;if(!fC(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},KN=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&gx(Uint8Array)),ZN=(n,e)=>{const i=(n&&n[Symbol.iterator]).call(n);let r;for(;(r=i.next())&&!r.done;){const s=r.value;e.call(n,s[0],s[1])}},JN=(n,e)=>{let t;const i=[];for(;(t=n.exec(e))!==null;)i.push(t);return i},QN=hs("HTMLFormElement"),eU=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,i,r){return i.toUpperCase()+r}),fE=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),tU=hs("RegExp"),_C=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),i={};Ld(t,(r,s)=>{e(r,s,n)!==!1&&(i[s]=r)}),Object.defineProperties(n,i)},nU=n=>{_C(n,(e,t)=>{if(nr(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const i=n[t];if(nr(i)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},iU=(n,e)=>{const t={},i=r=>{r.forEach(s=>{t[s]=!0})};return vc(n)?i(n):i(String(n).split(e)),t},rU=()=>{},sU=(n,e)=>(n=+n,Number.isFinite(n)?n:e),Hg="abcdefghijklmnopqrstuvwxyz",pE="0123456789",vC={DIGIT:pE,ALPHA:Hg,ALPHA_DIGIT:Hg+Hg.toUpperCase()+pE},oU=(n=16,e=vC.ALPHA_DIGIT)=>{let t="";const{length:i}=e;for(;n--;)t+=e[Math.random()*i|0];return t};function aU(n){return!!(n&&nr(n.append)&&n[Symbol.toStringTag]==="FormData"&&n[Symbol.iterator])}const lU=n=>{const e=new Array(10),t=(i,r)=>{if(Nm(i)){if(e.indexOf(i)>=0)return;if(!("toJSON"in i)){e[r]=i;const s=vc(i)?[]:{};return Ld(i,(o,a)=>{const l=t(o,r+1);!qh(l)&&(s[a]=l)}),e[r]=void 0,s}}return i};return t(n,0)},uU=hs("AsyncFunction"),cU=n=>n&&(Nm(n)||nr(n))&&nr(n.then)&&nr(n.catch),Se={isArray:vc,isArrayBuffer:dC,isBuffer:LN,isFormData:GN,isArrayBufferView:ON,isString:DN,isNumber:fC,isBoolean:FN,isObject:Nm,isPlainObject:xp,isUndefined:qh,isDate:NN,isFile:UN,isBlob:BN,isRegExp:tU,isFunction:nr,isStream:VN,isURLSearchParams:HN,isTypedArray:KN,isFileList:kN,forEach:Ld,merge:r0,extend:WN,trim:zN,stripBOM:XN,inherits:jN,toFlatObject:$N,kindOf:Dm,kindOfTest:hs,endsWith:YN,toArray:qN,forEachEntry:ZN,matchAll:JN,isHTMLForm:QN,hasOwnProperty:fE,hasOwnProp:fE,reduceDescriptors:_C,freezeMethods:nU,toObjectSet:iU,toCamelCase:eU,noop:rU,toFiniteNumber:sU,findKey:pC,global:mC,isContextDefined:gC,ALPHABET:vC,generateString:oU,isSpecCompliantForm:aU,toJSONObject:lU,isAsyncFn:uU,isThenable:cU};function wt(n,e,t,i,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),i&&(this.request=i),r&&(this.response=r)}Se.inherits(wt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Se.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const yC=wt.prototype,xC={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{xC[n]={value:n}});Object.defineProperties(wt,xC);Object.defineProperty(yC,"isAxiosError",{value:!0});wt.from=(n,e,t,i,r,s)=>{const o=Object.create(yC);return Se.toFlatObject(n,o,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),wt.call(o,n.message,e,t,i,r),o.cause=n,o.name=n.name,s&&Object.assign(o,s),o};const hU=null;function s0(n){return Se.isPlainObject(n)||Se.isArray(n)}function bC(n){return Se.endsWith(n,"[]")?n.slice(0,-2):n}function mE(n,e,t){return n?n.concat(e).map(function(r,s){return r=bC(r),!t&&s?"["+r+"]":r}).join(t?".":""):e}function dU(n){return Se.isArray(n)&&!n.some(s0)}const fU=Se.toFlatObject(Se,{},null,function(e){return/^is[A-Z]/.test(e)});function Um(n,e,t){if(!Se.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=Se.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(_,m){return!Se.isUndefined(m[_])});const i=t.metaTokens,r=t.visitor||c,s=t.dots,o=t.indexes,l=(t.Blob||typeof Blob<"u"&&Blob)&&Se.isSpecCompliantForm(e);if(!Se.isFunction(r))throw new TypeError("visitor must be a function");function u(p){if(p===null)return"";if(Se.isDate(p))return p.toISOString();if(!l&&Se.isBlob(p))throw new wt("Blob is not supported. Use a Buffer instead.");return Se.isArrayBuffer(p)||Se.isTypedArray(p)?l&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function c(p,_,m){let g=p;if(p&&!m&&typeof p=="object"){if(Se.endsWith(_,"{}"))_=i?_:_.slice(0,-2),p=JSON.stringify(p);else if(Se.isArray(p)&&dU(p)||(Se.isFileList(p)||Se.endsWith(_,"[]"))&&(g=Se.toArray(p)))return _=bC(_),g.forEach(function(y,x){!(Se.isUndefined(y)||y===null)&&e.append(o===!0?mE([_],x,s):o===null?_:_+"[]",u(y))}),!1}return s0(p)?!0:(e.append(mE(m,_,s),u(p)),!1)}const h=[],d=Object.assign(fU,{defaultVisitor:c,convertValue:u,isVisitable:s0});function f(p,_){if(!Se.isUndefined(p)){if(h.indexOf(p)!==-1)throw Error("Circular reference detected in "+_.join("."));h.push(p),Se.forEach(p,function(g,v){(!(Se.isUndefined(g)||g===null)&&r.call(e,g,Se.isString(v)?v.trim():v,_,d))===!0&&f(g,_?_.concat(v):[v])}),h.pop()}}if(!Se.isObject(n))throw new TypeError("data must be an object");return f(n),e}function gE(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(i){return e[i]})}function _x(n,e){this._pairs=[],n&&Um(n,this,e)}const SC=_x.prototype;SC.append=function(e,t){this._pairs.push([e,t])};SC.toString=function(e){const t=e?function(i){return e.call(this,i,gE)}:gE;return this._pairs.map(function(r){return t(r[0])+"="+t(r[1])},"").join("&")};function pU(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function EC(n,e,t){if(!e)return n;const i=t&&t.encode||pU,r=t&&t.serialize;let s;if(r?s=r(e,t):s=Se.isURLSearchParams(e)?e.toString():new _x(e,t).toString(i),s){const o=n.indexOf("#");o!==-1&&(n=n.slice(0,o)),n+=(n.indexOf("?")===-1?"?":"&")+s}return n}class mU{constructor(){this.handlers=[]}use(e,t,i){return this.handlers.push({fulfilled:e,rejected:t,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Se.forEach(this.handlers,function(i){i!==null&&e(i)})}}const _E=mU,TC={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},gU=typeof URLSearchParams<"u"?URLSearchParams:_x,_U=typeof FormData<"u"?FormData:null,vU=typeof Blob<"u"?Blob:null,yU=(()=>{let n;return typeof navigator<"u"&&((n=navigator.product)==="ReactNative"||n==="NativeScript"||n==="NS")?!1:typeof window<"u"&&typeof document<"u"})(),xU=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),ns={isBrowser:!0,classes:{URLSearchParams:gU,FormData:_U,Blob:vU},isStandardBrowserEnv:yU,isStandardBrowserWebWorkerEnv:xU,protocols:["http","https","file","blob","url","data"]};function bU(n,e){return Um(n,new ns.classes.URLSearchParams,Object.assign({visitor:function(t,i,r,s){return ns.isNode&&Se.isBuffer(t)?(this.append(i,t.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},e))}function SU(n){return Se.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function EU(n){const e={},t=Object.keys(n);let i;const r=t.length;let s;for(i=0;i<r;i++)s=t[i],e[s]=n[s];return e}function MC(n){function e(t,i,r,s){let o=t[s++];const a=Number.isFinite(+o),l=s>=t.length;return o=!o&&Se.isArray(r)?r.length:o,l?(Se.hasOwnProp(r,o)?r[o]=[r[o],i]:r[o]=i,!a):((!r[o]||!Se.isObject(r[o]))&&(r[o]=[]),e(t,i,r[o],s)&&Se.isArray(r[o])&&(r[o]=EU(r[o])),!a)}if(Se.isFormData(n)&&Se.isFunction(n.entries)){const t={};return Se.forEachEntry(n,(i,r)=>{e(SU(i),r,t,0)}),t}return null}const TU={"Content-Type":void 0};function MU(n,e,t){if(Se.isString(n))try{return(e||JSON.parse)(n),Se.trim(n)}catch(i){if(i.name!=="SyntaxError")throw i}return(t||JSON.stringify)(n)}const Bm={transitional:TC,adapter:["xhr","http"],transformRequest:[function(e,t){const i=t.getContentType()||"",r=i.indexOf("application/json")>-1,s=Se.isObject(e);if(s&&Se.isHTMLForm(e)&&(e=new FormData(e)),Se.isFormData(e))return r&&r?JSON.stringify(MC(e)):e;if(Se.isArrayBuffer(e)||Se.isBuffer(e)||Se.isStream(e)||Se.isFile(e)||Se.isBlob(e))return e;if(Se.isArrayBufferView(e))return e.buffer;if(Se.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(s){if(i.indexOf("application/x-www-form-urlencoded")>-1)return bU(e,this.formSerializer).toString();if((a=Se.isFileList(e))||i.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return Um(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return s||r?(t.setContentType("application/json",!1),MU(e)):e}],transformResponse:[function(e){const t=this.transitional||Bm.transitional,i=t&&t.forcedJSONParsing,r=this.responseType==="json";if(e&&Se.isString(e)&&(i&&!this.responseType||r)){const o=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(a){if(o)throw a.name==="SyntaxError"?wt.from(a,wt.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ns.classes.FormData,Blob:ns.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};Se.forEach(["delete","get","head"],function(e){Bm.headers[e]={}});Se.forEach(["post","put","patch"],function(e){Bm.headers[e]=Se.merge(TU)});const vx=Bm,wU=Se.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),AU=n=>{const e={};let t,i,r;return n&&n.split(`
`).forEach(function(o){r=o.indexOf(":"),t=o.substring(0,r).trim().toLowerCase(),i=o.substring(r+1).trim(),!(!t||e[t]&&wU[t])&&(t==="set-cookie"?e[t]?e[t].push(i):e[t]=[i]:e[t]=e[t]?e[t]+", "+i:i)}),e},vE=Symbol("internals");function Oc(n){return n&&String(n).trim().toLowerCase()}function bp(n){return n===!1||n==null?n:Se.isArray(n)?n.map(bp):String(n)}function PU(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=t.exec(n);)e[i[1]]=i[2];return e}const CU=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function zg(n,e,t,i,r){if(Se.isFunction(i))return i.call(this,e,t);if(r&&(e=t),!!Se.isString(e)){if(Se.isString(i))return e.indexOf(i)!==-1;if(Se.isRegExp(i))return i.test(e)}}function RU(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,i)=>t.toUpperCase()+i)}function IU(n,e){const t=Se.toCamelCase(" "+e);["get","set","has"].forEach(i=>{Object.defineProperty(n,i+t,{value:function(r,s,o){return this[i].call(this,e,r,s,o)},configurable:!0})})}class km{constructor(e){e&&this.set(e)}set(e,t,i){const r=this;function s(a,l,u){const c=Oc(l);if(!c)throw new Error("header name must be a non-empty string");const h=Se.findKey(r,c);(!h||r[h]===void 0||u===!0||u===void 0&&r[h]!==!1)&&(r[h||l]=bp(a))}const o=(a,l)=>Se.forEach(a,(u,c)=>s(u,c,l));return Se.isPlainObject(e)||e instanceof this.constructor?o(e,t):Se.isString(e)&&(e=e.trim())&&!CU(e)?o(AU(e),t):e!=null&&s(t,e,i),this}get(e,t){if(e=Oc(e),e){const i=Se.findKey(this,e);if(i){const r=this[i];if(!t)return r;if(t===!0)return PU(r);if(Se.isFunction(t))return t.call(this,r,i);if(Se.isRegExp(t))return t.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Oc(e),e){const i=Se.findKey(this,e);return!!(i&&this[i]!==void 0&&(!t||zg(this,this[i],i,t)))}return!1}delete(e,t){const i=this;let r=!1;function s(o){if(o=Oc(o),o){const a=Se.findKey(i,o);a&&(!t||zg(i,i[a],a,t))&&(delete i[a],r=!0)}}return Se.isArray(e)?e.forEach(s):s(e),r}clear(e){const t=Object.keys(this);let i=t.length,r=!1;for(;i--;){const s=t[i];(!e||zg(this,this[s],s,e,!0))&&(delete this[s],r=!0)}return r}normalize(e){const t=this,i={};return Se.forEach(this,(r,s)=>{const o=Se.findKey(i,s);if(o){t[o]=bp(r),delete t[s];return}const a=e?RU(s):String(s).trim();a!==s&&delete t[s],t[a]=bp(r),i[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return Se.forEach(this,(i,r)=>{i!=null&&i!==!1&&(t[r]=e&&Se.isArray(i)?i.join(", "):i)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const i=new this(e);return t.forEach(r=>i.set(r)),i}static accessor(e){const i=(this[vE]=this[vE]={accessors:{}}).accessors,r=this.prototype;function s(o){const a=Oc(o);i[a]||(IU(r,o),i[a]=!0)}return Se.isArray(e)?e.forEach(s):s(e),this}}km.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Se.freezeMethods(km.prototype);Se.freezeMethods(km);const zs=km;function Wg(n,e){const t=this||vx,i=e||t,r=zs.from(i.headers);let s=i.data;return Se.forEach(n,function(a){s=a.call(t,s,r.normalize(),e?e.status:void 0)}),r.normalize(),s}function wC(n){return!!(n&&n.__CANCEL__)}function Od(n,e,t){wt.call(this,n??"canceled",wt.ERR_CANCELED,e,t),this.name="CanceledError"}Se.inherits(Od,wt,{__CANCEL__:!0});function LU(n,e,t){const i=t.config.validateStatus;!t.status||!i||i(t.status)?n(t):e(new wt("Request failed with status code "+t.status,[wt.ERR_BAD_REQUEST,wt.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}const OU=ns.isStandardBrowserEnv?function(){return{write:function(t,i,r,s,o,a){const l=[];l.push(t+"="+encodeURIComponent(i)),Se.isNumber(r)&&l.push("expires="+new Date(r).toGMTString()),Se.isString(s)&&l.push("path="+s),Se.isString(o)&&l.push("domain="+o),a===!0&&l.push("secure"),document.cookie=l.join("; ")},read:function(t){const i=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return i?decodeURIComponent(i[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}();function DU(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function FU(n,e){return e?n.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):n}function AC(n,e){return n&&!DU(e)?FU(n,e):e}const NU=ns.isStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a");let i;function r(s){let o=s;return e&&(t.setAttribute("href",o),o=t.href),t.setAttribute("href",o),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:t.pathname.charAt(0)==="/"?t.pathname:"/"+t.pathname}}return i=r(window.location.href),function(o){const a=Se.isString(o)?r(o):o;return a.protocol===i.protocol&&a.host===i.host}}():function(){return function(){return!0}}();function UU(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function BU(n,e){n=n||10;const t=new Array(n),i=new Array(n);let r=0,s=0,o;return e=e!==void 0?e:1e3,function(l){const u=Date.now(),c=i[s];o||(o=u),t[r]=l,i[r]=u;let h=s,d=0;for(;h!==r;)d+=t[h++],h=h%n;if(r=(r+1)%n,r===s&&(s=(s+1)%n),u-o<e)return;const f=c&&u-c;return f?Math.round(d*1e3/f):void 0}}function yE(n,e){let t=0;const i=BU(50,250);return r=>{const s=r.loaded,o=r.lengthComputable?r.total:void 0,a=s-t,l=i(a),u=s<=o;t=s;const c={loaded:s,total:o,progress:o?s/o:void 0,bytes:a,rate:l||void 0,estimated:l&&o&&u?(o-s)/l:void 0,event:r};c[e?"download":"upload"]=!0,n(c)}}const kU=typeof XMLHttpRequest<"u",VU=kU&&function(n){return new Promise(function(t,i){let r=n.data;const s=zs.from(n.headers).normalize(),o=n.responseType;let a;function l(){n.cancelToken&&n.cancelToken.unsubscribe(a),n.signal&&n.signal.removeEventListener("abort",a)}Se.isFormData(r)&&(ns.isStandardBrowserEnv||ns.isStandardBrowserWebWorkerEnv?s.setContentType(!1):s.setContentType("multipart/form-data;",!1));let u=new XMLHttpRequest;if(n.auth){const f=n.auth.username||"",p=n.auth.password?unescape(encodeURIComponent(n.auth.password)):"";s.set("Authorization","Basic "+btoa(f+":"+p))}const c=AC(n.baseURL,n.url);u.open(n.method.toUpperCase(),EC(c,n.params,n.paramsSerializer),!0),u.timeout=n.timeout;function h(){if(!u)return;const f=zs.from("getAllResponseHeaders"in u&&u.getAllResponseHeaders()),_={data:!o||o==="text"||o==="json"?u.responseText:u.response,status:u.status,statusText:u.statusText,headers:f,config:n,request:u};LU(function(g){t(g),l()},function(g){i(g),l()},_),u=null}if("onloadend"in u?u.onloadend=h:u.onreadystatechange=function(){!u||u.readyState!==4||u.status===0&&!(u.responseURL&&u.responseURL.indexOf("file:")===0)||setTimeout(h)},u.onabort=function(){u&&(i(new wt("Request aborted",wt.ECONNABORTED,n,u)),u=null)},u.onerror=function(){i(new wt("Network Error",wt.ERR_NETWORK,n,u)),u=null},u.ontimeout=function(){let p=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const _=n.transitional||TC;n.timeoutErrorMessage&&(p=n.timeoutErrorMessage),i(new wt(p,_.clarifyTimeoutError?wt.ETIMEDOUT:wt.ECONNABORTED,n,u)),u=null},ns.isStandardBrowserEnv){const f=(n.withCredentials||NU(c))&&n.xsrfCookieName&&OU.read(n.xsrfCookieName);f&&s.set(n.xsrfHeaderName,f)}r===void 0&&s.setContentType(null),"setRequestHeader"in u&&Se.forEach(s.toJSON(),function(p,_){u.setRequestHeader(_,p)}),Se.isUndefined(n.withCredentials)||(u.withCredentials=!!n.withCredentials),o&&o!=="json"&&(u.responseType=n.responseType),typeof n.onDownloadProgress=="function"&&u.addEventListener("progress",yE(n.onDownloadProgress,!0)),typeof n.onUploadProgress=="function"&&u.upload&&u.upload.addEventListener("progress",yE(n.onUploadProgress)),(n.cancelToken||n.signal)&&(a=f=>{u&&(i(!f||f.type?new Od(null,n,u):f),u.abort(),u=null)},n.cancelToken&&n.cancelToken.subscribe(a),n.signal&&(n.signal.aborted?a():n.signal.addEventListener("abort",a)));const d=UU(c);if(d&&ns.protocols.indexOf(d)===-1){i(new wt("Unsupported protocol "+d+":",wt.ERR_BAD_REQUEST,n));return}u.send(r||null)})},Sp={http:hU,xhr:VU};Se.forEach(Sp,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const GU={getAdapter:n=>{n=Se.isArray(n)?n:[n];const{length:e}=n;let t,i;for(let r=0;r<e&&(t=n[r],!(i=Se.isString(t)?Sp[t.toLowerCase()]:t));r++);if(!i)throw i===!1?new wt(`Adapter ${t} is not supported by the environment`,"ERR_NOT_SUPPORT"):new Error(Se.hasOwnProp(Sp,t)?`Adapter '${t}' is not available in the build`:`Unknown adapter '${t}'`);if(!Se.isFunction(i))throw new TypeError("adapter is not a function");return i},adapters:Sp};function Xg(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new Od(null,n)}function xE(n){return Xg(n),n.headers=zs.from(n.headers),n.data=Wg.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),GU.getAdapter(n.adapter||vx.adapter)(n).then(function(i){return Xg(n),i.data=Wg.call(n,n.transformResponse,i),i.headers=zs.from(i.headers),i},function(i){return wC(i)||(Xg(n),i&&i.response&&(i.response.data=Wg.call(n,n.transformResponse,i.response),i.response.headers=zs.from(i.response.headers))),Promise.reject(i)})}const bE=n=>n instanceof zs?n.toJSON():n;function Uu(n,e){e=e||{};const t={};function i(u,c,h){return Se.isPlainObject(u)&&Se.isPlainObject(c)?Se.merge.call({caseless:h},u,c):Se.isPlainObject(c)?Se.merge({},c):Se.isArray(c)?c.slice():c}function r(u,c,h){if(Se.isUndefined(c)){if(!Se.isUndefined(u))return i(void 0,u,h)}else return i(u,c,h)}function s(u,c){if(!Se.isUndefined(c))return i(void 0,c)}function o(u,c){if(Se.isUndefined(c)){if(!Se.isUndefined(u))return i(void 0,u)}else return i(void 0,c)}function a(u,c,h){if(h in e)return i(u,c);if(h in n)return i(void 0,u)}const l={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(u,c)=>r(bE(u),bE(c),!0)};return Se.forEach(Object.keys(Object.assign({},n,e)),function(c){const h=l[c]||r,d=h(n[c],e[c],c);Se.isUndefined(d)&&h!==a||(t[c]=d)}),t}const PC="1.4.0",yx={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{yx[n]=function(i){return typeof i===n||"a"+(e<1?"n ":" ")+n}});const SE={};yx.transitional=function(e,t,i){function r(s,o){return"[Axios v"+PC+"] Transitional option '"+s+"'"+o+(i?". "+i:"")}return(s,o,a)=>{if(e===!1)throw new wt(r(o," has been removed"+(t?" in "+t:"")),wt.ERR_DEPRECATED);return t&&!SE[o]&&(SE[o]=!0,console.warn(r(o," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(s,o,a):!0}};function HU(n,e,t){if(typeof n!="object")throw new wt("options must be an object",wt.ERR_BAD_OPTION_VALUE);const i=Object.keys(n);let r=i.length;for(;r-- >0;){const s=i[r],o=e[s];if(o){const a=n[s],l=a===void 0||o(a,s,n);if(l!==!0)throw new wt("option "+s+" must be "+l,wt.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new wt("Unknown option "+s,wt.ERR_BAD_OPTION)}}const o0={assertOptions:HU,validators:yx},so=o0.validators;class Xp{constructor(e){this.defaults=e,this.interceptors={request:new _E,response:new _E}}request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=Uu(this.defaults,t);const{transitional:i,paramsSerializer:r,headers:s}=t;i!==void 0&&o0.assertOptions(i,{silentJSONParsing:so.transitional(so.boolean),forcedJSONParsing:so.transitional(so.boolean),clarifyTimeoutError:so.transitional(so.boolean)},!1),r!=null&&(Se.isFunction(r)?t.paramsSerializer={serialize:r}:o0.assertOptions(r,{encode:so.function,serialize:so.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o;o=s&&Se.merge(s.common,s[t.method]),o&&Se.forEach(["delete","get","head","post","put","patch","common"],p=>{delete s[p]}),t.headers=zs.concat(o,s);const a=[];let l=!0;this.interceptors.request.forEach(function(_){typeof _.runWhen=="function"&&_.runWhen(t)===!1||(l=l&&_.synchronous,a.unshift(_.fulfilled,_.rejected))});const u=[];this.interceptors.response.forEach(function(_){u.push(_.fulfilled,_.rejected)});let c,h=0,d;if(!l){const p=[xE.bind(this),void 0];for(p.unshift.apply(p,a),p.push.apply(p,u),d=p.length,c=Promise.resolve(t);h<d;)c=c.then(p[h++],p[h++]);return c}d=a.length;let f=t;for(h=0;h<d;){const p=a[h++],_=a[h++];try{f=p(f)}catch(m){_.call(this,m);break}}try{c=xE.call(this,f)}catch(p){return Promise.reject(p)}for(h=0,d=u.length;h<d;)c=c.then(u[h++],u[h++]);return c}getUri(e){e=Uu(this.defaults,e);const t=AC(e.baseURL,e.url);return EC(t,e.params,e.paramsSerializer)}}Se.forEach(["delete","get","head","options"],function(e){Xp.prototype[e]=function(t,i){return this.request(Uu(i||{},{method:e,url:t,data:(i||{}).data}))}});Se.forEach(["post","put","patch"],function(e){function t(i){return function(s,o,a){return this.request(Uu(a||{},{method:e,headers:i?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}Xp.prototype[e]=t(),Xp.prototype[e+"Form"]=t(!0)});const Ep=Xp;class xx{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(s){t=s});const i=this;this.promise.then(r=>{if(!i._listeners)return;let s=i._listeners.length;for(;s-- >0;)i._listeners[s](r);i._listeners=null}),this.promise.then=r=>{let s;const o=new Promise(a=>{i.subscribe(a),s=a}).then(r);return o.cancel=function(){i.unsubscribe(s)},o},e(function(s,o,a){i.reason||(i.reason=new Od(s,o,a),t(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}static source(){let e;return{token:new xx(function(r){e=r}),cancel:e}}}const zU=xx;function WU(n){return function(t){return n.apply(null,t)}}function XU(n){return Se.isObject(n)&&n.isAxiosError===!0}const a0={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(a0).forEach(([n,e])=>{a0[e]=n});const jU=a0;function CC(n){const e=new Ep(n),t=hC(Ep.prototype.request,e);return Se.extend(t,Ep.prototype,e,{allOwnKeys:!0}),Se.extend(t,e,null,{allOwnKeys:!0}),t.create=function(r){return CC(Uu(n,r))},t}const wn=CC(vx);wn.Axios=Ep;wn.CanceledError=Od;wn.CancelToken=zU;wn.isCancel=wC;wn.VERSION=PC;wn.toFormData=Um;wn.AxiosError=wt;wn.Cancel=wn.CanceledError;wn.all=function(e){return Promise.all(e)};wn.spread=WU;wn.isAxiosError=XU;wn.mergeConfig=Uu;wn.AxiosHeaders=zs;wn.formToJSON=n=>MC(Se.isHTMLForm(n)?new FormData(n):n);wn.HttpStatusCode=jU;wn.default=wn;const RC=wn;async function IC(n){let e;switch(n.VType){case 1:e=await RC({url:n.voice,method:"get",responseType:"arraybuffer"}),e=e.data;break;case 2:e=dE(n.voice);break;case 3:e=dE(n.voice);break}return e}let xr,Xr,gu,jg=!1,$U=80;async function YU(n,e){let t;t=await IC(n);const i=t;xr.decodeAudioData(i,o=>{const a=xr.createBufferSource();a.buffer=o,a.connect(xr.destination),a.connect(Xr),jg=!0,r(),setTimeout(()=>{a.start(0)},.5),e.state.model4.expression(n.expression),e.state.model4.motion(n.act,n.movement),a.onended=()=>{jg=!1,e.state.websocket.send(0),e.state.model4.expression(0)}}).catch(o=>{console.log(o),e.state.websocket.send(-1)});function r(){if(!jg)return;const o=KU(),a=[];for(var l=0;l<700;l+=$U)a.push(o[l]);s((RN(a)/a.length-20)/e.state.percentage),setTimeout(r,1e3/60)}function s(o){o=Math.max(0,Math.min(1,o)),console.log(o),e.state.model4.internalModel.coreModel.setParameterValueByIndex(e.state.parameterIndex,o,1,!0)}}function qU(){location.protocol==="https:"?navigator.userAgent.indexOf("Firefox")!=-1||navigator.userAgent.indexOf("Chrome")!=-1?navigator.mediaDevices.getUserMedia({audio:!0}).then(function(n){xr=new AudioContext,Xr=xr.createAnalyser(),gu=new Uint8Array(Xr.frequencyBinCount)}).catch(function(n){alert("未授予音频权限或发生错误："+n.name+",请将sound(autoplay)权限改为allow"),xr=new AudioContext,Xr=xr.createAnalyser(),gu=new Uint8Array(Xr.frequencyBinCount)}):(xr=new AudioContext,Xr=xr.createAnalyser(),gu=new Uint8Array(Xr.frequencyBinCount)):(xr=new AudioContext,Xr=xr.createAnalyser(),gu=new Uint8Array(Xr.frequencyBinCount))}function KU(){return Xr.getByteFrequencyData(gu),gu}function ZU(){return LC().__VUE_DEVTOOLS_GLOBAL_HOOK__}function LC(){return typeof navigator<"u"&&typeof window<"u"?window:typeof global<"u"?global:{}}const JU=typeof Proxy=="function",QU="devtools-plugin:setup",eB="plugin:settings:set";let Pl,l0;function tB(){var n;return Pl!==void 0||(typeof window<"u"&&window.performance?(Pl=!0,l0=window.performance):typeof global<"u"&&(!((n=global.perf_hooks)===null||n===void 0)&&n.performance)?(Pl=!0,l0=global.perf_hooks.performance):Pl=!1),Pl}function nB(){return tB()?l0.now():Date.now()}class iB{constructor(e,t){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=e,this.hook=t;const i={};if(e.settings)for(const o in e.settings){const a=e.settings[o];i[o]=a.defaultValue}const r=`__vue-devtools-plugin-settings__${e.id}`;let s=Object.assign({},i);try{const o=localStorage.getItem(r),a=JSON.parse(o);Object.assign(s,a)}catch{}this.fallbacks={getSettings(){return s},setSettings(o){try{localStorage.setItem(r,JSON.stringify(o))}catch{}s=o},now(){return nB()}},t&&t.on(eB,(o,a)=>{o===this.plugin.id&&this.fallbacks.setSettings(a)}),this.proxiedOn=new Proxy({},{get:(o,a)=>this.target?this.target.on[a]:(...l)=>{this.onQueue.push({method:a,args:l})}}),this.proxiedTarget=new Proxy({},{get:(o,a)=>this.target?this.target[a]:a==="on"?this.proxiedOn:Object.keys(this.fallbacks).includes(a)?(...l)=>(this.targetQueue.push({method:a,args:l,resolve:()=>{}}),this.fallbacks[a](...l)):(...l)=>new Promise(u=>{this.targetQueue.push({method:a,args:l,resolve:u})})})}async setRealTarget(e){this.target=e;for(const t of this.onQueue)this.target.on[t.method](...t.args);for(const t of this.targetQueue)t.resolve(await this.target[t.method](...t.args))}}function rB(n,e){const t=n,i=LC(),r=ZU(),s=JU&&t.enableEarlyProxy;if(r&&(i.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__||!s))r.emit(QU,n,e);else{const o=s?new iB(t,r):null;(i.__VUE_DEVTOOLS_PLUGINS__=i.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:t,setupFn:e,proxy:o}),o&&e(o.proxiedTarget)}}/*!
 * vuex v4.1.0
 * (c) 2022 Evan You
 * @license MIT
 */var OC="store";function yl(n){return n===void 0&&(n=null),Lt(n!==null?n:OC)}function yc(n,e){Object.keys(n).forEach(function(t){return e(n[t],t)})}function sB(n){return n!==null&&typeof n=="object"}function oB(n){return n&&typeof n.then=="function"}function aB(n,e){return function(){return n(e)}}function DC(n,e,t){return e.indexOf(n)<0&&(t&&t.prepend?e.unshift(n):e.push(n)),function(){var i=e.indexOf(n);i>-1&&e.splice(i,1)}}function FC(n,e){n._actions=Object.create(null),n._mutations=Object.create(null),n._wrappedGetters=Object.create(null),n._modulesNamespaceMap=Object.create(null);var t=n.state;Vm(n,t,[],n._modules.root,!0),bx(n,t,e)}function bx(n,e,t){var i=n._state,r=n._scope;n.getters={},n._makeLocalGettersCache=Object.create(null);var s=n._wrappedGetters,o={},a={},l=vD(!0);l.run(function(){yc(s,function(u,c){o[c]=aB(u,n),a[c]=oe(function(){return o[c]()}),Object.defineProperty(n.getters,c,{get:function(){return a[c].value},enumerable:!0})})}),n._state=Zs({data:e}),n._scope=l,n.strict&&dB(n),i&&t&&n._withCommit(function(){i.data=null}),r&&r.stop()}function Vm(n,e,t,i,r){var s=!t.length,o=n._modules.getNamespace(t);if(i.namespaced&&(n._modulesNamespaceMap[o],n._modulesNamespaceMap[o]=i),!s&&!r){var a=Sx(e,t.slice(0,-1)),l=t[t.length-1];n._withCommit(function(){a[l]=i.state})}var u=i.context=lB(n,o,t);i.forEachMutation(function(c,h){var d=o+h;uB(n,d,c,u)}),i.forEachAction(function(c,h){var d=c.root?h:o+h,f=c.handler||c;cB(n,d,f,u)}),i.forEachGetter(function(c,h){var d=o+h;hB(n,d,c,u)}),i.forEachChild(function(c,h){Vm(n,e,t.concat(h),c,r)})}function lB(n,e,t){var i=e==="",r={dispatch:i?n.dispatch:function(s,o,a){var l=jp(s,o,a),u=l.payload,c=l.options,h=l.type;return(!c||!c.root)&&(h=e+h),n.dispatch(h,u)},commit:i?n.commit:function(s,o,a){var l=jp(s,o,a),u=l.payload,c=l.options,h=l.type;(!c||!c.root)&&(h=e+h),n.commit(h,u,c)}};return Object.defineProperties(r,{getters:{get:i?function(){return n.getters}:function(){return NC(n,e)}},state:{get:function(){return Sx(n.state,t)}}}),r}function NC(n,e){if(!n._makeLocalGettersCache[e]){var t={},i=e.length;Object.keys(n.getters).forEach(function(r){if(r.slice(0,i)===e){var s=r.slice(i);Object.defineProperty(t,s,{get:function(){return n.getters[r]},enumerable:!0})}}),n._makeLocalGettersCache[e]=t}return n._makeLocalGettersCache[e]}function uB(n,e,t,i){var r=n._mutations[e]||(n._mutations[e]=[]);r.push(function(o){t.call(n,i.state,o)})}function cB(n,e,t,i){var r=n._actions[e]||(n._actions[e]=[]);r.push(function(o){var a=t.call(n,{dispatch:i.dispatch,commit:i.commit,getters:i.getters,state:i.state,rootGetters:n.getters,rootState:n.state},o);return oB(a)||(a=Promise.resolve(a)),n._devtoolHook?a.catch(function(l){throw n._devtoolHook.emit("vuex:error",l),l}):a})}function hB(n,e,t,i){n._wrappedGetters[e]||(n._wrappedGetters[e]=function(s){return t(i.state,i.getters,s.state,s.getters)})}function dB(n){et(function(){return n._state.data},function(){},{deep:!0,flush:"sync"})}function Sx(n,e){return e.reduce(function(t,i){return t[i]},n)}function jp(n,e,t){return sB(n)&&n.type&&(t=e,e=n,n=n.type),{type:n,payload:e,options:t}}var fB="vuex bindings",EE="vuex:mutations",$g="vuex:actions",Cl="vuex",pB=0;function mB(n,e){rB({id:"org.vuejs.vuex",app:n,label:"Vuex",homepage:"https://next.vuex.vuejs.org/",logo:"https://vuejs.org/images/icons/favicon-96x96.png",packageName:"vuex",componentStateTypes:[fB]},function(t){t.addTimelineLayer({id:EE,label:"Vuex Mutations",color:TE}),t.addTimelineLayer({id:$g,label:"Vuex Actions",color:TE}),t.addInspector({id:Cl,label:"Vuex",icon:"storage",treeFilterPlaceholder:"Filter stores..."}),t.on.getInspectorTree(function(i){if(i.app===n&&i.inspectorId===Cl)if(i.filter){var r=[];VC(r,e._modules.root,i.filter,""),i.rootNodes=r}else i.rootNodes=[kC(e._modules.root,"")]}),t.on.getInspectorState(function(i){if(i.app===n&&i.inspectorId===Cl){var r=i.nodeId;NC(e,r),i.state=vB(xB(e._modules,r),r==="root"?e.getters:e._makeLocalGettersCache,r)}}),t.on.editInspectorState(function(i){if(i.app===n&&i.inspectorId===Cl){var r=i.nodeId,s=i.path;r!=="root"&&(s=r.split("/").filter(Boolean).concat(s)),e._withCommit(function(){i.set(e._state.data,s,i.state.value)})}}),e.subscribe(function(i,r){var s={};i.payload&&(s.payload=i.payload),s.state=r,t.notifyComponentUpdate(),t.sendInspectorTree(Cl),t.sendInspectorState(Cl),t.addTimelineEvent({layerId:EE,event:{time:Date.now(),title:i.type,data:s}})}),e.subscribeAction({before:function(i,r){var s={};i.payload&&(s.payload=i.payload),i._id=pB++,i._time=Date.now(),s.state=r,t.addTimelineEvent({layerId:$g,event:{time:i._time,title:i.type,groupId:i._id,subtitle:"start",data:s}})},after:function(i,r){var s={},o=Date.now()-i._time;s.duration={_custom:{type:"duration",display:o+"ms",tooltip:"Action duration",value:o}},i.payload&&(s.payload=i.payload),s.state=r,t.addTimelineEvent({layerId:$g,event:{time:Date.now(),title:i.type,groupId:i._id,subtitle:"end",data:s}})}})})}var TE=8702998,gB=6710886,_B=16777215,UC={label:"namespaced",textColor:_B,backgroundColor:gB};function BC(n){return n&&n!=="root"?n.split("/").slice(-2,-1)[0]:"Root"}function kC(n,e){return{id:e||"root",label:BC(e),tags:n.namespaced?[UC]:[],children:Object.keys(n._children).map(function(t){return kC(n._children[t],e+t+"/")})}}function VC(n,e,t,i){i.includes(t)&&n.push({id:i||"root",label:i.endsWith("/")?i.slice(0,i.length-1):i||"Root",tags:e.namespaced?[UC]:[]}),Object.keys(e._children).forEach(function(r){VC(n,e._children[r],t,i+r+"/")})}function vB(n,e,t){e=t==="root"?e:e[t];var i=Object.keys(e),r={state:Object.keys(n.state).map(function(o){return{key:o,editable:!0,value:n.state[o]}})};if(i.length){var s=yB(e);r.getters=Object.keys(s).map(function(o){return{key:o.endsWith("/")?BC(o):o,editable:!1,value:u0(function(){return s[o]})}})}return r}function yB(n){var e={};return Object.keys(n).forEach(function(t){var i=t.split("/");if(i.length>1){var r=e,s=i.pop();i.forEach(function(o){r[o]||(r[o]={_custom:{value:{},display:o,tooltip:"Module",abstract:!0}}),r=r[o]._custom.value}),r[s]=u0(function(){return n[t]})}else e[t]=u0(function(){return n[t]})}),e}function xB(n,e){var t=e.split("/").filter(function(i){return i});return t.reduce(function(i,r,s){var o=i[r];if(!o)throw new Error('Missing module "'+r+'" for path "'+e+'".');return s===t.length-1?o:o._children},e==="root"?n:n.root._children)}function u0(n){try{return n()}catch(e){return e}}var Nr=function(e,t){this.runtime=t,this._children=Object.create(null),this._rawModule=e;var i=e.state;this.state=(typeof i=="function"?i():i)||{}},GC={namespaced:{configurable:!0}};GC.namespaced.get=function(){return!!this._rawModule.namespaced};Nr.prototype.addChild=function(e,t){this._children[e]=t};Nr.prototype.removeChild=function(e){delete this._children[e]};Nr.prototype.getChild=function(e){return this._children[e]};Nr.prototype.hasChild=function(e){return e in this._children};Nr.prototype.update=function(e){this._rawModule.namespaced=e.namespaced,e.actions&&(this._rawModule.actions=e.actions),e.mutations&&(this._rawModule.mutations=e.mutations),e.getters&&(this._rawModule.getters=e.getters)};Nr.prototype.forEachChild=function(e){yc(this._children,e)};Nr.prototype.forEachGetter=function(e){this._rawModule.getters&&yc(this._rawModule.getters,e)};Nr.prototype.forEachAction=function(e){this._rawModule.actions&&yc(this._rawModule.actions,e)};Nr.prototype.forEachMutation=function(e){this._rawModule.mutations&&yc(this._rawModule.mutations,e)};Object.defineProperties(Nr.prototype,GC);var xl=function(e){this.register([],e,!1)};xl.prototype.get=function(e){return e.reduce(function(t,i){return t.getChild(i)},this.root)};xl.prototype.getNamespace=function(e){var t=this.root;return e.reduce(function(i,r){return t=t.getChild(r),i+(t.namespaced?r+"/":"")},"")};xl.prototype.update=function(e){HC([],this.root,e)};xl.prototype.register=function(e,t,i){var r=this;i===void 0&&(i=!0);var s=new Nr(t,i);if(e.length===0)this.root=s;else{var o=this.get(e.slice(0,-1));o.addChild(e[e.length-1],s)}t.modules&&yc(t.modules,function(a,l){r.register(e.concat(l),a,i)})};xl.prototype.unregister=function(e){var t=this.get(e.slice(0,-1)),i=e[e.length-1],r=t.getChild(i);r&&r.runtime&&t.removeChild(i)};xl.prototype.isRegistered=function(e){var t=this.get(e.slice(0,-1)),i=e[e.length-1];return t?t.hasChild(i):!1};function HC(n,e,t){if(e.update(t),t.modules)for(var i in t.modules){if(!e.getChild(i))return;HC(n.concat(i),e.getChild(i),t.modules[i])}}function bB(n){return new bi(n)}var bi=function(e){var t=this;e===void 0&&(e={});var i=e.plugins;i===void 0&&(i=[]);var r=e.strict;r===void 0&&(r=!1);var s=e.devtools;this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new xl(e),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._makeLocalGettersCache=Object.create(null),this._scope=null,this._devtools=s;var o=this,a=this,l=a.dispatch,u=a.commit;this.dispatch=function(d,f){return l.call(o,d,f)},this.commit=function(d,f,p){return u.call(o,d,f,p)},this.strict=r;var c=this._modules.root.state;Vm(this,c,[],this._modules.root),bx(this,c),i.forEach(function(h){return h(t)})},Ex={state:{configurable:!0}};bi.prototype.install=function(e,t){e.provide(t||OC,this),e.config.globalProperties.$store=this;var i=this._devtools!==void 0?this._devtools:!1;i&&mB(e,this)};Ex.state.get=function(){return this._state.data};Ex.state.set=function(n){};bi.prototype.commit=function(e,t,i){var r=this,s=jp(e,t,i),o=s.type,a=s.payload,l={type:o,payload:a},u=this._mutations[o];u&&(this._withCommit(function(){u.forEach(function(h){h(a)})}),this._subscribers.slice().forEach(function(c){return c(l,r.state)}))};bi.prototype.dispatch=function(e,t){var i=this,r=jp(e,t),s=r.type,o=r.payload,a={type:s,payload:o},l=this._actions[s];if(l){try{this._actionSubscribers.slice().filter(function(c){return c.before}).forEach(function(c){return c.before(a,i.state)})}catch{}var u=l.length>1?Promise.all(l.map(function(c){return c(o)})):l[0](o);return new Promise(function(c,h){u.then(function(d){try{i._actionSubscribers.filter(function(f){return f.after}).forEach(function(f){return f.after(a,i.state)})}catch{}c(d)},function(d){try{i._actionSubscribers.filter(function(f){return f.error}).forEach(function(f){return f.error(a,i.state,d)})}catch{}h(d)})})}};bi.prototype.subscribe=function(e,t){return DC(e,this._subscribers,t)};bi.prototype.subscribeAction=function(e,t){var i=typeof e=="function"?{before:e}:e;return DC(i,this._actionSubscribers,t)};bi.prototype.watch=function(e,t,i){var r=this;return et(function(){return e(r.state,r.getters)},t,Object.assign({},i))};bi.prototype.replaceState=function(e){var t=this;this._withCommit(function(){t._state.data=e})};bi.prototype.registerModule=function(e,t,i){i===void 0&&(i={}),typeof e=="string"&&(e=[e]),this._modules.register(e,t),Vm(this,this.state,e,this._modules.get(e),i.preserveState),bx(this,this.state)};bi.prototype.unregisterModule=function(e){var t=this;typeof e=="string"&&(e=[e]),this._modules.unregister(e),this._withCommit(function(){var i=Sx(t.state,e.slice(0,-1));delete i[e[e.length-1]]}),FC(this)};bi.prototype.hasModule=function(e){return typeof e=="string"&&(e=[e]),this._modules.isRegistered(e)};bi.prototype.hotUpdate=function(e){this._modules.update(e),FC(this,!0)};bi.prototype._withCommit=function(e){var t=this._committing;this._committing=!0,e(),this._committing=t};Object.defineProperties(bi.prototype,Ex);const SB=()=>{let n=Promise.resolve(),e=Promise.resolve();return(t,i,r,s)=>{const o=n.then(async()=>await IC(t));n=o,e=Promise.all([o,e]).then(([a])=>{var l;if(r==null||r(),!!a)return(l=i.model)==null?void 0:l.speak(a)}),e.then(()=>{s==null||s()})}},EB=SB(),Is=(n,e,{checkForDefaultPrevented:t=!0}={})=>r=>{const s=n==null?void 0:n(r);if(t===!1||!s)return e==null?void 0:e(r)};var ME;const Un=typeof window<"u",TB=n=>typeof n=="string",zC=()=>{},MB=Un&&((ME=window==null?void 0:window.navigator)==null?void 0:ME.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function Tx(n){return typeof n=="function"?n():R(n)}function wB(n){return n}function Gm(n){return cP()?(hP(n),!0):!1}function AB(n,e=!0){Fr()?Sn(n):e?n():Kn(n)}function c0(n,e,t={}){const{immediate:i=!0}=t,r=Fe(!1);let s=null;function o(){s&&(clearTimeout(s),s=null)}function a(){r.value=!1,o()}function l(...u){o(),r.value=!0,s=setTimeout(()=>{r.value=!1,s=null,n(...u)},Tx(e))}return i&&(r.value=!0,Un&&l()),Gm(a),{isPending:Am(r),start:l,stop:a}}function Ao(n){var e;const t=Tx(n);return(e=t==null?void 0:t.$el)!=null?e:t}const Mx=Un?window:void 0;function Mu(...n){let e,t,i,r;if(TB(n[0])||Array.isArray(n[0])?([t,i,r]=n,e=Mx):[e,t,i,r]=n,!e)return zC;Array.isArray(t)||(t=[t]),Array.isArray(i)||(i=[i]);const s=[],o=()=>{s.forEach(c=>c()),s.length=0},a=(c,h,d,f)=>(c.addEventListener(h,d,f),()=>c.removeEventListener(h,d,f)),l=et(()=>[Ao(e),Tx(r)],([c,h])=>{o(),c&&s.push(...t.flatMap(d=>i.map(f=>a(c,d,f,h))))},{immediate:!0,flush:"post"}),u=()=>{l(),o()};return Gm(u),u}let wE=!1;function PB(n,e,t={}){const{window:i=Mx,ignore:r=[],capture:s=!0,detectIframe:o=!1}=t;if(!i)return;MB&&!wE&&(wE=!0,Array.from(i.document.body.children).forEach(d=>d.addEventListener("click",zC)));let a=!0;const l=d=>r.some(f=>{if(typeof f=="string")return Array.from(i.document.querySelectorAll(f)).some(p=>p===d.target||d.composedPath().includes(p));{const p=Ao(f);return p&&(d.target===p||d.composedPath().includes(p))}}),c=[Mu(i,"click",d=>{const f=Ao(n);if(!(!f||f===d.target||d.composedPath().includes(f))){if(d.detail===0&&(a=!l(d)),!a){a=!0;return}e(d)}},{passive:!0,capture:s}),Mu(i,"pointerdown",d=>{const f=Ao(n);f&&(a=!d.composedPath().includes(f)&&!l(d))},{passive:!0}),o&&Mu(i,"blur",d=>{var f;const p=Ao(n);((f=i.document.activeElement)==null?void 0:f.tagName)==="IFRAME"&&!(p!=null&&p.contains(i.document.activeElement))&&e(d)})].filter(Boolean);return()=>c.forEach(d=>d())}function CB(n,e=!1){const t=Fe(),i=()=>t.value=!!n();return i(),AB(i,e),t}const AE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},PE="__vueuse_ssr_handlers__";AE[PE]=AE[PE]||{};var CE=Object.getOwnPropertySymbols,RB=Object.prototype.hasOwnProperty,IB=Object.prototype.propertyIsEnumerable,LB=(n,e)=>{var t={};for(var i in n)RB.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&CE)for(var i of CE(n))e.indexOf(i)<0&&IB.call(n,i)&&(t[i]=n[i]);return t};function WC(n,e,t={}){const i=t,{window:r=Mx}=i,s=LB(i,["window"]);let o;const a=CB(()=>r&&"ResizeObserver"in r),l=()=>{o&&(o.disconnect(),o=void 0)},u=et(()=>Ao(n),h=>{l(),a.value&&r&&h&&(o=new ResizeObserver(e),o.observe(h,s))},{immediate:!0,flush:"post"}),c=()=>{l(),u()};return Gm(c),{isSupported:a,stop:c}}var RE;(function(n){n.UP="UP",n.RIGHT="RIGHT",n.DOWN="DOWN",n.LEFT="LEFT",n.NONE="NONE"})(RE||(RE={}));var OB=Object.defineProperty,IE=Object.getOwnPropertySymbols,DB=Object.prototype.hasOwnProperty,FB=Object.prototype.propertyIsEnumerable,LE=(n,e,t)=>e in n?OB(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,NB=(n,e)=>{for(var t in e||(e={}))DB.call(e,t)&&LE(n,t,e[t]);if(IE)for(var t of IE(e))FB.call(e,t)&&LE(n,t,e[t]);return n};const UB={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};NB({linear:wB},UB);const BB=()=>Un&&/firefox/i.test(window.navigator.userAgent);var kB=typeof global=="object"&&global&&global.Object===Object&&global;const VB=kB;var GB=typeof self=="object"&&self&&self.Object===Object&&self,HB=VB||GB||Function("return this")();const Hm=HB;var zB=Hm.Symbol;const Bu=zB;var XC=Object.prototype,WB=XC.hasOwnProperty,XB=XC.toString,Dc=Bu?Bu.toStringTag:void 0;function jB(n){var e=WB.call(n,Dc),t=n[Dc];try{n[Dc]=void 0;var i=!0}catch{}var r=XB.call(n);return i&&(e?n[Dc]=t:delete n[Dc]),r}var $B=Object.prototype,YB=$B.toString;function qB(n){return YB.call(n)}var KB="[object Null]",ZB="[object Undefined]",OE=Bu?Bu.toStringTag:void 0;function jC(n){return n==null?n===void 0?ZB:KB:OE&&OE in Object(n)?jB(n):qB(n)}function JB(n){return n!=null&&typeof n=="object"}var QB="[object Symbol]";function zm(n){return typeof n=="symbol"||JB(n)&&jC(n)==QB}function e3(n,e){for(var t=-1,i=n==null?0:n.length,r=Array(i);++t<i;)r[t]=e(n[t],t,n);return r}var t3=Array.isArray;const wx=t3;var n3=1/0,DE=Bu?Bu.prototype:void 0,FE=DE?DE.toString:void 0;function $C(n){if(typeof n=="string")return n;if(wx(n))return e3(n,$C)+"";if(zm(n))return FE?FE.call(n):"";var e=n+"";return e=="0"&&1/n==-n3?"-0":e}var i3=/\s/;function r3(n){for(var e=n.length;e--&&i3.test(n.charAt(e)););return e}var s3=/^\s+/;function o3(n){return n&&n.slice(0,r3(n)+1).replace(s3,"")}function Kh(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}var NE=0/0,a3=/^[-+]0x[0-9a-f]+$/i,l3=/^0b[01]+$/i,u3=/^0o[0-7]+$/i,c3=parseInt;function UE(n){if(typeof n=="number")return n;if(zm(n))return NE;if(Kh(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=Kh(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=o3(n);var t=l3.test(n);return t||u3.test(n)?c3(n.slice(2),t?2:8):a3.test(n)?NE:+n}var h3="[object AsyncFunction]",d3="[object Function]",f3="[object GeneratorFunction]",p3="[object Proxy]";function m3(n){if(!Kh(n))return!1;var e=jC(n);return e==d3||e==f3||e==h3||e==p3}var g3=Hm["__core-js_shared__"];const Yg=g3;var BE=function(){var n=/[^.]+$/.exec(Yg&&Yg.keys&&Yg.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function _3(n){return!!BE&&BE in n}var v3=Function.prototype,y3=v3.toString;function x3(n){if(n!=null){try{return y3.call(n)}catch{}try{return n+""}catch{}}return""}var b3=/[\\^$.*+?()[\]{}|]/g,S3=/^\[object .+?Constructor\]$/,E3=Function.prototype,T3=Object.prototype,M3=E3.toString,w3=T3.hasOwnProperty,A3=RegExp("^"+M3.call(w3).replace(b3,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function P3(n){if(!Kh(n)||_3(n))return!1;var e=m3(n)?A3:S3;return e.test(x3(n))}function C3(n,e){return n==null?void 0:n[e]}function YC(n,e){var t=C3(n,e);return P3(t)?t:void 0}function R3(n,e){return n===e||n!==n&&e!==e}var I3=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,L3=/^\w*$/;function O3(n,e){if(wx(n))return!1;var t=typeof n;return t=="number"||t=="symbol"||t=="boolean"||n==null||zm(n)?!0:L3.test(n)||!I3.test(n)||e!=null&&n in Object(e)}var D3=YC(Object,"create");const Zh=D3;function F3(){this.__data__=Zh?Zh(null):{},this.size=0}function N3(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e}var U3="__lodash_hash_undefined__",B3=Object.prototype,k3=B3.hasOwnProperty;function V3(n){var e=this.__data__;if(Zh){var t=e[n];return t===U3?void 0:t}return k3.call(e,n)?e[n]:void 0}var G3=Object.prototype,H3=G3.hasOwnProperty;function z3(n){var e=this.__data__;return Zh?e[n]!==void 0:H3.call(e,n)}var W3="__lodash_hash_undefined__";function X3(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=Zh&&e===void 0?W3:e,this}function ul(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var i=n[e];this.set(i[0],i[1])}}ul.prototype.clear=F3;ul.prototype.delete=N3;ul.prototype.get=V3;ul.prototype.has=z3;ul.prototype.set=X3;function j3(){this.__data__=[],this.size=0}function Wm(n,e){for(var t=n.length;t--;)if(R3(n[t][0],e))return t;return-1}var $3=Array.prototype,Y3=$3.splice;function q3(n){var e=this.__data__,t=Wm(e,n);if(t<0)return!1;var i=e.length-1;return t==i?e.pop():Y3.call(e,t,1),--this.size,!0}function K3(n){var e=this.__data__,t=Wm(e,n);return t<0?void 0:e[t][1]}function Z3(n){return Wm(this.__data__,n)>-1}function J3(n,e){var t=this.__data__,i=Wm(t,n);return i<0?(++this.size,t.push([n,e])):t[i][1]=e,this}function xc(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var i=n[e];this.set(i[0],i[1])}}xc.prototype.clear=j3;xc.prototype.delete=q3;xc.prototype.get=K3;xc.prototype.has=Z3;xc.prototype.set=J3;var Q3=YC(Hm,"Map");const ek=Q3;function tk(){this.size=0,this.__data__={hash:new ul,map:new(ek||xc),string:new ul}}function nk(n){var e=typeof n;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?n!=="__proto__":n===null}function Xm(n,e){var t=n.__data__;return nk(e)?t[typeof e=="string"?"string":"hash"]:t.map}function ik(n){var e=Xm(this,n).delete(n);return this.size-=e?1:0,e}function rk(n){return Xm(this,n).get(n)}function sk(n){return Xm(this,n).has(n)}function ok(n,e){var t=Xm(this,n),i=t.size;return t.set(n,e),this.size+=t.size==i?0:1,this}function bl(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var i=n[e];this.set(i[0],i[1])}}bl.prototype.clear=tk;bl.prototype.delete=ik;bl.prototype.get=rk;bl.prototype.has=sk;bl.prototype.set=ok;var ak="Expected a function";function Ax(n,e){if(typeof n!="function"||e!=null&&typeof e!="function")throw new TypeError(ak);var t=function(){var i=arguments,r=e?e.apply(this,i):i[0],s=t.cache;if(s.has(r))return s.get(r);var o=n.apply(this,i);return t.cache=s.set(r,o)||s,o};return t.cache=new(Ax.Cache||bl),t}Ax.Cache=bl;var lk=500;function uk(n){var e=Ax(n,function(i){return t.size===lk&&t.clear(),i}),t=e.cache;return e}var ck=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,hk=/\\(\\)?/g,dk=uk(function(n){var e=[];return n.charCodeAt(0)===46&&e.push(""),n.replace(ck,function(t,i,r,s){e.push(r?s.replace(hk,"$1"):i||t)}),e});const fk=dk;function pk(n){return n==null?"":$C(n)}function mk(n,e){return wx(n)?n:O3(n,e)?[n]:fk(pk(n))}var gk=1/0;function _k(n){if(typeof n=="string"||zm(n))return n;var e=n+"";return e=="0"&&1/n==-gk?"-0":e}function vk(n,e){e=mk(e,n);for(var t=0,i=e.length;n!=null&&t<i;)n=n[_k(e[t++])];return t&&t==i?n:void 0}function yk(n,e,t){var i=n==null?void 0:vk(n,e);return i===void 0?t:i}var xk=function(){return Hm.Date.now()};const qg=xk;var bk="Expected a function",Sk=Math.max,Ek=Math.min;function kE(n,e,t){var i,r,s,o,a,l,u=0,c=!1,h=!1,d=!0;if(typeof n!="function")throw new TypeError(bk);e=UE(e)||0,Kh(t)&&(c=!!t.leading,h="maxWait"in t,s=h?Sk(UE(t.maxWait)||0,e):s,d="trailing"in t?!!t.trailing:d);function f(S){var T=i,P=r;return i=r=void 0,u=S,o=n.apply(P,T),o}function p(S){return u=S,a=setTimeout(g,e),c?f(S):o}function _(S){var T=S-l,P=S-u,E=e-T;return h?Ek(E,s-P):E}function m(S){var T=S-l,P=S-u;return l===void 0||T>=e||T<0||h&&P>=s}function g(){var S=qg();if(m(S))return v(S);a=setTimeout(g,_(S))}function v(S){return a=void 0,d&&i?f(S):(i=r=void 0,o)}function y(){a!==void 0&&clearTimeout(a),u=0,i=l=r=a=void 0}function x(){return a===void 0?o:v(qg())}function b(){var S=qg(),T=m(S);if(i=arguments,r=this,l=S,T){if(a===void 0)return p(l);if(h)return clearTimeout(a),a=setTimeout(g,e),f(l)}return a===void 0&&(a=setTimeout(g,e)),o}return b.cancel=y,b.flush=x,b}function $p(n){for(var e=-1,t=n==null?0:n.length,i={};++e<t;){var r=n[e];i[r[0]]=r[1]}return i}function Ws(n){return n==null}function Tk(n){return n===void 0}const fh=n=>n===void 0,Px=n=>typeof n=="boolean",pn=n=>typeof n=="number",Jh=n=>typeof Element>"u"?!1:n instanceof Element,Mk=n=>At(n)?!Number.isNaN(Number(n)):!1,VE=n=>Object.keys(n);class wk extends Error{constructor(e){super(e),this.name="ElementPlusError"}}function Cx(n,e){throw new wk(`[${n}] ${e}`)}const qC=(n="")=>n.split(" ").filter(e=>!!e.trim()),GE=(n,e)=>{if(!n||!e)return!1;if(e.includes(" "))throw new Error("className should not contain space.");return n.classList.contains(e)},Ak=(n,e)=>{!n||!e.trim()||n.classList.add(...qC(e))},Pk=(n,e)=>{!n||!e.trim()||n.classList.remove(...qC(e))},Ck=(n,e)=>{var t;if(!Un||!n||!e)return"";let i=Lr(e);i==="float"&&(i="cssFloat");try{const r=n.style[i];if(r)return r;const s=(t=document.defaultView)==null?void 0:t.getComputedStyle(n,"");return s?s[i]:""}catch{return n.style[i]}};function Rx(n,e="px"){if(!n)return"";if(pn(n)||Mk(n))return`${n}${e}`;if(At(n))return n}let sf;const Rk=n=>{var e;if(!Un)return 0;if(sf!==void 0)return sf;const t=document.createElement("div");t.className=`${n}-scrollbar__wrap`,t.style.visibility="hidden",t.style.width="100px",t.style.position="absolute",t.style.top="-9999px",document.body.appendChild(t);const i=t.offsetWidth;t.style.overflow="scroll";const r=document.createElement("div");r.style.width="100%",t.appendChild(r);const s=r.offsetWidth;return(e=t.parentNode)==null||e.removeChild(t),sf=i-s,sf};/*! Element Plus Icons Vue v2.1.0 */var Si=(n,e)=>{let t=n.__vccOpts||n;for(let[i,r]of e)t[i]=r;return t},Ik={name:"ArrowDown"},Lk={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Ok=ze("path",{fill:"currentColor",d:"M831.872 340.864 512 652.672 192.128 340.864a30.592 30.592 0 0 0-42.752 0 29.12 29.12 0 0 0 0 41.6L489.664 714.24a32 32 0 0 0 44.672 0l340.288-331.712a29.12 29.12 0 0 0 0-41.728 30.592 30.592 0 0 0-42.752 0z"},null,-1),Dk=[Ok];function Fk(n,e,t,i,r,s){return Te(),ke("svg",Lk,Dk)}var Nk=Si(Ik,[["render",Fk],["__file","arrow-down.vue"]]),Uk={name:"ArrowUp"},Bk={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},kk=ze("path",{fill:"currentColor",d:"m488.832 344.32-339.84 356.672a32 32 0 0 0 0 44.16l.384.384a29.44 29.44 0 0 0 42.688 0l320-335.872 319.872 335.872a29.44 29.44 0 0 0 42.688 0l.384-.384a32 32 0 0 0 0-44.16L535.168 344.32a32 32 0 0 0-46.336 0z"},null,-1),Vk=[kk];function Gk(n,e,t,i,r,s){return Te(),ke("svg",Bk,Vk)}var Hk=Si(Uk,[["render",Gk],["__file","arrow-up.vue"]]),zk={name:"CircleCheck"},Wk={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Xk=ze("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768zm0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896z"},null,-1),jk=ze("path",{fill:"currentColor",d:"M745.344 361.344a32 32 0 0 1 45.312 45.312l-288 288a32 32 0 0 1-45.312 0l-160-160a32 32 0 1 1 45.312-45.312L480 626.752l265.344-265.408z"},null,-1),$k=[Xk,jk];function Yk(n,e,t,i,r,s){return Te(),ke("svg",Wk,$k)}var qk=Si(zk,[["render",Yk],["__file","circle-check.vue"]]),Kk={name:"CircleCloseFilled"},Zk={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Jk=ze("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm0 393.664L407.936 353.6a38.4 38.4 0 1 0-54.336 54.336L457.664 512 353.6 616.064a38.4 38.4 0 1 0 54.336 54.336L512 566.336 616.064 670.4a38.4 38.4 0 1 0 54.336-54.336L566.336 512 670.4 407.936a38.4 38.4 0 1 0-54.336-54.336L512 457.664z"},null,-1),Qk=[Jk];function e4(n,e,t,i,r,s){return Te(),ke("svg",Zk,Qk)}var KC=Si(Kk,[["render",e4],["__file","circle-close-filled.vue"]]),t4={name:"CircleClose"},n4={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},i4=ze("path",{fill:"currentColor",d:"m466.752 512-90.496-90.496a32 32 0 0 1 45.248-45.248L512 466.752l90.496-90.496a32 32 0 1 1 45.248 45.248L557.248 512l90.496 90.496a32 32 0 1 1-45.248 45.248L512 557.248l-90.496 90.496a32 32 0 0 1-45.248-45.248L466.752 512z"},null,-1),r4=ze("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768zm0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896z"},null,-1),s4=[i4,r4];function o4(n,e,t,i,r,s){return Te(),ke("svg",n4,s4)}var ZC=Si(t4,[["render",o4],["__file","circle-close.vue"]]),a4={name:"Close"},l4={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},u4=ze("path",{fill:"currentColor",d:"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512 214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"},null,-1),c4=[u4];function h4(n,e,t,i,r,s){return Te(),ke("svg",l4,c4)}var JC=Si(a4,[["render",h4],["__file","close.vue"]]),d4={name:"Hide"},f4={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},p4=ze("path",{fill:"currentColor",d:"M876.8 156.8c0-9.6-3.2-16-9.6-22.4-6.4-6.4-12.8-9.6-22.4-9.6-9.6 0-16 3.2-22.4 9.6L736 220.8c-64-32-137.6-51.2-224-60.8-160 16-288 73.6-377.6 176C44.8 438.4 0 496 0 512s48 73.6 134.4 176c22.4 25.6 44.8 48 73.6 67.2l-86.4 89.6c-6.4 6.4-9.6 12.8-9.6 22.4 0 9.6 3.2 16 9.6 22.4 6.4 6.4 12.8 9.6 22.4 9.6 9.6 0 16-3.2 22.4-9.6l704-710.4c3.2-6.4 6.4-12.8 6.4-22.4Zm-646.4 528c-76.8-70.4-128-128-153.6-172.8 28.8-48 80-105.6 153.6-172.8C304 272 400 230.4 512 224c64 3.2 124.8 19.2 176 44.8l-54.4 54.4C598.4 300.8 560 288 512 288c-64 0-115.2 22.4-160 64s-64 96-64 160c0 48 12.8 89.6 35.2 124.8L256 707.2c-9.6-6.4-19.2-16-25.6-22.4Zm140.8-96c-12.8-22.4-19.2-48-19.2-76.8 0-44.8 16-83.2 48-112 32-28.8 67.2-48 112-48 28.8 0 54.4 6.4 73.6 19.2L371.2 588.8ZM889.599 336c-12.8-16-28.8-28.8-41.6-41.6l-48 48c73.6 67.2 124.8 124.8 150.4 169.6-28.8 48-80 105.6-153.6 172.8-73.6 67.2-172.8 108.8-284.8 115.2-51.2-3.2-99.2-12.8-140.8-28.8l-48 48c57.6 22.4 118.4 38.4 188.8 44.8 160-16 288-73.6 377.6-176C979.199 585.6 1024 528 1024 512s-48.001-73.6-134.401-176Z"},null,-1),m4=ze("path",{fill:"currentColor",d:"M511.998 672c-12.8 0-25.6-3.2-38.4-6.4l-51.2 51.2c28.8 12.8 57.6 19.2 89.6 19.2 64 0 115.2-22.4 160-64 41.6-41.6 64-96 64-160 0-32-6.4-64-19.2-89.6l-51.2 51.2c3.2 12.8 6.4 25.6 6.4 38.4 0 44.8-16 83.2-48 112-32 28.8-67.2 48-112 48Z"},null,-1),g4=[p4,m4];function _4(n,e,t,i,r,s){return Te(),ke("svg",f4,g4)}var v4=Si(d4,[["render",_4],["__file","hide.vue"]]),y4={name:"InfoFilled"},x4={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},b4=ze("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64zm67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344zM590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296-44.096 0-108.992 44.736-148.48 101.504 0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04 67.84 0 107.904-43.648 147.456-100.416z"},null,-1),S4=[b4];function E4(n,e,t,i,r,s){return Te(),ke("svg",x4,S4)}var QC=Si(y4,[["render",E4],["__file","info-filled.vue"]]),T4={name:"Loading"},M4={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},w4=ze("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32zm0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32zm448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32zm-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32zM195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0zm-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"},null,-1),A4=[w4];function P4(n,e,t,i,r,s){return Te(),ke("svg",M4,A4)}var eR=Si(T4,[["render",P4],["__file","loading.vue"]]),C4={name:"Minus"},R4={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},I4=ze("path",{fill:"currentColor",d:"M128 544h768a32 32 0 1 0 0-64H128a32 32 0 0 0 0 64z"},null,-1),L4=[I4];function O4(n,e,t,i,r,s){return Te(),ke("svg",R4,L4)}var D4=Si(C4,[["render",O4],["__file","minus.vue"]]),F4={name:"Plus"},N4={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},U4=ze("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64h352z"},null,-1),B4=[U4];function k4(n,e,t,i,r,s){return Te(),ke("svg",N4,B4)}var V4=Si(F4,[["render",k4],["__file","plus.vue"]]),G4={name:"SuccessFilled"},H4={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},z4=ze("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336L456.192 600.384z"},null,-1),W4=[z4];function X4(n,e,t,i,r,s){return Te(),ke("svg",H4,W4)}var tR=Si(G4,[["render",X4],["__file","success-filled.vue"]]),j4={name:"View"},$4={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Y4=ze("path",{fill:"currentColor",d:"M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352zm0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448 224 224 0 0 1 0-448zm0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160z"},null,-1),q4=[Y4];function K4(n,e,t,i,r,s){return Te(),ke("svg",$4,q4)}var Z4=Si(j4,[["render",K4],["__file","view.vue"]]),J4={name:"WarningFilled"},Q4={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},eV=ze("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm0 192a58.432 58.432 0 0 0-58.24 63.744l23.36 256.384a35.072 35.072 0 0 0 69.76 0l23.296-256.384A58.432 58.432 0 0 0 512 256zm0 512a51.2 51.2 0 1 0 0-102.4 51.2 51.2 0 0 0 0 102.4z"},null,-1),tV=[eV];function nV(n,e,t,i,r,s){return Te(),ke("svg",Q4,tV)}var nR=Si(J4,[["render",nV],["__file","warning-filled.vue"]]);const iR="__epPropKey",pt=n=>n,iV=n=>Rt(n)&&!!n[iR],jm=(n,e)=>{if(!Rt(n)||iV(n))return n;const{values:t,required:i,default:r,type:s,validator:o}=n,l={type:s,required:!!i,validator:t||o?u=>{let c=!1,h=[];if(t&&(h=Array.from(t),yt(n,"default")&&h.push(r),c||(c=h.includes(u))),o&&(c||(c=o(u))),!c&&h.length>0){const d=[...new Set(h)].map(f=>JSON.stringify(f)).join(", ");JD(`Invalid prop: validation failed${e?` for prop "${e}"`:""}. Expected one of [${d}], got value ${JSON.stringify(u)}.`)}return c}:void 0,[iR]:!0};return yt(n,"default")&&(l.default=r),l},hn=n=>$p(Object.entries(n).map(([e,t])=>[e,jm(t,e)])),ku=pt([String,Object,Function]),rV={Close:JC,SuccessFilled:tR,InfoFilled:QC,WarningFilled:nR,CircleCloseFilled:KC},HE={success:tR,warning:nR,error:KC,info:QC},sV={validating:eR,success:qk,error:ZC},Qs=(n,e)=>{if(n.install=t=>{for(const i of[n,...Object.values(e??{})])t.component(i.name,i)},e)for(const[t,i]of Object.entries(e))n[t]=i;return n},oV=(n,e)=>(n.install=t=>{n._context=t._context,t.config.globalProperties[e]=n},n),aV=n=>(n.install=Mn,n),Vu={tab:"Tab",enter:"Enter",space:"Space",left:"ArrowLeft",up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",esc:"Escape",delete:"Delete",backspace:"Backspace",numpadEnter:"NumpadEnter",pageUp:"PageUp",pageDown:"PageDown",home:"Home",end:"End"},oi="update:modelValue",$m="change",Qa="input",lV=["","default","small","large"];var Tp=(n=>(n[n.TEXT=1]="TEXT",n[n.CLASS=2]="CLASS",n[n.STYLE=4]="STYLE",n[n.PROPS=8]="PROPS",n[n.FULL_PROPS=16]="FULL_PROPS",n[n.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",n[n.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",n[n.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",n[n.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",n[n.NEED_PATCH=512]="NEED_PATCH",n[n.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",n[n.HOISTED=-1]="HOISTED",n[n.BAIL=-2]="BAIL",n))(Tp||{});const uV=n=>/([\uAC00-\uD7AF\u3130-\u318F])+/gi.test(n),rR=n=>n,cV=["class","style"],hV=/^on[A-Z]/,dV=(n={})=>{const{excludeListeners:e=!1,excludeKeys:t}=n,i=oe(()=>((t==null?void 0:t.value)||[]).concat(cV)),r=Fr();return oe(r?()=>{var s;return $p(Object.entries((s=r.proxy)==null?void 0:s.$attrs).filter(([o])=>!i.value.includes(o)&&!(e&&hV.test(o))))}:()=>({}))},h0=({from:n,replacement:e,scope:t,version:i,ref:r,type:s="API"},o)=>{et(()=>R(o),a=>{},{immediate:!0})};var fV={name:"en",el:{colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color."},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",dateTablePrompt:"Use the arrow keys and enter to select the day of the month",monthTablePrompt:"Use the arrow keys and enter to select the month",yearTablePrompt:"Use the arrow keys and enter to select the year",selectedDate:"Selected date",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},weeksFull:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},dropdown:{toggleDropdown:"Toggle Dropdown"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",page:"Page",prev:"Go to previous page",next:"Go to next page",currentPage:"page {pager}",prevPages:"Previous {pager} pages",nextPages:"Next {pager} pages",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},dialog:{close:"Close this dialog"},drawer:{close:"Close this dialog"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input",close:"Close this dialog"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"}}};const pV=n=>(e,t)=>mV(e,t,R(n)),mV=(n,e,t)=>yk(t,n,n).replace(/\{(\w+)\}/g,(i,r)=>{var s;return`${(s=e==null?void 0:e[r])!=null?s:`{${r}}`}`}),gV=n=>{const e=oe(()=>R(n).name),t=yn(n)?n:Fe(n);return{lang:e,locale:t,t:pV(n)}},sR=Symbol("localeContextKey"),Ym=n=>{const e=n||Lt(sR,Fe());return gV(oe(()=>e.value||fV))},Yp="el",_V="is-",sa=(n,e,t,i,r)=>{let s=`${n}-${e}`;return t&&(s+=`-${t}`),i&&(s+=`__${i}`),r&&(s+=`--${r}`),s},oR=Symbol("namespaceContextKey"),Ix=n=>{const e=n||Lt(oR,Fe(Yp));return oe(()=>R(e)||Yp)},bn=(n,e)=>{const t=Ix(e);return{namespace:t,b:(_="")=>sa(t.value,n,_,"",""),e:_=>_?sa(t.value,n,"",_,""):"",m:_=>_?sa(t.value,n,"","",_):"",be:(_,m)=>_&&m?sa(t.value,n,_,m,""):"",em:(_,m)=>_&&m?sa(t.value,n,"",_,m):"",bm:(_,m)=>_&&m?sa(t.value,n,_,"",m):"",bem:(_,m,g)=>_&&m&&g?sa(t.value,n,_,m,g):"",is:(_,...m)=>{const g=m.length>=1?m[0]:!0;return _&&g?`${_V}${_}`:""},cssVar:_=>{const m={};for(const g in _)_[g]&&(m[`--${t.value}-${g}`]=_[g]);return m},cssVarName:_=>`--${t.value}-${_}`,cssVarBlock:_=>{const m={};for(const g in _)_[g]&&(m[`--${t.value}-${n}-${g}`]=_[g]);return m},cssVarBlockName:_=>`--${t.value}-${n}-${_}`}},vV=(n,e={})=>{yn(n)||Cx("[useLockscreen]","You need to pass a ref param to this function");const t=e.ns||bn("popup"),i=CP(()=>t.bm("parent","hidden"));if(!Un||GE(document.body,i.value))return;let r=0,s=!1,o="0";const a=()=>{setTimeout(()=>{Pk(document==null?void 0:document.body,i.value),s&&document&&(document.body.style.width=o)},200)};et(n,l=>{if(!l){a();return}s=!GE(document.body,i.value),s&&(o=document.body.style.width),r=Rk(t.namespace.value);const u=document.documentElement.clientHeight<document.body.scrollHeight,c=Ck(document.body,"overflowY");r>0&&(u||c==="scroll")&&s&&(document.body.style.width=`calc(100% - ${r}px)`),Ak(document.body,i.value)}),hP(()=>a())},yV=jm({type:pt(Boolean),default:null}),xV=jm({type:pt(Function)}),aR=n=>{const e=`update:${n}`,t=`onUpdate:${n}`,i=[e],r={[n]:yV,[t]:xV};return{useModelToggle:({indicator:o,toggleReason:a,shouldHideWhenRouteChanges:l,shouldProceed:u,onShow:c,onHide:h})=>{const d=Fr(),{emit:f}=d,p=d.props,_=oe(()=>je(p[t])),m=oe(()=>p[n]===null),g=T=>{o.value!==!0&&(o.value=!0,a&&(a.value=T),je(c)&&c(T))},v=T=>{o.value!==!1&&(o.value=!1,a&&(a.value=T),je(h)&&h(T))},y=T=>{if(p.disabled===!0||je(u)&&!u())return;const P=_.value&&Un;P&&f(e,!0),(m.value||!P)&&g(T)},x=T=>{if(p.disabled===!0||!Un)return;const P=_.value&&Un;P&&f(e,!1),(m.value||!P)&&v(T)},b=T=>{Px(T)&&(p.disabled&&T?_.value&&f(e,!1):o.value!==T&&(T?g():v()))},S=()=>{o.value?x():y()};return et(()=>p[n],b),l&&d.appContext.config.globalProperties.$route!==void 0&&et(()=>({...d.proxy.$route}),()=>{l.value&&o.value&&x()}),Sn(()=>{b(p[n])}),{hide:x,show:y,toggle:S,hasUpdateHandler:_}},useModelToggleProps:r,useModelToggleEmits:i}};aR("modelValue");const lR=n=>{const e=Fr();return oe(()=>{var t,i;return(i=(t=e==null?void 0:e.proxy)==null?void 0:t.$props)==null?void 0:i[n]})};var vi="top",rr="bottom",sr="right",yi="left",Lx="auto",Dd=[vi,rr,sr,yi],Gu="start",Qh="end",bV="clippingParents",uR="viewport",Fc="popper",SV="reference",zE=Dd.reduce(function(n,e){return n.concat([e+"-"+Gu,e+"-"+Qh])},[]),Fd=[].concat(Dd,[Lx]).reduce(function(n,e){return n.concat([e,e+"-"+Gu,e+"-"+Qh])},[]),EV="beforeRead",TV="read",MV="afterRead",wV="beforeMain",AV="main",PV="afterMain",CV="beforeWrite",RV="write",IV="afterWrite",LV=[EV,TV,MV,wV,AV,PV,CV,RV,IV];function os(n){return n?(n.nodeName||"").toLowerCase():null}function Ur(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function Hu(n){var e=Ur(n).Element;return n instanceof e||n instanceof Element}function ir(n){var e=Ur(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function Ox(n){if(typeof ShadowRoot>"u")return!1;var e=Ur(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function OV(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var i=e.styles[t]||{},r=e.attributes[t]||{},s=e.elements[t];!ir(s)||!os(s)||(Object.assign(s.style,i),Object.keys(r).forEach(function(o){var a=r[o];a===!1?s.removeAttribute(o):s.setAttribute(o,a===!0?"":a)}))})}function DV(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(i){var r=e.elements[i],s=e.attributes[i]||{},o=Object.keys(e.styles.hasOwnProperty(i)?e.styles[i]:t[i]),a=o.reduce(function(l,u){return l[u]="",l},{});!ir(r)||!os(r)||(Object.assign(r.style,a),Object.keys(s).forEach(function(l){r.removeAttribute(l)}))})}}var cR={name:"applyStyles",enabled:!0,phase:"write",fn:OV,effect:DV,requires:["computeStyles"]};function rs(n){return n.split("-")[0]}var el=Math.max,qp=Math.min,zu=Math.round;function Wu(n,e){e===void 0&&(e=!1);var t=n.getBoundingClientRect(),i=1,r=1;if(ir(n)&&e){var s=n.offsetHeight,o=n.offsetWidth;o>0&&(i=zu(t.width)/o||1),s>0&&(r=zu(t.height)/s||1)}return{width:t.width/i,height:t.height/r,top:t.top/r,right:t.right/i,bottom:t.bottom/r,left:t.left/i,x:t.left/i,y:t.top/r}}function Dx(n){var e=Wu(n),t=n.offsetWidth,i=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-i)<=1&&(i=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:i}}function hR(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&Ox(t)){var i=e;do{if(i&&n.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function qs(n){return Ur(n).getComputedStyle(n)}function FV(n){return["table","td","th"].indexOf(os(n))>=0}function $o(n){return((Hu(n)?n.ownerDocument:n.document)||window.document).documentElement}function qm(n){return os(n)==="html"?n:n.assignedSlot||n.parentNode||(Ox(n)?n.host:null)||$o(n)}function WE(n){return!ir(n)||qs(n).position==="fixed"?null:n.offsetParent}function NV(n){var e=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1,t=navigator.userAgent.indexOf("Trident")!==-1;if(t&&ir(n)){var i=qs(n);if(i.position==="fixed")return null}var r=qm(n);for(Ox(r)&&(r=r.host);ir(r)&&["html","body"].indexOf(os(r))<0;){var s=qs(r);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||e&&s.willChange==="filter"||e&&s.filter&&s.filter!=="none")return r;r=r.parentNode}return null}function Nd(n){for(var e=Ur(n),t=WE(n);t&&FV(t)&&qs(t).position==="static";)t=WE(t);return t&&(os(t)==="html"||os(t)==="body"&&qs(t).position==="static")?e:t||NV(n)||e}function Fx(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Ch(n,e,t){return el(n,qp(e,t))}function UV(n,e,t){var i=Ch(n,e,t);return i>t?t:i}function dR(){return{top:0,right:0,bottom:0,left:0}}function fR(n){return Object.assign({},dR(),n)}function pR(n,e){return e.reduce(function(t,i){return t[i]=n,t},{})}var BV=function(n,e){return n=typeof n=="function"?n(Object.assign({},e.rects,{placement:e.placement})):n,fR(typeof n!="number"?n:pR(n,Dd))};function kV(n){var e,t=n.state,i=n.name,r=n.options,s=t.elements.arrow,o=t.modifiersData.popperOffsets,a=rs(t.placement),l=Fx(a),u=[yi,sr].indexOf(a)>=0,c=u?"height":"width";if(!(!s||!o)){var h=BV(r.padding,t),d=Dx(s),f=l==="y"?vi:yi,p=l==="y"?rr:sr,_=t.rects.reference[c]+t.rects.reference[l]-o[l]-t.rects.popper[c],m=o[l]-t.rects.reference[l],g=Nd(s),v=g?l==="y"?g.clientHeight||0:g.clientWidth||0:0,y=_/2-m/2,x=h[f],b=v-d[c]-h[p],S=v/2-d[c]/2+y,T=Ch(x,S,b),P=l;t.modifiersData[i]=(e={},e[P]=T,e.centerOffset=T-S,e)}}function VV(n){var e=n.state,t=n.options,i=t.element,r=i===void 0?"[data-popper-arrow]":i;r!=null&&(typeof r=="string"&&(r=e.elements.popper.querySelector(r),!r)||!hR(e.elements.popper,r)||(e.elements.arrow=r))}var GV={name:"arrow",enabled:!0,phase:"main",fn:kV,effect:VV,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Xu(n){return n.split("-")[1]}var HV={top:"auto",right:"auto",bottom:"auto",left:"auto"};function zV(n){var e=n.x,t=n.y,i=window,r=i.devicePixelRatio||1;return{x:zu(e*r)/r||0,y:zu(t*r)/r||0}}function XE(n){var e,t=n.popper,i=n.popperRect,r=n.placement,s=n.variation,o=n.offsets,a=n.position,l=n.gpuAcceleration,u=n.adaptive,c=n.roundOffsets,h=n.isFixed,d=o.x,f=d===void 0?0:d,p=o.y,_=p===void 0?0:p,m=typeof c=="function"?c({x:f,y:_}):{x:f,y:_};f=m.x,_=m.y;var g=o.hasOwnProperty("x"),v=o.hasOwnProperty("y"),y=yi,x=vi,b=window;if(u){var S=Nd(t),T="clientHeight",P="clientWidth";if(S===Ur(t)&&(S=$o(t),qs(S).position!=="static"&&a==="absolute"&&(T="scrollHeight",P="scrollWidth")),S=S,r===vi||(r===yi||r===sr)&&s===Qh){x=rr;var E=h&&S===b&&b.visualViewport?b.visualViewport.height:S[T];_-=E-i.height,_*=l?1:-1}if(r===yi||(r===vi||r===rr)&&s===Qh){y=sr;var M=h&&S===b&&b.visualViewport?b.visualViewport.width:S[P];f-=M-i.width,f*=l?1:-1}}var O=Object.assign({position:a},u&&HV),L=c===!0?zV({x:f,y:_}):{x:f,y:_};if(f=L.x,_=L.y,l){var C;return Object.assign({},O,(C={},C[x]=v?"0":"",C[y]=g?"0":"",C.transform=(b.devicePixelRatio||1)<=1?"translate("+f+"px, "+_+"px)":"translate3d("+f+"px, "+_+"px, 0)",C))}return Object.assign({},O,(e={},e[x]=v?_+"px":"",e[y]=g?f+"px":"",e.transform="",e))}function WV(n){var e=n.state,t=n.options,i=t.gpuAcceleration,r=i===void 0?!0:i,s=t.adaptive,o=s===void 0?!0:s,a=t.roundOffsets,l=a===void 0?!0:a,u={placement:rs(e.placement),variation:Xu(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:r,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,XE(Object.assign({},u,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:o,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,XE(Object.assign({},u,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}var mR={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:WV,data:{}},of={passive:!0};function XV(n){var e=n.state,t=n.instance,i=n.options,r=i.scroll,s=r===void 0?!0:r,o=i.resize,a=o===void 0?!0:o,l=Ur(e.elements.popper),u=[].concat(e.scrollParents.reference,e.scrollParents.popper);return s&&u.forEach(function(c){c.addEventListener("scroll",t.update,of)}),a&&l.addEventListener("resize",t.update,of),function(){s&&u.forEach(function(c){c.removeEventListener("scroll",t.update,of)}),a&&l.removeEventListener("resize",t.update,of)}}var gR={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:XV,data:{}},jV={left:"right",right:"left",bottom:"top",top:"bottom"};function Mp(n){return n.replace(/left|right|bottom|top/g,function(e){return jV[e]})}var $V={start:"end",end:"start"};function jE(n){return n.replace(/start|end/g,function(e){return $V[e]})}function Nx(n){var e=Ur(n),t=e.pageXOffset,i=e.pageYOffset;return{scrollLeft:t,scrollTop:i}}function Ux(n){return Wu($o(n)).left+Nx(n).scrollLeft}function YV(n){var e=Ur(n),t=$o(n),i=e.visualViewport,r=t.clientWidth,s=t.clientHeight,o=0,a=0;return i&&(r=i.width,s=i.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(o=i.offsetLeft,a=i.offsetTop)),{width:r,height:s,x:o+Ux(n),y:a}}function qV(n){var e,t=$o(n),i=Nx(n),r=(e=n.ownerDocument)==null?void 0:e.body,s=el(t.scrollWidth,t.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),o=el(t.scrollHeight,t.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),a=-i.scrollLeft+Ux(n),l=-i.scrollTop;return qs(r||t).direction==="rtl"&&(a+=el(t.clientWidth,r?r.clientWidth:0)-s),{width:s,height:o,x:a,y:l}}function Bx(n){var e=qs(n),t=e.overflow,i=e.overflowX,r=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+r+i)}function _R(n){return["html","body","#document"].indexOf(os(n))>=0?n.ownerDocument.body:ir(n)&&Bx(n)?n:_R(qm(n))}function Rh(n,e){var t;e===void 0&&(e=[]);var i=_R(n),r=i===((t=n.ownerDocument)==null?void 0:t.body),s=Ur(i),o=r?[s].concat(s.visualViewport||[],Bx(i)?i:[]):i,a=e.concat(o);return r?a:a.concat(Rh(qm(o)))}function d0(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function KV(n){var e=Wu(n);return e.top=e.top+n.clientTop,e.left=e.left+n.clientLeft,e.bottom=e.top+n.clientHeight,e.right=e.left+n.clientWidth,e.width=n.clientWidth,e.height=n.clientHeight,e.x=e.left,e.y=e.top,e}function $E(n,e){return e===uR?d0(YV(n)):Hu(e)?KV(e):d0(qV($o(n)))}function ZV(n){var e=Rh(qm(n)),t=["absolute","fixed"].indexOf(qs(n).position)>=0,i=t&&ir(n)?Nd(n):n;return Hu(i)?e.filter(function(r){return Hu(r)&&hR(r,i)&&os(r)!=="body"}):[]}function JV(n,e,t){var i=e==="clippingParents"?ZV(n):[].concat(e),r=[].concat(i,[t]),s=r[0],o=r.reduce(function(a,l){var u=$E(n,l);return a.top=el(u.top,a.top),a.right=qp(u.right,a.right),a.bottom=qp(u.bottom,a.bottom),a.left=el(u.left,a.left),a},$E(n,s));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function vR(n){var e=n.reference,t=n.element,i=n.placement,r=i?rs(i):null,s=i?Xu(i):null,o=e.x+e.width/2-t.width/2,a=e.y+e.height/2-t.height/2,l;switch(r){case vi:l={x:o,y:e.y-t.height};break;case rr:l={x:o,y:e.y+e.height};break;case sr:l={x:e.x+e.width,y:a};break;case yi:l={x:e.x-t.width,y:a};break;default:l={x:e.x,y:e.y}}var u=r?Fx(r):null;if(u!=null){var c=u==="y"?"height":"width";switch(s){case Gu:l[u]=l[u]-(e[c]/2-t[c]/2);break;case Qh:l[u]=l[u]+(e[c]/2-t[c]/2);break}}return l}function ed(n,e){e===void 0&&(e={});var t=e,i=t.placement,r=i===void 0?n.placement:i,s=t.boundary,o=s===void 0?bV:s,a=t.rootBoundary,l=a===void 0?uR:a,u=t.elementContext,c=u===void 0?Fc:u,h=t.altBoundary,d=h===void 0?!1:h,f=t.padding,p=f===void 0?0:f,_=fR(typeof p!="number"?p:pR(p,Dd)),m=c===Fc?SV:Fc,g=n.rects.popper,v=n.elements[d?m:c],y=JV(Hu(v)?v:v.contextElement||$o(n.elements.popper),o,l),x=Wu(n.elements.reference),b=vR({reference:x,element:g,strategy:"absolute",placement:r}),S=d0(Object.assign({},g,b)),T=c===Fc?S:x,P={top:y.top-T.top+_.top,bottom:T.bottom-y.bottom+_.bottom,left:y.left-T.left+_.left,right:T.right-y.right+_.right},E=n.modifiersData.offset;if(c===Fc&&E){var M=E[r];Object.keys(P).forEach(function(O){var L=[sr,rr].indexOf(O)>=0?1:-1,C=[vi,rr].indexOf(O)>=0?"y":"x";P[O]+=M[C]*L})}return P}function QV(n,e){e===void 0&&(e={});var t=e,i=t.placement,r=t.boundary,s=t.rootBoundary,o=t.padding,a=t.flipVariations,l=t.allowedAutoPlacements,u=l===void 0?Fd:l,c=Xu(i),h=c?a?zE:zE.filter(function(p){return Xu(p)===c}):Dd,d=h.filter(function(p){return u.indexOf(p)>=0});d.length===0&&(d=h);var f=d.reduce(function(p,_){return p[_]=ed(n,{placement:_,boundary:r,rootBoundary:s,padding:o})[rs(_)],p},{});return Object.keys(f).sort(function(p,_){return f[p]-f[_]})}function eG(n){if(rs(n)===Lx)return[];var e=Mp(n);return[jE(n),e,jE(e)]}function tG(n){var e=n.state,t=n.options,i=n.name;if(!e.modifiersData[i]._skip){for(var r=t.mainAxis,s=r===void 0?!0:r,o=t.altAxis,a=o===void 0?!0:o,l=t.fallbackPlacements,u=t.padding,c=t.boundary,h=t.rootBoundary,d=t.altBoundary,f=t.flipVariations,p=f===void 0?!0:f,_=t.allowedAutoPlacements,m=e.options.placement,g=rs(m),v=g===m,y=l||(v||!p?[Mp(m)]:eG(m)),x=[m].concat(y).reduce(function(ce,ve){return ce.concat(rs(ve)===Lx?QV(e,{placement:ve,boundary:c,rootBoundary:h,padding:u,flipVariations:p,allowedAutoPlacements:_}):ve)},[]),b=e.rects.reference,S=e.rects.popper,T=new Map,P=!0,E=x[0],M=0;M<x.length;M++){var O=x[M],L=rs(O),C=Xu(O)===Gu,D=[vi,rr].indexOf(L)>=0,B=D?"width":"height",W=ed(e,{placement:O,boundary:c,rootBoundary:h,altBoundary:d,padding:u}),U=D?C?sr:yi:C?rr:vi;b[B]>S[B]&&(U=Mp(U));var $=Mp(U),J=[];if(s&&J.push(W[L]<=0),a&&J.push(W[U]<=0,W[$]<=0),J.every(function(ce){return ce})){E=O,P=!1;break}T.set(O,J)}if(P)for(var j=p?3:1,F=function(ce){var ve=x.find(function(ae){var Y=T.get(ae);if(Y)return Y.slice(0,ce).every(function(ne){return ne})});if(ve)return E=ve,"break"},X=j;X>0;X--){var re=F(X);if(re==="break")break}e.placement!==E&&(e.modifiersData[i]._skip=!0,e.placement=E,e.reset=!0)}}var nG={name:"flip",enabled:!0,phase:"main",fn:tG,requiresIfExists:["offset"],data:{_skip:!1}};function YE(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function qE(n){return[vi,sr,rr,yi].some(function(e){return n[e]>=0})}function iG(n){var e=n.state,t=n.name,i=e.rects.reference,r=e.rects.popper,s=e.modifiersData.preventOverflow,o=ed(e,{elementContext:"reference"}),a=ed(e,{altBoundary:!0}),l=YE(o,i),u=YE(a,r,s),c=qE(l),h=qE(u);e.modifiersData[t]={referenceClippingOffsets:l,popperEscapeOffsets:u,isReferenceHidden:c,hasPopperEscaped:h},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":h})}var rG={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:iG};function sG(n,e,t){var i=rs(n),r=[yi,vi].indexOf(i)>=0?-1:1,s=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,o=s[0],a=s[1];return o=o||0,a=(a||0)*r,[yi,sr].indexOf(i)>=0?{x:a,y:o}:{x:o,y:a}}function oG(n){var e=n.state,t=n.options,i=n.name,r=t.offset,s=r===void 0?[0,0]:r,o=Fd.reduce(function(c,h){return c[h]=sG(h,e.rects,s),c},{}),a=o[e.placement],l=a.x,u=a.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=u),e.modifiersData[i]=o}var aG={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:oG};function lG(n){var e=n.state,t=n.name;e.modifiersData[t]=vR({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}var yR={name:"popperOffsets",enabled:!0,phase:"read",fn:lG,data:{}};function uG(n){return n==="x"?"y":"x"}function cG(n){var e=n.state,t=n.options,i=n.name,r=t.mainAxis,s=r===void 0?!0:r,o=t.altAxis,a=o===void 0?!1:o,l=t.boundary,u=t.rootBoundary,c=t.altBoundary,h=t.padding,d=t.tether,f=d===void 0?!0:d,p=t.tetherOffset,_=p===void 0?0:p,m=ed(e,{boundary:l,rootBoundary:u,padding:h,altBoundary:c}),g=rs(e.placement),v=Xu(e.placement),y=!v,x=Fx(g),b=uG(x),S=e.modifiersData.popperOffsets,T=e.rects.reference,P=e.rects.popper,E=typeof _=="function"?_(Object.assign({},e.rects,{placement:e.placement})):_,M=typeof E=="number"?{mainAxis:E,altAxis:E}:Object.assign({mainAxis:0,altAxis:0},E),O=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,L={x:0,y:0};if(S){if(s){var C,D=x==="y"?vi:yi,B=x==="y"?rr:sr,W=x==="y"?"height":"width",U=S[x],$=U+m[D],J=U-m[B],j=f?-P[W]/2:0,F=v===Gu?T[W]:P[W],X=v===Gu?-P[W]:-T[W],re=e.elements.arrow,ce=f&&re?Dx(re):{width:0,height:0},ve=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:dR(),ae=ve[D],Y=ve[B],ne=Ch(0,T[W],ce[W]),he=y?T[W]/2-j-ne-ae-M.mainAxis:F-ne-ae-M.mainAxis,xe=y?-T[W]/2+j+ne+Y+M.mainAxis:X+ne+Y+M.mainAxis,be=e.elements.arrow&&Nd(e.elements.arrow),w=be?x==="y"?be.clientTop||0:be.clientLeft||0:0,V=(C=O==null?void 0:O[x])!=null?C:0,H=U+he-V-w,K=U+xe-V,Z=Ch(f?qp($,H):$,U,f?el(J,K):J);S[x]=Z,L[x]=Z-U}if(a){var ee,ge=x==="x"?vi:yi,le=x==="x"?rr:sr,fe=S[b],me=b==="y"?"height":"width",we=fe+m[ge],I=fe-m[le],A=[vi,yi].indexOf(g)!==-1,G=(ee=O==null?void 0:O[b])!=null?ee:0,Q=A?we:fe-T[me]-P[me]-G+M.altAxis,ue=A?fe+T[me]+P[me]-G-M.altAxis:I,k=f&&A?UV(Q,fe,ue):Ch(f?Q:we,fe,f?ue:I);S[b]=k,L[b]=k-fe}e.modifiersData[i]=L}}var hG={name:"preventOverflow",enabled:!0,phase:"main",fn:cG,requiresIfExists:["offset"]};function dG(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function fG(n){return n===Ur(n)||!ir(n)?Nx(n):dG(n)}function pG(n){var e=n.getBoundingClientRect(),t=zu(e.width)/n.offsetWidth||1,i=zu(e.height)/n.offsetHeight||1;return t!==1||i!==1}function mG(n,e,t){t===void 0&&(t=!1);var i=ir(e),r=ir(e)&&pG(e),s=$o(e),o=Wu(n,r),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(i||!i&&!t)&&((os(e)!=="body"||Bx(s))&&(a=fG(e)),ir(e)?(l=Wu(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):s&&(l.x=Ux(s))),{x:o.left+a.scrollLeft-l.x,y:o.top+a.scrollTop-l.y,width:o.width,height:o.height}}function gG(n){var e=new Map,t=new Set,i=[];n.forEach(function(s){e.set(s.name,s)});function r(s){t.add(s.name);var o=[].concat(s.requires||[],s.requiresIfExists||[]);o.forEach(function(a){if(!t.has(a)){var l=e.get(a);l&&r(l)}}),i.push(s)}return n.forEach(function(s){t.has(s.name)||r(s)}),i}function _G(n){var e=gG(n);return LV.reduce(function(t,i){return t.concat(e.filter(function(r){return r.phase===i}))},[])}function vG(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function yG(n){var e=n.reduce(function(t,i){var r=t[i.name];return t[i.name]=r?Object.assign({},r,i,{options:Object.assign({},r.options,i.options),data:Object.assign({},r.data,i.data)}):i,t},{});return Object.keys(e).map(function(t){return e[t]})}var KE={placement:"bottom",modifiers:[],strategy:"absolute"};function ZE(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(i){return!(i&&typeof i.getBoundingClientRect=="function")})}function kx(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,i=t===void 0?[]:t,r=e.defaultOptions,s=r===void 0?KE:r;return function(o,a,l){l===void 0&&(l=s);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},KE,s),modifiersData:{},elements:{reference:o,popper:a},attributes:{},styles:{}},c=[],h=!1,d={state:u,setOptions:function(_){var m=typeof _=="function"?_(u.options):_;p(),u.options=Object.assign({},s,u.options,m),u.scrollParents={reference:Hu(o)?Rh(o):o.contextElement?Rh(o.contextElement):[],popper:Rh(a)};var g=_G(yG([].concat(i,u.options.modifiers)));return u.orderedModifiers=g.filter(function(v){return v.enabled}),f(),d.update()},forceUpdate:function(){if(!h){var _=u.elements,m=_.reference,g=_.popper;if(ZE(m,g)){u.rects={reference:mG(m,Nd(g),u.options.strategy==="fixed"),popper:Dx(g)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(P){return u.modifiersData[P.name]=Object.assign({},P.data)});for(var v=0;v<u.orderedModifiers.length;v++){if(u.reset===!0){u.reset=!1,v=-1;continue}var y=u.orderedModifiers[v],x=y.fn,b=y.options,S=b===void 0?{}:b,T=y.name;typeof x=="function"&&(u=x({state:u,options:S,name:T,instance:d})||u)}}}},update:vG(function(){return new Promise(function(_){d.forceUpdate(),_(u)})}),destroy:function(){p(),h=!0}};if(!ZE(o,a))return d;d.setOptions(l).then(function(_){!h&&l.onFirstUpdate&&l.onFirstUpdate(_)});function f(){u.orderedModifiers.forEach(function(_){var m=_.name,g=_.options,v=g===void 0?{}:g,y=_.effect;if(typeof y=="function"){var x=y({state:u,name:m,instance:d,options:v}),b=function(){};c.push(x||b)}})}function p(){c.forEach(function(_){return _()}),c=[]}return d}}kx();var xG=[gR,yR,mR,cR];kx({defaultModifiers:xG});var bG=[gR,yR,mR,cR,aG,nG,hG,GV,rG],SG=kx({defaultModifiers:bG});const EG=(n,e,t={})=>{const i={name:"updateState",enabled:!0,phase:"write",fn:({state:l})=>{const u=TG(l);Object.assign(o.value,u)},requires:["computeStyles"]},r=oe(()=>{const{onFirstUpdate:l,placement:u,strategy:c,modifiers:h}=R(t);return{onFirstUpdate:l,placement:u||"bottom",strategy:c||"absolute",modifiers:[...h||[],i,{name:"applyStyles",enabled:!1}]}}),s=Za(),o=Fe({styles:{popper:{position:R(r).strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),a=()=>{s.value&&(s.value.destroy(),s.value=void 0)};return et(r,l=>{const u=R(s);u&&u.setOptions(l)},{deep:!0}),et([n,e],([l,u])=>{a(),!(!l||!u)&&(s.value=SG(l,u,R(r)))}),Dr(()=>{a()}),{state:oe(()=>{var l;return{...((l=R(s))==null?void 0:l.state)||{}}}),styles:oe(()=>R(o).styles),attributes:oe(()=>R(o).attributes),update:()=>{var l;return(l=R(s))==null?void 0:l.update()},forceUpdate:()=>{var l;return(l=R(s))==null?void 0:l.forceUpdate()},instanceRef:oe(()=>R(s))}};function TG(n){const e=Object.keys(n.elements),t=$p(e.map(r=>[r,n.styles[r]||{}])),i=$p(e.map(r=>[r,n.attributes[r]]));return{styles:t,attributes:i}}const MG=n=>{if(!n)return{onClick:Mn,onMousedown:Mn,onMouseup:Mn};let e=!1,t=!1;return{onClick:o=>{e&&t&&n(o),e=t=!1},onMousedown:o=>{e=o.target===o.currentTarget},onMouseup:o=>{t=o.target===o.currentTarget}}};function JE(){let n;const e=(i,r)=>{t(),n=window.setTimeout(i,r)},t=()=>window.clearTimeout(n);return Gm(()=>t()),{registerTimeout:e,cancelTimeout:t}}const QE={prefix:Math.floor(Math.random()*1e4),current:0},wG=Symbol("elIdInjection"),xR=()=>Fr()?Lt(wG,QE):QE,Kp=n=>{const e=xR(),t=Ix();return oe(()=>R(n)||`${t.value}-id-${e.prefix}-${e.current++}`)};let cu=[];const eT=n=>{const e=n;e.key===Vu.esc&&cu.forEach(t=>t(e))},AG=n=>{Sn(()=>{cu.length===0&&document.addEventListener("keydown",eT),Un&&cu.push(n)}),Dr(()=>{cu=cu.filter(e=>e!==n),cu.length===0&&Un&&document.removeEventListener("keydown",eT)})};let tT;const bR=()=>{const n=Ix(),e=xR(),t=oe(()=>`${n.value}-popper-container-${e.prefix}`),i=oe(()=>`#${t.value}`);return{id:t,selector:i}},PG=n=>{const e=document.createElement("div");return e.id=n,document.body.appendChild(e),e},CG=()=>{const{id:n,selector:e}=bR();return lx(()=>{Un&&!tT&&!document.body.querySelector(e.value)&&(tT=PG(n.value))}),{id:n,selector:e}},RG=hn({showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0}}),IG=({showAfter:n,hideAfter:e,autoClose:t,open:i,close:r})=>{const{registerTimeout:s}=JE(),{registerTimeout:o,cancelTimeout:a}=JE();return{onOpen:c=>{s(()=>{i(c);const h=R(t);pn(h)&&h>0&&o(()=>{r(c)},h)},R(n))},onClose:c=>{a(),s(()=>{r(c)},R(e))}}},SR=Symbol("elForwardRef"),LG=n=>{Ii(SR,{setForwardRef:t=>{n.value=t}})},OG=n=>({mounted(e){n(e)},updated(e){n(e)},unmounted(){n(null)}}),nT=Fe(0),ER=2e3,TR=Symbol("zIndexContextKey"),Vx=n=>{const e=n||Lt(TR,void 0),t=oe(()=>{const s=R(e);return pn(s)?s:ER}),i=oe(()=>t.value+nT.value);return{initialZIndex:t,currentZIndex:i,nextZIndex:()=>(nT.value++,i.value)}};function DG(n){const e=Fe();function t(){if(n.value==null)return;const{selectionStart:r,selectionEnd:s,value:o}=n.value;if(r==null||s==null)return;const a=o.slice(0,Math.max(0,r)),l=o.slice(Math.max(0,s));e.value={selectionStart:r,selectionEnd:s,value:o,beforeTxt:a,afterTxt:l}}function i(){if(n.value==null||e.value==null)return;const{value:r}=n.value,{beforeTxt:s,afterTxt:o,selectionStart:a}=e.value;if(s==null||o==null||a==null)return;let l=r.length;if(r.endsWith(o))l=r.length-o.length;else if(r.startsWith(s))l=s.length;else{const u=s[a-1],c=r.indexOf(u,a-1);c!==-1&&(l=c+1)}n.value.setSelectionRange(l,l)}return[t,i]}const td=jm({type:String,values:lV,required:!1}),MR=Symbol("size"),FG=()=>{const n=Lt(MR,{});return oe(()=>R(n.size)||"")};function NG(n,{afterFocus:e,afterBlur:t}={}){const i=Fr(),{emit:r}=i,s=Za(),o=Fe(!1),a=c=>{o.value||(o.value=!0,r("focus",c),e==null||e())},l=c=>{var h;c.relatedTarget&&((h=s.value)!=null&&h.contains(c.relatedTarget))||(o.value=!1,r("blur",c),t==null||t())},u=()=>{var c;(c=n.value)==null||c.focus()};return et(s,c=>{c&&(c.setAttribute("role","button"),c.setAttribute("tabindex","-1"))}),Mu(s,"click",u),{wrapperRef:s,isFocused:o,handleFocus:a,handleBlur:l}}const wR=Symbol(),Zp=Fe();function Km(n,e=void 0){const t=Fr()?Lt(wR,Zp):Zp;return n?oe(()=>{var i,r;return(r=(i=t.value)==null?void 0:i[n])!=null?r:e}):t}function UG(n,e){const t=Km(),i=bn(n,oe(()=>{var a;return((a=t.value)==null?void 0:a.namespace)||Yp})),r=Ym(oe(()=>{var a;return(a=t.value)==null?void 0:a.locale})),s=Vx(oe(()=>{var a;return((a=t.value)==null?void 0:a.zIndex)||ER})),o=oe(()=>{var a;return R(e)||((a=t.value)==null?void 0:a.size)||""});return BG(oe(()=>R(t)||{})),{ns:i,locale:r,zIndex:s,size:o}}const BG=(n,e,t=!1)=>{var i;const r=!!Fr(),s=r?Km():void 0,o=(i=e==null?void 0:e.provide)!=null?i:r?Ii:void 0;if(!o)return;const a=oe(()=>{const l=R(n);return s!=null&&s.value?kG(s.value,l):l});return o(wR,a),o(sR,oe(()=>a.value.locale)),o(oR,oe(()=>a.value.namespace)),o(TR,oe(()=>a.value.zIndex)),o(MR,{size:oe(()=>a.value.size||"")}),(t||!Zp.value)&&(Zp.value=a.value),a},kG=(n,e)=>{var t;const i=[...new Set([...VE(n),...VE(e)])],r={};for(const s of i)r[s]=(t=e[s])!=null?t:n[s];return r},iT={};var Bn=(n,e)=>{const t=n.__vccOpts||n;for(const[i,r]of e)t[i]=r;return t};const VG=hn({size:{type:pt([Number,String])},color:{type:String}}),GG=dt({name:"ElIcon",inheritAttrs:!1}),HG=dt({...GG,props:VG,setup(n){const e=n,t=bn("icon"),i=oe(()=>{const{size:r,color:s}=e;return!r&&!s?{}:{fontSize:fh(r)?void 0:Rx(r),"--color":s}});return(r,s)=>(Te(),ke("i",is({class:R(t).b(),style:R(i)},r.$attrs),[Qt(r.$slots,"default")],16))}});var zG=Bn(HG,[["__file","/home/runner/work/element-plus/element-plus/packages/components/icon/src/icon.vue"]]);const Yi=Qs(zG),Gx=Symbol("formContextKey"),Jp=Symbol("formItemContextKey"),Zm=(n,e={})=>{const t=Fe(void 0),i=e.prop?t:lR("size"),r=e.global?t:FG(),s=e.form?{size:void 0}:Lt(Gx,void 0),o=e.formItem?{size:void 0}:Lt(Jp,void 0);return oe(()=>i.value||R(n)||(o==null?void 0:o.size)||(s==null?void 0:s.size)||r.value||"")},Jm=n=>{const e=lR("disabled"),t=Lt(Gx,void 0);return oe(()=>e.value||R(n)||(t==null?void 0:t.disabled)||!1)},Qm=()=>{const n=Lt(Gx,void 0),e=Lt(Jp,void 0);return{form:n,formItem:e}},AR=(n,{formItemContext:e,disableIdGeneration:t,disableIdManagement:i})=>{t||(t=Fe(!1)),i||(i=Fe(!1));const r=Fe();let s;const o=oe(()=>{var a;return!!(!n.label&&e&&e.inputIds&&((a=e.inputIds)==null?void 0:a.length)<=1)});return Sn(()=>{s=et([Ns(n,"id"),t],([a,l])=>{const u=a??(l?void 0:Kp().value);u!==r.value&&(e!=null&&e.removeInputId&&(r.value&&e.removeInputId(r.value),!(i!=null&&i.value)&&!l&&u&&e.addInputId(u)),r.value=u)},{immediate:!0})}),ux(()=>{s&&s(),e!=null&&e.removeInputId&&r.value&&e.removeInputId(r.value)}),{isLabeledByFormItem:o,inputId:r}};let cr;const WG=`
  height:0 !important;
  visibility:hidden !important;
  ${BB()?"":"overflow:hidden !important;"}
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
`,XG=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function jG(n){const e=window.getComputedStyle(n),t=e.getPropertyValue("box-sizing"),i=Number.parseFloat(e.getPropertyValue("padding-bottom"))+Number.parseFloat(e.getPropertyValue("padding-top")),r=Number.parseFloat(e.getPropertyValue("border-bottom-width"))+Number.parseFloat(e.getPropertyValue("border-top-width"));return{contextStyle:XG.map(o=>`${o}:${e.getPropertyValue(o)}`).join(";"),paddingSize:i,borderSize:r,boxSizing:t}}function rT(n,e=1,t){var i;cr||(cr=document.createElement("textarea"),document.body.appendChild(cr));const{paddingSize:r,borderSize:s,boxSizing:o,contextStyle:a}=jG(n);cr.setAttribute("style",`${a};${WG}`),cr.value=n.value||n.placeholder||"";let l=cr.scrollHeight;const u={};o==="border-box"?l=l+s:o==="content-box"&&(l=l-r),cr.value="";const c=cr.scrollHeight-r;if(pn(e)){let h=c*e;o==="border-box"&&(h=h+r+s),l=Math.max(h,l),u.minHeight=`${h}px`}if(pn(t)){let h=c*t;o==="border-box"&&(h=h+r+s),l=Math.min(h,l)}return u.height=`${l}px`,(i=cr.parentNode)==null||i.removeChild(cr),cr=void 0,u}const $G=hn({id:{type:String,default:void 0},size:td,disabled:Boolean,modelValue:{type:pt([String,Number,Object]),default:""},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:pt([Boolean,Object]),default:!1},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},showPassword:{type:Boolean,default:!1},showWordLimit:{type:Boolean,default:!1},suffixIcon:{type:ku},prefixIcon:{type:ku},containerRole:{type:String,default:void 0},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},inputStyle:{type:pt([Object,Array,String]),default:()=>rR({})}}),YG={[oi]:n=>At(n),input:n=>At(n),change:n=>At(n),focus:n=>n instanceof FocusEvent,blur:n=>n instanceof FocusEvent,clear:()=>!0,mouseleave:n=>n instanceof MouseEvent,mouseenter:n=>n instanceof MouseEvent,keydown:n=>n instanceof Event,compositionstart:n=>n instanceof CompositionEvent,compositionupdate:n=>n instanceof CompositionEvent,compositionend:n=>n instanceof CompositionEvent},qG=["role"],KG=["id","type","disabled","formatter","parser","readonly","autocomplete","tabindex","aria-label","placeholder","form"],ZG=["id","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form"],JG=dt({name:"ElInput",inheritAttrs:!1}),QG=dt({...JG,props:$G,emits:YG,setup(n,{expose:e,emit:t}){const i=n,r=EF(),s=$P(),o=oe(()=>{const G={};return i.containerRole==="combobox"&&(G["aria-haspopup"]=r["aria-haspopup"],G["aria-owns"]=r["aria-owns"],G["aria-expanded"]=r["aria-expanded"]),G}),a=oe(()=>[i.type==="textarea"?m.b():_.b(),_.m(f.value),_.is("disabled",p.value),_.is("exceed",ce.value),{[_.b("group")]:s.prepend||s.append,[_.bm("group","append")]:s.append,[_.bm("group","prepend")]:s.prepend,[_.m("prefix")]:s.prefix||i.prefixIcon,[_.m("suffix")]:s.suffix||i.suffixIcon||i.clearable||i.showPassword,[_.bm("suffix","password-clear")]:j.value&&F.value},r.class]),l=oe(()=>[_.e("wrapper"),_.is("focus",M.value)]),u=dV({excludeKeys:oe(()=>Object.keys(o.value))}),{form:c,formItem:h}=Qm(),{inputId:d}=AR(i,{formItemContext:h}),f=Zm(),p=Jm(),_=bn("input"),m=bn("textarea"),g=Za(),v=Za(),y=Fe(!1),x=Fe(!1),b=Fe(!1),S=Fe(),T=Za(i.inputStyle),P=oe(()=>g.value||v.value),{wrapperRef:E,isFocused:M,handleFocus:O,handleBlur:L}=NG(P,{afterBlur(){var G;i.validateEvent&&((G=h==null?void 0:h.validate)==null||G.call(h,"blur").catch(Q=>void 0))}}),C=oe(()=>{var G;return(G=c==null?void 0:c.statusIcon)!=null?G:!1}),D=oe(()=>(h==null?void 0:h.validateState)||""),B=oe(()=>D.value&&sV[D.value]),W=oe(()=>b.value?Z4:v4),U=oe(()=>[r.style,i.inputStyle]),$=oe(()=>[i.inputStyle,T.value,{resize:i.resize}]),J=oe(()=>Ws(i.modelValue)?"":String(i.modelValue)),j=oe(()=>i.clearable&&!p.value&&!i.readonly&&!!J.value&&(M.value||y.value)),F=oe(()=>i.showPassword&&!p.value&&!i.readonly&&!!J.value&&(!!J.value||M.value)),X=oe(()=>i.showWordLimit&&!!u.value.maxlength&&(i.type==="text"||i.type==="textarea")&&!p.value&&!i.readonly&&!i.showPassword),re=oe(()=>J.value.length),ce=oe(()=>!!X.value&&re.value>Number(u.value.maxlength)),ve=oe(()=>!!s.suffix||!!i.suffixIcon||j.value||i.showPassword||X.value||!!D.value&&C.value),[ae,Y]=DG(g);WC(v,G=>{if(xe(),!X.value||i.resize!=="both")return;const Q=G[0],{width:ue}=Q.contentRect;S.value={right:`calc(100% - ${ue+15+6}px)`}});const ne=()=>{const{type:G,autosize:Q}=i;if(!(!Un||G!=="textarea"||!v.value))if(Q){const ue=Rt(Q)?Q.minRows:void 0,k=Rt(Q)?Q.maxRows:void 0,pe=rT(v.value,ue,k);T.value={overflowY:"hidden",...pe},Kn(()=>{v.value.offsetHeight,T.value=pe})}else T.value={minHeight:rT(v.value).minHeight}},xe=(G=>{let Q=!1;return()=>{var ue;if(Q||!i.autosize)return;((ue=v.value)==null?void 0:ue.offsetParent)===null||(G(),Q=!0)}})(ne),be=()=>{const G=P.value,Q=i.formatter?i.formatter(J.value):J.value;!G||G.value===Q||(G.value=Q)},w=async G=>{ae();let{value:Q}=G.target;if(i.formatter&&(Q=i.parser?i.parser(Q):Q),!x.value){if(Q===J.value){be();return}t(oi,Q),t("input",Q),await Kn(),be(),Y()}},V=G=>{t("change",G.target.value)},H=G=>{t("compositionstart",G),x.value=!0},K=G=>{var Q;t("compositionupdate",G);const ue=(Q=G.target)==null?void 0:Q.value,k=ue[ue.length-1]||"";x.value=!uV(k)},Z=G=>{t("compositionend",G),x.value&&(x.value=!1,w(G))},ee=()=>{b.value=!b.value,ge()},ge=async()=>{var G;await Kn(),(G=P.value)==null||G.focus()},le=()=>{var G;return(G=P.value)==null?void 0:G.blur()},fe=G=>{y.value=!1,t("mouseleave",G)},me=G=>{y.value=!0,t("mouseenter",G)},we=G=>{t("keydown",G)},I=()=>{var G;(G=P.value)==null||G.select()},A=()=>{t(oi,""),t("change",""),t("clear"),t("input","")};return et(()=>i.modelValue,()=>{var G;Kn(()=>ne()),i.validateEvent&&((G=h==null?void 0:h.validate)==null||G.call(h,"change").catch(Q=>void 0))}),et(J,()=>be()),et(()=>i.type,async()=>{await Kn(),be(),ne()}),Sn(()=>{!i.formatter&&i.parser,be(),Kn(ne)}),e({input:g,textarea:v,ref:P,textareaStyle:$,autosize:Ns(i,"autosize"),focus:ge,blur:le,select:I,clear:A,resizeTextarea:ne}),(G,Q)=>Go((Te(),ke("div",is(R(o),{class:R(a),style:R(U),role:G.containerRole,onMouseenter:me,onMouseleave:fe}),[ut(" input "),G.type!=="textarea"?(Te(),ke(jt,{key:0},[ut(" prepend slot "),G.$slots.prepend?(Te(),ke("div",{key:0,class:qe(R(_).be("group","prepend"))},[Qt(G.$slots,"prepend")],2)):ut("v-if",!0),ze("div",{ref_key:"wrapperRef",ref:E,class:qe(R(l))},[ut(" prefix slot "),G.$slots.prefix||G.prefixIcon?(Te(),ke("span",{key:0,class:qe(R(_).e("prefix"))},[ze("span",{class:qe(R(_).e("prefix-inner"))},[Qt(G.$slots,"prefix"),G.prefixIcon?(Te(),vt(R(Yi),{key:0,class:qe(R(_).e("icon"))},{default:Mt(()=>[(Te(),vt(wo(G.prefixIcon)))]),_:1},8,["class"])):ut("v-if",!0)],2)],2)):ut("v-if",!0),ze("input",is({id:R(d),ref_key:"input",ref:g,class:R(_).e("inner")},R(u),{type:G.showPassword?b.value?"text":"password":G.type,disabled:R(p),formatter:G.formatter,parser:G.parser,readonly:G.readonly,autocomplete:G.autocomplete,tabindex:G.tabindex,"aria-label":G.label,placeholder:G.placeholder,style:G.inputStyle,form:i.form,onCompositionstart:H,onCompositionupdate:K,onCompositionend:Z,onInput:w,onFocus:Q[0]||(Q[0]=(...ue)=>R(O)&&R(O)(...ue)),onBlur:Q[1]||(Q[1]=(...ue)=>R(L)&&R(L)(...ue)),onChange:V,onKeydown:we}),null,16,KG),ut(" suffix slot "),R(ve)?(Te(),ke("span",{key:1,class:qe(R(_).e("suffix"))},[ze("span",{class:qe(R(_).e("suffix-inner"))},[!R(j)||!R(F)||!R(X)?(Te(),ke(jt,{key:0},[Qt(G.$slots,"suffix"),G.suffixIcon?(Te(),vt(R(Yi),{key:0,class:qe(R(_).e("icon"))},{default:Mt(()=>[(Te(),vt(wo(G.suffixIcon)))]),_:1},8,["class"])):ut("v-if",!0)],64)):ut("v-if",!0),R(j)?(Te(),vt(R(Yi),{key:1,class:qe([R(_).e("icon"),R(_).e("clear")]),onMousedown:Wa(R(Mn),["prevent"]),onClick:A},{default:Mt(()=>[lt(R(ZC))]),_:1},8,["class","onMousedown"])):ut("v-if",!0),R(F)?(Te(),vt(R(Yi),{key:2,class:qe([R(_).e("icon"),R(_).e("password")]),onClick:ee},{default:Mt(()=>[(Te(),vt(wo(R(W))))]),_:1},8,["class"])):ut("v-if",!0),R(X)?(Te(),ke("span",{key:3,class:qe(R(_).e("count"))},[ze("span",{class:qe(R(_).e("count-inner"))},Fs(R(re))+" / "+Fs(R(u).maxlength),3)],2)):ut("v-if",!0),R(D)&&R(B)&&R(C)?(Te(),vt(R(Yi),{key:4,class:qe([R(_).e("icon"),R(_).e("validateIcon"),R(_).is("loading",R(D)==="validating")])},{default:Mt(()=>[(Te(),vt(wo(R(B))))]),_:1},8,["class"])):ut("v-if",!0)],2)],2)):ut("v-if",!0)],2),ut(" append slot "),G.$slots.append?(Te(),ke("div",{key:1,class:qe(R(_).be("group","append"))},[Qt(G.$slots,"append")],2)):ut("v-if",!0)],64)):(Te(),ke(jt,{key:1},[ut(" textarea "),ze("textarea",is({id:R(d),ref_key:"textarea",ref:v,class:R(m).e("inner")},R(u),{tabindex:G.tabindex,disabled:R(p),readonly:G.readonly,autocomplete:G.autocomplete,style:R($),"aria-label":G.label,placeholder:G.placeholder,form:i.form,onCompositionstart:H,onCompositionupdate:K,onCompositionend:Z,onInput:w,onFocus:Q[2]||(Q[2]=(...ue)=>R(O)&&R(O)(...ue)),onBlur:Q[3]||(Q[3]=(...ue)=>R(L)&&R(L)(...ue)),onChange:V,onKeydown:we}),null,16,ZG),R(X)?(Te(),ke("span",{key:0,style:$i(S.value),class:qe(R(_).e("count"))},Fs(R(re))+" / "+Fs(R(u).maxlength),7)):ut("v-if",!0)],64))],16,qG)),[[Id,G.type!=="hidden"]])}});var eH=Bn(QG,[["__file","/home/runner/work/element-plus/element-plus/packages/components/input/src/input.vue"]]);const tH=Qs(eH),Hx=Symbol("popper"),PR=Symbol("popperContent"),nH=["dialog","grid","group","listbox","menu","navigation","tooltip","tree"],CR=hn({role:{type:String,values:nH,default:"tooltip"}}),iH=dt({name:"ElPopper",inheritAttrs:!1}),rH=dt({...iH,props:CR,setup(n,{expose:e}){const t=n,i=Fe(),r=Fe(),s=Fe(),o=Fe(),a=oe(()=>t.role),l={triggerRef:i,popperInstanceRef:r,contentRef:s,referenceRef:o,role:a};return e(l),Ii(Hx,l),(u,c)=>Qt(u.$slots,"default")}});var sH=Bn(rH,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/popper.vue"]]);const RR=hn({arrowOffset:{type:Number,default:5}}),oH=dt({name:"ElPopperArrow",inheritAttrs:!1}),aH=dt({...oH,props:RR,setup(n,{expose:e}){const t=n,i=bn("popper"),{arrowOffset:r,arrowRef:s,arrowStyle:o}=Lt(PR,void 0);return et(()=>t.arrowOffset,a=>{r.value=a}),Dr(()=>{s.value=void 0}),e({arrowRef:s}),(a,l)=>(Te(),ke("span",{ref_key:"arrowRef",ref:s,class:qe(R(i).e("arrow")),style:$i(R(o)),"data-popper-arrow":""},null,6))}});var lH=Bn(aH,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/arrow.vue"]]);const uH="ElOnlyChild",cH=dt({name:uH,setup(n,{slots:e,attrs:t}){var i;const r=Lt(SR),s=OG((i=r==null?void 0:r.setForwardRef)!=null?i:Mn);return()=>{var o;const a=(o=e.default)==null?void 0:o.call(e,t);if(!a||a.length>1)return null;const l=IR(a);return l?Go(Ys(l,t),[[s]]):null}}});function IR(n){if(!n)return null;const e=n;for(const t of e){if(Rt(t))switch(t.type){case Li:continue;case gc:case"svg":return sT(t);case jt:return IR(t.children);default:return t}return sT(t)}return null}function sT(n){const e=bn("only-child");return lt("span",{class:e.e("content")},[n])}const LR=hn({virtualRef:{type:pt(Object)},virtualTriggering:Boolean,onMouseenter:{type:pt(Function)},onMouseleave:{type:pt(Function)},onClick:{type:pt(Function)},onKeydown:{type:pt(Function)},onFocus:{type:pt(Function)},onBlur:{type:pt(Function)},onContextmenu:{type:pt(Function)},id:String,open:Boolean}),hH=dt({name:"ElPopperTrigger",inheritAttrs:!1}),dH=dt({...hH,props:LR,setup(n,{expose:e}){const t=n,{role:i,triggerRef:r}=Lt(Hx,void 0);LG(r);const s=oe(()=>a.value?t.id:void 0),o=oe(()=>{if(i&&i.value==="tooltip")return t.open&&t.id?t.id:void 0}),a=oe(()=>{if(i&&i.value!=="tooltip")return i.value}),l=oe(()=>a.value?`${t.open}`:void 0);let u;return Sn(()=>{et(()=>t.virtualRef,c=>{c&&(r.value=Ao(c))},{immediate:!0}),et(r,(c,h)=>{u==null||u(),u=void 0,Jh(c)&&(["onMouseenter","onMouseleave","onClick","onKeydown","onFocus","onBlur","onContextmenu"].forEach(d=>{var f;const p=t[d];p&&(c.addEventListener(d.slice(2).toLowerCase(),p),(f=h==null?void 0:h.removeEventListener)==null||f.call(h,d.slice(2).toLowerCase(),p))}),u=et([s,o,a,l],d=>{["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach((f,p)=>{Ws(d[p])?c.removeAttribute(f):c.setAttribute(f,d[p])})},{immediate:!0})),Jh(h)&&["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach(d=>h.removeAttribute(d))},{immediate:!0})}),Dr(()=>{u==null||u(),u=void 0}),e({triggerRef:r}),(c,h)=>c.virtualTriggering?ut("v-if",!0):(Te(),vt(R(cH),is({key:0},c.$attrs,{"aria-controls":R(s),"aria-describedby":R(o),"aria-expanded":R(l),"aria-haspopup":R(a)}),{default:Mt(()=>[Qt(c.$slots,"default")]),_:3},16,["aria-controls","aria-describedby","aria-expanded","aria-haspopup"]))}});var fH=Bn(dH,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/trigger.vue"]]);const Kg="focus-trap.focus-after-trapped",Zg="focus-trap.focus-after-released",pH="focus-trap.focusout-prevented",oT={cancelable:!0,bubbles:!1},mH={cancelable:!0,bubbles:!1},aT="focusAfterTrapped",lT="focusAfterReleased",gH=Symbol("elFocusTrap"),zx=Fe(),eg=Fe(0),Wx=Fe(0);let af=0;const OR=n=>{const e=[],t=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>{const r=i.tagName==="INPUT"&&i.type==="hidden";return i.disabled||i.hidden||r?NodeFilter.FILTER_SKIP:i.tabIndex>=0||i===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e},uT=(n,e)=>{for(const t of n)if(!_H(t,e))return t},_H=(n,e)=>{if(getComputedStyle(n).visibility==="hidden")return!0;for(;n;){if(e&&n===e)return!1;if(getComputedStyle(n).display==="none")return!0;n=n.parentElement}return!1},vH=n=>{const e=OR(n),t=uT(e,n),i=uT(e.reverse(),n);return[t,i]},yH=n=>n instanceof HTMLInputElement&&"select"in n,yo=(n,e)=>{if(n&&n.focus){const t=document.activeElement;n.focus({preventScroll:!0}),Wx.value=window.performance.now(),n!==t&&yH(n)&&e&&n.select()}};function cT(n,e){const t=[...n],i=n.indexOf(e);return i!==-1&&t.splice(i,1),t}const xH=()=>{let n=[];return{push:i=>{const r=n[0];r&&i!==r&&r.pause(),n=cT(n,i),n.unshift(i)},remove:i=>{var r,s;n=cT(n,i),(s=(r=n[0])==null?void 0:r.resume)==null||s.call(r)}}},bH=(n,e=!1)=>{const t=document.activeElement;for(const i of n)if(yo(i,e),document.activeElement!==t)return},hT=xH(),SH=()=>eg.value>Wx.value,lf=()=>{zx.value="pointer",eg.value=window.performance.now()},dT=()=>{zx.value="keyboard",eg.value=window.performance.now()},EH=()=>(Sn(()=>{af===0&&(document.addEventListener("mousedown",lf),document.addEventListener("touchstart",lf),document.addEventListener("keydown",dT)),af++}),Dr(()=>{af--,af<=0&&(document.removeEventListener("mousedown",lf),document.removeEventListener("touchstart",lf),document.removeEventListener("keydown",dT))}),{focusReason:zx,lastUserFocusTimestamp:eg,lastAutomatedFocusTimestamp:Wx}),uf=n=>new CustomEvent(pH,{...mH,detail:n}),TH=dt({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[aT,lT,"focusin","focusout","focusout-prevented","release-requested"],setup(n,{emit:e}){const t=Fe();let i,r;const{focusReason:s}=EH();AG(p=>{n.trapped&&!o.paused&&e("release-requested",p)});const o={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},a=p=>{if(!n.loop&&!n.trapped||o.paused)return;const{key:_,altKey:m,ctrlKey:g,metaKey:v,currentTarget:y,shiftKey:x}=p,{loop:b}=n,S=_===Vu.tab&&!m&&!g&&!v,T=document.activeElement;if(S&&T){const P=y,[E,M]=vH(P);if(E&&M){if(!x&&T===M){const L=uf({focusReason:s.value});e("focusout-prevented",L),L.defaultPrevented||(p.preventDefault(),b&&yo(E,!0))}else if(x&&[E,P].includes(T)){const L=uf({focusReason:s.value});e("focusout-prevented",L),L.defaultPrevented||(p.preventDefault(),b&&yo(M,!0))}}else if(T===P){const L=uf({focusReason:s.value});e("focusout-prevented",L),L.defaultPrevented||p.preventDefault()}}};Ii(gH,{focusTrapRef:t,onKeydown:a}),et(()=>n.focusTrapEl,p=>{p&&(t.value=p)},{immediate:!0}),et([t],([p],[_])=>{p&&(p.addEventListener("keydown",a),p.addEventListener("focusin",c),p.addEventListener("focusout",h)),_&&(_.removeEventListener("keydown",a),_.removeEventListener("focusin",c),_.removeEventListener("focusout",h))});const l=p=>{e(aT,p)},u=p=>e(lT,p),c=p=>{const _=R(t);if(!_)return;const m=p.target,g=p.relatedTarget,v=m&&_.contains(m);n.trapped||g&&_.contains(g)||(i=g),v&&e("focusin",p),!o.paused&&n.trapped&&(v?r=m:yo(r,!0))},h=p=>{const _=R(t);if(!(o.paused||!_))if(n.trapped){const m=p.relatedTarget;!Ws(m)&&!_.contains(m)&&setTimeout(()=>{if(!o.paused&&n.trapped){const g=uf({focusReason:s.value});e("focusout-prevented",g),g.defaultPrevented||yo(r,!0)}},0)}else{const m=p.target;m&&_.contains(m)||e("focusout",p)}};async function d(){await Kn();const p=R(t);if(p){hT.push(o);const _=p.contains(document.activeElement)?i:document.activeElement;if(i=_,!p.contains(_)){const g=new Event(Kg,oT);p.addEventListener(Kg,l),p.dispatchEvent(g),g.defaultPrevented||Kn(()=>{let v=n.focusStartEl;At(v)||(yo(v),document.activeElement!==v&&(v="first")),v==="first"&&bH(OR(p),!0),(document.activeElement===_||v==="container")&&yo(p)})}}}function f(){const p=R(t);if(p){p.removeEventListener(Kg,l);const _=new CustomEvent(Zg,{...oT,detail:{focusReason:s.value}});p.addEventListener(Zg,u),p.dispatchEvent(_),!_.defaultPrevented&&(s.value=="keyboard"||!SH()||p.contains(document.activeElement))&&yo(i??document.body),p.removeEventListener(Zg,l),hT.remove(o)}}return Sn(()=>{n.trapped&&d(),et(()=>n.trapped,p=>{p?d():f()})}),Dr(()=>{n.trapped&&f()}),{onKeydown:a}}});function MH(n,e,t,i,r,s){return Qt(n.$slots,"default",{handleKeydown:n.onKeydown})}var DR=Bn(TH,[["render",MH],["__file","/home/runner/work/element-plus/element-plus/packages/components/focus-trap/src/focus-trap.vue"]]);const wH=["fixed","absolute"],AH=hn({boundariesPadding:{type:Number,default:0},fallbackPlacements:{type:pt(Array),default:void 0},gpuAcceleration:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:String,values:Fd,default:"bottom"},popperOptions:{type:pt(Object),default:()=>({})},strategy:{type:String,values:wH,default:"absolute"}}),FR=hn({...AH,id:String,style:{type:pt([String,Array,Object])},className:{type:pt([String,Array,Object])},effect:{type:String,default:"dark"},visible:Boolean,enterable:{type:Boolean,default:!0},pure:Boolean,focusOnShow:{type:Boolean,default:!1},trapping:{type:Boolean,default:!1},popperClass:{type:pt([String,Array,Object])},popperStyle:{type:pt([String,Array,Object])},referenceEl:{type:pt(Object)},triggerTargetEl:{type:pt(Object)},stopPopperMouseEvent:{type:Boolean,default:!0},ariaLabel:{type:String,default:void 0},virtualTriggering:Boolean,zIndex:Number}),PH={mouseenter:n=>n instanceof MouseEvent,mouseleave:n=>n instanceof MouseEvent,focus:()=>!0,blur:()=>!0,close:()=>!0},CH=(n,e=[])=>{const{placement:t,strategy:i,popperOptions:r}=n,s={placement:t,strategy:i,...r,modifiers:[...IH(n),...e]};return LH(s,r==null?void 0:r.modifiers),s},RH=n=>{if(Un)return Ao(n)};function IH(n){const{offset:e,gpuAcceleration:t,fallbackPlacements:i}=n;return[{name:"offset",options:{offset:[0,e??12]}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5,fallbackPlacements:i}},{name:"computeStyles",options:{gpuAcceleration:t}}]}function LH(n,e){e&&(n.modifiers=[...n.modifiers,...e??[]])}const OH=0,DH=n=>{const{popperInstanceRef:e,contentRef:t,triggerRef:i,role:r}=Lt(Hx,void 0),s=Fe(),o=Fe(),a=oe(()=>({name:"eventListeners",enabled:!!n.visible})),l=oe(()=>{var g;const v=R(s),y=(g=R(o))!=null?g:OH;return{name:"arrow",enabled:!Tk(v),options:{element:v,padding:y}}}),u=oe(()=>({onFirstUpdate:()=>{p()},...CH(n,[R(l),R(a)])})),c=oe(()=>RH(n.referenceEl)||R(i)),{attributes:h,state:d,styles:f,update:p,forceUpdate:_,instanceRef:m}=EG(c,t,u);return et(m,g=>e.value=g),Sn(()=>{et(()=>{var g;return(g=R(c))==null?void 0:g.getBoundingClientRect()},()=>{p()})}),{attributes:h,arrowRef:s,contentRef:t,instanceRef:m,state:d,styles:f,role:r,forceUpdate:_,update:p}},FH=(n,{attributes:e,styles:t,role:i})=>{const{nextZIndex:r}=Vx(),s=bn("popper"),o=oe(()=>R(e).popper),a=Fe(n.zIndex||r()),l=oe(()=>[s.b(),s.is("pure",n.pure),s.is(n.effect),n.popperClass]),u=oe(()=>[{zIndex:R(a)},R(t).popper,n.popperStyle||{}]),c=oe(()=>i.value==="dialog"?"false":void 0),h=oe(()=>R(t).arrow||{});return{ariaModal:c,arrowStyle:h,contentAttrs:o,contentClass:l,contentStyle:u,contentZIndex:a,updateZIndex:()=>{a.value=n.zIndex||r()}}},NH=(n,e)=>{const t=Fe(!1),i=Fe();return{focusStartRef:i,trapped:t,onFocusAfterReleased:u=>{var c;((c=u.detail)==null?void 0:c.focusReason)!=="pointer"&&(i.value="first",e("blur"))},onFocusAfterTrapped:()=>{e("focus")},onFocusInTrap:u=>{n.visible&&!t.value&&(u.target&&(i.value=u.target),t.value=!0)},onFocusoutPrevented:u=>{n.trapping||(u.detail.focusReason==="pointer"&&u.preventDefault(),t.value=!1)},onReleaseRequested:()=>{t.value=!1,e("close")}}},UH=dt({name:"ElPopperContent"}),BH=dt({...UH,props:FR,emits:PH,setup(n,{expose:e,emit:t}){const i=n,{focusStartRef:r,trapped:s,onFocusAfterReleased:o,onFocusAfterTrapped:a,onFocusInTrap:l,onFocusoutPrevented:u,onReleaseRequested:c}=NH(i,t),{attributes:h,arrowRef:d,contentRef:f,styles:p,instanceRef:_,role:m,update:g}=DH(i),{ariaModal:v,arrowStyle:y,contentAttrs:x,contentClass:b,contentStyle:S,updateZIndex:T}=FH(i,{styles:p,attributes:h,role:m}),P=Lt(Jp,void 0),E=Fe();Ii(PR,{arrowStyle:y,arrowRef:d,arrowOffset:E}),P&&(P.addInputId||P.removeInputId)&&Ii(Jp,{...P,addInputId:Mn,removeInputId:Mn});let M;const O=(C=!0)=>{g(),C&&T()},L=()=>{O(!1),i.visible&&i.focusOnShow?s.value=!0:i.visible===!1&&(s.value=!1)};return Sn(()=>{et(()=>i.triggerTargetEl,(C,D)=>{M==null||M(),M=void 0;const B=R(C||f.value),W=R(D||f.value);Jh(B)&&(M=et([m,()=>i.ariaLabel,v,()=>i.id],U=>{["role","aria-label","aria-modal","id"].forEach(($,J)=>{Ws(U[J])?B.removeAttribute($):B.setAttribute($,U[J])})},{immediate:!0})),W!==B&&Jh(W)&&["role","aria-label","aria-modal","id"].forEach(U=>{W.removeAttribute(U)})},{immediate:!0}),et(()=>i.visible,L,{immediate:!0})}),Dr(()=>{M==null||M(),M=void 0}),e({popperContentRef:f,popperInstanceRef:_,updatePopper:O,contentStyle:S}),(C,D)=>(Te(),ke("div",is({ref_key:"contentRef",ref:f},R(x),{style:R(S),class:R(b),tabindex:"-1",onMouseenter:D[0]||(D[0]=B=>C.$emit("mouseenter",B)),onMouseleave:D[1]||(D[1]=B=>C.$emit("mouseleave",B))}),[lt(R(DR),{trapped:R(s),"trap-on-focus-in":!0,"focus-trap-el":R(f),"focus-start-el":R(r),onFocusAfterTrapped:R(a),onFocusAfterReleased:R(o),onFocusin:R(l),onFocusoutPrevented:R(u),onReleaseRequested:R(c)},{default:Mt(()=>[Qt(C.$slots,"default")]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusin","onFocusoutPrevented","onReleaseRequested"])],16))}});var kH=Bn(BH,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/content.vue"]]);const VH=Qs(sH),Xx=Symbol("elTooltip"),NR=hn({...RG,...FR,appendTo:{type:pt([String,Object])},content:{type:String,default:""},rawContent:{type:Boolean,default:!1},persistent:Boolean,ariaLabel:String,visible:{type:pt(Boolean),default:null},transition:String,teleported:{type:Boolean,default:!0},disabled:Boolean}),UR=hn({...LR,disabled:Boolean,trigger:{type:pt([String,Array]),default:"hover"},triggerKeys:{type:pt(Array),default:()=>[Vu.enter,Vu.space]}}),{useModelToggleProps:GH,useModelToggleEmits:HH,useModelToggle:zH}=aR("visible"),WH=hn({...CR,...GH,...NR,...UR,...RR,showArrow:{type:Boolean,default:!0}}),XH=[...HH,"before-show","before-hide","show","hide","open","close"],jH=(n,e)=>$e(n)?n.includes(e):n===e,Rl=(n,e,t)=>i=>{jH(R(n),e)&&t(i)},$H=dt({name:"ElTooltipTrigger"}),YH=dt({...$H,props:UR,setup(n,{expose:e}){const t=n,i=bn("tooltip"),{controlled:r,id:s,open:o,onOpen:a,onClose:l,onToggle:u}=Lt(Xx,void 0),c=Fe(null),h=()=>{if(R(r)||t.disabled)return!0},d=Ns(t,"trigger"),f=Is(h,Rl(d,"hover",a)),p=Is(h,Rl(d,"hover",l)),_=Is(h,Rl(d,"click",x=>{x.button===0&&u(x)})),m=Is(h,Rl(d,"focus",a)),g=Is(h,Rl(d,"focus",l)),v=Is(h,Rl(d,"contextmenu",x=>{x.preventDefault(),u(x)})),y=Is(h,x=>{const{code:b}=x;t.triggerKeys.includes(b)&&(x.preventDefault(),u(x))});return e({triggerRef:c}),(x,b)=>(Te(),vt(R(fH),{id:R(s),"virtual-ref":x.virtualRef,open:R(o),"virtual-triggering":x.virtualTriggering,class:qe(R(i).e("trigger")),onBlur:R(g),onClick:R(_),onContextmenu:R(v),onFocus:R(m),onMouseenter:R(f),onMouseleave:R(p),onKeydown:R(y)},{default:Mt(()=>[Qt(x.$slots,"default")]),_:3},8,["id","virtual-ref","open","virtual-triggering","class","onBlur","onClick","onContextmenu","onFocus","onMouseenter","onMouseleave","onKeydown"]))}});var qH=Bn(YH,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip/src/trigger.vue"]]);const KH=dt({name:"ElTooltipContent",inheritAttrs:!1}),ZH=dt({...KH,props:NR,setup(n,{expose:e}){const t=n,{selector:i}=bR(),r=bn("tooltip"),s=Fe(null),o=Fe(!1),{controlled:a,id:l,open:u,trigger:c,onClose:h,onOpen:d,onShow:f,onHide:p,onBeforeShow:_,onBeforeHide:m}=Lt(Xx,void 0),g=oe(()=>t.transition||`${r.namespace.value}-fade-in-linear`),v=oe(()=>t.persistent);Dr(()=>{o.value=!0});const y=oe(()=>R(v)?!0:R(u)),x=oe(()=>t.disabled?!1:R(u)),b=oe(()=>t.appendTo||i.value),S=oe(()=>{var U;return(U=t.style)!=null?U:{}}),T=oe(()=>!R(u)),P=()=>{p()},E=()=>{if(R(a))return!0},M=Is(E,()=>{t.enterable&&R(c)==="hover"&&d()}),O=Is(E,()=>{R(c)==="hover"&&h()}),L=()=>{var U,$;($=(U=s.value)==null?void 0:U.updatePopper)==null||$.call(U),_==null||_()},C=()=>{m==null||m()},D=()=>{f(),W=PB(oe(()=>{var U;return(U=s.value)==null?void 0:U.popperContentRef}),()=>{if(R(a))return;R(c)!=="hover"&&h()})},B=()=>{t.virtualTriggering||h()};let W;return et(()=>R(u),U=>{U||W==null||W()},{flush:"post"}),et(()=>t.content,()=>{var U,$;($=(U=s.value)==null?void 0:U.updatePopper)==null||$.call(U)}),e({contentRef:s}),(U,$)=>(Te(),vt(nC,{disabled:!U.teleported,to:R(b)},[lt(_c,{name:R(g),onAfterLeave:P,onBeforeEnter:L,onAfterEnter:D,onBeforeLeave:C},{default:Mt(()=>[R(y)?Go((Te(),vt(R(kH),is({key:0,id:R(l),ref_key:"contentRef",ref:s},U.$attrs,{"aria-label":U.ariaLabel,"aria-hidden":R(T),"boundaries-padding":U.boundariesPadding,"fallback-placements":U.fallbackPlacements,"gpu-acceleration":U.gpuAcceleration,offset:U.offset,placement:U.placement,"popper-options":U.popperOptions,strategy:U.strategy,effect:U.effect,enterable:U.enterable,pure:U.pure,"popper-class":U.popperClass,"popper-style":[U.popperStyle,R(S)],"reference-el":U.referenceEl,"trigger-target-el":U.triggerTargetEl,visible:R(x),"z-index":U.zIndex,onMouseenter:R(M),onMouseleave:R(O),onBlur:B,onClose:R(h)}),{default:Mt(()=>[o.value?ut("v-if",!0):Qt(U.$slots,"default",{key:0})]),_:3},16,["id","aria-label","aria-hidden","boundaries-padding","fallback-placements","gpu-acceleration","offset","placement","popper-options","strategy","effect","enterable","pure","popper-class","popper-style","reference-el","trigger-target-el","visible","z-index","onMouseenter","onMouseleave","onClose"])),[[Id,R(x)]]):ut("v-if",!0)]),_:3},8,["name"])],8,["disabled","to"]))}});var JH=Bn(ZH,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip/src/content.vue"]]);const QH=["innerHTML"],ez={key:1},tz=dt({name:"ElTooltip"}),nz=dt({...tz,props:WH,emits:XH,setup(n,{expose:e,emit:t}){const i=n;CG();const r=Kp(),s=Fe(),o=Fe(),a=()=>{var g;const v=R(s);v&&((g=v.popperInstanceRef)==null||g.update())},l=Fe(!1),u=Fe(),{show:c,hide:h,hasUpdateHandler:d}=zH({indicator:l,toggleReason:u}),{onOpen:f,onClose:p}=IG({showAfter:Ns(i,"showAfter"),hideAfter:Ns(i,"hideAfter"),autoClose:Ns(i,"autoClose"),open:c,close:h}),_=oe(()=>Px(i.visible)&&!d.value);Ii(Xx,{controlled:_,id:r,open:Am(l),trigger:Ns(i,"trigger"),onOpen:g=>{f(g)},onClose:g=>{p(g)},onToggle:g=>{R(l)?p(g):f(g)},onShow:()=>{t("show",u.value)},onHide:()=>{t("hide",u.value)},onBeforeShow:()=>{t("before-show",u.value)},onBeforeHide:()=>{t("before-hide",u.value)},updatePopper:a}),et(()=>i.disabled,g=>{g&&l.value&&(l.value=!1)});const m=()=>{var g,v;const y=(v=(g=o.value)==null?void 0:g.contentRef)==null?void 0:v.popperContentRef;return y&&y.contains(document.activeElement)};return GP(()=>l.value&&h()),e({popperRef:s,contentRef:o,isFocusInsideContent:m,updatePopper:a,onOpen:f,onClose:p,hide:h}),(g,v)=>(Te(),vt(R(VH),{ref_key:"popperRef",ref:s,role:g.role},{default:Mt(()=>[lt(qH,{disabled:g.disabled,trigger:g.trigger,"trigger-keys":g.triggerKeys,"virtual-ref":g.virtualRef,"virtual-triggering":g.virtualTriggering},{default:Mt(()=>[g.$slots.default?Qt(g.$slots,"default",{key:0}):ut("v-if",!0)]),_:3},8,["disabled","trigger","trigger-keys","virtual-ref","virtual-triggering"]),lt(JH,{ref_key:"contentRef",ref:o,"aria-label":g.ariaLabel,"boundaries-padding":g.boundariesPadding,content:g.content,disabled:g.disabled,effect:g.effect,enterable:g.enterable,"fallback-placements":g.fallbackPlacements,"hide-after":g.hideAfter,"gpu-acceleration":g.gpuAcceleration,offset:g.offset,persistent:g.persistent,"popper-class":g.popperClass,"popper-style":g.popperStyle,placement:g.placement,"popper-options":g.popperOptions,pure:g.pure,"raw-content":g.rawContent,"reference-el":g.referenceEl,"trigger-target-el":g.triggerTargetEl,"show-after":g.showAfter,strategy:g.strategy,teleported:g.teleported,transition:g.transition,"virtual-triggering":g.virtualTriggering,"z-index":g.zIndex,"append-to":g.appendTo},{default:Mt(()=>[Qt(g.$slots,"content",{},()=>[g.rawContent?(Te(),ke("span",{key:0,innerHTML:g.content},null,8,QH)):(Te(),ke("span",ez,Fs(g.content),1))]),g.showArrow?(Te(),vt(R(lH),{key:0,"arrow-offset":g.arrowOffset},null,8,["arrow-offset"])):ut("v-if",!0)]),_:3},8,["aria-label","boundaries-padding","content","disabled","effect","enterable","fallback-placements","hide-after","gpu-acceleration","offset","persistent","popper-class","popper-style","placement","popper-options","pure","raw-content","reference-el","trigger-target-el","show-after","strategy","teleported","transition","virtual-triggering","z-index","append-to"])]),_:3},8,["role"]))}});var iz=Bn(nz,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip/src/tooltip.vue"]]);const BR=Qs(iz),rz=hn({value:{type:[String,Number],default:""},max:{type:Number,default:99},isDot:Boolean,hidden:Boolean,type:{type:String,values:["primary","success","warning","info","danger"],default:"danger"}}),sz=["textContent"],oz=dt({name:"ElBadge"}),az=dt({...oz,props:rz,setup(n,{expose:e}){const t=n,i=bn("badge"),r=oe(()=>t.isDot?"":pn(t.value)&&pn(t.max)?t.max<t.value?`${t.max}+`:`${t.value}`:`${t.value}`);return e({content:r}),(s,o)=>(Te(),ke("div",{class:qe(R(i).b())},[Qt(s.$slots,"default"),lt(_c,{name:`${R(i).namespace.value}-zoom-in-center`,persisted:""},{default:Mt(()=>[Go(ze("sup",{class:qe([R(i).e("content"),R(i).em("content",s.type),R(i).is("fixed",!!s.$slots.default),R(i).is("dot",s.isDot)]),textContent:Fs(R(r))},null,10,sz),[[Id,!s.hidden&&(R(r)||s.isDot)]])]),_:1},8,["name"])],2))}});var lz=Bn(az,[["__file","/home/runner/work/element-plus/element-plus/packages/components/badge/src/badge.vue"]]);const uz=Qs(lz),kR=Symbol("buttonGroupContextKey"),cz=(n,e)=>{h0({from:"type.text",replacement:"link",version:"3.0.0",scope:"props",ref:"https://element-plus.org/en-US/component/button.html#button-attributes"},oe(()=>n.type==="text"));const t=Lt(kR,void 0),i=Km("button"),{form:r}=Qm(),s=Zm(oe(()=>t==null?void 0:t.size)),o=Jm(),a=Fe(),l=$P(),u=oe(()=>n.type||(t==null?void 0:t.type)||""),c=oe(()=>{var p,_,m;return(m=(_=n.autoInsertSpace)!=null?_:(p=i.value)==null?void 0:p.autoInsertSpace)!=null?m:!1}),h=oe(()=>n.tag==="button"?{ariaDisabled:o.value||n.loading,disabled:o.value||n.loading,autofocus:n.autofocus,type:n.nativeType}:{}),d=oe(()=>{var p;const _=(p=l.default)==null?void 0:p.call(l);if(c.value&&(_==null?void 0:_.length)===1){const m=_[0];if((m==null?void 0:m.type)===gc){const g=m.children;return/^\p{Unified_Ideograph}{2}$/u.test(g.trim())}}return!1});return{_disabled:o,_size:s,_type:u,_ref:a,_props:h,shouldAddSpace:d,handleClick:p=>{n.nativeType==="reset"&&(r==null||r.resetFields()),e("click",p)}}},hz=["default","primary","success","warning","info","danger","text",""],dz=["button","submit","reset"],f0=hn({size:td,disabled:Boolean,type:{type:String,values:hz,default:""},icon:{type:ku},nativeType:{type:String,values:dz,default:"button"},loading:Boolean,loadingIcon:{type:ku,default:()=>eR},plain:Boolean,text:Boolean,link:Boolean,bg:Boolean,autofocus:Boolean,round:Boolean,circle:Boolean,color:String,dark:Boolean,autoInsertSpace:{type:Boolean,default:void 0},tag:{type:pt([String,Object]),default:"button"}}),fz={click:n=>n instanceof MouseEvent};function Xn(n,e){pz(n)&&(n="100%");var t=mz(n);return n=e===360?n:Math.min(e,Math.max(0,parseFloat(n))),t&&(n=parseInt(String(n*e),10)/100),Math.abs(n-e)<1e-6?1:(e===360?n=(n<0?n%e+e:n%e)/parseFloat(String(e)):n=n%e/parseFloat(String(e)),n)}function cf(n){return Math.min(1,Math.max(0,n))}function pz(n){return typeof n=="string"&&n.indexOf(".")!==-1&&parseFloat(n)===1}function mz(n){return typeof n=="string"&&n.indexOf("%")!==-1}function VR(n){return n=parseFloat(n),(isNaN(n)||n<0||n>1)&&(n=1),n}function hf(n){return n<=1?"".concat(Number(n)*100,"%"):n}function Xa(n){return n.length===1?"0"+n:String(n)}function gz(n,e,t){return{r:Xn(n,255)*255,g:Xn(e,255)*255,b:Xn(t,255)*255}}function fT(n,e,t){n=Xn(n,255),e=Xn(e,255),t=Xn(t,255);var i=Math.max(n,e,t),r=Math.min(n,e,t),s=0,o=0,a=(i+r)/2;if(i===r)o=0,s=0;else{var l=i-r;switch(o=a>.5?l/(2-i-r):l/(i+r),i){case n:s=(e-t)/l+(e<t?6:0);break;case e:s=(t-n)/l+2;break;case t:s=(n-e)/l+4;break}s/=6}return{h:s,s:o,l:a}}function Jg(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*(6*t):t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function _z(n,e,t){var i,r,s;if(n=Xn(n,360),e=Xn(e,100),t=Xn(t,100),e===0)r=t,s=t,i=t;else{var o=t<.5?t*(1+e):t+e-t*e,a=2*t-o;i=Jg(a,o,n+1/3),r=Jg(a,o,n),s=Jg(a,o,n-1/3)}return{r:i*255,g:r*255,b:s*255}}function pT(n,e,t){n=Xn(n,255),e=Xn(e,255),t=Xn(t,255);var i=Math.max(n,e,t),r=Math.min(n,e,t),s=0,o=i,a=i-r,l=i===0?0:a/i;if(i===r)s=0;else{switch(i){case n:s=(e-t)/a+(e<t?6:0);break;case e:s=(t-n)/a+2;break;case t:s=(n-e)/a+4;break}s/=6}return{h:s,s:l,v:o}}function vz(n,e,t){n=Xn(n,360)*6,e=Xn(e,100),t=Xn(t,100);var i=Math.floor(n),r=n-i,s=t*(1-e),o=t*(1-r*e),a=t*(1-(1-r)*e),l=i%6,u=[t,o,s,s,a,t][l],c=[a,t,t,o,s,s][l],h=[s,s,a,t,t,o][l];return{r:u*255,g:c*255,b:h*255}}function mT(n,e,t,i){var r=[Xa(Math.round(n).toString(16)),Xa(Math.round(e).toString(16)),Xa(Math.round(t).toString(16))];return i&&r[0].startsWith(r[0].charAt(1))&&r[1].startsWith(r[1].charAt(1))&&r[2].startsWith(r[2].charAt(1))?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0):r.join("")}function yz(n,e,t,i,r){var s=[Xa(Math.round(n).toString(16)),Xa(Math.round(e).toString(16)),Xa(Math.round(t).toString(16)),Xa(xz(i))];return r&&s[0].startsWith(s[0].charAt(1))&&s[1].startsWith(s[1].charAt(1))&&s[2].startsWith(s[2].charAt(1))&&s[3].startsWith(s[3].charAt(1))?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}function xz(n){return Math.round(parseFloat(n)*255).toString(16)}function gT(n){return wi(n)/255}function wi(n){return parseInt(n,16)}function bz(n){return{r:n>>16,g:(n&65280)>>8,b:n&255}}var p0={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function Sz(n){var e={r:0,g:0,b:0},t=1,i=null,r=null,s=null,o=!1,a=!1;return typeof n=="string"&&(n=Mz(n)),typeof n=="object"&&(_s(n.r)&&_s(n.g)&&_s(n.b)?(e=gz(n.r,n.g,n.b),o=!0,a=String(n.r).substr(-1)==="%"?"prgb":"rgb"):_s(n.h)&&_s(n.s)&&_s(n.v)?(i=hf(n.s),r=hf(n.v),e=vz(n.h,i,r),o=!0,a="hsv"):_s(n.h)&&_s(n.s)&&_s(n.l)&&(i=hf(n.s),s=hf(n.l),e=_z(n.h,i,s),o=!0,a="hsl"),Object.prototype.hasOwnProperty.call(n,"a")&&(t=n.a)),t=VR(t),{ok:o,format:n.format||a,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:t}}var Ez="[-\\+]?\\d+%?",Tz="[-\\+]?\\d*\\.\\d+%?",Po="(?:".concat(Tz,")|(?:").concat(Ez,")"),Qg="[\\s|\\(]+(".concat(Po,")[,|\\s]+(").concat(Po,")[,|\\s]+(").concat(Po,")\\s*\\)?"),e_="[\\s|\\(]+(".concat(Po,")[,|\\s]+(").concat(Po,")[,|\\s]+(").concat(Po,")[,|\\s]+(").concat(Po,")\\s*\\)?"),vr={CSS_UNIT:new RegExp(Po),rgb:new RegExp("rgb"+Qg),rgba:new RegExp("rgba"+e_),hsl:new RegExp("hsl"+Qg),hsla:new RegExp("hsla"+e_),hsv:new RegExp("hsv"+Qg),hsva:new RegExp("hsva"+e_),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function Mz(n){if(n=n.trim().toLowerCase(),n.length===0)return!1;var e=!1;if(p0[n])n=p0[n],e=!0;else if(n==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var t=vr.rgb.exec(n);return t?{r:t[1],g:t[2],b:t[3]}:(t=vr.rgba.exec(n),t?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=vr.hsl.exec(n),t?{h:t[1],s:t[2],l:t[3]}:(t=vr.hsla.exec(n),t?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=vr.hsv.exec(n),t?{h:t[1],s:t[2],v:t[3]}:(t=vr.hsva.exec(n),t?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=vr.hex8.exec(n),t?{r:wi(t[1]),g:wi(t[2]),b:wi(t[3]),a:gT(t[4]),format:e?"name":"hex8"}:(t=vr.hex6.exec(n),t?{r:wi(t[1]),g:wi(t[2]),b:wi(t[3]),format:e?"name":"hex"}:(t=vr.hex4.exec(n),t?{r:wi(t[1]+t[1]),g:wi(t[2]+t[2]),b:wi(t[3]+t[3]),a:gT(t[4]+t[4]),format:e?"name":"hex8"}:(t=vr.hex3.exec(n),t?{r:wi(t[1]+t[1]),g:wi(t[2]+t[2]),b:wi(t[3]+t[3]),format:e?"name":"hex"}:!1)))))))))}function _s(n){return!!vr.CSS_UNIT.exec(String(n))}var wz=function(){function n(e,t){e===void 0&&(e=""),t===void 0&&(t={});var i;if(e instanceof n)return e;typeof e=="number"&&(e=bz(e)),this.originalInput=e;var r=Sz(e);this.originalInput=e,this.r=r.r,this.g=r.g,this.b=r.b,this.a=r.a,this.roundA=Math.round(100*this.a)/100,this.format=(i=t.format)!==null&&i!==void 0?i:r.format,this.gradientType=t.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=r.ok}return n.prototype.isDark=function(){return this.getBrightness()<128},n.prototype.isLight=function(){return!this.isDark()},n.prototype.getBrightness=function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},n.prototype.getLuminance=function(){var e=this.toRgb(),t,i,r,s=e.r/255,o=e.g/255,a=e.b/255;return s<=.03928?t=s/12.92:t=Math.pow((s+.055)/1.055,2.4),o<=.03928?i=o/12.92:i=Math.pow((o+.055)/1.055,2.4),a<=.03928?r=a/12.92:r=Math.pow((a+.055)/1.055,2.4),.2126*t+.7152*i+.0722*r},n.prototype.getAlpha=function(){return this.a},n.prototype.setAlpha=function(e){return this.a=VR(e),this.roundA=Math.round(100*this.a)/100,this},n.prototype.isMonochrome=function(){var e=this.toHsl().s;return e===0},n.prototype.toHsv=function(){var e=pT(this.r,this.g,this.b);return{h:e.h*360,s:e.s,v:e.v,a:this.a}},n.prototype.toHsvString=function(){var e=pT(this.r,this.g,this.b),t=Math.round(e.h*360),i=Math.round(e.s*100),r=Math.round(e.v*100);return this.a===1?"hsv(".concat(t,", ").concat(i,"%, ").concat(r,"%)"):"hsva(".concat(t,", ").concat(i,"%, ").concat(r,"%, ").concat(this.roundA,")")},n.prototype.toHsl=function(){var e=fT(this.r,this.g,this.b);return{h:e.h*360,s:e.s,l:e.l,a:this.a}},n.prototype.toHslString=function(){var e=fT(this.r,this.g,this.b),t=Math.round(e.h*360),i=Math.round(e.s*100),r=Math.round(e.l*100);return this.a===1?"hsl(".concat(t,", ").concat(i,"%, ").concat(r,"%)"):"hsla(".concat(t,", ").concat(i,"%, ").concat(r,"%, ").concat(this.roundA,")")},n.prototype.toHex=function(e){return e===void 0&&(e=!1),mT(this.r,this.g,this.b,e)},n.prototype.toHexString=function(e){return e===void 0&&(e=!1),"#"+this.toHex(e)},n.prototype.toHex8=function(e){return e===void 0&&(e=!1),yz(this.r,this.g,this.b,this.a,e)},n.prototype.toHex8String=function(e){return e===void 0&&(e=!1),"#"+this.toHex8(e)},n.prototype.toHexShortString=function(e){return e===void 0&&(e=!1),this.a===1?this.toHexString(e):this.toHex8String(e)},n.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},n.prototype.toRgbString=function(){var e=Math.round(this.r),t=Math.round(this.g),i=Math.round(this.b);return this.a===1?"rgb(".concat(e,", ").concat(t,", ").concat(i,")"):"rgba(".concat(e,", ").concat(t,", ").concat(i,", ").concat(this.roundA,")")},n.prototype.toPercentageRgb=function(){var e=function(t){return"".concat(Math.round(Xn(t,255)*100),"%")};return{r:e(this.r),g:e(this.g),b:e(this.b),a:this.a}},n.prototype.toPercentageRgbString=function(){var e=function(t){return Math.round(Xn(t,255)*100)};return this.a===1?"rgb(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%)"):"rgba(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%, ").concat(this.roundA,")")},n.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var e="#"+mT(this.r,this.g,this.b,!1),t=0,i=Object.entries(p0);t<i.length;t++){var r=i[t],s=r[0],o=r[1];if(e===o)return s}return!1},n.prototype.toString=function(e){var t=!!e;e=e??this.format;var i=!1,r=this.a<1&&this.a>=0,s=!t&&r&&(e.startsWith("hex")||e==="name");return s?e==="name"&&this.a===0?this.toName():this.toRgbString():(e==="rgb"&&(i=this.toRgbString()),e==="prgb"&&(i=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(i=this.toHexString()),e==="hex3"&&(i=this.toHexString(!0)),e==="hex4"&&(i=this.toHex8String(!0)),e==="hex8"&&(i=this.toHex8String()),e==="name"&&(i=this.toName()),e==="hsl"&&(i=this.toHslString()),e==="hsv"&&(i=this.toHsvString()),i||this.toHexString())},n.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},n.prototype.clone=function(){return new n(this.toString())},n.prototype.lighten=function(e){e===void 0&&(e=10);var t=this.toHsl();return t.l+=e/100,t.l=cf(t.l),new n(t)},n.prototype.brighten=function(e){e===void 0&&(e=10);var t=this.toRgb();return t.r=Math.max(0,Math.min(255,t.r-Math.round(255*-(e/100)))),t.g=Math.max(0,Math.min(255,t.g-Math.round(255*-(e/100)))),t.b=Math.max(0,Math.min(255,t.b-Math.round(255*-(e/100)))),new n(t)},n.prototype.darken=function(e){e===void 0&&(e=10);var t=this.toHsl();return t.l-=e/100,t.l=cf(t.l),new n(t)},n.prototype.tint=function(e){return e===void 0&&(e=10),this.mix("white",e)},n.prototype.shade=function(e){return e===void 0&&(e=10),this.mix("black",e)},n.prototype.desaturate=function(e){e===void 0&&(e=10);var t=this.toHsl();return t.s-=e/100,t.s=cf(t.s),new n(t)},n.prototype.saturate=function(e){e===void 0&&(e=10);var t=this.toHsl();return t.s+=e/100,t.s=cf(t.s),new n(t)},n.prototype.greyscale=function(){return this.desaturate(100)},n.prototype.spin=function(e){var t=this.toHsl(),i=(t.h+e)%360;return t.h=i<0?360+i:i,new n(t)},n.prototype.mix=function(e,t){t===void 0&&(t=50);var i=this.toRgb(),r=new n(e).toRgb(),s=t/100,o={r:(r.r-i.r)*s+i.r,g:(r.g-i.g)*s+i.g,b:(r.b-i.b)*s+i.b,a:(r.a-i.a)*s+i.a};return new n(o)},n.prototype.analogous=function(e,t){e===void 0&&(e=6),t===void 0&&(t=30);var i=this.toHsl(),r=360/t,s=[this];for(i.h=(i.h-(r*e>>1)+720)%360;--e;)i.h=(i.h+r)%360,s.push(new n(i));return s},n.prototype.complement=function(){var e=this.toHsl();return e.h=(e.h+180)%360,new n(e)},n.prototype.monochromatic=function(e){e===void 0&&(e=6);for(var t=this.toHsv(),i=t.h,r=t.s,s=t.v,o=[],a=1/e;e--;)o.push(new n({h:i,s:r,v:s})),s=(s+a)%1;return o},n.prototype.splitcomplement=function(){var e=this.toHsl(),t=e.h;return[this,new n({h:(t+72)%360,s:e.s,l:e.l}),new n({h:(t+216)%360,s:e.s,l:e.l})]},n.prototype.onBackground=function(e){var t=this.toRgb(),i=new n(e).toRgb(),r=t.a+i.a*(1-t.a);return new n({r:(t.r*t.a+i.r*i.a*(1-t.a))/r,g:(t.g*t.a+i.g*i.a*(1-t.a))/r,b:(t.b*t.a+i.b*i.a*(1-t.a))/r,a:r})},n.prototype.triad=function(){return this.polyad(3)},n.prototype.tetrad=function(){return this.polyad(4)},n.prototype.polyad=function(e){for(var t=this.toHsl(),i=t.h,r=[this],s=360/e,o=1;o<e;o++)r.push(new n({h:(i+o*s)%360,s:t.s,l:t.l}));return r},n.prototype.equals=function(e){return this.toRgbString()===new n(e).toRgbString()},n}();function oo(n,e=20){return n.mix("#141414",e).toString()}function Az(n){const e=Jm(),t=bn("button");return oe(()=>{let i={};const r=n.color;if(r){const s=new wz(r),o=n.dark?s.tint(20).toString():oo(s,20);if(n.plain)i=t.cssVarBlock({"bg-color":n.dark?oo(s,90):s.tint(90).toString(),"text-color":r,"border-color":n.dark?oo(s,50):s.tint(50).toString(),"hover-text-color":`var(${t.cssVarName("color-white")})`,"hover-bg-color":r,"hover-border-color":r,"active-bg-color":o,"active-text-color":`var(${t.cssVarName("color-white")})`,"active-border-color":o}),e.value&&(i[t.cssVarBlockName("disabled-bg-color")]=n.dark?oo(s,90):s.tint(90).toString(),i[t.cssVarBlockName("disabled-text-color")]=n.dark?oo(s,50):s.tint(50).toString(),i[t.cssVarBlockName("disabled-border-color")]=n.dark?oo(s,80):s.tint(80).toString());else{const a=n.dark?oo(s,30):s.tint(30).toString(),l=s.isDark()?`var(${t.cssVarName("color-white")})`:`var(${t.cssVarName("color-black")})`;if(i=t.cssVarBlock({"bg-color":r,"text-color":l,"border-color":r,"hover-bg-color":a,"hover-text-color":l,"hover-border-color":a,"active-bg-color":o,"active-border-color":o}),e.value){const u=n.dark?oo(s,50):s.tint(50).toString();i[t.cssVarBlockName("disabled-bg-color")]=u,i[t.cssVarBlockName("disabled-text-color")]=n.dark?"rgba(255, 255, 255, 0.5)":`var(${t.cssVarName("color-white")})`,i[t.cssVarBlockName("disabled-border-color")]=u}}}return i})}const Pz=dt({name:"ElButton"}),Cz=dt({...Pz,props:f0,emits:fz,setup(n,{expose:e,emit:t}){const i=n,r=Az(i),s=bn("button"),{_ref:o,_size:a,_type:l,_disabled:u,_props:c,shouldAddSpace:h,handleClick:d}=cz(i,t);return e({ref:o,size:a,type:l,disabled:u,shouldAddSpace:h}),(f,p)=>(Te(),vt(wo(f.tag),is({ref_key:"_ref",ref:o},R(c),{class:[R(s).b(),R(s).m(R(l)),R(s).m(R(a)),R(s).is("disabled",R(u)),R(s).is("loading",f.loading),R(s).is("plain",f.plain),R(s).is("round",f.round),R(s).is("circle",f.circle),R(s).is("text",f.text),R(s).is("link",f.link),R(s).is("has-bg",f.bg)],style:R(r),onClick:R(d)}),{default:Mt(()=>[f.loading?(Te(),ke(jt,{key:0},[f.$slots.loading?Qt(f.$slots,"loading",{key:0}):(Te(),vt(R(Yi),{key:1,class:qe(R(s).is("loading"))},{default:Mt(()=>[(Te(),vt(wo(f.loadingIcon)))]),_:1},8,["class"]))],64)):f.icon||f.$slots.icon?(Te(),vt(R(Yi),{key:1},{default:Mt(()=>[f.icon?(Te(),vt(wo(f.icon),{key:0})):Qt(f.$slots,"icon",{key:1})]),_:3})):ut("v-if",!0),f.$slots.default?(Te(),ke("span",{key:2,class:qe({[R(s).em("text","expand")]:R(h)})},[Qt(f.$slots,"default")],2)):ut("v-if",!0)]),_:3},16,["class","style","onClick"]))}});var Rz=Bn(Cz,[["__file","/home/runner/work/element-plus/element-plus/packages/components/button/src/button.vue"]]);const Iz={size:f0.size,type:f0.type},Lz=dt({name:"ElButtonGroup"}),Oz=dt({...Lz,props:Iz,setup(n){const e=n;Ii(kR,Zs({size:Ns(e,"size"),type:Ns(e,"type")}));const t=bn("button");return(i,r)=>(Te(),ke("div",{class:qe(`${R(t).b("group")}`)},[Qt(i.$slots,"default")],2))}});var GR=Bn(Oz,[["__file","/home/runner/work/element-plus/element-plus/packages/components/button/src/button-group.vue"]]);const Dz=Qs(Rz,{ButtonGroup:GR});aV(GR);var t_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function jx(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Fz(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(i){var r=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:function(){return n[i]}})}),t}const Nz=100,Uz=600,_T={beforeMount(n,e){const t=e.value,{interval:i=Nz,delay:r=Uz}=je(t)?{}:t;let s,o;const a=()=>je(t)?t():t.handler(),l=()=>{o&&(clearTimeout(o),o=void 0),s&&(clearInterval(s),s=void 0)};n.addEventListener("mousedown",u=>{u.button===0&&(l(),a(),document.addEventListener("mouseup",()=>l(),{once:!0}),o=setTimeout(()=>{s=setInterval(()=>{a()},i)},r))})}},Bz=hn({mask:{type:Boolean,default:!0},customMaskEvent:{type:Boolean,default:!1},overlayClass:{type:pt([String,Array,Object])},zIndex:{type:pt([String,Number])}}),kz={click:n=>n instanceof MouseEvent},Vz="overlay";var Gz=dt({name:"ElOverlay",props:Bz,emits:kz,setup(n,{slots:e,emit:t}){const i=bn(Vz),r=l=>{t("click",l)},{onClick:s,onMousedown:o,onMouseup:a}=MG(n.customMaskEvent?void 0:r);return()=>n.mask?lt("div",{class:[i.b(),n.overlayClass],style:{zIndex:n.zIndex},onClick:s,onMousedown:o,onMouseup:a},[Qt(e,"default")],Tp.STYLE|Tp.CLASS|Tp.PROPS,["onClick","onMouseup","onMousedown"]):Rd("div",{class:n.overlayClass,style:{zIndex:n.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[Qt(e,"default")])}});const Hz=Gz,zz=hn({center:{type:Boolean,default:!1},alignCenter:{type:Boolean,default:!1},closeIcon:{type:ku},customClass:{type:String,default:""},draggable:{type:Boolean,default:!1},fullscreen:{type:Boolean,default:!1},showClose:{type:Boolean,default:!0},title:{type:String,default:""}}),Wz=hn({...zz,appendToBody:{type:Boolean,default:!1},beforeClose:{type:pt(Function)},destroyOnClose:{type:Boolean,default:!1},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:{type:Boolean,default:!1},modalClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:{type:Boolean,default:!1}}),Xz={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[oi]:n=>Px(n),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},jz=(n,e)=>{const i=Fr().emit,{nextZIndex:r}=Vx();let s="";const o=Kp(),a=Kp(),l=Fe(!1),u=Fe(!1),c=Fe(!1),h=Fe(n.zIndex||r());let d,f;const p=Km("namespace",Yp),_=oe(()=>{const D={},B=`--${p.value}-dialog`;return n.fullscreen||(n.top&&(D[`${B}-margin-top`]=n.top),n.width&&(D[`${B}-width`]=Rx(n.width))),D}),m=oe(()=>n.alignCenter?{display:"flex"}:{});function g(){i("opened")}function v(){i("closed"),i(oi,!1),n.destroyOnClose&&(c.value=!1)}function y(){i("close")}function x(){f==null||f(),d==null||d(),n.openDelay&&n.openDelay>0?{stop:d}=c0(()=>P(),n.openDelay):P()}function b(){d==null||d(),f==null||f(),n.closeDelay&&n.closeDelay>0?{stop:f}=c0(()=>E(),n.closeDelay):E()}function S(){function D(B){B||(u.value=!0,l.value=!1)}n.beforeClose?n.beforeClose(D):b()}function T(){n.closeOnClickModal&&S()}function P(){Un&&(l.value=!0)}function E(){l.value=!1}function M(){i("openAutoFocus")}function O(){i("closeAutoFocus")}function L(D){var B;((B=D.detail)==null?void 0:B.focusReason)==="pointer"&&D.preventDefault()}n.lockScroll&&vV(l);function C(){n.closeOnPressEscape&&S()}return et(()=>n.modelValue,D=>{D?(u.value=!1,x(),c.value=!0,h.value=n.zIndex?h.value++:r(),Kn(()=>{i("open"),e.value&&(e.value.scrollTop=0)})):l.value&&b()}),et(()=>n.fullscreen,D=>{e.value&&(D?(s=e.value.style.transform,e.value.style.transform=""):e.value.style.transform=s)}),Sn(()=>{n.modelValue&&(l.value=!0,c.value=!0,x())}),{afterEnter:g,afterLeave:v,beforeLeave:y,handleClose:S,onModalClick:T,close:b,doClose:E,onOpenAutoFocus:M,onCloseAutoFocus:O,onCloseRequested:C,onFocusoutPrevented:L,titleId:o,bodyId:a,closed:u,style:_,overlayDialogStyle:m,rendered:c,visible:l,zIndex:h}},$z=hn({...Wz,direction:{type:String,default:"rtl",values:["ltr","rtl","ttb","btt"]},size:{type:[String,Number],default:"30%"},withHeader:{type:Boolean,default:!0},modalFade:{type:Boolean,default:!0}}),Yz=Xz,qz=dt({name:"ElDrawer",components:{ElOverlay:Hz,ElFocusTrap:DR,ElIcon:Yi,Close:JC},inheritAttrs:!1,props:$z,emits:Yz,setup(n,{slots:e}){h0({scope:"el-drawer",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/drawer.html#slots"},oe(()=>!!e.title)),h0({scope:"el-drawer",from:"custom-class",replacement:"class",version:"2.3.0",ref:"https://element-plus.org/en-US/component/drawer.html#attributes",type:"Attribute"},oe(()=>!!n.customClass));const t=Fe(),i=Fe(),r=bn("drawer"),{t:s}=Ym(),o=oe(()=>n.direction==="rtl"||n.direction==="ltr"),a=oe(()=>Rx(n.size));return{...jz(n,t),drawerRef:t,focusStartRef:i,isHorizontal:o,drawerSize:a,ns:r,t:s}}}),Kz=["aria-label","aria-labelledby","aria-describedby"],Zz=["id"],Jz=["aria-label"],Qz=["id"];function e5(n,e,t,i,r,s){const o=ch("close"),a=ch("el-icon"),l=ch("el-focus-trap"),u=ch("el-overlay");return Te(),vt(nC,{to:"body",disabled:!n.appendToBody},[lt(_c,{name:n.ns.b("fade"),onAfterEnter:n.afterEnter,onAfterLeave:n.afterLeave,onBeforeLeave:n.beforeLeave,persisted:""},{default:Mt(()=>[Go(lt(u,{mask:n.modal,"overlay-class":n.modalClass,"z-index":n.zIndex,onClick:n.onModalClick},{default:Mt(()=>[lt(l,{loop:"",trapped:n.visible,"focus-trap-el":n.drawerRef,"focus-start-el":n.focusStartRef,onReleaseRequested:n.onCloseRequested},{default:Mt(()=>[ze("div",is({ref:"drawerRef","aria-modal":"true","aria-label":n.title||void 0,"aria-labelledby":n.title?void 0:n.titleId,"aria-describedby":n.bodyId},n.$attrs,{class:[n.ns.b(),n.direction,n.visible&&"open",n.customClass],style:n.isHorizontal?"width: "+n.drawerSize:"height: "+n.drawerSize,role:"dialog",onClick:e[1]||(e[1]=Wa(()=>{},["stop"]))}),[ze("span",{ref:"focusStartRef",class:qe(n.ns.e("sr-focus")),tabindex:"-1"},null,2),n.withHeader?(Te(),ke("header",{key:0,class:qe(n.ns.e("header"))},[n.$slots.title?Qt(n.$slots,"title",{key:1},()=>[ut(" DEPRECATED SLOT ")]):Qt(n.$slots,"header",{key:0,close:n.handleClose,titleId:n.titleId,titleClass:n.ns.e("title")},()=>[n.$slots.title?ut("v-if",!0):(Te(),ke("span",{key:0,id:n.titleId,role:"heading",class:qe(n.ns.e("title"))},Fs(n.title),11,Zz))]),n.showClose?(Te(),ke("button",{key:2,"aria-label":n.t("el.drawer.close"),class:qe(n.ns.e("close-btn")),type:"button",onClick:e[0]||(e[0]=(...c)=>n.handleClose&&n.handleClose(...c))},[lt(a,{class:qe(n.ns.e("close"))},{default:Mt(()=>[lt(o)]),_:1},8,["class"])],10,Jz)):ut("v-if",!0)],2)):ut("v-if",!0),n.rendered?(Te(),ke("div",{key:1,id:n.bodyId,class:qe(n.ns.e("body"))},[Qt(n.$slots,"default")],10,Qz)):ut("v-if",!0),n.$slots.footer?(Te(),ke("div",{key:2,class:qe(n.ns.e("footer"))},[Qt(n.$slots,"footer")],2)):ut("v-if",!0)],16,Kz)]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])]),_:3},8,["mask","overlay-class","z-index","onClick"]),[[Id,n.visible]])]),_:3},8,["name","onAfterEnter","onAfterLeave","onBeforeLeave"])],8,["disabled"])}var t5=Bn(qz,[["render",e5],["__file","/home/runner/work/element-plus/element-plus/packages/components/drawer/src/drawer.vue"]]);const HR=Qs(t5),n5=hn({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.POSITIVE_INFINITY},min:{type:Number,default:Number.NEGATIVE_INFINITY},modelValue:Number,readonly:Boolean,disabled:Boolean,size:td,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:n=>n===null||pn(n)||["min","max"].includes(n),default:null},name:String,label:String,placeholder:String,precision:{type:Number,validator:n=>n>=0&&n===Number.parseInt(`${n}`,10)},validateEvent:{type:Boolean,default:!0}}),i5={[$m]:(n,e)=>e!==n,blur:n=>n instanceof FocusEvent,focus:n=>n instanceof FocusEvent,[Qa]:n=>pn(n)||Ws(n),[oi]:n=>pn(n)||Ws(n)},r5=["aria-label","onKeydown"],s5=["aria-label","onKeydown"],o5=dt({name:"ElInputNumber"}),a5=dt({...o5,props:n5,emits:i5,setup(n,{expose:e,emit:t}){const i=n,{t:r}=Ym(),s=bn("input-number"),o=Fe(),a=Zs({currentValue:i.modelValue,userInput:null}),{formItem:l}=Qm(),u=oe(()=>pn(i.modelValue)&&i.modelValue<=i.min),c=oe(()=>pn(i.modelValue)&&i.modelValue>=i.max),h=oe(()=>{const C=g(i.step);return fh(i.precision)?Math.max(g(i.modelValue),C):(C>i.precision,i.precision)}),d=oe(()=>i.controls&&i.controlsPosition==="right"),f=Zm(),p=Jm(),_=oe(()=>{if(a.userInput!==null)return a.userInput;let C=a.currentValue;if(Ws(C))return"";if(pn(C)){if(Number.isNaN(C))return"";fh(i.precision)||(C=C.toFixed(i.precision))}return C}),m=(C,D)=>{if(fh(D)&&(D=h.value),D===0)return Math.round(C);let B=String(C);const W=B.indexOf(".");if(W===-1||!B.replace(".","").split("")[W+D])return C;const J=B.length;return B.charAt(J-1)==="5"&&(B=`${B.slice(0,Math.max(0,J-1))}6`),Number.parseFloat(Number(B).toFixed(D))},g=C=>{if(Ws(C))return 0;const D=C.toString(),B=D.indexOf(".");let W=0;return B!==-1&&(W=D.length-B-1),W},v=(C,D=1)=>pn(C)?m(C+i.step*D):a.currentValue,y=()=>{if(i.readonly||p.value||c.value)return;const C=Number(_.value)||0,D=v(C);S(D),t(Qa,a.currentValue)},x=()=>{if(i.readonly||p.value||u.value)return;const C=Number(_.value)||0,D=v(C,-1);S(D),t(Qa,a.currentValue)},b=(C,D)=>{const{max:B,min:W,step:U,precision:$,stepStrictly:J,valueOnClear:j}=i;B<W&&Cx("InputNumber","min should not be greater than max.");let F=Number(C);if(Ws(C)||Number.isNaN(F))return null;if(C===""){if(j===null)return null;F=At(j)?{min:W,max:B}[j]:j}return J&&(F=m(Math.round(F/U)*U,$)),fh($)||(F=m(F,$)),(F>B||F<W)&&(F=F>B?B:W,D&&t(oi,F)),F},S=(C,D=!0)=>{var B;const W=a.currentValue,U=b(C);if(!D){t(oi,U);return}W!==U&&(a.userInput=null,t(oi,U),t($m,U,W),i.validateEvent&&((B=l==null?void 0:l.validate)==null||B.call(l,"change").catch($=>void 0)),a.currentValue=U)},T=C=>{a.userInput=C;const D=C===""?null:Number(C);t(Qa,D),S(D,!1)},P=C=>{const D=C!==""?Number(C):"";(pn(D)&&!Number.isNaN(D)||C==="")&&S(D),a.userInput=null},E=()=>{var C,D;(D=(C=o.value)==null?void 0:C.focus)==null||D.call(C)},M=()=>{var C,D;(D=(C=o.value)==null?void 0:C.blur)==null||D.call(C)},O=C=>{t("focus",C)},L=C=>{var D;t("blur",C),i.validateEvent&&((D=l==null?void 0:l.validate)==null||D.call(l,"blur").catch(B=>void 0))};return et(()=>i.modelValue,C=>{const D=b(a.userInput),B=b(C,!0);!pn(D)&&(!D||D!==B)&&(a.currentValue=B,a.userInput=null)},{immediate:!0}),Sn(()=>{var C;const{min:D,max:B,modelValue:W}=i,U=(C=o.value)==null?void 0:C.input;if(U.setAttribute("role","spinbutton"),Number.isFinite(B)?U.setAttribute("aria-valuemax",String(B)):U.removeAttribute("aria-valuemax"),Number.isFinite(D)?U.setAttribute("aria-valuemin",String(D)):U.removeAttribute("aria-valuemin"),U.setAttribute("aria-valuenow",String(a.currentValue)),U.setAttribute("aria-disabled",String(p.value)),!pn(W)&&W!=null){let $=Number(W);Number.isNaN($)&&($=null),t(oi,$)}}),zP(()=>{var C;const D=(C=o.value)==null?void 0:C.input;D==null||D.setAttribute("aria-valuenow",`${a.currentValue}`)}),e({focus:E,blur:M}),(C,D)=>(Te(),ke("div",{class:qe([R(s).b(),R(s).m(R(f)),R(s).is("disabled",R(p)),R(s).is("without-controls",!C.controls),R(s).is("controls-right",R(d))]),onDragstart:D[1]||(D[1]=Wa(()=>{},["prevent"]))},[C.controls?Go((Te(),ke("span",{key:0,role:"button","aria-label":R(r)("el.inputNumber.decrease"),class:qe([R(s).e("decrease"),R(s).is("disabled",R(u))]),onKeydown:rf(x,["enter"])},[lt(R(Yi),null,{default:Mt(()=>[R(d)?(Te(),vt(R(Nk),{key:0})):(Te(),vt(R(D4),{key:1}))]),_:1})],42,r5)),[[R(_T),x]]):ut("v-if",!0),C.controls?Go((Te(),ke("span",{key:1,role:"button","aria-label":R(r)("el.inputNumber.increase"),class:qe([R(s).e("increase"),R(s).is("disabled",R(c))]),onKeydown:rf(y,["enter"])},[lt(R(Yi),null,{default:Mt(()=>[R(d)?(Te(),vt(R(Hk),{key:0})):(Te(),vt(R(V4),{key:1}))]),_:1})],42,s5)),[[R(_T),y]]):ut("v-if",!0),lt(R(tH),{id:C.id,ref_key:"input",ref:o,type:"number",step:C.step,"model-value":R(_),placeholder:C.placeholder,readonly:C.readonly,disabled:R(p),size:R(f),max:C.max,min:C.min,name:C.name,label:C.label,"validate-event":!1,onWheel:D[0]||(D[0]=Wa(()=>{},["prevent"])),onKeydown:[rf(Wa(y,["prevent"]),["up"]),rf(Wa(x,["prevent"]),["down"])],onBlur:L,onFocus:O,onInput:T,onChange:P},null,8,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","label","onKeydown"])],34))}});var l5=Bn(a5,[["__file","/home/runner/work/element-plus/element-plus/packages/components/input-number/src/input-number.vue"]]);const u5=Qs(l5),zR=Symbol("sliderContextKey"),c5=hn({modelValue:{type:pt([Number,Array]),default:0},id:{type:String,default:void 0},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},showInput:Boolean,showInputControls:{type:Boolean,default:!0},size:td,inputSize:td,showStops:Boolean,showTooltip:{type:Boolean,default:!0},formatTooltip:{type:pt(Function),default:void 0},disabled:Boolean,range:Boolean,vertical:Boolean,height:String,debounce:{type:Number,default:300},label:{type:String,default:void 0},rangeStartLabel:{type:String,default:void 0},rangeEndLabel:{type:String,default:void 0},formatValueText:{type:pt(Function),default:void 0},tooltipClass:{type:String,default:void 0},placement:{type:String,values:Fd,default:"top"},marks:{type:pt(Object)},validateEvent:{type:Boolean,default:!0}}),n_=n=>pn(n)||$e(n)&&n.every(pn),h5={[oi]:n_,[Qa]:n_,[$m]:n_},d5=(n,e,t)=>{const i=Fe();return Sn(async()=>{n.range?(Array.isArray(n.modelValue)?(e.firstValue=Math.max(n.min,n.modelValue[0]),e.secondValue=Math.min(n.max,n.modelValue[1])):(e.firstValue=n.min,e.secondValue=n.max),e.oldValue=[e.firstValue,e.secondValue]):(typeof n.modelValue!="number"||Number.isNaN(n.modelValue)?e.firstValue=n.min:e.firstValue=Math.min(n.max,Math.max(n.min,n.modelValue)),e.oldValue=e.firstValue),Mu(window,"resize",t),await Kn(),t()}),{sliderWrapper:i}},f5=n=>oe(()=>n.marks?Object.keys(n.marks).map(Number.parseFloat).sort((t,i)=>t-i).filter(t=>t<=n.max&&t>=n.min).map(t=>({point:t,position:(t-n.min)*100/(n.max-n.min),mark:n.marks[t]})):[]),p5=(n,e,t)=>{const{form:i,formItem:r}=Qm(),s=Za(),o=Fe(),a=Fe(),l={firstButton:o,secondButton:a},u=oe(()=>n.disabled||(i==null?void 0:i.disabled)||!1),c=oe(()=>Math.min(e.firstValue,e.secondValue)),h=oe(()=>Math.max(e.firstValue,e.secondValue)),d=oe(()=>n.range?`${100*(h.value-c.value)/(n.max-n.min)}%`:`${100*(e.firstValue-n.min)/(n.max-n.min)}%`),f=oe(()=>n.range?`${100*(c.value-n.min)/(n.max-n.min)}%`:"0%"),p=oe(()=>n.vertical?{height:n.height}:{}),_=oe(()=>n.vertical?{height:d.value,bottom:f.value}:{width:d.value,left:f.value}),m=()=>{s.value&&(e.sliderSize=s.value[`client${n.vertical?"Height":"Width"}`])},g=O=>{const L=n.min+O*(n.max-n.min)/100;if(!n.range)return o;let C;return Math.abs(c.value-L)<Math.abs(h.value-L)?C=e.firstValue<e.secondValue?"firstButton":"secondButton":C=e.firstValue>e.secondValue?"firstButton":"secondButton",l[C]},v=O=>{const L=g(O);return L.value.setPosition(O),L},y=O=>{e.firstValue=O,b(n.range?[c.value,h.value]:O)},x=O=>{e.secondValue=O,n.range&&b([c.value,h.value])},b=O=>{t(oi,O),t(Qa,O)},S=async()=>{await Kn(),t($m,n.range?[c.value,h.value]:n.modelValue)},T=O=>{var L,C,D,B,W,U;if(u.value||e.dragging)return;m();let $=0;if(n.vertical){const J=(D=(C=(L=O.touches)==null?void 0:L.item(0))==null?void 0:C.clientY)!=null?D:O.clientY;$=(s.value.getBoundingClientRect().bottom-J)/e.sliderSize*100}else{const J=(U=(W=(B=O.touches)==null?void 0:B.item(0))==null?void 0:W.clientX)!=null?U:O.clientX,j=s.value.getBoundingClientRect().left;$=(J-j)/e.sliderSize*100}if(!($<0||$>100))return v($)};return{elFormItem:r,slider:s,firstButton:o,secondButton:a,sliderDisabled:u,minValue:c,maxValue:h,runwayStyle:p,barStyle:_,resetSize:m,setPosition:v,emitChange:S,onSliderWrapperPrevent:O=>{var L,C;((L=l.firstButton.value)!=null&&L.dragging||(C=l.secondButton.value)!=null&&C.dragging)&&O.preventDefault()},onSliderClick:O=>{T(O)&&S()},onSliderDown:async O=>{const L=T(O);L&&(await Kn(),L.value.onButtonDown(O))},setFirstValue:y,setSecondValue:x}},{left:m5,down:g5,right:_5,up:v5,home:y5,end:x5,pageUp:b5,pageDown:S5}=Vu,E5=(n,e,t)=>{const i=Fe(),r=Fe(!1),s=oe(()=>e.value instanceof Function),o=oe(()=>s.value&&e.value(n.modelValue)||n.modelValue),a=kE(()=>{t.value&&(r.value=!0)},50),l=kE(()=>{t.value&&(r.value=!1)},50);return{tooltip:i,tooltipVisible:r,formatValue:o,displayTooltip:a,hideTooltip:l}},T5=(n,e,t)=>{const{disabled:i,min:r,max:s,step:o,showTooltip:a,precision:l,sliderSize:u,formatTooltip:c,emitChange:h,resetSize:d,updateDragging:f}=Lt(zR),{tooltip:p,tooltipVisible:_,formatValue:m,displayTooltip:g,hideTooltip:v}=E5(n,c,a),y=Fe(),x=oe(()=>`${(n.modelValue-r.value)/(s.value-r.value)*100}%`),b=oe(()=>n.vertical?{bottom:x.value}:{left:x.value}),S=()=>{e.hovering=!0,g()},T=()=>{e.hovering=!1,e.dragging||v()},P=X=>{i.value||(X.preventDefault(),$(X),window.addEventListener("mousemove",J),window.addEventListener("touchmove",J),window.addEventListener("mouseup",j),window.addEventListener("touchend",j),window.addEventListener("contextmenu",j),y.value.focus())},E=X=>{i.value||(e.newPosition=Number.parseFloat(x.value)+X/(s.value-r.value)*100,F(e.newPosition),h())},M=()=>{E(-o.value)},O=()=>{E(o.value)},L=()=>{E(-o.value*4)},C=()=>{E(o.value*4)},D=()=>{i.value||(F(0),h())},B=()=>{i.value||(F(100),h())},W=X=>{let re=!0;[m5,g5].includes(X.key)?M():[_5,v5].includes(X.key)?O():X.key===y5?D():X.key===x5?B():X.key===S5?L():X.key===b5?C():re=!1,re&&X.preventDefault()},U=X=>{let re,ce;return X.type.startsWith("touch")?(ce=X.touches[0].clientY,re=X.touches[0].clientX):(ce=X.clientY,re=X.clientX),{clientX:re,clientY:ce}},$=X=>{e.dragging=!0,e.isClick=!0;const{clientX:re,clientY:ce}=U(X);n.vertical?e.startY=ce:e.startX=re,e.startPosition=Number.parseFloat(x.value),e.newPosition=e.startPosition},J=X=>{if(e.dragging){e.isClick=!1,g(),d();let re;const{clientX:ce,clientY:ve}=U(X);n.vertical?(e.currentY=ve,re=(e.startY-e.currentY)/u.value*100):(e.currentX=ce,re=(e.currentX-e.startX)/u.value*100),e.newPosition=e.startPosition+re,F(e.newPosition)}},j=()=>{e.dragging&&(setTimeout(()=>{e.dragging=!1,e.hovering||v(),e.isClick||F(e.newPosition),h()},0),window.removeEventListener("mousemove",J),window.removeEventListener("touchmove",J),window.removeEventListener("mouseup",j),window.removeEventListener("touchend",j),window.removeEventListener("contextmenu",j))},F=async X=>{if(X===null||Number.isNaN(+X))return;X<0?X=0:X>100&&(X=100);const re=100/((s.value-r.value)/o.value);let ve=Math.round(X/re)*re*(s.value-r.value)*.01+r.value;ve=Number.parseFloat(ve.toFixed(l.value)),ve!==n.modelValue&&t(oi,ve),!e.dragging&&n.modelValue!==e.oldValue&&(e.oldValue=n.modelValue),await Kn(),e.dragging&&g(),p.value.updatePopper()};return et(()=>e.dragging,X=>{f(X)}),{disabled:i,button:y,tooltip:p,tooltipVisible:_,showTooltip:a,wrapperStyle:b,formatValue:m,handleMouseEnter:S,handleMouseLeave:T,onButtonDown:P,onKeyDown:W,setPosition:F}},M5=(n,e,t,i)=>({stops:oe(()=>{if(!n.showStops||n.min>n.max)return[];if(n.step===0)return[];const o=(n.max-n.min)/n.step,a=100*n.step/(n.max-n.min),l=Array.from({length:o-1}).map((u,c)=>(c+1)*a);return n.range?l.filter(u=>u<100*(t.value-n.min)/(n.max-n.min)||u>100*(i.value-n.min)/(n.max-n.min)):l.filter(u=>u>100*(e.firstValue-n.min)/(n.max-n.min))}),getStopStyle:o=>n.vertical?{bottom:`${o}%`}:{left:`${o}%`}}),w5=(n,e,t,i,r,s)=>{const o=u=>{r(oi,u),r(Qa,u)},a=()=>n.range?![t.value,i.value].every((u,c)=>u===e.oldValue[c]):n.modelValue!==e.oldValue,l=()=>{var u,c;n.min>n.max&&Cx("Slider","min should not be greater than max.");const h=n.modelValue;n.range&&Array.isArray(h)?h[1]<n.min?o([n.min,n.min]):h[0]>n.max?o([n.max,n.max]):h[0]<n.min?o([n.min,h[1]]):h[1]>n.max?o([h[0],n.max]):(e.firstValue=h[0],e.secondValue=h[1],a()&&(n.validateEvent&&((u=s==null?void 0:s.validate)==null||u.call(s,"change").catch(d=>void 0)),e.oldValue=h.slice())):!n.range&&typeof h=="number"&&!Number.isNaN(h)&&(h<n.min?o(n.min):h>n.max?o(n.max):(e.firstValue=h,a()&&(n.validateEvent&&((c=s==null?void 0:s.validate)==null||c.call(s,"change").catch(d=>void 0)),e.oldValue=h)))};l(),et(()=>e.dragging,u=>{u||l()}),et(()=>n.modelValue,(u,c)=>{e.dragging||Array.isArray(u)&&Array.isArray(c)&&u.every((h,d)=>h===c[d])&&e.firstValue===u[0]&&e.secondValue===u[1]||l()},{deep:!0}),et(()=>[n.min,n.max],()=>{l()})},A5=hn({modelValue:{type:Number,default:0},vertical:Boolean,tooltipClass:String,placement:{type:String,values:Fd,default:"top"}}),P5={[oi]:n=>pn(n)},C5=["tabindex"],R5=dt({name:"ElSliderButton"}),I5=dt({...R5,props:A5,emits:P5,setup(n,{expose:e,emit:t}){const i=n,r=bn("slider"),s=Zs({hovering:!1,dragging:!1,isClick:!1,startX:0,currentX:0,startY:0,currentY:0,startPosition:0,newPosition:0,oldValue:i.modelValue}),{disabled:o,button:a,tooltip:l,showTooltip:u,tooltipVisible:c,wrapperStyle:h,formatValue:d,handleMouseEnter:f,handleMouseLeave:p,onButtonDown:_,onKeyDown:m,setPosition:g}=T5(i,s,t),{hovering:v,dragging:y}=$v(s);return e({onButtonDown:_,onKeyDown:m,setPosition:g,hovering:v,dragging:y}),(x,b)=>(Te(),ke("div",{ref_key:"button",ref:a,class:qe([R(r).e("button-wrapper"),{hover:R(v),dragging:R(y)}]),style:$i(R(h)),tabindex:R(o)?-1:0,onMouseenter:b[0]||(b[0]=(...S)=>R(f)&&R(f)(...S)),onMouseleave:b[1]||(b[1]=(...S)=>R(p)&&R(p)(...S)),onMousedown:b[2]||(b[2]=(...S)=>R(_)&&R(_)(...S)),onTouchstart:b[3]||(b[3]=(...S)=>R(_)&&R(_)(...S)),onFocus:b[4]||(b[4]=(...S)=>R(f)&&R(f)(...S)),onBlur:b[5]||(b[5]=(...S)=>R(p)&&R(p)(...S)),onKeydown:b[6]||(b[6]=(...S)=>R(m)&&R(m)(...S))},[lt(R(BR),{ref_key:"tooltip",ref:l,visible:R(c),placement:x.placement,"fallback-placements":["top","bottom","right","left"],"stop-popper-mouse-event":!1,"popper-class":x.tooltipClass,disabled:!R(u),persistent:""},{content:Mt(()=>[ze("span",null,Fs(R(d)),1)]),default:Mt(()=>[ze("div",{class:qe([R(r).e("button"),{hover:R(v),dragging:R(y)}])},null,2)]),_:1},8,["visible","placement","popper-class","disabled"])],46,C5))}});var vT=Bn(I5,[["__file","/home/runner/work/element-plus/element-plus/packages/components/slider/src/button.vue"]]);const L5=hn({mark:{type:pt([String,Object]),default:void 0}});var O5=dt({name:"ElSliderMarker",props:L5,setup(n){const e=bn("slider"),t=oe(()=>At(n.mark)?n.mark:n.mark.label),i=oe(()=>At(n.mark)?void 0:n.mark.style);return()=>Rd("div",{class:e.e("marks-text"),style:i.value},t.value)}});const D5=["id","role","aria-label","aria-labelledby"],F5={key:1},N5=dt({name:"ElSlider"}),U5=dt({...N5,props:c5,emits:h5,setup(n,{expose:e,emit:t}){const i=n,r=bn("slider"),{t:s}=Ym(),o=Zs({firstValue:0,secondValue:0,oldValue:0,dragging:!1,sliderSize:1}),{elFormItem:a,slider:l,firstButton:u,secondButton:c,sliderDisabled:h,minValue:d,maxValue:f,runwayStyle:p,barStyle:_,resetSize:m,emitChange:g,onSliderWrapperPrevent:v,onSliderClick:y,onSliderDown:x,setFirstValue:b,setSecondValue:S}=p5(i,o,t),{stops:T,getStopStyle:P}=M5(i,o,d,f),{inputId:E,isLabeledByFormItem:M}=AR(i,{formItemContext:a}),O=Zm(),L=oe(()=>i.inputSize||O.value),C=oe(()=>i.label||s("el.slider.defaultLabel",{min:i.min,max:i.max})),D=oe(()=>i.range?i.rangeStartLabel||s("el.slider.defaultRangeStartLabel"):C.value),B=oe(()=>i.formatValueText?i.formatValueText(X.value):`${X.value}`),W=oe(()=>i.rangeEndLabel||s("el.slider.defaultRangeEndLabel")),U=oe(()=>i.formatValueText?i.formatValueText(re.value):`${re.value}`),$=oe(()=>[r.b(),r.m(O.value),r.is("vertical",i.vertical),{[r.m("with-input")]:i.showInput}]),J=f5(i);w5(i,o,d,f,t,a);const j=oe(()=>{const ae=[i.min,i.max,i.step].map(Y=>{const ne=`${Y}`.split(".")[1];return ne?ne.length:0});return Math.max.apply(null,ae)}),{sliderWrapper:F}=d5(i,o,m),{firstValue:X,secondValue:re,sliderSize:ce}=$v(o),ve=ae=>{o.dragging=ae};return Ii(zR,{...$v(i),sliderSize:ce,disabled:h,precision:j,emitChange:g,resetSize:m,updateDragging:ve}),e({onSliderClick:y}),(ae,Y)=>{var ne,he;return Te(),ke("div",{id:ae.range?R(E):void 0,ref_key:"sliderWrapper",ref:F,class:qe(R($)),role:ae.range?"group":void 0,"aria-label":ae.range&&!R(M)?R(C):void 0,"aria-labelledby":ae.range&&R(M)?(ne=R(a))==null?void 0:ne.labelId:void 0,onTouchstart:Y[2]||(Y[2]=(...xe)=>R(v)&&R(v)(...xe)),onTouchmove:Y[3]||(Y[3]=(...xe)=>R(v)&&R(v)(...xe))},[ze("div",{ref_key:"slider",ref:l,class:qe([R(r).e("runway"),{"show-input":ae.showInput&&!ae.range},R(r).is("disabled",R(h))]),style:$i(R(p)),onMousedown:Y[0]||(Y[0]=(...xe)=>R(x)&&R(x)(...xe)),onTouchstart:Y[1]||(Y[1]=(...xe)=>R(x)&&R(x)(...xe))},[ze("div",{class:qe(R(r).e("bar")),style:$i(R(_))},null,6),lt(vT,{id:ae.range?void 0:R(E),ref_key:"firstButton",ref:u,"model-value":R(X),vertical:ae.vertical,"tooltip-class":ae.tooltipClass,placement:ae.placement,role:"slider","aria-label":ae.range||!R(M)?R(D):void 0,"aria-labelledby":!ae.range&&R(M)?(he=R(a))==null?void 0:he.labelId:void 0,"aria-valuemin":ae.min,"aria-valuemax":ae.range?R(re):ae.max,"aria-valuenow":R(X),"aria-valuetext":R(B),"aria-orientation":ae.vertical?"vertical":"horizontal","aria-disabled":R(h),"onUpdate:modelValue":R(b)},null,8,["id","model-value","vertical","tooltip-class","placement","aria-label","aria-labelledby","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"]),ae.range?(Te(),vt(vT,{key:0,ref_key:"secondButton",ref:c,"model-value":R(re),vertical:ae.vertical,"tooltip-class":ae.tooltipClass,placement:ae.placement,role:"slider","aria-label":R(W),"aria-valuemin":R(X),"aria-valuemax":ae.max,"aria-valuenow":R(re),"aria-valuetext":R(U),"aria-orientation":ae.vertical?"vertical":"horizontal","aria-disabled":R(h),"onUpdate:modelValue":R(S)},null,8,["model-value","vertical","tooltip-class","placement","aria-label","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"])):ut("v-if",!0),ae.showStops?(Te(),ke("div",F5,[(Te(!0),ke(jt,null,Ng(R(T),(xe,be)=>(Te(),ke("div",{key:be,class:qe(R(r).e("stop")),style:$i(R(P)(xe))},null,6))),128))])):ut("v-if",!0),R(J).length>0?(Te(),ke(jt,{key:2},[ze("div",null,[(Te(!0),ke(jt,null,Ng(R(J),(xe,be)=>(Te(),ke("div",{key:be,style:$i(R(P)(xe.position)),class:qe([R(r).e("stop"),R(r).e("marks-stop")])},null,6))),128))]),ze("div",{class:qe(R(r).e("marks"))},[(Te(!0),ke(jt,null,Ng(R(J),(xe,be)=>(Te(),vt(R(O5),{key:be,mark:xe.mark,style:$i(R(P)(xe.position))},null,8,["mark","style"]))),128))],2)],64)):ut("v-if",!0)],38),ae.showInput&&!ae.range?(Te(),vt(R(u5),{key:0,ref:"input","model-value":R(X),class:qe(R(r).e("input")),step:ae.step,disabled:R(h),controls:ae.showInputControls,min:ae.min,max:ae.max,debounce:ae.debounce,size:R(L),"onUpdate:modelValue":R(b),onChange:R(g)},null,8,["model-value","class","step","disabled","controls","min","max","debounce","size","onUpdate:modelValue","onChange"])):ut("v-if",!0)],42,D5)}}});var B5=Bn(U5,[["__file","/home/runner/work/element-plus/element-plus/packages/components/slider/src/slider.vue"]]);const k5=Qs(B5),WR=["success","info","warning","error"],ci=rR({customClass:"",center:!1,dangerouslyUseHTMLString:!1,duration:3e3,icon:void 0,id:"",message:"",onClose:void 0,showClose:!1,type:"info",offset:16,zIndex:0,grouping:!1,repeatNum:1,appendTo:Un?document.body:void 0}),V5=hn({customClass:{type:String,default:ci.customClass},center:{type:Boolean,default:ci.center},dangerouslyUseHTMLString:{type:Boolean,default:ci.dangerouslyUseHTMLString},duration:{type:Number,default:ci.duration},icon:{type:ku,default:ci.icon},id:{type:String,default:ci.id},message:{type:pt([String,Object,Function]),default:ci.message},onClose:{type:pt(Function),required:!1},showClose:{type:Boolean,default:ci.showClose},type:{type:String,values:WR,default:ci.type},offset:{type:Number,default:ci.offset},zIndex:{type:Number,default:ci.zIndex},grouping:{type:Boolean,default:ci.grouping},repeatNum:{type:Number,default:ci.repeatNum}}),G5={destroy:()=>!0},Mr=ix([]),H5=n=>{const e=Mr.findIndex(r=>r.id===n),t=Mr[e];let i;return e>0&&(i=Mr[e-1]),{current:t,prev:i}},z5=n=>{const{prev:e}=H5(n);return e?e.vm.exposed.bottom.value:0},W5=(n,e)=>Mr.findIndex(i=>i.id===n)>0?20:e,X5=["id"],j5=["innerHTML"],$5=dt({name:"ElMessage"}),Y5=dt({...$5,props:V5,emits:G5,setup(n,{expose:e}){const t=n,{Close:i}=rV,{ns:r,zIndex:s}=UG("message"),{currentZIndex:o,nextZIndex:a}=s,l=Fe(),u=Fe(!1),c=Fe(0);let h;const d=oe(()=>t.type?t.type==="error"?"danger":t.type:"info"),f=oe(()=>{const T=t.type;return{[r.bm("icon",T)]:T&&HE[T]}}),p=oe(()=>t.icon||HE[t.type]||""),_=oe(()=>z5(t.id)),m=oe(()=>W5(t.id,t.offset)+_.value),g=oe(()=>c.value+m.value),v=oe(()=>({top:`${m.value}px`,zIndex:o.value}));function y(){t.duration!==0&&({stop:h}=c0(()=>{b()},t.duration))}function x(){h==null||h()}function b(){u.value=!1}function S({code:T}){T===Vu.esc&&b()}return Sn(()=>{y(),a(),u.value=!0}),et(()=>t.repeatNum,()=>{x(),y()}),Mu(document,"keydown",S),WC(l,()=>{c.value=l.value.getBoundingClientRect().height}),e({visible:u,bottom:g,close:b}),(T,P)=>(Te(),vt(_c,{name:R(r).b("fade"),onBeforeLeave:T.onClose,onAfterLeave:P[0]||(P[0]=E=>T.$emit("destroy")),persisted:""},{default:Mt(()=>[Go(ze("div",{id:T.id,ref_key:"messageRef",ref:l,class:qe([R(r).b(),{[R(r).m(T.type)]:T.type&&!T.icon},R(r).is("center",T.center),R(r).is("closable",T.showClose),T.customClass]),style:$i(R(v)),role:"alert",onMouseenter:x,onMouseleave:y},[T.repeatNum>1?(Te(),vt(R(uz),{key:0,value:T.repeatNum,type:R(d),class:qe(R(r).e("badge"))},null,8,["value","type","class"])):ut("v-if",!0),R(p)?(Te(),vt(R(Yi),{key:1,class:qe([R(r).e("icon"),R(f)])},{default:Mt(()=>[(Te(),vt(wo(R(p))))]),_:1},8,["class"])):ut("v-if",!0),Qt(T.$slots,"default",{},()=>[T.dangerouslyUseHTMLString?(Te(),ke(jt,{key:1},[ut(" Caution here, message could've been compromised, never use user's input as message "),ze("p",{class:qe(R(r).e("content")),innerHTML:T.message},null,10,j5)],2112)):(Te(),ke("p",{key:0,class:qe(R(r).e("content"))},Fs(T.message),3))]),T.showClose?(Te(),vt(R(Yi),{key:2,class:qe(R(r).e("closeBtn")),onClick:Wa(b,["stop"])},{default:Mt(()=>[lt(R(i))]),_:1},8,["class","onClick"])):ut("v-if",!0)],46,X5),[[Id,u.value]])]),_:3},8,["name","onBeforeLeave"]))}});var q5=Bn(Y5,[["__file","/home/runner/work/element-plus/element-plus/packages/components/message/src/message.vue"]]);let K5=1;const XR=n=>{const e=!n||At(n)||Fu(n)||je(n)?{message:n}:n,t={...ci,...e};if(!t.appendTo)t.appendTo=document.body;else if(At(t.appendTo)){let i=document.querySelector(t.appendTo);Jh(i)||(i=document.body),t.appendTo=i}return t},Z5=n=>{const e=Mr.indexOf(n);if(e===-1)return;Mr.splice(e,1);const{handler:t}=n;t.close()},J5=({appendTo:n,...e},t)=>{const i=`message_${K5++}`,r=e.onClose,s=document.createElement("div"),o={...e,id:i,onClose:()=>{r==null||r(),Z5(c)},onDestroy:()=>{hE(null,s)}},a=lt(q5,o,je(o.message)||Fu(o.message)?{default:je(o.message)?o.message:()=>o.message}:null);a.appContext=t||ju._context,hE(a,s),n.appendChild(s.firstElementChild);const l=a.component,c={id:i,vnode:a,vm:l,handler:{close:()=>{l.exposed.visible.value=!1}},props:a.component.props};return c},ju=(n={},e)=>{if(!Un)return{close:()=>{}};if(pn(iT.max)&&Mr.length>=iT.max)return{close:()=>{}};const t=XR(n);if(t.grouping&&Mr.length){const r=Mr.find(({vnode:s})=>{var o;return((o=s.props)==null?void 0:o.message)===t.message});if(r)return r.props.repeatNum+=1,r.props.type=t.type,r.handler}const i=J5(t,e);return Mr.push(i),i.handler};WR.forEach(n=>{ju[n]=(e={},t)=>{const i=XR(e);return ju({...i,type:n},t)}});function Q5(n){for(const e of Mr)(!n||n===e.props.type)&&e.handler.close()}ju.closeAll=Q5;ju._context=null;const $x=oV(ju,"$message");let Il;function e8(){const n=yl(),e="ws://localhost:9000/live2d";Il=new WebSocket(e);const t=()=>{},i=()=>{};return Il.onopen=t8,Il.onerror=n8,Il.onclose=i8,Il.onmessage=r=>{switch(n.state.modelType){case"live2d":{let s=JSON.parse(r.data);YU(s,n).catch(o=>{console.error(o)});break}case"vrm":{let s=JSON.parse(r.data);EB(s,n.state.viewer,t,i)}}},Il}function t8(){$x({message:"成功建立连接 ₍ᐢ..ᐢ₎♡ ",type:"success"})}function n8(){$x({message:"连接发生了错误! ̊ଳ ̊ᵎᵎᵎᵎ ",type:"warning"})}function i8(){$x({message:"连接已断开!!! ˃̣̣̥᷄⌓˂̣̣̥᷅ ",type:"warning"})}const r8={__name:"App",setup(n){const e=yl();return lx(()=>{e.state.websocket=e8()}),Dr(()=>{e.state.websocket.close()}),(t,i)=>{const r=ch("router-view");return Te(),vt(r)}}},s8={reduce(n,e){typeof localStorage.scale!="number"&&(localStorage.scale=parseFloat(localStorage.scale)),n.state.scale<=.3&&(n.state.scale=.3),n.state.scale-=.1,n.state.model4.scale.set(n.state.scale),e.width=n.state.model4.width,e.height=n.state.model4.height,n.state.app.resizeTo=e},amplify(n,e){typeof localStorage.scale!="number"&&(localStorage.scale=parseFloat(localStorage.scale)),n.state.scale>=1.5&&(n.state.scale=1.5),n.state.scale-=-.1,n.state.model4.scale.set(n.state.scale),e.width=n.state.model4.width,e.height=n.state.model4.height,n.state.app.resizeTo=e}},o8={},a8={websocket:"",model4:"",parameterIndex:"",percentage:parseFloat(localStorage.getItem("percentage")||60),scale:parseFloat(localStorage.getItem("scale")||1),app:"",live2d:"",modelType:"vrm",vrm:{}},l8=bB({actions:s8,mutations:o8,state:a8});const u8=ze("svg",{viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","data-v-ea893728":""},[ze("path",{fill:"currentColor",d:"M338.752 104.704a64 64 0 0 0 0 90.496l316.8 316.8-316.8 316.8a64 64 0 0 0 90.496 90.496l362.048-362.048a64 64 0 0 0 0-90.496L429.248 104.704a64 64 0 0 0-90.496 0z"})],-1),c8=[u8],h8=ze("h4",{style:{"margin-bottom":"-20px"}},"模型大小控制",-1),d8={class:"button"},f8=ze("div",{style:{"margin-bottom":"30px"}},null,-1),p8={style:{display:"flex","justify-content":"center","align-items":"baseline"}},m8=ze("h4",null,"嘴型控制",-1),g8=ze("br",null,null,-1),_8={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","data-v-ea893728":"",style:{width:"1em",height:"1em"}},v8=ze("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm23.744 191.488c-52.096 0-92.928 14.784-123.2 44.352-30.976 29.568-45.76 70.4-45.76 122.496h80.256c0-29.568 5.632-52.8 17.6-68.992 13.376-19.712 35.2-28.864 66.176-28.864 23.936 0 42.944 6.336 56.32 19.712 12.672 13.376 19.712 31.68 19.712 54.912 0 17.6-6.336 34.496-19.008 49.984l-8.448 9.856c-45.76 40.832-73.216 70.4-82.368 89.408-9.856 19.008-14.08 42.24-14.08 68.992v9.856h80.96v-9.856c0-16.896 3.52-31.68 10.56-45.76 6.336-12.672 15.488-24.64 28.16-35.2 33.792-29.568 54.208-48.576 60.544-55.616 16.896-22.528 26.048-51.392 26.048-86.592 0-42.944-14.08-76.736-42.24-101.376-28.16-25.344-65.472-37.312-111.232-37.312zm-12.672 406.208a54.272 54.272 0 0 0-38.72 14.784 49.408 49.408 0 0 0-15.488 38.016c0 15.488 4.928 28.16 15.488 38.016A54.848 54.848 0 0 0 523.072 768c15.488 0 28.16-4.928 38.72-14.784a51.52 51.52 0 0 0 16.192-38.72 51.968 51.968 0 0 0-15.488-38.016 55.936 55.936 0 0 0-39.424-14.784z"},null,-1),y8=[v8],x8={class:"slider-demo-block"},b8={__name:"Live2dDrawer",setup(n){const e=Fe(!1);Fe(null);const t=yl();function i(){e.value=!0}const r=oe(()=>t.state.live2d),s=oe(()=>t.state.percentage),o=oe(()=>t.state.scale);return et(s,(a,l)=>{window.localStorage.setItem("percentage",parseFloat(a)),console.log(a)}),et(o,(a,l)=>{window.localStorage.setItem("scale",parseFloat(a)),console.log(a)}),Sn(()=>{document.addEventListener("keydown",a=>{a.code==="ArrowLeft"&&(e.value=!1),a.code==="ArrowRight"&&(e.value=!0),a.code==="ArrowUp"&&t.dispatch("amplify"),a.code==="ArrowDown"&&t.dispatch("reduce")})}),(a,l)=>{const u=Dz,c=BR,h=k5,d=HR;return Te(),ke(jt,null,[ze("div",{class:"show_setting",onClick:i},c8),lt(d,{modelValue:e.value,"onUpdate:modelValue":l[3]||(l[3]=f=>e.value=f),direction:"ltr","show-close":"","with-header":!1,modal:!1},{default:Mt(()=>[h8,ze("div",d8,[lt(u,{onClick:l[0]||(l[0]=f=>R(t).dispatch("amplify",r.value)),type:"primary",round:"",style:{height:"7vh",width:"8vw","font-size":"2vh","line-height":"0vh","border-radius":"3.5vh"}},{default:Mt(()=>[dh("放大")]),_:1}),lt(u,{onClick:l[1]||(l[1]=f=>R(t).dispatch("reduce",r.value)),type:"primary",round:"",style:{height:"7vh",width:"8vw","font-size":"2vh","line-height":"0vh","border-radius":"3.5vh"}},{default:Mt(()=>[dh("缩小")]),_:1})]),f8,ze("div",p8,[m8,lt(c,{placement:"top"},{content:Mt(()=>[dh("数值越小，嘴越容易张开。"),g8,dh("当模型说话嘴型奇怪时，请适当改变数值。")]),default:Mt(()=>[(Te(),ke("svg",_8,y8))]),_:1})]),ze("div",x8,[lt(h,{modelValue:R(t).state.percentage,"onUpdate:modelValue":l[2]||(l[2]=f=>R(t).state.percentage=f),"show-input":"","input-size":"small"},null,8,["modelValue"])])]),_:1},8,["modelValue"])],64)}}};/*!
 * @pixi/constants - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/constants is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var as;(function(n){n[n.WEBGL_LEGACY=0]="WEBGL_LEGACY",n[n.WEBGL=1]="WEBGL",n[n.WEBGL2=2]="WEBGL2"})(as||(as={}));var $u;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.WEBGL=1]="WEBGL",n[n.CANVAS=2]="CANVAS"})($u||($u={}));var nd;(function(n){n[n.COLOR=16384]="COLOR",n[n.DEPTH=256]="DEPTH",n[n.STENCIL=1024]="STENCIL"})(nd||(nd={}));var He;(function(n){n[n.NORMAL=0]="NORMAL",n[n.ADD=1]="ADD",n[n.MULTIPLY=2]="MULTIPLY",n[n.SCREEN=3]="SCREEN",n[n.OVERLAY=4]="OVERLAY",n[n.DARKEN=5]="DARKEN",n[n.LIGHTEN=6]="LIGHTEN",n[n.COLOR_DODGE=7]="COLOR_DODGE",n[n.COLOR_BURN=8]="COLOR_BURN",n[n.HARD_LIGHT=9]="HARD_LIGHT",n[n.SOFT_LIGHT=10]="SOFT_LIGHT",n[n.DIFFERENCE=11]="DIFFERENCE",n[n.EXCLUSION=12]="EXCLUSION",n[n.HUE=13]="HUE",n[n.SATURATION=14]="SATURATION",n[n.COLOR=15]="COLOR",n[n.LUMINOSITY=16]="LUMINOSITY",n[n.NORMAL_NPM=17]="NORMAL_NPM",n[n.ADD_NPM=18]="ADD_NPM",n[n.SCREEN_NPM=19]="SCREEN_NPM",n[n.NONE=20]="NONE",n[n.SRC_OVER=0]="SRC_OVER",n[n.SRC_IN=21]="SRC_IN",n[n.SRC_OUT=22]="SRC_OUT",n[n.SRC_ATOP=23]="SRC_ATOP",n[n.DST_OVER=24]="DST_OVER",n[n.DST_IN=25]="DST_IN",n[n.DST_OUT=26]="DST_OUT",n[n.DST_ATOP=27]="DST_ATOP",n[n.ERASE=26]="ERASE",n[n.SUBTRACT=28]="SUBTRACT",n[n.XOR=29]="XOR"})(He||(He={}));var Ji;(function(n){n[n.POINTS=0]="POINTS",n[n.LINES=1]="LINES",n[n.LINE_LOOP=2]="LINE_LOOP",n[n.LINE_STRIP=3]="LINE_STRIP",n[n.TRIANGLES=4]="TRIANGLES",n[n.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",n[n.TRIANGLE_FAN=6]="TRIANGLE_FAN"})(Ji||(Ji={}));var Me;(function(n){n[n.RGBA=6408]="RGBA",n[n.RGB=6407]="RGB",n[n.RG=33319]="RG",n[n.RED=6403]="RED",n[n.RGBA_INTEGER=36249]="RGBA_INTEGER",n[n.RGB_INTEGER=36248]="RGB_INTEGER",n[n.RG_INTEGER=33320]="RG_INTEGER",n[n.RED_INTEGER=36244]="RED_INTEGER",n[n.ALPHA=6406]="ALPHA",n[n.LUMINANCE=6409]="LUMINANCE",n[n.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",n[n.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",n[n.DEPTH_STENCIL=34041]="DEPTH_STENCIL"})(Me||(Me={}));var Oo;(function(n){n[n.TEXTURE_2D=3553]="TEXTURE_2D",n[n.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",n[n.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",n[n.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",n[n.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",n[n.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",n[n.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"})(Oo||(Oo={}));var Ge;(function(n){n[n.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",n[n.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",n[n.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",n[n.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",n[n.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",n[n.UNSIGNED_INT=5125]="UNSIGNED_INT",n[n.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",n[n.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",n[n.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",n[n.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",n[n.BYTE=5120]="BYTE",n[n.SHORT=5122]="SHORT",n[n.INT=5124]="INT",n[n.FLOAT=5126]="FLOAT",n[n.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",n[n.HALF_FLOAT=36193]="HALF_FLOAT"})(Ge||(Ge={}));var id;(function(n){n[n.FLOAT=0]="FLOAT",n[n.INT=1]="INT",n[n.UINT=2]="UINT"})(id||(id={}));var wr;(function(n){n[n.NEAREST=0]="NEAREST",n[n.LINEAR=1]="LINEAR"})(wr||(wr={}));var Ar;(function(n){n[n.CLAMP=33071]="CLAMP",n[n.REPEAT=10497]="REPEAT",n[n.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"})(Ar||(Ar={}));var or;(function(n){n[n.OFF=0]="OFF",n[n.POW2=1]="POW2",n[n.ON=2]="ON",n[n.ON_MANUAL=3]="ON_MANUAL"})(or||(or={}));var ar;(function(n){n[n.NPM=0]="NPM",n[n.UNPACK=1]="UNPACK",n[n.PMA=2]="PMA",n[n.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",n[n.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",n[n.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",n[n.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"})(ar||(ar={}));var Wi;(function(n){n[n.NO=0]="NO",n[n.YES=1]="YES",n[n.AUTO=2]="AUTO",n[n.BLEND=0]="BLEND",n[n.CLEAR=1]="CLEAR",n[n.BLIT=2]="BLIT"})(Wi||(Wi={}));var rd;(function(n){n[n.AUTO=0]="AUTO",n[n.MANUAL=1]="MANUAL"})(rd||(rd={}));var gi;(function(n){n.LOW="lowp",n.MEDIUM="mediump",n.HIGH="highp"})(gi||(gi={}));var fn;(function(n){n[n.NONE=0]="NONE",n[n.SCISSOR=1]="SCISSOR",n[n.STENCIL=2]="STENCIL",n[n.SPRITE=3]="SPRITE",n[n.COLOR=4]="COLOR"})(fn||(fn={}));var m0;(function(n){n[n.RED=1]="RED",n[n.GREEN=2]="GREEN",n[n.BLUE=4]="BLUE",n[n.ALPHA=8]="ALPHA"})(m0||(m0={}));var Jt;(function(n){n[n.NONE=0]="NONE",n[n.LOW=2]="LOW",n[n.MEDIUM=4]="MEDIUM",n[n.HIGH=8]="HIGH"})(Jt||(Jt={}));var Pr;(function(n){n[n.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",n[n.ARRAY_BUFFER=34962]="ARRAY_BUFFER",n[n.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"})(Pr||(Pr={}));/*!
 * @pixi/settings - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var jR={createCanvas:function(n,e){var t=document.createElement("canvas");return t.width=n,t.height=e,t},getWebGLRenderingContext:function(){return WebGLRenderingContext},getNavigator:function(){return navigator},getBaseUrl:function(){var n;return(n=document.baseURI)!==null&&n!==void 0?n:window.location.href},fetch:function(n,e){return fetch(n,e)}},i_=/iPhone/i,yT=/iPod/i,xT=/iPad/i,bT=/\biOS-universal(?:.+)Mac\b/i,r_=/\bAndroid(?:.+)Mobile\b/i,ST=/Android/i,Ll=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,df=/Silk/i,vs=/Windows Phone/i,ET=/\bWindows(?:.+)ARM\b/i,TT=/BlackBerry/i,MT=/BB10/i,wT=/Opera Mini/i,AT=/\b(CriOS|Chrome)(?:.+)Mobile/i,PT=/Mobile(?:.+)Firefox\b/i,CT=function(n){return typeof n<"u"&&n.platform==="MacIntel"&&typeof n.maxTouchPoints=="number"&&n.maxTouchPoints>1&&typeof MSStream>"u"};function S8(n){return function(e){return e.test(n)}}function E8(n){var e={userAgent:"",platform:"",maxTouchPoints:0};!n&&typeof navigator<"u"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof n=="string"?e.userAgent=n:n&&n.userAgent&&(e={userAgent:n.userAgent,platform:n.platform,maxTouchPoints:n.maxTouchPoints||0});var t=e.userAgent,i=t.split("[FBAN");typeof i[1]<"u"&&(t=i[0]),i=t.split("Twitter"),typeof i[1]<"u"&&(t=i[0]);var r=S8(t),s={apple:{phone:r(i_)&&!r(vs),ipod:r(yT),tablet:!r(i_)&&(r(xT)||CT(e))&&!r(vs),universal:r(bT),device:(r(i_)||r(yT)||r(xT)||r(bT)||CT(e))&&!r(vs)},amazon:{phone:r(Ll),tablet:!r(Ll)&&r(df),device:r(Ll)||r(df)},android:{phone:!r(vs)&&r(Ll)||!r(vs)&&r(r_),tablet:!r(vs)&&!r(Ll)&&!r(r_)&&(r(df)||r(ST)),device:!r(vs)&&(r(Ll)||r(df)||r(r_)||r(ST))||r(/\bokhttp\b/i)},windows:{phone:r(vs),tablet:r(ET),device:r(vs)||r(ET)},other:{blackberry:r(TT),blackberry10:r(MT),opera:r(wT),firefox:r(PT),chrome:r(AT),device:r(TT)||r(MT)||r(wT)||r(PT)||r(AT)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}var Qi=E8(globalThis.navigator);function T8(){return!Qi.apple.device}function M8(n){var e=!0;if(Qi.tablet||Qi.phone){if(Qi.apple.device){var t=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(t){var i=parseInt(t[1],10);i<11&&(e=!1)}}if(Qi.android.device){var t=navigator.userAgent.match(/Android\s([0-9.]*)/);if(t){var i=parseInt(t[1],10);i<7&&(e=!1)}}}return e?n:4}var Oe={ADAPTER:jR,MIPMAP_TEXTURES:or.POW2,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,FILTER_MULTISAMPLE:Jt.NONE,SPRITE_MAX_TEXTURES:M8(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,width:800,height:600,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,antialias:!1,preserveDrawingBuffer:!1},GC_MODE:rd.AUTO,GC_MAX_IDLE:60*60,GC_MAX_CHECK_COUNT:60*10,WRAP_MODE:Ar.CLAMP,SCALE_MODE:wr.LINEAR,PRECISION_VERTEX:gi.HIGH,PRECISION_FRAGMENT:Qi.apple.device?gi.HIGH:gi.MEDIUM,CAN_UPLOAD_SAME_BUFFER:T8(),CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},$R={exports:{}};(function(n){var e=Object.prototype.hasOwnProperty,t="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(t=!1));function r(l,u,c){this.fn=l,this.context=u,this.once=c||!1}function s(l,u,c,h,d){if(typeof c!="function")throw new TypeError("The listener must be a function");var f=new r(c,h||l,d),p=t?t+u:u;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],f]:l._events[p].push(f):(l._events[p]=f,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new i:delete l._events[u]}function a(){this._events=new i,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],c,h;if(this._eventsCount===0)return u;for(h in c=this._events)e.call(c,h)&&u.push(t?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(c)):u},a.prototype.listeners=function(u){var c=t?t+u:u,h=this._events[c];if(!h)return[];if(h.fn)return[h.fn];for(var d=0,f=h.length,p=new Array(f);d<f;d++)p[d]=h[d].fn;return p},a.prototype.listenerCount=function(u){var c=t?t+u:u,h=this._events[c];return h?h.fn?1:h.length:0},a.prototype.emit=function(u,c,h,d,f,p){var _=t?t+u:u;if(!this._events[_])return!1;var m=this._events[_],g=arguments.length,v,y;if(m.fn){switch(m.once&&this.removeListener(u,m.fn,void 0,!0),g){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,c),!0;case 3:return m.fn.call(m.context,c,h),!0;case 4:return m.fn.call(m.context,c,h,d),!0;case 5:return m.fn.call(m.context,c,h,d,f),!0;case 6:return m.fn.call(m.context,c,h,d,f,p),!0}for(y=1,v=new Array(g-1);y<g;y++)v[y-1]=arguments[y];m.fn.apply(m.context,v)}else{var x=m.length,b;for(y=0;y<x;y++)switch(m[y].once&&this.removeListener(u,m[y].fn,void 0,!0),g){case 1:m[y].fn.call(m[y].context);break;case 2:m[y].fn.call(m[y].context,c);break;case 3:m[y].fn.call(m[y].context,c,h);break;case 4:m[y].fn.call(m[y].context,c,h,d);break;default:if(!v)for(b=1,v=new Array(g-1);b<g;b++)v[b-1]=arguments[b];m[y].fn.apply(m[y].context,v)}}return!0},a.prototype.on=function(u,c,h){return s(this,u,c,h,!1)},a.prototype.once=function(u,c,h){return s(this,u,c,h,!0)},a.prototype.removeListener=function(u,c,h,d){var f=t?t+u:u;if(!this._events[f])return this;if(!c)return o(this,f),this;var p=this._events[f];if(p.fn)p.fn===c&&(!d||p.once)&&(!h||p.context===h)&&o(this,f);else{for(var _=0,m=[],g=p.length;_<g;_++)(p[_].fn!==c||d&&!p[_].once||h&&p[_].context!==h)&&m.push(p[_]);m.length?this._events[f]=m.length===1?m[0]:m:o(this,f)}return this},a.prototype.removeAllListeners=function(u){var c;return u?(c=t?t+u:u,this._events[c]&&o(this,c)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=t,a.EventEmitter=a,n.exports=a})($R);var w8=$R.exports;const lr=jx(w8);var Yx={exports:{}};Yx.exports=tg;Yx.exports.default=tg;function tg(n,e,t){t=t||2;var i=e&&e.length,r=i?e[0]*t:n.length,s=YR(n,0,r,t,!0),o=[];if(!s||s.next===s.prev)return o;var a,l,u,c,h,d,f;if(i&&(s=I8(n,e,s,t)),n.length>80*t){a=u=n[0],l=c=n[1];for(var p=t;p<r;p+=t)h=n[p],d=n[p+1],h<a&&(a=h),d<l&&(l=d),h>u&&(u=h),d>c&&(c=d);f=Math.max(u-a,c-l),f=f!==0?32767/f:0}return sd(s,o,t,a,l,f,0),o}function YR(n,e,t,i,r){var s,o;if(r===v0(n,e,t,i)>0)for(s=e;s<t;s+=i)o=RT(s,n[s],n[s+1],o);else for(s=t-i;s>=e;s-=i)o=RT(s,n[s],n[s+1],o);return o&&ng(o,o.next)&&(ad(o),o=o.next),o}function cl(n,e){if(!n)return n;e||(e=n);var t=n,i;do if(i=!1,!t.steiner&&(ng(t,t.next)||sn(t.prev,t,t.next)===0)){if(ad(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function sd(n,e,t,i,r,s,o){if(n){!o&&s&&N8(n,i,r,s);for(var a=n,l,u;n.prev!==n.next;){if(l=n.prev,u=n.next,s?P8(n,i,r,s):A8(n)){e.push(l.i/t|0),e.push(n.i/t|0),e.push(u.i/t|0),ad(n),n=u.next,a=u.next;continue}if(n=u,n===a){o?o===1?(n=C8(cl(n),e,t),sd(n,e,t,i,r,s,2)):o===2&&R8(n,e,t,i,r,s):sd(cl(n),e,t,i,r,s,1);break}}}}function A8(n){var e=n.prev,t=n,i=n.next;if(sn(e,t,i)>=0)return!1;for(var r=e.x,s=t.x,o=i.x,a=e.y,l=t.y,u=i.y,c=r<s?r<o?r:o:s<o?s:o,h=a<l?a<u?a:u:l<u?l:u,d=r>s?r>o?r:o:s>o?s:o,f=a>l?a>u?a:u:l>u?l:u,p=i.next;p!==e;){if(p.x>=c&&p.x<=d&&p.y>=h&&p.y<=f&&_u(r,a,s,l,o,u,p.x,p.y)&&sn(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function P8(n,e,t,i){var r=n.prev,s=n,o=n.next;if(sn(r,s,o)>=0)return!1;for(var a=r.x,l=s.x,u=o.x,c=r.y,h=s.y,d=o.y,f=a<l?a<u?a:u:l<u?l:u,p=c<h?c<d?c:d:h<d?h:d,_=a>l?a>u?a:u:l>u?l:u,m=c>h?c>d?c:d:h>d?h:d,g=g0(f,p,e,t,i),v=g0(_,m,e,t,i),y=n.prevZ,x=n.nextZ;y&&y.z>=g&&x&&x.z<=v;){if(y.x>=f&&y.x<=_&&y.y>=p&&y.y<=m&&y!==r&&y!==o&&_u(a,c,l,h,u,d,y.x,y.y)&&sn(y.prev,y,y.next)>=0||(y=y.prevZ,x.x>=f&&x.x<=_&&x.y>=p&&x.y<=m&&x!==r&&x!==o&&_u(a,c,l,h,u,d,x.x,x.y)&&sn(x.prev,x,x.next)>=0))return!1;x=x.nextZ}for(;y&&y.z>=g;){if(y.x>=f&&y.x<=_&&y.y>=p&&y.y<=m&&y!==r&&y!==o&&_u(a,c,l,h,u,d,y.x,y.y)&&sn(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;x&&x.z<=v;){if(x.x>=f&&x.x<=_&&x.y>=p&&x.y<=m&&x!==r&&x!==o&&_u(a,c,l,h,u,d,x.x,x.y)&&sn(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function C8(n,e,t){var i=n;do{var r=i.prev,s=i.next.next;!ng(r,s)&&qR(r,i,i.next,s)&&od(r,s)&&od(s,r)&&(e.push(r.i/t|0),e.push(i.i/t|0),e.push(s.i/t|0),ad(i),ad(i.next),i=n=s),i=i.next}while(i!==n);return cl(i)}function R8(n,e,t,i,r,s){var o=n;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&k8(o,a)){var l=KR(o,a);o=cl(o,o.next),l=cl(l,l.next),sd(o,e,t,i,r,s,0),sd(l,e,t,i,r,s,0);return}a=a.next}o=o.next}while(o!==n)}function I8(n,e,t,i){var r=[],s,o,a,l,u;for(s=0,o=e.length;s<o;s++)a=e[s]*i,l=s<o-1?e[s+1]*i:n.length,u=YR(n,a,l,i,!1),u===u.next&&(u.steiner=!0),r.push(B8(u));for(r.sort(L8),s=0;s<r.length;s++)t=O8(r[s],t);return t}function L8(n,e){return n.x-e.x}function O8(n,e){var t=D8(n,e);if(!t)return e;var i=KR(t,n);return cl(i,i.next),cl(t,t.next)}function D8(n,e){var t=e,i=n.x,r=n.y,s=-1/0,o;do{if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){var a=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(a<=i&&a>s&&(s=a,o=t.x<t.next.x?t:t.next,a===i))return o}t=t.next}while(t!==e);if(!o)return null;var l=o,u=o.x,c=o.y,h=1/0,d;t=o;do i>=t.x&&t.x>=u&&i!==t.x&&_u(r<c?i:s,r,u,c,r<c?s:i,r,t.x,t.y)&&(d=Math.abs(r-t.y)/(i-t.x),od(t,n)&&(d<h||d===h&&(t.x>o.x||t.x===o.x&&F8(o,t)))&&(o=t,h=d)),t=t.next;while(t!==l);return o}function F8(n,e){return sn(n.prev,n,e.prev)<0&&sn(e.next,n,n.next)<0}function N8(n,e,t,i){var r=n;do r.z===0&&(r.z=g0(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,U8(r)}function U8(n){var e,t,i,r,s,o,a,l,u=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,i=t,a=0,e=0;e<u&&(a++,i=i.nextZ,!!i);e++);for(l=u;a>0||l>0&&i;)a!==0&&(l===0||!i||t.z<=i.z)?(r=t,t=t.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;t=i}s.nextZ=null,u*=2}while(o>1);return n}function g0(n,e,t,i,r){return n=(n-t)*r|0,e=(e-i)*r|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function B8(n){var e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function _u(n,e,t,i,r,s,o,a){return(r-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(i-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(i-a)}function k8(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!V8(n,e)&&(od(n,e)&&od(e,n)&&G8(n,e)&&(sn(n.prev,n,e.prev)||sn(n,e.prev,e))||ng(n,e)&&sn(n.prev,n,n.next)>0&&sn(e.prev,e,e.next)>0)}function sn(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function ng(n,e){return n.x===e.x&&n.y===e.y}function qR(n,e,t,i){var r=pf(sn(n,e,t)),s=pf(sn(n,e,i)),o=pf(sn(t,i,n)),a=pf(sn(t,i,e));return!!(r!==s&&o!==a||r===0&&ff(n,t,e)||s===0&&ff(n,i,e)||o===0&&ff(t,n,i)||a===0&&ff(t,e,i))}function ff(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function pf(n){return n>0?1:n<0?-1:0}function V8(n,e){var t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&qR(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function od(n,e){return sn(n.prev,n,n.next)<0?sn(n,e,n.next)>=0&&sn(n,n.prev,e)>=0:sn(n,e,n.prev)<0||sn(n,n.next,e)<0}function G8(n,e){var t=n,i=!1,r=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==n);return i}function KR(n,e){var t=new _0(n.i,n.x,n.y),i=new _0(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function RT(n,e,t,i){var r=new _0(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function ad(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function _0(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}tg.deviation=function(n,e,t,i){var r=e&&e.length,s=r?e[0]*t:n.length,o=Math.abs(v0(n,0,s,t));if(r)for(var a=0,l=e.length;a<l;a++){var u=e[a]*t,c=a<l-1?e[a+1]*t:n.length;o-=Math.abs(v0(n,u,c,t))}var h=0;for(a=0;a<i.length;a+=3){var d=i[a]*t,f=i[a+1]*t,p=i[a+2]*t;h+=Math.abs((n[d]-n[p])*(n[f+1]-n[d+1])-(n[d]-n[f])*(n[p+1]-n[d+1]))}return o===0&&h===0?0:Math.abs((h-o)/o)};function v0(n,e,t,i){for(var r=0,s=e,o=t-i;s<t;s+=i)r+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return r}tg.flatten=function(n){for(var e=n[0][0].length,t={vertices:[],holes:[],dimensions:e},i=0,r=0;r<n.length;r++){for(var s=0;s<n[r].length;s++)for(var o=0;o<e;o++)t.vertices.push(n[r][s][o]);r>0&&(i+=n[r-1].length,t.holes.push(i))}return t};var H8=Yx.exports;const qx=jx(H8);var Qp={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */Qp.exports;(function(n,e){(function(t){var i=e&&!e.nodeType&&e,r=n&&!n.nodeType&&n,s=typeof t_=="object"&&t_;(s.global===s||s.window===s||s.self===s)&&(t=s);var o,a=2147483647,l=36,u=1,c=26,h=38,d=700,f=72,p=128,_="-",m=/^xn--/,g=/[^\x20-\x7E]/,v=/[\x2E\u3002\uFF0E\uFF61]/g,y={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},x=l-u,b=Math.floor,S=String.fromCharCode,T;function P(j){throw new RangeError(y[j])}function E(j,F){for(var X=j.length,re=[];X--;)re[X]=F(j[X]);return re}function M(j,F){var X=j.split("@"),re="";X.length>1&&(re=X[0]+"@",j=X[1]),j=j.replace(v,".");var ce=j.split("."),ve=E(ce,F).join(".");return re+ve}function O(j){for(var F=[],X=0,re=j.length,ce,ve;X<re;)ce=j.charCodeAt(X++),ce>=55296&&ce<=56319&&X<re?(ve=j.charCodeAt(X++),(ve&64512)==56320?F.push(((ce&1023)<<10)+(ve&1023)+65536):(F.push(ce),X--)):F.push(ce);return F}function L(j){return E(j,function(F){var X="";return F>65535&&(F-=65536,X+=S(F>>>10&1023|55296),F=56320|F&1023),X+=S(F),X}).join("")}function C(j){return j-48<10?j-22:j-65<26?j-65:j-97<26?j-97:l}function D(j,F){return j+22+75*(j<26)-((F!=0)<<5)}function B(j,F,X){var re=0;for(j=X?b(j/d):j>>1,j+=b(j/F);j>x*c>>1;re+=l)j=b(j/x);return b(re+(x+1)*j/(j+h))}function W(j){var F=[],X=j.length,re,ce=0,ve=p,ae=f,Y,ne,he,xe,be,w,V,H,K;for(Y=j.lastIndexOf(_),Y<0&&(Y=0),ne=0;ne<Y;++ne)j.charCodeAt(ne)>=128&&P("not-basic"),F.push(j.charCodeAt(ne));for(he=Y>0?Y+1:0;he<X;){for(xe=ce,be=1,w=l;he>=X&&P("invalid-input"),V=C(j.charCodeAt(he++)),(V>=l||V>b((a-ce)/be))&&P("overflow"),ce+=V*be,H=w<=ae?u:w>=ae+c?c:w-ae,!(V<H);w+=l)K=l-H,be>b(a/K)&&P("overflow"),be*=K;re=F.length+1,ae=B(ce-xe,re,xe==0),b(ce/re)>a-ve&&P("overflow"),ve+=b(ce/re),ce%=re,F.splice(ce++,0,ve)}return L(F)}function U(j){var F,X,re,ce,ve,ae,Y,ne,he,xe,be,w=[],V,H,K,Z;for(j=O(j),V=j.length,F=p,X=0,ve=f,ae=0;ae<V;++ae)be=j[ae],be<128&&w.push(S(be));for(re=ce=w.length,ce&&w.push(_);re<V;){for(Y=a,ae=0;ae<V;++ae)be=j[ae],be>=F&&be<Y&&(Y=be);for(H=re+1,Y-F>b((a-X)/H)&&P("overflow"),X+=(Y-F)*H,F=Y,ae=0;ae<V;++ae)if(be=j[ae],be<F&&++X>a&&P("overflow"),be==F){for(ne=X,he=l;xe=he<=ve?u:he>=ve+c?c:he-ve,!(ne<xe);he+=l)Z=ne-xe,K=l-xe,w.push(S(D(xe+Z%K,0))),ne=b(Z/K);w.push(S(D(ne,0))),ve=B(X,H,re==ce),X=0,++re}++X,++F}return w.join("")}function $(j){return M(j,function(F){return m.test(F)?W(F.slice(4).toLowerCase()):F})}function J(j){return M(j,function(F){return g.test(F)?"xn--"+U(F):F})}if(o={version:"1.4.1",ucs2:{decode:O,encode:L},decode:W,encode:U,toASCII:J,toUnicode:$},i&&r)if(n.exports==i)r.exports=o;else for(T in o)o.hasOwnProperty(T)&&(i[T]=o[T]);else t.punycode=o})(t_)})(Qp,Qp.exports);var z8=Qp.exports,W8=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),i=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(i)!=="[object Symbol]")return!1;var r=42;e[t]=r;for(t in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var s=Object.getOwnPropertySymbols(e);if(s.length!==1||s[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,t);if(o.value!==r||o.enumerable!==!0)return!1}return!0},IT=typeof Symbol<"u"&&Symbol,X8=W8,j8=function(){return typeof IT!="function"||typeof Symbol!="function"||typeof IT("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:X8()},LT={foo:{}},$8=Object,Y8=function(){return{__proto__:LT}.foo===LT.foo&&!({__proto__:null}instanceof $8)},q8="Function.prototype.bind called on incompatible ",s_=Array.prototype.slice,K8=Object.prototype.toString,Z8="[object Function]",J8=function(e){var t=this;if(typeof t!="function"||K8.call(t)!==Z8)throw new TypeError(q8+t);for(var i=s_.call(arguments,1),r,s=function(){if(this instanceof r){var c=t.apply(this,i.concat(s_.call(arguments)));return Object(c)===c?c:this}else return t.apply(e,i.concat(s_.call(arguments)))},o=Math.max(0,t.length-i.length),a=[],l=0;l<o;l++)a.push("$"+l);if(r=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(s),t.prototype){var u=function(){};u.prototype=t.prototype,r.prototype=new u,u.prototype=null}return r},Q8=J8,Kx=Function.prototype.bind||Q8,e6=Kx,t6=e6.call(Function.call,Object.prototype.hasOwnProperty),_t,Yu=SyntaxError,ZR=Function,wu=TypeError,o_=function(n){try{return ZR('"use strict"; return ('+n+").constructor;")()}catch{}},tl=Object.getOwnPropertyDescriptor;if(tl)try{tl({},"")}catch{tl=null}var a_=function(){throw new wu},n6=tl?function(){try{return arguments.callee,a_}catch{try{return tl(arguments,"callee").get}catch{return a_}}}():a_,Ol=j8(),i6=Y8(),Ln=Object.getPrototypeOf||(i6?function(n){return n.__proto__}:null),hu={},r6=typeof Uint8Array>"u"||!Ln?_t:Ln(Uint8Array),nl={"%AggregateError%":typeof AggregateError>"u"?_t:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?_t:ArrayBuffer,"%ArrayIteratorPrototype%":Ol&&Ln?Ln([][Symbol.iterator]()):_t,"%AsyncFromSyncIteratorPrototype%":_t,"%AsyncFunction%":hu,"%AsyncGenerator%":hu,"%AsyncGeneratorFunction%":hu,"%AsyncIteratorPrototype%":hu,"%Atomics%":typeof Atomics>"u"?_t:Atomics,"%BigInt%":typeof BigInt>"u"?_t:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?_t:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?_t:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?_t:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?_t:Float32Array,"%Float64Array%":typeof Float64Array>"u"?_t:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?_t:FinalizationRegistry,"%Function%":ZR,"%GeneratorFunction%":hu,"%Int8Array%":typeof Int8Array>"u"?_t:Int8Array,"%Int16Array%":typeof Int16Array>"u"?_t:Int16Array,"%Int32Array%":typeof Int32Array>"u"?_t:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Ol&&Ln?Ln(Ln([][Symbol.iterator]())):_t,"%JSON%":typeof JSON=="object"?JSON:_t,"%Map%":typeof Map>"u"?_t:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Ol||!Ln?_t:Ln(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?_t:Promise,"%Proxy%":typeof Proxy>"u"?_t:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?_t:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?_t:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Ol||!Ln?_t:Ln(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?_t:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Ol&&Ln?Ln(""[Symbol.iterator]()):_t,"%Symbol%":Ol?Symbol:_t,"%SyntaxError%":Yu,"%ThrowTypeError%":n6,"%TypedArray%":r6,"%TypeError%":wu,"%Uint8Array%":typeof Uint8Array>"u"?_t:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?_t:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?_t:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?_t:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?_t:WeakMap,"%WeakRef%":typeof WeakRef>"u"?_t:WeakRef,"%WeakSet%":typeof WeakSet>"u"?_t:WeakSet};if(Ln)try{null.error}catch(n){var s6=Ln(Ln(n));nl["%Error.prototype%"]=s6}var o6=function n(e){var t;if(e==="%AsyncFunction%")t=o_("async function () {}");else if(e==="%GeneratorFunction%")t=o_("function* () {}");else if(e==="%AsyncGeneratorFunction%")t=o_("async function* () {}");else if(e==="%AsyncGenerator%"){var i=n("%AsyncGeneratorFunction%");i&&(t=i.prototype)}else if(e==="%AsyncIteratorPrototype%"){var r=n("%AsyncGenerator%");r&&Ln&&(t=Ln(r.prototype))}return nl[e]=t,t},OT={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Ud=Kx,em=t6,a6=Ud.call(Function.call,Array.prototype.concat),l6=Ud.call(Function.apply,Array.prototype.splice),DT=Ud.call(Function.call,String.prototype.replace),tm=Ud.call(Function.call,String.prototype.slice),u6=Ud.call(Function.call,RegExp.prototype.exec),c6=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,h6=/\\(\\)?/g,d6=function(e){var t=tm(e,0,1),i=tm(e,-1);if(t==="%"&&i!=="%")throw new Yu("invalid intrinsic syntax, expected closing `%`");if(i==="%"&&t!=="%")throw new Yu("invalid intrinsic syntax, expected opening `%`");var r=[];return DT(e,c6,function(s,o,a,l){r[r.length]=a?DT(l,h6,"$1"):o||s}),r},f6=function(e,t){var i=e,r;if(em(OT,i)&&(r=OT[i],i="%"+r[0]+"%"),em(nl,i)){var s=nl[i];if(s===hu&&(s=o6(i)),typeof s>"u"&&!t)throw new wu("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:i,value:s}}throw new Yu("intrinsic "+e+" does not exist!")},Zx=function(e,t){if(typeof e!="string"||e.length===0)throw new wu("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof t!="boolean")throw new wu('"allowMissing" argument must be a boolean');if(u6(/^%?[^%]*%?$/,e)===null)throw new Yu("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var i=d6(e),r=i.length>0?i[0]:"",s=f6("%"+r+"%",t),o=s.name,a=s.value,l=!1,u=s.alias;u&&(r=u[0],l6(i,a6([0,1],u)));for(var c=1,h=!0;c<i.length;c+=1){var d=i[c],f=tm(d,0,1),p=tm(d,-1);if((f==='"'||f==="'"||f==="`"||p==='"'||p==="'"||p==="`")&&f!==p)throw new Yu("property names with quotes must have matching quotes");if((d==="constructor"||!h)&&(l=!0),r+="."+d,o="%"+r+"%",em(nl,o))a=nl[o];else if(a!=null){if(!(d in a)){if(!t)throw new wu("base intrinsic for "+e+" exists, but the property is not available.");return}if(tl&&c+1>=i.length){var _=tl(a,d);h=!!_,h&&"get"in _&&!("originalValue"in _.get)?a=_.get:a=a[d]}else h=em(a,d),a=a[d];h&&!l&&(nl[o]=a)}}return a},JR={exports:{}};(function(n){var e=Kx,t=Zx,i=t("%Function.prototype.apply%"),r=t("%Function.prototype.call%"),s=t("%Reflect.apply%",!0)||e.call(r,i),o=t("%Object.getOwnPropertyDescriptor%",!0),a=t("%Object.defineProperty%",!0),l=t("%Math.max%");if(a)try{a({},"a",{value:1})}catch{a=null}n.exports=function(h){var d=s(e,r,arguments);if(o&&a){var f=o(d,"length");f.configurable&&a(d,"length",{value:1+l(0,h.length-(arguments.length-1))})}return d};var u=function(){return s(e,i,arguments)};a?a(n.exports,"apply",{value:u}):n.exports.apply=u})(JR);var p6=JR.exports,QR=Zx,eI=p6,m6=eI(QR("String.prototype.indexOf")),g6=function(e,t){var i=QR(e,!!t);return typeof i=="function"&&m6(e,".prototype.")>-1?eI(i):i};const _6={},v6=Object.freeze(Object.defineProperty({__proto__:null,default:_6},Symbol.toStringTag,{value:"Module"})),y6=Fz(v6);var Jx=typeof Map=="function"&&Map.prototype,l_=Object.getOwnPropertyDescriptor&&Jx?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,nm=Jx&&l_&&typeof l_.get=="function"?l_.get:null,FT=Jx&&Map.prototype.forEach,Qx=typeof Set=="function"&&Set.prototype,u_=Object.getOwnPropertyDescriptor&&Qx?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,im=Qx&&u_&&typeof u_.get=="function"?u_.get:null,NT=Qx&&Set.prototype.forEach,x6=typeof WeakMap=="function"&&WeakMap.prototype,Ih=x6?WeakMap.prototype.has:null,b6=typeof WeakSet=="function"&&WeakSet.prototype,Lh=b6?WeakSet.prototype.has:null,S6=typeof WeakRef=="function"&&WeakRef.prototype,UT=S6?WeakRef.prototype.deref:null,E6=Boolean.prototype.valueOf,T6=Object.prototype.toString,M6=Function.prototype.toString,w6=String.prototype.match,eb=String.prototype.slice,Co=String.prototype.replace,A6=String.prototype.toUpperCase,BT=String.prototype.toLowerCase,tI=RegExp.prototype.test,kT=Array.prototype.concat,qr=Array.prototype.join,P6=Array.prototype.slice,VT=Math.floor,y0=typeof BigInt=="function"?BigInt.prototype.valueOf:null,c_=Object.getOwnPropertySymbols,x0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,qu=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Jn=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===qu||"symbol")?Symbol.toStringTag:null,nI=Object.prototype.propertyIsEnumerable,GT=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(n){return n.__proto__}:null);function HT(n,e){if(n===1/0||n===-1/0||n!==n||n&&n>-1e3&&n<1e3||tI.call(/e/,e))return e;var t=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof n=="number"){var i=n<0?-VT(-n):VT(n);if(i!==n){var r=String(i),s=eb.call(e,r.length+1);return Co.call(r,t,"$&_")+"."+Co.call(Co.call(s,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Co.call(e,t,"$&_")}var b0=y6,zT=b0.custom,WT=rI(zT)?zT:null,C6=function n(e,t,i,r){var s=t||{};if(Eo(s,"quoteStyle")&&s.quoteStyle!=="single"&&s.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Eo(s,"maxStringLength")&&(typeof s.maxStringLength=="number"?s.maxStringLength<0&&s.maxStringLength!==1/0:s.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=Eo(s,"customInspect")?s.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Eo(s,"indent")&&s.indent!==null&&s.indent!=="	"&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Eo(s,"numericSeparator")&&typeof s.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=s.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return oI(e,s);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var l=String(e);return a?HT(e,l):l}if(typeof e=="bigint"){var u=String(e)+"n";return a?HT(e,u):u}var c=typeof s.depth>"u"?5:s.depth;if(typeof i>"u"&&(i=0),i>=c&&c>0&&typeof e=="object")return S0(e)?"[Array]":"[Object]";var h=$6(s,i);if(typeof r>"u")r=[];else if(sI(r,e)>=0)return"[Circular]";function d(C,D,B){if(D&&(r=P6.call(r),r.push(D)),B){var W={depth:s.depth};return Eo(s,"quoteStyle")&&(W.quoteStyle=s.quoteStyle),n(C,W,i+1,r)}return n(C,s,i+1,r)}if(typeof e=="function"&&!XT(e)){var f=B6(e),p=mf(e,d);return"[Function"+(f?": "+f:" (anonymous)")+"]"+(p.length>0?" { "+qr.call(p,", ")+" }":"")}if(rI(e)){var _=qu?Co.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):x0.call(e);return typeof e=="object"&&!qu?Nc(_):_}if(W6(e)){for(var m="<"+BT.call(String(e.nodeName)),g=e.attributes||[],v=0;v<g.length;v++)m+=" "+g[v].name+"="+iI(R6(g[v].value),"double",s);return m+=">",e.childNodes&&e.childNodes.length&&(m+="..."),m+="</"+BT.call(String(e.nodeName))+">",m}if(S0(e)){if(e.length===0)return"[]";var y=mf(e,d);return h&&!j6(y)?"["+E0(y,h)+"]":"[ "+qr.call(y,", ")+" ]"}if(L6(e)){var x=mf(e,d);return!("cause"in Error.prototype)&&"cause"in e&&!nI.call(e,"cause")?"{ ["+String(e)+"] "+qr.call(kT.call("[cause]: "+d(e.cause),x),", ")+" }":x.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+qr.call(x,", ")+" }"}if(typeof e=="object"&&o){if(WT&&typeof e[WT]=="function"&&b0)return b0(e,{depth:c-i});if(o!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(k6(e)){var b=[];return FT&&FT.call(e,function(C,D){b.push(d(D,e,!0)+" => "+d(C,e))}),jT("Map",nm.call(e),b,h)}if(H6(e)){var S=[];return NT&&NT.call(e,function(C){S.push(d(C,e))}),jT("Set",im.call(e),S,h)}if(V6(e))return h_("WeakMap");if(z6(e))return h_("WeakSet");if(G6(e))return h_("WeakRef");if(D6(e))return Nc(d(Number(e)));if(N6(e))return Nc(d(y0.call(e)));if(F6(e))return Nc(E6.call(e));if(O6(e))return Nc(d(String(e)));if(!I6(e)&&!XT(e)){var T=mf(e,d),P=GT?GT(e)===Object.prototype:e instanceof Object||e.constructor===Object,E=e instanceof Object?"":"null prototype",M=!P&&Jn&&Object(e)===e&&Jn in e?eb.call(Yo(e),8,-1):E?"Object":"",O=P||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",L=O+(M||E?"["+qr.call(kT.call([],M||[],E||[]),": ")+"] ":"");return T.length===0?L+"{}":h?L+"{"+E0(T,h)+"}":L+"{ "+qr.call(T,", ")+" }"}return String(e)};function iI(n,e,t){var i=(t.quoteStyle||e)==="double"?'"':"'";return i+n+i}function R6(n){return Co.call(String(n),/"/g,"&quot;")}function S0(n){return Yo(n)==="[object Array]"&&(!Jn||!(typeof n=="object"&&Jn in n))}function I6(n){return Yo(n)==="[object Date]"&&(!Jn||!(typeof n=="object"&&Jn in n))}function XT(n){return Yo(n)==="[object RegExp]"&&(!Jn||!(typeof n=="object"&&Jn in n))}function L6(n){return Yo(n)==="[object Error]"&&(!Jn||!(typeof n=="object"&&Jn in n))}function O6(n){return Yo(n)==="[object String]"&&(!Jn||!(typeof n=="object"&&Jn in n))}function D6(n){return Yo(n)==="[object Number]"&&(!Jn||!(typeof n=="object"&&Jn in n))}function F6(n){return Yo(n)==="[object Boolean]"&&(!Jn||!(typeof n=="object"&&Jn in n))}function rI(n){if(qu)return n&&typeof n=="object"&&n instanceof Symbol;if(typeof n=="symbol")return!0;if(!n||typeof n!="object"||!x0)return!1;try{return x0.call(n),!0}catch{}return!1}function N6(n){if(!n||typeof n!="object"||!y0)return!1;try{return y0.call(n),!0}catch{}return!1}var U6=Object.prototype.hasOwnProperty||function(n){return n in this};function Eo(n,e){return U6.call(n,e)}function Yo(n){return T6.call(n)}function B6(n){if(n.name)return n.name;var e=w6.call(M6.call(n),/^function\s*([\w$]+)/);return e?e[1]:null}function sI(n,e){if(n.indexOf)return n.indexOf(e);for(var t=0,i=n.length;t<i;t++)if(n[t]===e)return t;return-1}function k6(n){if(!nm||!n||typeof n!="object")return!1;try{nm.call(n);try{im.call(n)}catch{return!0}return n instanceof Map}catch{}return!1}function V6(n){if(!Ih||!n||typeof n!="object")return!1;try{Ih.call(n,Ih);try{Lh.call(n,Lh)}catch{return!0}return n instanceof WeakMap}catch{}return!1}function G6(n){if(!UT||!n||typeof n!="object")return!1;try{return UT.call(n),!0}catch{}return!1}function H6(n){if(!im||!n||typeof n!="object")return!1;try{im.call(n);try{nm.call(n)}catch{return!0}return n instanceof Set}catch{}return!1}function z6(n){if(!Lh||!n||typeof n!="object")return!1;try{Lh.call(n,Lh);try{Ih.call(n,Ih)}catch{return!0}return n instanceof WeakSet}catch{}return!1}function W6(n){return!n||typeof n!="object"?!1:typeof HTMLElement<"u"&&n instanceof HTMLElement?!0:typeof n.nodeName=="string"&&typeof n.getAttribute=="function"}function oI(n,e){if(n.length>e.maxStringLength){var t=n.length-e.maxStringLength,i="... "+t+" more character"+(t>1?"s":"");return oI(eb.call(n,0,e.maxStringLength),e)+i}var r=Co.call(Co.call(n,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,X6);return iI(r,"single",e)}function X6(n){var e=n.charCodeAt(0),t={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return t?"\\"+t:"\\x"+(e<16?"0":"")+A6.call(e.toString(16))}function Nc(n){return"Object("+n+")"}function h_(n){return n+" { ? }"}function jT(n,e,t,i){var r=i?E0(t,i):qr.call(t,", ");return n+" ("+e+") {"+r+"}"}function j6(n){for(var e=0;e<n.length;e++)if(sI(n[e],`
`)>=0)return!1;return!0}function $6(n,e){var t;if(n.indent==="	")t="	";else if(typeof n.indent=="number"&&n.indent>0)t=qr.call(Array(n.indent+1)," ");else return null;return{base:t,prev:qr.call(Array(e+1),t)}}function E0(n,e){if(n.length===0)return"";var t=`
`+e.prev+e.base;return t+qr.call(n,","+t)+`
`+e.prev}function mf(n,e){var t=S0(n),i=[];if(t){i.length=n.length;for(var r=0;r<n.length;r++)i[r]=Eo(n,r)?e(n[r],n):""}var s=typeof c_=="function"?c_(n):[],o;if(qu){o={};for(var a=0;a<s.length;a++)o["$"+s[a]]=s[a]}for(var l in n)Eo(n,l)&&(t&&String(Number(l))===l&&l<n.length||qu&&o["$"+l]instanceof Symbol||(tI.call(/[^\w$]/,l)?i.push(e(l,n)+": "+e(n[l],n)):i.push(l+": "+e(n[l],n))));if(typeof c_=="function")for(var u=0;u<s.length;u++)nI.call(n,s[u])&&i.push("["+e(s[u])+"]: "+e(n[s[u]],n));return i}var tb=Zx,bc=g6,Y6=C6,q6=tb("%TypeError%"),gf=tb("%WeakMap%",!0),_f=tb("%Map%",!0),K6=bc("WeakMap.prototype.get",!0),Z6=bc("WeakMap.prototype.set",!0),J6=bc("WeakMap.prototype.has",!0),Q6=bc("Map.prototype.get",!0),eW=bc("Map.prototype.set",!0),tW=bc("Map.prototype.has",!0),nb=function(n,e){for(var t=n,i;(i=t.next)!==null;t=i)if(i.key===e)return t.next=i.next,i.next=n.next,n.next=i,i},nW=function(n,e){var t=nb(n,e);return t&&t.value},iW=function(n,e,t){var i=nb(n,e);i?i.value=t:n.next={key:e,next:n.next,value:t}},rW=function(n,e){return!!nb(n,e)},sW=function(){var e,t,i,r={assert:function(s){if(!r.has(s))throw new q6("Side channel does not contain "+Y6(s))},get:function(s){if(gf&&s&&(typeof s=="object"||typeof s=="function")){if(e)return K6(e,s)}else if(_f){if(t)return Q6(t,s)}else if(i)return nW(i,s)},has:function(s){if(gf&&s&&(typeof s=="object"||typeof s=="function")){if(e)return J6(e,s)}else if(_f){if(t)return tW(t,s)}else if(i)return rW(i,s);return!1},set:function(s,o){gf&&s&&(typeof s=="object"||typeof s=="function")?(e||(e=new gf),Z6(e,s,o)):_f?(t||(t=new _f),eW(t,s,o)):(i||(i={key:{},next:null}),iW(i,s,o))}};return r},oW=String.prototype.replace,aW=/%20/g,d_={RFC1738:"RFC1738",RFC3986:"RFC3986"},ib={default:d_.RFC3986,formatters:{RFC1738:function(n){return oW.call(n,aW,"+")},RFC3986:function(n){return String(n)}},RFC1738:d_.RFC1738,RFC3986:d_.RFC3986},lW=ib,f_=Object.prototype.hasOwnProperty,ka=Array.isArray,Vr=function(){for(var n=[],e=0;e<256;++e)n.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return n}(),uW=function(e){for(;e.length>1;){var t=e.pop(),i=t.obj[t.prop];if(ka(i)){for(var r=[],s=0;s<i.length;++s)typeof i[s]<"u"&&r.push(i[s]);t.obj[t.prop]=r}}},aI=function(e,t){for(var i=t&&t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)typeof e[r]<"u"&&(i[r]=e[r]);return i},cW=function n(e,t,i){if(!t)return e;if(typeof t!="object"){if(ka(e))e.push(t);else if(e&&typeof e=="object")(i&&(i.plainObjects||i.allowPrototypes)||!f_.call(Object.prototype,t))&&(e[t]=!0);else return[e,t];return e}if(!e||typeof e!="object")return[e].concat(t);var r=e;return ka(e)&&!ka(t)&&(r=aI(e,i)),ka(e)&&ka(t)?(t.forEach(function(s,o){if(f_.call(e,o)){var a=e[o];a&&typeof a=="object"&&s&&typeof s=="object"?e[o]=n(a,s,i):e.push(s)}else e[o]=s}),e):Object.keys(t).reduce(function(s,o){var a=t[o];return f_.call(s,o)?s[o]=n(s[o],a,i):s[o]=a,s},r)},hW=function(e,t){return Object.keys(t).reduce(function(i,r){return i[r]=t[r],i},e)},dW=function(n,e,t){var i=n.replace(/\+/g," ");if(t==="iso-8859-1")return i.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(i)}catch{return i}},fW=function(e,t,i,r,s){if(e.length===0)return e;var o=e;if(typeof e=="symbol"?o=Symbol.prototype.toString.call(e):typeof e!="string"&&(o=String(e)),i==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(c){return"%26%23"+parseInt(c.slice(2),16)+"%3B"});for(var a="",l=0;l<o.length;++l){var u=o.charCodeAt(l);if(u===45||u===46||u===95||u===126||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||s===lW.RFC1738&&(u===40||u===41)){a+=o.charAt(l);continue}if(u<128){a=a+Vr[u];continue}if(u<2048){a=a+(Vr[192|u>>6]+Vr[128|u&63]);continue}if(u<55296||u>=57344){a=a+(Vr[224|u>>12]+Vr[128|u>>6&63]+Vr[128|u&63]);continue}l+=1,u=65536+((u&1023)<<10|o.charCodeAt(l)&1023),a+=Vr[240|u>>18]+Vr[128|u>>12&63]+Vr[128|u>>6&63]+Vr[128|u&63]}return a},pW=function(e){for(var t=[{obj:{o:e},prop:"o"}],i=[],r=0;r<t.length;++r)for(var s=t[r],o=s.obj[s.prop],a=Object.keys(o),l=0;l<a.length;++l){var u=a[l],c=o[u];typeof c=="object"&&c!==null&&i.indexOf(c)===-1&&(t.push({obj:o,prop:u}),i.push(c))}return uW(t),e},mW=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},gW=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},_W=function(e,t){return[].concat(e,t)},vW=function(e,t){if(ka(e)){for(var i=[],r=0;r<e.length;r+=1)i.push(t(e[r]));return i}return t(e)},lI={arrayToObject:aI,assign:hW,combine:_W,compact:pW,decode:dW,encode:fW,isBuffer:gW,isRegExp:mW,maybeMap:vW,merge:cW},uI=sW,wp=lI,Oh=ib,yW=Object.prototype.hasOwnProperty,$T={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},Os=Array.isArray,xW=Array.prototype.push,cI=function(n,e){xW.apply(n,Os(e)?e:[e])},bW=Date.prototype.toISOString,YT=Oh.default,qn={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:wp.encode,encodeValuesOnly:!1,format:YT,formatter:Oh.formatters[YT],indices:!1,serializeDate:function(e){return bW.call(e)},skipNulls:!1,strictNullHandling:!1},SW=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},p_={},EW=function n(e,t,i,r,s,o,a,l,u,c,h,d,f,p,_,m){for(var g=e,v=m,y=0,x=!1;(v=v.get(p_))!==void 0&&!x;){var b=v.get(e);if(y+=1,typeof b<"u"){if(b===y)throw new RangeError("Cyclic object value");x=!0}typeof v.get(p_)>"u"&&(y=0)}if(typeof l=="function"?g=l(t,g):g instanceof Date?g=h(g):i==="comma"&&Os(g)&&(g=wp.maybeMap(g,function(W){return W instanceof Date?h(W):W})),g===null){if(s)return a&&!p?a(t,qn.encoder,_,"key",d):t;g=""}if(SW(g)||wp.isBuffer(g)){if(a){var S=p?t:a(t,qn.encoder,_,"key",d);return[f(S)+"="+f(a(g,qn.encoder,_,"value",d))]}return[f(t)+"="+f(String(g))]}var T=[];if(typeof g>"u")return T;var P;if(i==="comma"&&Os(g))p&&a&&(g=wp.maybeMap(g,a)),P=[{value:g.length>0?g.join(",")||null:void 0}];else if(Os(l))P=l;else{var E=Object.keys(g);P=u?E.sort(u):E}for(var M=r&&Os(g)&&g.length===1?t+"[]":t,O=0;O<P.length;++O){var L=P[O],C=typeof L=="object"&&typeof L.value<"u"?L.value:g[L];if(!(o&&C===null)){var D=Os(g)?typeof i=="function"?i(M,L):M:M+(c?"."+L:"["+L+"]");m.set(e,y);var B=uI();B.set(p_,m),cI(T,n(C,D,i,r,s,o,i==="comma"&&p&&Os(g)?null:a,l,u,c,h,d,f,p,_,B))}}return T},TW=function(e){if(!e)return qn;if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var t=e.charset||qn.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var i=Oh.default;if(typeof e.format<"u"){if(!yW.call(Oh.formatters,e.format))throw new TypeError("Unknown format option provided.");i=e.format}var r=Oh.formatters[i],s=qn.filter;return(typeof e.filter=="function"||Os(e.filter))&&(s=e.filter),{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:qn.addQueryPrefix,allowDots:typeof e.allowDots>"u"?qn.allowDots:!!e.allowDots,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:qn.charsetSentinel,delimiter:typeof e.delimiter>"u"?qn.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:qn.encode,encoder:typeof e.encoder=="function"?e.encoder:qn.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:qn.encodeValuesOnly,filter:s,format:i,formatter:r,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:qn.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:qn.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:qn.strictNullHandling}},MW=function(n,e){var t=n,i=TW(e),r,s;typeof i.filter=="function"?(s=i.filter,t=s("",t)):Os(i.filter)&&(s=i.filter,r=s);var o=[];if(typeof t!="object"||t===null)return"";var a;e&&e.arrayFormat in $T?a=e.arrayFormat:e&&"indices"in e?a=e.indices?"indices":"repeat":a="indices";var l=$T[a];if(e&&"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var u=l==="comma"&&e&&e.commaRoundTrip;r||(r=Object.keys(t)),i.sort&&r.sort(i.sort);for(var c=uI(),h=0;h<r.length;++h){var d=r[h];i.skipNulls&&t[d]===null||cI(o,EW(t[d],d,l,u,i.strictNullHandling,i.skipNulls,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.format,i.formatter,i.encodeValuesOnly,i.charset,c))}var f=o.join(i.delimiter),p=i.addQueryPrefix===!0?"?":"";return i.charsetSentinel&&(i.charset==="iso-8859-1"?p+="utf8=%26%2310003%3B&":p+="utf8=%E2%9C%93&"),f.length>0?p+f:""},Ku=lI,T0=Object.prototype.hasOwnProperty,wW=Array.isArray,In={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:Ku.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},AW=function(n){return n.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(parseInt(t,10))})},hI=function(n,e){return n&&typeof n=="string"&&e.comma&&n.indexOf(",")>-1?n.split(","):n},PW="utf8=%26%2310003%3B",CW="utf8=%E2%9C%93",RW=function(e,t){var i={__proto__:null},r=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,s=t.parameterLimit===1/0?void 0:t.parameterLimit,o=r.split(t.delimiter,s),a=-1,l,u=t.charset;if(t.charsetSentinel)for(l=0;l<o.length;++l)o[l].indexOf("utf8=")===0&&(o[l]===CW?u="utf-8":o[l]===PW&&(u="iso-8859-1"),a=l,l=o.length);for(l=0;l<o.length;++l)if(l!==a){var c=o[l],h=c.indexOf("]="),d=h===-1?c.indexOf("="):h+1,f,p;d===-1?(f=t.decoder(c,In.decoder,u,"key"),p=t.strictNullHandling?null:""):(f=t.decoder(c.slice(0,d),In.decoder,u,"key"),p=Ku.maybeMap(hI(c.slice(d+1),t),function(_){return t.decoder(_,In.decoder,u,"value")})),p&&t.interpretNumericEntities&&u==="iso-8859-1"&&(p=AW(p)),c.indexOf("[]=")>-1&&(p=wW(p)?[p]:p),T0.call(i,f)?i[f]=Ku.combine(i[f],p):i[f]=p}return i},IW=function(n,e,t,i){for(var r=i?e:hI(e,t),s=n.length-1;s>=0;--s){var o,a=n[s];if(a==="[]"&&t.parseArrays)o=[].concat(r);else{o=t.plainObjects?Object.create(null):{};var l=a.charAt(0)==="["&&a.charAt(a.length-1)==="]"?a.slice(1,-1):a,u=parseInt(l,10);!t.parseArrays&&l===""?o={0:r}:!isNaN(u)&&a!==l&&String(u)===l&&u>=0&&t.parseArrays&&u<=t.arrayLimit?(o=[],o[u]=r):l!=="__proto__"&&(o[l]=r)}r=o}return r},LW=function(e,t,i,r){if(e){var s=i.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,o=/(\[[^[\]]*])/,a=/(\[[^[\]]*])/g,l=i.depth>0&&o.exec(s),u=l?s.slice(0,l.index):s,c=[];if(u){if(!i.plainObjects&&T0.call(Object.prototype,u)&&!i.allowPrototypes)return;c.push(u)}for(var h=0;i.depth>0&&(l=a.exec(s))!==null&&h<i.depth;){if(h+=1,!i.plainObjects&&T0.call(Object.prototype,l[1].slice(1,-1))&&!i.allowPrototypes)return;c.push(l[1])}return l&&c.push("["+s.slice(l.index)+"]"),IW(c,t,i,r)}},OW=function(e){if(!e)return In;if(e.decoder!==null&&e.decoder!==void 0&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var t=typeof e.charset>"u"?In.charset:e.charset;return{allowDots:typeof e.allowDots>"u"?In.allowDots:!!e.allowDots,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:In.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:In.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:In.arrayLimit,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:In.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:In.comma,decoder:typeof e.decoder=="function"?e.decoder:In.decoder,delimiter:typeof e.delimiter=="string"||Ku.isRegExp(e.delimiter)?e.delimiter:In.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:In.depth,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:In.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:In.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:In.plainObjects,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:In.strictNullHandling}},DW=function(n,e){var t=OW(e);if(n===""||n===null||typeof n>"u")return t.plainObjects?Object.create(null):{};for(var i=typeof n=="string"?RW(n,t):n,r=t.plainObjects?Object.create(null):{},s=Object.keys(i),o=0;o<s.length;++o){var a=s[o],l=LW(a,i[a],t,typeof n=="string");r=Ku.merge(r,l,t)}return t.allowSparse===!0?r:Ku.compact(r)},FW=MW,NW=DW,UW=ib,BW={formats:UW,parse:NW,stringify:FW},kW=z8;function Cr(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var VW=/^([a-z0-9.+-]+:)/i,GW=/:[0-9]*$/,HW=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,zW=["<",">",'"',"`"," ","\r",`
`,"	"],WW=["{","}","|","\\","^","`"].concat(zW),M0=["'"].concat(WW),qT=["%","/","?",";","#"].concat(M0),KT=["/","?","#"],XW=255,ZT=/^[+a-z0-9A-Z_-]{0,63}$/,jW=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,$W={javascript:!0,"javascript:":!0},w0={javascript:!0,"javascript:":!0},Au={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},A0=BW;function ig(n,e,t){if(n&&typeof n=="object"&&n instanceof Cr)return n;var i=new Cr;return i.parse(n,e,t),i}Cr.prototype.parse=function(n,e,t){if(typeof n!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof n);var i=n.indexOf("?"),r=i!==-1&&i<n.indexOf("#")?"?":"#",s=n.split(r),o=/\\/g;s[0]=s[0].replace(o,"/"),n=s.join(r);var a=n;if(a=a.trim(),!t&&n.split("#").length===1){var l=HW.exec(a);if(l)return this.path=a,this.href=a,this.pathname=l[1],l[2]?(this.search=l[2],e?this.query=A0.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var u=VW.exec(a);if(u){u=u[0];var c=u.toLowerCase();this.protocol=c,a=a.substr(u.length)}if(t||u||a.match(/^\/\/[^@/]+@[^@/]+/)){var h=a.substr(0,2)==="//";h&&!(u&&w0[u])&&(a=a.substr(2),this.slashes=!0)}if(!w0[u]&&(h||u&&!Au[u])){for(var d=-1,f=0;f<KT.length;f++){var p=a.indexOf(KT[f]);p!==-1&&(d===-1||p<d)&&(d=p)}var _,m;d===-1?m=a.lastIndexOf("@"):m=a.lastIndexOf("@",d),m!==-1&&(_=a.slice(0,m),a=a.slice(m+1),this.auth=decodeURIComponent(_)),d=-1;for(var f=0;f<qT.length;f++){var p=a.indexOf(qT[f]);p!==-1&&(d===-1||p<d)&&(d=p)}d===-1&&(d=a.length),this.host=a.slice(0,d),a=a.slice(d),this.parseHost(),this.hostname=this.hostname||"";var g=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!g)for(var v=this.hostname.split(/\./),f=0,y=v.length;f<y;f++){var x=v[f];if(x&&!x.match(ZT)){for(var b="",S=0,T=x.length;S<T;S++)x.charCodeAt(S)>127?b+="x":b+=x[S];if(!b.match(ZT)){var P=v.slice(0,f),E=v.slice(f+1),M=x.match(jW);M&&(P.push(M[1]),E.unshift(M[2])),E.length&&(a="/"+E.join(".")+a),this.hostname=P.join(".");break}}}this.hostname.length>XW?this.hostname="":this.hostname=this.hostname.toLowerCase(),g||(this.hostname=kW.toASCII(this.hostname));var O=this.port?":"+this.port:"",L=this.hostname||"";this.host=L+O,this.href+=this.host,g&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!$W[c])for(var f=0,y=M0.length;f<y;f++){var C=M0[f];if(a.indexOf(C)!==-1){var D=encodeURIComponent(C);D===C&&(D=escape(C)),a=a.split(C).join(D)}}var B=a.indexOf("#");B!==-1&&(this.hash=a.substr(B),a=a.slice(0,B));var W=a.indexOf("?");if(W!==-1?(this.search=a.substr(W),this.query=a.substr(W+1),e&&(this.query=A0.parse(this.query)),a=a.slice(0,W)):e&&(this.search="",this.query={}),a&&(this.pathname=a),Au[c]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var O=this.pathname||"",U=this.search||"";this.path=O+U}return this.href=this.format(),this};function YW(n){return typeof n=="string"&&(n=ig(n)),n instanceof Cr?n.format():Cr.prototype.format.call(n)}Cr.prototype.format=function(){var n=this.auth||"";n&&(n=encodeURIComponent(n),n=n.replace(/%3A/i,":"),n+="@");var e=this.protocol||"",t=this.pathname||"",i=this.hash||"",r=!1,s="";this.host?r=n+this.host:this.hostname&&(r=n+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(s=A0.stringify(this.query));var o=this.search||s&&"?"+s||"";return e&&e.substr(-1)!==":"&&(e+=":"),this.slashes||(!e||Au[e])&&r!==!1?(r="//"+(r||""),t&&t.charAt(0)!=="/"&&(t="/"+t)):r||(r=""),i&&i.charAt(0)!=="#"&&(i="#"+i),o&&o.charAt(0)!=="?"&&(o="?"+o),t=t.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),e+r+t+o+i};function qW(n,e){return ig(n,!1,!0).resolve(e)}Cr.prototype.resolve=function(n){return this.resolveObject(ig(n,!1,!0)).format()};Cr.prototype.resolveObject=function(n){if(typeof n=="string"){var e=new Cr;e.parse(n,!1,!0),n=e}for(var t=new Cr,i=Object.keys(this),r=0;r<i.length;r++){var s=i[r];t[s]=this[s]}if(t.hash=n.hash,n.href==="")return t.href=t.format(),t;if(n.slashes&&!n.protocol){for(var o=Object.keys(n),a=0;a<o.length;a++){var l=o[a];l!=="protocol"&&(t[l]=n[l])}return Au[t.protocol]&&t.hostname&&!t.pathname&&(t.pathname="/",t.path=t.pathname),t.href=t.format(),t}if(n.protocol&&n.protocol!==t.protocol){if(!Au[n.protocol]){for(var u=Object.keys(n),c=0;c<u.length;c++){var h=u[c];t[h]=n[h]}return t.href=t.format(),t}if(t.protocol=n.protocol,!n.host&&!w0[n.protocol]){for(var y=(n.pathname||"").split("/");y.length&&!(n.host=y.shift()););n.host||(n.host=""),n.hostname||(n.hostname=""),y[0]!==""&&y.unshift(""),y.length<2&&y.unshift(""),t.pathname=y.join("/")}else t.pathname=n.pathname;if(t.search=n.search,t.query=n.query,t.host=n.host||"",t.auth=n.auth,t.hostname=n.hostname||n.host,t.port=n.port,t.pathname||t.search){var d=t.pathname||"",f=t.search||"";t.path=d+f}return t.slashes=t.slashes||n.slashes,t.href=t.format(),t}var p=t.pathname&&t.pathname.charAt(0)==="/",_=n.host||n.pathname&&n.pathname.charAt(0)==="/",m=_||p||t.host&&n.pathname,g=m,v=t.pathname&&t.pathname.split("/")||[],y=n.pathname&&n.pathname.split("/")||[],x=t.protocol&&!Au[t.protocol];if(x&&(t.hostname="",t.port=null,t.host&&(v[0]===""?v[0]=t.host:v.unshift(t.host)),t.host="",n.protocol&&(n.hostname=null,n.port=null,n.host&&(y[0]===""?y[0]=n.host:y.unshift(n.host)),n.host=null),m=m&&(y[0]===""||v[0]==="")),_)t.host=n.host||n.host===""?n.host:t.host,t.hostname=n.hostname||n.hostname===""?n.hostname:t.hostname,t.search=n.search,t.query=n.query,v=y;else if(y.length)v||(v=[]),v.pop(),v=v.concat(y),t.search=n.search,t.query=n.query;else if(n.search!=null){if(x){t.host=v.shift(),t.hostname=t.host;var b=t.host&&t.host.indexOf("@")>0?t.host.split("@"):!1;b&&(t.auth=b.shift(),t.hostname=b.shift(),t.host=t.hostname)}return t.search=n.search,t.query=n.query,(t.pathname!==null||t.search!==null)&&(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.href=t.format(),t}if(!v.length)return t.pathname=null,t.search?t.path="/"+t.search:t.path=null,t.href=t.format(),t;for(var S=v.slice(-1)[0],T=(t.host||n.host||v.length>1)&&(S==="."||S==="..")||S==="",P=0,E=v.length;E>=0;E--)S=v[E],S==="."?v.splice(E,1):S===".."?(v.splice(E,1),P++):P&&(v.splice(E,1),P--);if(!m&&!g)for(;P--;P)v.unshift("..");m&&v[0]!==""&&(!v[0]||v[0].charAt(0)!=="/")&&v.unshift(""),T&&v.join("/").substr(-1)!=="/"&&v.push("");var M=v[0]===""||v[0]&&v[0].charAt(0)==="/";if(x){t.hostname=M?"":v.length?v.shift():"",t.host=t.hostname;var b=t.host&&t.host.indexOf("@")>0?t.host.split("@"):!1;b&&(t.auth=b.shift(),t.hostname=b.shift(),t.host=t.hostname)}return m=m||t.host&&v.length,m&&!M&&v.unshift(""),v.length>0?t.pathname=v.join("/"):(t.pathname=null,t.path=null),(t.pathname!==null||t.search!==null)&&(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.auth=n.auth||t.auth,t.slashes=t.slashes||n.slashes,t.href=t.format(),t};Cr.prototype.parseHost=function(){var n=this.host,e=GW.exec(n);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),n=n.substr(0,n.length-e.length)),n&&(this.hostname=n)};var KW=ig,ZW=qW,JW=YW;/*!
 * @pixi/utils - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Ci={parse:KW,format:JW,resolve:ZW};function hr(n){if(typeof n!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(n))}function JT(n){var e=n.split("?")[0];return e.split("#")[0]}function QW(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function eX(n,e,t){return n.replace(new RegExp(QW(e),"g"),t)}function tX(n,e){for(var t="",i=0,r=-1,s=0,o,a=0;a<=n.length;++a){if(a<n.length)o=n.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(r===a-1||s===1))if(r!==a-1&&s===2){if(t.length<2||i!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){var l=t.lastIndexOf("/");if(l!==t.length-1){l===-1?(t="",i=0):(t=t.slice(0,l),i=t.length-1-t.lastIndexOf("/")),r=a,s=0;continue}}else if(t.length===2||t.length===1){t="",i=0,r=a,s=0;continue}}e&&(t.length>0?t+="/..":t="..",i=2)}else t.length>0?t+="/"+n.slice(r+1,a):t=n.slice(r+1,a),i=a-r-1;r=a,s=0}else o===46&&s!==-1?++s:s=-1}return t}var dI={toPosix:function(n){return eX(n,"\\","/")},isUrl:function(n){return/^https?:/.test(this.toPosix(n))},isDataUrl:function(n){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(n)},hasProtocol:function(n){return/^[^/:]+:\//.test(this.toPosix(n))},getProtocol:function(n){hr(n),n=this.toPosix(n);var e="",t=/^file:\/\/\//.exec(n),i=/^[^/:]+:\/\//.exec(n),r=/^[^/:]+:\//.exec(n);if(t||i||r){var s=(t==null?void 0:t[0])||(i==null?void 0:i[0])||(r==null?void 0:r[0]);e=s,n=n.slice(s.length)}return e},toAbsolute:function(n,e,t){if(this.isDataUrl(n))return n;var i=JT(this.toPosix(e??Oe.ADAPTER.getBaseUrl())),r=JT(this.toPosix(t??this.rootname(i)));if(hr(n),n=this.toPosix(n),n.startsWith("/"))return dI.join(r,n.slice(1));var s=this.isAbsolute(n)?n:this.join(i,n);return s},normalize:function(n){if(n=this.toPosix(n),hr(n),n.length===0)return".";var e="",t=n.startsWith("/");this.hasProtocol(n)&&(e=this.rootname(n),n=n.slice(e.length));var i=n.endsWith("/");return n=tX(n,!1),n.length>0&&i&&(n+="/"),t?"/"+n:e+n},isAbsolute:function(n){return hr(n),n=this.toPosix(n),this.hasProtocol(n)?!0:n.startsWith("/")},join:function(){for(var n=arguments,e,t=[],i=0;i<arguments.length;i++)t[i]=n[i];if(t.length===0)return".";for(var r,s=0;s<t.length;++s){var o=t[s];if(hr(o),o.length>0)if(r===void 0)r=o;else{var a=(e=t[s-1])!==null&&e!==void 0?e:"";this.extname(a)?r+="/../"+o:r+="/"+o}}return r===void 0?".":this.normalize(r)},dirname:function(n){if(hr(n),n.length===0)return".";n=this.toPosix(n);var e=n.charCodeAt(0),t=e===47,i=-1,r=!0,s=this.getProtocol(n),o=n;n=n.slice(s.length);for(var a=n.length-1;a>=1;--a)if(e=n.charCodeAt(a),e===47){if(!r){i=a;break}}else r=!1;return i===-1?t?"/":this.isUrl(o)?s+n:s:t&&i===1?"//":s+n.slice(0,i)},rootname:function(n){hr(n),n=this.toPosix(n);var e="";if(n.startsWith("/")?e="/":e=this.getProtocol(n),this.isUrl(n)){var t=n.indexOf("/",e.length);t!==-1?e=n.slice(0,t):e=n,e.endsWith("/")||(e+="/")}return e},basename:function(n,e){hr(n),e&&hr(e),n=this.toPosix(n);var t=0,i=-1,r=!0,s;if(e!==void 0&&e.length>0&&e.length<=n.length){if(e.length===n.length&&e===n)return"";var o=e.length-1,a=-1;for(s=n.length-1;s>=0;--s){var l=n.charCodeAt(s);if(l===47){if(!r){t=s+1;break}}else a===-1&&(r=!1,a=s+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(i=s):(o=-1,i=a))}return t===i?i=a:i===-1&&(i=n.length),n.slice(t,i)}for(s=n.length-1;s>=0;--s)if(n.charCodeAt(s)===47){if(!r){t=s+1;break}}else i===-1&&(r=!1,i=s+1);return i===-1?"":n.slice(t,i)},extname:function(n){hr(n),n=this.toPosix(n);for(var e=-1,t=0,i=-1,r=!0,s=0,o=n.length-1;o>=0;--o){var a=n.charCodeAt(o);if(a===47){if(!r){t=o+1;break}continue}i===-1&&(r=!1,i=o+1),a===46?e===-1?e=o:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||i===-1||s===0||s===1&&e===i-1&&e===t+1?"":n.slice(e,i)},parse:function(n){hr(n);var e={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return e;n=this.toPosix(n);var t=n.charCodeAt(0),i=this.isAbsolute(n),r;e.root=this.rootname(n),i||this.hasProtocol(n)?r=1:r=0;for(var s=-1,o=0,a=-1,l=!0,u=n.length-1,c=0;u>=r;--u){if(t=n.charCodeAt(u),t===47){if(!l){o=u+1;break}continue}a===-1&&(l=!1,a=u+1),t===46?s===-1?s=u:c!==1&&(c=1):s!==-1&&(c=-1)}return s===-1||a===-1||c===0||c===1&&s===a-1&&s===o+1?a!==-1&&(o===0&&i?e.base=e.name=n.slice(1,a):e.base=e.name=n.slice(o,a)):(o===0&&i?(e.name=n.slice(1,s),e.base=n.slice(1,a)):(e.name=n.slice(o,s),e.base=n.slice(o,a)),e.ext=n.slice(s,a)),e.dir=this.dirname(n),e},sep:"/",delimiter:":"};Oe.RETINA_PREFIX=/@([0-9\.]+)x/;Oe.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var P0=!1,QT="6.5.10";function nX(){P0=!0}function fI(n){var e;if(!P0){if(Oe.ADAPTER.getNavigator().userAgent.toLowerCase().indexOf("chrome")>-1){var t=[`
 %c %c %c PixiJS `+QT+" - ✰ "+n+` ✰  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ 

`,"background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(e=globalThis.console).log.apply(e,t)}else globalThis.console&&globalThis.console.log("PixiJS "+QT+" - "+n+" - http://www.pixijs.com/");P0=!0}}var m_;function pI(){return typeof m_>"u"&&(m_=function(){var e={stencil:!0,failIfMajorPerformanceCaveat:Oe.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!Oe.ADAPTER.getWebGLRenderingContext())return!1;var t=Oe.ADAPTER.createCanvas(),i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),r=!!(i&&i.getContextAttributes().stencil);if(i){var s=i.getExtension("WEBGL_lose_context");s&&s.loseContext()}return i=null,r}catch{return!1}}()),m_}var iX="#f0f8ff",rX="#faebd7",sX="#00ffff",oX="#7fffd4",aX="#f0ffff",lX="#f5f5dc",uX="#ffe4c4",cX="#000000",hX="#ffebcd",dX="#0000ff",fX="#8a2be2",pX="#a52a2a",mX="#deb887",gX="#5f9ea0",_X="#7fff00",vX="#d2691e",yX="#ff7f50",xX="#6495ed",bX="#fff8dc",SX="#dc143c",EX="#00ffff",TX="#00008b",MX="#008b8b",wX="#b8860b",AX="#a9a9a9",PX="#006400",CX="#a9a9a9",RX="#bdb76b",IX="#8b008b",LX="#556b2f",OX="#ff8c00",DX="#9932cc",FX="#8b0000",NX="#e9967a",UX="#8fbc8f",BX="#483d8b",kX="#2f4f4f",VX="#2f4f4f",GX="#00ced1",HX="#9400d3",zX="#ff1493",WX="#00bfff",XX="#696969",jX="#696969",$X="#1e90ff",YX="#b22222",qX="#fffaf0",KX="#228b22",ZX="#ff00ff",JX="#dcdcdc",QX="#f8f8ff",ej="#daa520",tj="#ffd700",nj="#808080",ij="#008000",rj="#adff2f",sj="#808080",oj="#f0fff0",aj="#ff69b4",lj="#cd5c5c",uj="#4b0082",cj="#fffff0",hj="#f0e68c",dj="#fff0f5",fj="#e6e6fa",pj="#7cfc00",mj="#fffacd",gj="#add8e6",_j="#f08080",vj="#e0ffff",yj="#fafad2",xj="#d3d3d3",bj="#90ee90",Sj="#d3d3d3",Ej="#ffb6c1",Tj="#ffa07a",Mj="#20b2aa",wj="#87cefa",Aj="#778899",Pj="#778899",Cj="#b0c4de",Rj="#ffffe0",Ij="#00ff00",Lj="#32cd32",Oj="#faf0e6",Dj="#ff00ff",Fj="#800000",Nj="#66cdaa",Uj="#0000cd",Bj="#ba55d3",kj="#9370db",Vj="#3cb371",Gj="#7b68ee",Hj="#00fa9a",zj="#48d1cc",Wj="#c71585",Xj="#191970",jj="#f5fffa",$j="#ffe4e1",Yj="#ffe4b5",qj="#ffdead",Kj="#000080",Zj="#fdf5e6",Jj="#808000",Qj="#6b8e23",e$="#ffa500",t$="#ff4500",n$="#da70d6",i$="#eee8aa",r$="#98fb98",s$="#afeeee",o$="#db7093",a$="#ffefd5",l$="#ffdab9",u$="#cd853f",c$="#ffc0cb",h$="#dda0dd",d$="#b0e0e6",f$="#800080",p$="#663399",m$="#ff0000",g$="#bc8f8f",_$="#4169e1",v$="#8b4513",y$="#fa8072",x$="#f4a460",b$="#2e8b57",S$="#fff5ee",E$="#a0522d",T$="#c0c0c0",M$="#87ceeb",w$="#6a5acd",A$="#708090",P$="#708090",C$="#fffafa",R$="#00ff7f",I$="#4682b4",L$="#d2b48c",O$="#008080",D$="#d8bfd8",F$="#ff6347",N$="#40e0d0",U$="#ee82ee",B$="#f5deb3",k$="#ffffff",V$="#f5f5f5",G$="#ffff00",H$="#9acd32",z$={aliceblue:iX,antiquewhite:rX,aqua:sX,aquamarine:oX,azure:aX,beige:lX,bisque:uX,black:cX,blanchedalmond:hX,blue:dX,blueviolet:fX,brown:pX,burlywood:mX,cadetblue:gX,chartreuse:_X,chocolate:vX,coral:yX,cornflowerblue:xX,cornsilk:bX,crimson:SX,cyan:EX,darkblue:TX,darkcyan:MX,darkgoldenrod:wX,darkgray:AX,darkgreen:PX,darkgrey:CX,darkkhaki:RX,darkmagenta:IX,darkolivegreen:LX,darkorange:OX,darkorchid:DX,darkred:FX,darksalmon:NX,darkseagreen:UX,darkslateblue:BX,darkslategray:kX,darkslategrey:VX,darkturquoise:GX,darkviolet:HX,deeppink:zX,deepskyblue:WX,dimgray:XX,dimgrey:jX,dodgerblue:$X,firebrick:YX,floralwhite:qX,forestgreen:KX,fuchsia:ZX,gainsboro:JX,ghostwhite:QX,goldenrod:ej,gold:tj,gray:nj,green:ij,greenyellow:rj,grey:sj,honeydew:oj,hotpink:aj,indianred:lj,indigo:uj,ivory:cj,khaki:hj,lavenderblush:dj,lavender:fj,lawngreen:pj,lemonchiffon:mj,lightblue:gj,lightcoral:_j,lightcyan:vj,lightgoldenrodyellow:yj,lightgray:xj,lightgreen:bj,lightgrey:Sj,lightpink:Ej,lightsalmon:Tj,lightseagreen:Mj,lightskyblue:wj,lightslategray:Aj,lightslategrey:Pj,lightsteelblue:Cj,lightyellow:Rj,lime:Ij,limegreen:Lj,linen:Oj,magenta:Dj,maroon:Fj,mediumaquamarine:Nj,mediumblue:Uj,mediumorchid:Bj,mediumpurple:kj,mediumseagreen:Vj,mediumslateblue:Gj,mediumspringgreen:Hj,mediumturquoise:zj,mediumvioletred:Wj,midnightblue:Xj,mintcream:jj,mistyrose:$j,moccasin:Yj,navajowhite:qj,navy:Kj,oldlace:Zj,olive:Jj,olivedrab:Qj,orange:e$,orangered:t$,orchid:n$,palegoldenrod:i$,palegreen:r$,paleturquoise:s$,palevioletred:o$,papayawhip:a$,peachpuff:l$,peru:u$,pink:c$,plum:h$,powderblue:d$,purple:f$,rebeccapurple:p$,red:m$,rosybrown:g$,royalblue:_$,saddlebrown:v$,salmon:y$,sandybrown:x$,seagreen:b$,seashell:S$,sienna:E$,silver:T$,skyblue:M$,slateblue:w$,slategray:A$,slategrey:P$,snow:C$,springgreen:R$,steelblue:I$,tan:L$,teal:O$,thistle:D$,tomato:F$,turquoise:N$,violet:U$,wheat:B$,white:k$,whitesmoke:V$,yellow:G$,yellowgreen:H$};function hl(n,e){return e===void 0&&(e=[]),e[0]=(n>>16&255)/255,e[1]=(n>>8&255)/255,e[2]=(n&255)/255,e}function rb(n){var e=n.toString(16);return e="000000".substring(0,6-e.length)+e,"#"+e}function sb(n){return typeof n=="string"&&(n=z$[n.toLowerCase()]||n,n[0]==="#"&&(n=n.slice(1))),parseInt(n,16)}function W$(n){return(n[0]*255<<16)+(n[1]*255<<8)+(n[2]*255|0)}function X$(){for(var n=[],e=[],t=0;t<32;t++)n[t]=t,e[t]=t;n[He.NORMAL_NPM]=He.NORMAL,n[He.ADD_NPM]=He.ADD,n[He.SCREEN_NPM]=He.SCREEN,e[He.NORMAL]=He.NORMAL_NPM,e[He.ADD]=He.ADD_NPM,e[He.SCREEN]=He.SCREEN_NPM;var i=[];return i.push(e),i.push(n),i}var ob=X$();function ab(n,e){return ob[e?1:0][n]}function mI(n,e,t,i){return t=t||new Float32Array(4),i||i===void 0?(t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e):(t[0]=n[0],t[1]=n[1],t[2]=n[2]),t[3]=e,t}function rg(n,e){if(e===1)return(e*255<<24)+n;if(e===0)return 0;var t=n>>16&255,i=n>>8&255,r=n&255;return t=t*e+.5|0,i=i*e+.5|0,r=r*e+.5|0,(e*255<<24)+(t<<16)+(i<<8)+r}function lb(n,e,t,i){return t=t||new Float32Array(4),t[0]=(n>>16&255)/255,t[1]=(n>>8&255)/255,t[2]=(n&255)/255,(i||i===void 0)&&(t[0]*=e,t[1]*=e,t[2]*=e),t[3]=e,t}function gI(n,e){e===void 0&&(e=null);var t=n*6;if(e=e||new Uint16Array(t),e.length!==t)throw new Error("Out buffer length is incorrect, got "+e.length+" and expected "+t);for(var i=0,r=0;i<t;i+=6,r+=4)e[i+0]=r+0,e[i+1]=r+1,e[i+2]=r+2,e[i+3]=r+0,e[i+4]=r+2,e[i+5]=r+3;return e}function sg(n){if(n.BYTES_PER_ELEMENT===4)return n instanceof Float32Array?"Float32Array":n instanceof Uint32Array?"Uint32Array":"Int32Array";if(n.BYTES_PER_ELEMENT===2){if(n instanceof Uint16Array)return"Uint16Array"}else if(n.BYTES_PER_ELEMENT===1&&n instanceof Uint8Array)return"Uint8Array";return null}var j$={Float32Array,Uint32Array,Int32Array,Uint8Array};function $$(n,e){for(var t=0,i=0,r={},s=0;s<n.length;s++)i+=e[s],t+=n[s].length;for(var o=new ArrayBuffer(t*4),a=null,l=0,s=0;s<n.length;s++){var u=e[s],c=n[s],h=sg(c);r[h]||(r[h]=new j$[h](o)),a=r[h];for(var d=0;d<c.length;d++){var f=(d/u|0)*i+l,p=d%u;a[f+p]=c[d]}l+=u}return new Float32Array(o)}function ld(n){return n+=n===0?1:0,--n,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n+1}function C0(n){return!(n&n-1)&&!!n}function R0(n){var e=(n>65535?1:0)<<4;n>>>=e;var t=(n>255?1:0)<<3;return n>>>=t,e|=t,t=(n>15?1:0)<<2,n>>>=t,e|=t,t=(n>3?1:0)<<1,n>>>=t,e|=t,e|n>>1}function il(n,e,t){var i=n.length,r;if(!(e>=i||t===0)){t=e+t>i?i-e:t;var s=i-t;for(r=e;r<s;++r)n[r]=n[r+t];n.length=s}}function ja(n){return n===0?0:n<0?-1:1}var Y$=0;function Ho(){return++Y$}var eM={};function ai(n,e,t){if(t===void 0&&(t=3),!eM[e]){var i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",e+`
Deprecated since v`+n):(i=i.split(`
`).splice(t).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",e+`
Deprecated since v`+n),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",e+`
Deprecated since v`+n),console.warn(i))),eM[e]=!0}}var I0={},pi=Object.create(null),zi=Object.create(null);function q$(){var n;for(n in pi)pi[n].destroy();for(n in zi)zi[n].destroy()}function K$(){var n;for(n in pi)delete pi[n];for(n in zi)delete zi[n]}var L0=function(){function n(e,t,i){this.canvas=Oe.ADAPTER.createCanvas(),this.context=this.canvas.getContext("2d"),this.resolution=i||Oe.RESOLUTION,this.resize(e,t)}return n.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},n.prototype.resize=function(e,t){this.canvas.width=Math.round(e*this.resolution),this.canvas.height=Math.round(t*this.resolution)},n.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(n.prototype,"width",{get:function(){return this.canvas.width},set:function(e){this.canvas.width=Math.round(e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.canvas.height},set:function(e){this.canvas.height=Math.round(e)},enumerable:!1,configurable:!0}),n}();function _I(n){var e=n.width,t=n.height,i=n.getContext("2d",{willReadFrequently:!0}),r=i.getImageData(0,0,e,t),s=r.data,o=s.length,a={top:null,left:null,right:null,bottom:null},l=null,u,c,h;for(u=0;u<o;u+=4)s[u+3]!==0&&(c=u/4%e,h=~~(u/4/e),a.top===null&&(a.top=h),(a.left===null||c<a.left)&&(a.left=c),(a.right===null||a.right<c)&&(a.right=c+1),(a.bottom===null||a.bottom<h)&&(a.bottom=h));return a.top!==null&&(e=a.right-a.left,t=a.bottom-a.top+1,l=i.getImageData(a.left,a.top,e,t)),{height:t,width:e,data:l}}var vI=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function Z$(n){var e=vI.exec(n);if(e)return{mediaType:e[1]?e[1].toLowerCase():void 0,subType:e[2]?e[2].toLowerCase():void 0,charset:e[3]?e[3].toLowerCase():void 0,encoding:e[4]?e[4].toLowerCase():void 0,data:e[5]}}var vf;function yI(n,e){if(e===void 0&&(e=globalThis.location),n.indexOf("data:")===0)return"";e=e||globalThis.location,vf||(vf=document.createElement("a")),vf.href=n;var t=Ci.parse(vf.href),i=!t.port&&e.port===""||t.port===e.port;return t.hostname!==e.hostname||!i||t.protocol!==e.protocol?"anonymous":""}function ud(n,e){var t=Oe.RETINA_PREFIX.exec(n);return t?parseFloat(t[1]):e!==void 0?e:1}const J$=Object.freeze(Object.defineProperty({__proto__:null,BaseTextureCache:zi,CanvasRenderTarget:L0,DATA_URI:vI,EventEmitter:lr,ProgramCache:I0,TextureCache:pi,clearTextureCache:K$,correctBlendMode:ab,createIndicesForQuads:gI,decomposeDataUri:Z$,deprecation:ai,destroyTextureCache:q$,determineCrossOrigin:yI,earcut:qx,getBufferType:sg,getResolutionOfUrl:ud,hex2rgb:hl,hex2string:rb,interleaveTypedArrays:$$,isMobile:Qi,isPow2:C0,isWebGLSupported:pI,log2:R0,nextPow2:ld,path:dI,premultiplyBlendMode:ob,premultiplyRgba:mI,premultiplyTint:rg,premultiplyTintToRgba:lb,removeItems:il,rgb2hex:W$,sayHello:fI,sign:ja,skipHello:nX,string2hex:sb,trimCanvas:_I,uid:Ho,url:Ci},Symbol.toStringTag,{value:"Module"}));/*!
 * @pixi/math - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/math is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var cd=Math.PI*2,xI=180/Math.PI,bI=Math.PI/180,Tn;(function(n){n[n.POLY=0]="POLY",n[n.RECT=1]="RECT",n[n.CIRC=2]="CIRC",n[n.ELIP=3]="ELIP",n[n.RREC=4]="RREC"})(Tn||(Tn={}));var Bt=function(){function n(e,t){e===void 0&&(e=0),t===void 0&&(t=0),this.x=0,this.y=0,this.x=e,this.y=t}return n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.copyFrom=function(e){return this.set(e.x,e.y),this},n.prototype.copyTo=function(e){return e.set(this.x,this.y),e},n.prototype.equals=function(e){return e.x===this.x&&e.y===this.y},n.prototype.set=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=e),this.x=e,this.y=t,this},n.prototype.toString=function(){return"[@pixi/math:Point x="+this.x+" y="+this.y+"]"},n}(),yf=[new Bt,new Bt,new Bt,new Bt],St=function(){function n(e,t,i,r){e===void 0&&(e=0),t===void 0&&(t=0),i===void 0&&(i=0),r===void 0&&(r=0),this.x=Number(e),this.y=Number(t),this.width=Number(i),this.height=Number(r),this.type=Tn.RECT}return Object.defineProperty(n.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(n,"EMPTY",{get:function(){return new n(0,0,0,0)},enumerable:!1,configurable:!0}),n.prototype.clone=function(){return new n(this.x,this.y,this.width,this.height)},n.prototype.copyFrom=function(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this},n.prototype.copyTo=function(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e},n.prototype.contains=function(e,t){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height},n.prototype.intersects=function(e,t){if(!t){var i=this.x<e.x?e.x:this.x,r=this.right>e.right?e.right:this.right;if(r<=i)return!1;var s=this.y<e.y?e.y:this.y,o=this.bottom>e.bottom?e.bottom:this.bottom;return o>s}var a=this.left,l=this.right,u=this.top,c=this.bottom;if(l<=a||c<=u)return!1;var h=yf[0].set(e.left,e.top),d=yf[1].set(e.left,e.bottom),f=yf[2].set(e.right,e.top),p=yf[3].set(e.right,e.bottom);if(f.x<=h.x||d.y<=h.y)return!1;var _=Math.sign(t.a*t.d-t.b*t.c);if(_===0||(t.apply(h,h),t.apply(d,d),t.apply(f,f),t.apply(p,p),Math.max(h.x,d.x,f.x,p.x)<=a||Math.min(h.x,d.x,f.x,p.x)>=l||Math.max(h.y,d.y,f.y,p.y)<=u||Math.min(h.y,d.y,f.y,p.y)>=c))return!1;var m=_*(d.y-h.y),g=_*(h.x-d.x),v=m*a+g*u,y=m*l+g*u,x=m*a+g*c,b=m*l+g*c;if(Math.max(v,y,x,b)<=m*h.x+g*h.y||Math.min(v,y,x,b)>=m*p.x+g*p.y)return!1;var S=_*(h.y-f.y),T=_*(f.x-h.x),P=S*a+T*u,E=S*l+T*u,M=S*a+T*c,O=S*l+T*c;return!(Math.max(P,E,M,O)<=S*h.x+T*h.y||Math.min(P,E,M,O)>=S*p.x+T*p.y)},n.prototype.pad=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=e),this.x-=e,this.y-=t,this.width+=e*2,this.height+=t*2,this},n.prototype.fit=function(e){var t=Math.max(this.x,e.x),i=Math.min(this.x+this.width,e.x+e.width),r=Math.max(this.y,e.y),s=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(i-t,0),this.y=r,this.height=Math.max(s-r,0),this},n.prototype.ceil=function(e,t){e===void 0&&(e=1),t===void 0&&(t=.001);var i=Math.ceil((this.x+this.width-t)*e)/e,r=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=i-this.x,this.height=r-this.y,this},n.prototype.enlarge=function(e){var t=Math.min(this.x,e.x),i=Math.max(this.x+this.width,e.x+e.width),r=Math.min(this.y,e.y),s=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=i-t,this.y=r,this.height=s-r,this},n.prototype.toString=function(){return"[@pixi/math:Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},n}(),SI=function(){function n(e,t,i){e===void 0&&(e=0),t===void 0&&(t=0),i===void 0&&(i=0),this.x=e,this.y=t,this.radius=i,this.type=Tn.CIRC}return n.prototype.clone=function(){return new n(this.x,this.y,this.radius)},n.prototype.contains=function(e,t){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-e,s=this.y-t;return r*=r,s*=s,r+s<=i},n.prototype.getBounds=function(){return new St(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)},n.prototype.toString=function(){return"[@pixi/math:Circle x="+this.x+" y="+this.y+" radius="+this.radius+"]"},n}(),EI=function(){function n(e,t,i,r){e===void 0&&(e=0),t===void 0&&(t=0),i===void 0&&(i=0),r===void 0&&(r=0),this.x=e,this.y=t,this.width=i,this.height=r,this.type=Tn.ELIP}return n.prototype.clone=function(){return new n(this.x,this.y,this.width,this.height)},n.prototype.contains=function(e,t){if(this.width<=0||this.height<=0)return!1;var i=(e-this.x)/this.width,r=(t-this.y)/this.height;return i*=i,r*=r,i+r<=1},n.prototype.getBounds=function(){return new St(this.x-this.width,this.y-this.height,this.width,this.height)},n.prototype.toString=function(){return"[@pixi/math:Ellipse x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},n}(),Dh=function(){function n(){for(var e=arguments,t=[],i=0;i<arguments.length;i++)t[i]=e[i];var r=Array.isArray(t[0])?t[0]:t;if(typeof r[0]!="number"){for(var s=[],o=0,a=r.length;o<a;o++)s.push(r[o].x,r[o].y);r=s}this.points=r,this.type=Tn.POLY,this.closeStroke=!0}return n.prototype.clone=function(){var e=this.points.slice(),t=new n(e);return t.closeStroke=this.closeStroke,t},n.prototype.contains=function(e,t){for(var i=!1,r=this.points.length/2,s=0,o=r-1;s<r;o=s++){var a=this.points[s*2],l=this.points[s*2+1],u=this.points[o*2],c=this.points[o*2+1],h=l>t!=c>t&&e<(u-a)*((t-l)/(c-l))+a;h&&(i=!i)}return i},n.prototype.toString=function(){return"[@pixi/math:Polygon"+("closeStroke="+this.closeStroke)+("points="+this.points.reduce(function(e,t){return e+", "+t},"")+"]")},n}(),TI=function(){function n(e,t,i,r,s){e===void 0&&(e=0),t===void 0&&(t=0),i===void 0&&(i=0),r===void 0&&(r=0),s===void 0&&(s=20),this.x=e,this.y=t,this.width=i,this.height=r,this.radius=s,this.type=Tn.RREC}return n.prototype.clone=function(){return new n(this.x,this.y,this.width,this.height,this.radius)},n.prototype.contains=function(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){var i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(t>=this.y+i&&t<=this.y+this.height-i||e>=this.x+i&&e<=this.x+this.width-i)return!0;var r=e-(this.x+i),s=t-(this.y+i),o=i*i;if(r*r+s*s<=o||(r=e-(this.x+this.width-i),r*r+s*s<=o)||(s=t-(this.y+this.height-i),r*r+s*s<=o)||(r=e-(this.x+i),r*r+s*s<=o))return!0}return!1},n.prototype.toString=function(){return"[@pixi/math:RoundedRectangle x="+this.x+" y="+this.y+("width="+this.width+" height="+this.height+" radius="+this.radius+"]")},n}(),Us=function(){function n(e,t,i,r){i===void 0&&(i=0),r===void 0&&(r=0),this._x=i,this._y=r,this.cb=e,this.scope=t}return n.prototype.clone=function(e,t){return e===void 0&&(e=this.cb),t===void 0&&(t=this.scope),new n(e,t,this._x,this._y)},n.prototype.set=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=e),(this._x!==e||this._y!==t)&&(this._x=e,this._y=t,this.cb.call(this.scope)),this},n.prototype.copyFrom=function(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this},n.prototype.copyTo=function(e){return e.set(this._x,this._y),e},n.prototype.equals=function(e){return e.x===this._x&&e.y===this._y},n.prototype.toString=function(){return"[@pixi/math:ObservablePoint x=0 y=0 scope="+this.scope+"]"},Object.defineProperty(n.prototype,"x",{get:function(){return this._x},set:function(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},set:function(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),n}(),kt=function(){function n(e,t,i,r,s,o){e===void 0&&(e=1),t===void 0&&(t=0),i===void 0&&(i=0),r===void 0&&(r=1),s===void 0&&(s=0),o===void 0&&(o=0),this.array=null,this.a=e,this.b=t,this.c=i,this.d=r,this.tx=s,this.ty=o}return n.prototype.fromArray=function(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]},n.prototype.set=function(e,t,i,r,s,o){return this.a=e,this.b=t,this.c=i,this.d=r,this.tx=s,this.ty=o,this},n.prototype.toArray=function(e,t){this.array||(this.array=new Float32Array(9));var i=t||this.array;return e?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i},n.prototype.apply=function(e,t){t=t||new Bt;var i=e.x,r=e.y;return t.x=this.a*i+this.c*r+this.tx,t.y=this.b*i+this.d*r+this.ty,t},n.prototype.applyInverse=function(e,t){t=t||new Bt;var i=1/(this.a*this.d+this.c*-this.b),r=e.x,s=e.y;return t.x=this.d*i*r+-this.c*i*s+(this.ty*this.c-this.tx*this.d)*i,t.y=this.a*i*s+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,t},n.prototype.translate=function(e,t){return this.tx+=e,this.ty+=t,this},n.prototype.scale=function(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this},n.prototype.rotate=function(e){var t=Math.cos(e),i=Math.sin(e),r=this.a,s=this.c,o=this.tx;return this.a=r*t-this.b*i,this.b=r*i+this.b*t,this.c=s*t-this.d*i,this.d=s*i+this.d*t,this.tx=o*t-this.ty*i,this.ty=o*i+this.ty*t,this},n.prototype.append=function(e){var t=this.a,i=this.b,r=this.c,s=this.d;return this.a=e.a*t+e.b*r,this.b=e.a*i+e.b*s,this.c=e.c*t+e.d*r,this.d=e.c*i+e.d*s,this.tx=e.tx*t+e.ty*r+this.tx,this.ty=e.tx*i+e.ty*s+this.ty,this},n.prototype.setTransform=function(e,t,i,r,s,o,a,l,u){return this.a=Math.cos(a+u)*s,this.b=Math.sin(a+u)*s,this.c=-Math.sin(a-l)*o,this.d=Math.cos(a-l)*o,this.tx=e-(i*this.a+r*this.c),this.ty=t-(i*this.b+r*this.d),this},n.prototype.prepend=function(e){var t=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){var i=this.a,r=this.c;this.a=i*e.a+this.b*e.c,this.b=i*e.b+this.b*e.d,this.c=r*e.a+this.d*e.c,this.d=r*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this},n.prototype.decompose=function(e){var t=this.a,i=this.b,r=this.c,s=this.d,o=e.pivot,a=-Math.atan2(-r,s),l=Math.atan2(i,t),u=Math.abs(a+l);return u<1e-5||Math.abs(cd-u)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=l),e.scale.x=Math.sqrt(t*t+i*i),e.scale.y=Math.sqrt(r*r+s*s),e.position.x=this.tx+(o.x*t+o.y*r),e.position.y=this.ty+(o.x*i+o.y*s),e},n.prototype.invert=function(){var e=this.a,t=this.b,i=this.c,r=this.d,s=this.tx,o=e*r-t*i;return this.a=r/o,this.b=-t/o,this.c=-i/o,this.d=e/o,this.tx=(i*this.ty-r*s)/o,this.ty=-(e*this.ty-t*s)/o,this},n.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},n.prototype.clone=function(){var e=new n;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},n.prototype.copyTo=function(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},n.prototype.copyFrom=function(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this},n.prototype.toString=function(){return"[@pixi/math:Matrix a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+"]"},Object.defineProperty(n,"IDENTITY",{get:function(){return new n},enumerable:!1,configurable:!0}),Object.defineProperty(n,"TEMP_MATRIX",{get:function(){return new n},enumerable:!1,configurable:!0}),n}(),Ea=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Ta=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Ma=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],wa=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],O0=[],MI=[],xf=Math.sign;function Q$(){for(var n=0;n<16;n++){var e=[];O0.push(e);for(var t=0;t<16;t++)for(var i=xf(Ea[n]*Ea[t]+Ma[n]*Ta[t]),r=xf(Ta[n]*Ea[t]+wa[n]*Ta[t]),s=xf(Ea[n]*Ma[t]+Ma[n]*wa[t]),o=xf(Ta[n]*Ma[t]+wa[n]*wa[t]),a=0;a<16;a++)if(Ea[a]===i&&Ta[a]===r&&Ma[a]===s&&wa[a]===o){e.push(a);break}}for(var n=0;n<16;n++){var l=new kt;l.set(Ea[n],Ta[n],Ma[n],wa[n],0,0),MI.push(l)}}Q$();var en={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(n){return Ea[n]},uY:function(n){return Ta[n]},vX:function(n){return Ma[n]},vY:function(n){return wa[n]},inv:function(n){return n&8?n&15:-n&7},add:function(n,e){return O0[n][e]},sub:function(n,e){return O0[n][en.inv(e)]},rotate180:function(n){return n^4},isVertical:function(n){return(n&3)===2},byDirection:function(n,e){return Math.abs(n)*2<=Math.abs(e)?e>=0?en.S:en.N:Math.abs(e)*2<=Math.abs(n)?n>0?en.E:en.W:e>0?n>0?en.SE:en.SW:n>0?en.NE:en.NW},matrixAppendRotationInv:function(n,e,t,i){t===void 0&&(t=0),i===void 0&&(i=0);var r=MI[en.inv(e)];r.tx=t,r.ty=i,n.append(r)}},Bd=function(){function n(){this.worldTransform=new kt,this.localTransform=new kt,this.position=new Us(this.onChange,this,0,0),this.scale=new Us(this.onChange,this,1,1),this.pivot=new Us(this.onChange,this,0,0),this.skew=new Us(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return n.prototype.onChange=function(){this._localID++},n.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},n.prototype.toString=function(){return"[@pixi/math:Transform "+("position=("+this.position.x+", "+this.position.y+") ")+("rotation="+this.rotation+" ")+("scale=("+this.scale.x+", "+this.scale.y+") ")+("skew=("+this.skew.x+", "+this.skew.y+") ")+"]"},n.prototype.updateLocalTransform=function(){var e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1)},n.prototype.updateTransform=function(e){var t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID){var i=e.worldTransform,r=this.worldTransform;r.a=t.a*i.a+t.b*i.c,r.b=t.a*i.b+t.b*i.d,r.c=t.c*i.a+t.d*i.c,r.d=t.c*i.b+t.d*i.d,r.tx=t.tx*i.a+t.ty*i.c+i.tx,r.ty=t.tx*i.b+t.ty*i.d+i.ty,this._parentID=e._worldID,this._worldID++}},n.prototype.setFromMatrix=function(e){e.decompose(this),this._localID++},Object.defineProperty(n.prototype,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation!==e&&(this._rotation=e,this.updateSkew())},enumerable:!1,configurable:!0}),n.IDENTITY=new n,n}();/*!
 * @pixi/extensions - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/extensions is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Fh=function(){return Fh=Object.assign||function(e){for(var t=arguments,i,r=1,s=arguments.length;r<s;r++){i=t[r];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},Fh.apply(this,arguments)},Ut;(function(n){n.Application="application",n.RendererPlugin="renderer-webgl-plugin",n.CanvasRendererPlugin="renderer-canvas-plugin",n.Loader="loader",n.LoadParser="load-parser",n.ResolveParser="resolve-parser",n.CacheParser="cache-parser",n.DetectionParser="detection-parser"})(Ut||(Ut={}));var tM=function(n){if(typeof n=="function"||typeof n=="object"&&n.extension){if(!n.extension)throw new Error("Extension class must have an extension object");var e=typeof n.extension!="object"?{type:n.extension}:n.extension;n=Fh(Fh({},e),{ref:n})}if(typeof n=="object")n=Fh({},n);else throw new Error("Invalid extension type");return typeof n.type=="string"&&(n.type=[n.type]),n},ds={_addHandlers:null,_removeHandlers:null,_queue:{},remove:function(){for(var n=arguments,e=this,t=[],i=0;i<arguments.length;i++)t[i]=n[i];return t.map(tM).forEach(function(r){r.type.forEach(function(s){var o,a;return(a=(o=e._removeHandlers)[s])===null||a===void 0?void 0:a.call(o,r)})}),this},add:function(){for(var n=arguments,e=this,t=[],i=0;i<arguments.length;i++)t[i]=n[i];return t.map(tM).forEach(function(r){r.type.forEach(function(s){var o=e._addHandlers,a=e._queue;o[s]?o[s](r):(a[s]=a[s]||[],a[s].push(r))})}),this},handle:function(n,e,t){var i=this._addHandlers=this._addHandlers||{},r=this._removeHandlers=this._removeHandlers||{};if(i[n]||r[n])throw new Error("Extension type "+n+" already has a handler");i[n]=e,r[n]=t;var s=this._queue;return s[n]&&(s[n].forEach(function(o){return e(o)}),delete s[n]),this},handleByMap:function(n,e){return this.handle(n,function(t){e[t.name]=t.ref},function(t){delete e[t.name]})},handleByList:function(n,e){return this.handle(n,function(t){var i,r;e.includes(t.ref)||(e.push(t.ref),n===Ut.Loader&&((r=(i=t.ref).add)===null||r===void 0||r.call(i)))},function(t){var i=e.indexOf(t.ref);i!==-1&&e.splice(i,1)})}};/*!
 * @pixi/runner - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/runner is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var On=function(){function n(e){this.items=[],this._name=e,this._aliasCount=0}return n.prototype.emit=function(e,t,i,r,s,o,a,l){if(arguments.length>8)throw new Error("max arguments reached");var u=this,c=u.name,h=u.items;this._aliasCount++;for(var d=0,f=h.length;d<f;d++)h[d][c](e,t,i,r,s,o,a,l);return h===this.items&&this._aliasCount--,this},n.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},n.prototype.add=function(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this},n.prototype.remove=function(e){var t=this.items.indexOf(e);return t!==-1&&(this.ensureNonAliasedItems(),this.items.splice(t,1)),this},n.prototype.contains=function(e){return this.items.indexOf(e)!==-1},n.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},n.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(n.prototype,"empty",{get:function(){return this.items.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),n}();Object.defineProperties(On.prototype,{dispatch:{value:On.prototype.emit},run:{value:On.prototype.emit}});/*!
 * @pixi/ticker - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */Oe.TARGET_FPMS=.06;var ls;(function(n){n[n.INTERACTION=50]="INTERACTION",n[n.HIGH=25]="HIGH",n[n.NORMAL=0]="NORMAL",n[n.LOW=-25]="LOW",n[n.UTILITY=-50]="UTILITY"})(ls||(ls={}));var g_=function(){function n(e,t,i,r){t===void 0&&(t=null),i===void 0&&(i=0),r===void 0&&(r=!1),this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=t,this.priority=i,this.once=r}return n.prototype.match=function(e,t){return t===void 0&&(t=null),this.fn===e&&this.context===t},n.prototype.emit=function(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));var t=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),t},n.prototype.connect=function(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this},n.prototype.destroy=function(e){e===void 0&&(e=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var t=this.next;return this.next=e?null:t,this.previous=null,t},n}(),Fn=function(){function n(){var e=this;this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new g_(null,null,1/0),this.deltaMS=1/Oe.TARGET_FPMS,this.elapsedMS=1/Oe.TARGET_FPMS,this._tick=function(t){e._requestId=null,e.started&&(e.update(t),e.started&&e._requestId===null&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}return n.prototype._requestIfNeeded=function(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},n.prototype._cancelIfNeeded=function(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)},n.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},n.prototype.add=function(e,t,i){return i===void 0&&(i=ls.NORMAL),this._addListener(new g_(e,t,i))},n.prototype.addOnce=function(e,t,i){return i===void 0&&(i=ls.NORMAL),this._addListener(new g_(e,t,i,!0))},n.prototype._addListener=function(e){var t=this._head.next,i=this._head;if(!t)e.connect(i);else{for(;t;){if(e.priority>t.priority){e.connect(i);break}i=t,t=t.next}e.previous||e.connect(i)}return this._startIfPossible(),this},n.prototype.remove=function(e,t){for(var i=this._head.next;i;)i.match(e,t)?i=i.destroy():i=i.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(n.prototype,"count",{get:function(){if(!this._head)return 0;for(var e=0,t=this._head;t=t.next;)e++;return e},enumerable:!1,configurable:!0}),n.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},n.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},n.prototype.destroy=function(){if(!this._protected){this.stop();for(var e=this._head.next;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}},n.prototype.update=function(e){e===void 0&&(e=performance.now());var t;if(e>this.lastTime){if(t=this.elapsedMS=e-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){var i=e-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=e-i%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*Oe.TARGET_FPMS;for(var r=this._head,s=r.next;s;)s=s.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e},Object.defineProperty(n.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(e){var t=Math.min(this.maxFPS,e),i=Math.min(Math.max(0,t)/1e3,Oe.TARGET_FPMS);this._maxElapsedMS=1/i},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(e){if(e===0)this._minElapsedMS=0;else{var t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(n,"shared",{get:function(){if(!n._shared){var e=n._shared=new n;e.autoStart=!0,e._protected=!0}return n._shared},enumerable:!1,configurable:!0}),Object.defineProperty(n,"system",{get:function(){if(!n._system){var e=n._system=new n;e.autoStart=!0,e._protected=!0}return n._system},enumerable:!1,configurable:!0}),n}(),wI=function(){function n(){}return n.init=function(e){var t=this;e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set:function(i){this._ticker&&this._ticker.remove(this.render,this),this._ticker=i,i&&i.add(this.render,this,ls.LOW)},get:function(){return this._ticker}}),this.stop=function(){t._ticker.stop()},this.start=function(){t._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?Fn.shared:new Fn,e.autoStart&&this.start()},n.destroy=function(){if(this._ticker){var e=this._ticker;this.ticker=null,e.destroy()}},n.extension=Ut.Application,n}();/*!
 * @pixi/core - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/core is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */Oe.PREFER_ENV=Qi.any?as.WEBGL:as.WEBGL2;Oe.STRICT_TEXTURE_CACHE=!1;var hd=[];function og(n,e){if(!n)return null;var t="";if(typeof n=="string"){var i=/\.(\w{3,4})(?:$|\?|#)/i.exec(n);i&&(t=i[1].toLowerCase())}for(var r=hd.length-1;r>=0;--r){var s=hd[r];if(s.test&&s.test(n,t))return new s(n,e)}throw new Error("Unrecognized source type to auto-detect Resource")}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var D0=function(n,e){return D0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},D0(n,e)};function $t(n,e){D0(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var F0=function(){return F0=Object.assign||function(e){for(var t=arguments,i,r=1,s=arguments.length;r<s;r++){i=t[r];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},F0.apply(this,arguments)};function e9(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t}var dl=function(){function n(e,t){e===void 0&&(e=0),t===void 0&&(t=0),this._width=e,this._height=t,this.destroyed=!1,this.internal=!1,this.onResize=new On("setRealSize"),this.onUpdate=new On("update"),this.onError=new On("onError")}return n.prototype.bind=function(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},n.prototype.unbind=function(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)},n.prototype.resize=function(e,t){(e!==this._width||t!==this._height)&&(this._width=e,this._height=t,this.onResize.emit(e,t))},Object.defineProperty(n.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),n.prototype.update=function(){this.destroyed||this.onUpdate.emit()},n.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(n.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),n.prototype.style=function(e,t,i){return!1},n.prototype.dispose=function(){},n.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},n.test=function(e,t){return!1},n}(),Sl=function(n){$t(e,n);function e(t,i){var r=this,s=i||{},o=s.width,a=s.height;if(!o||!a)throw new Error("BufferResource width or height invalid");return r=n.call(this,o,a)||this,r.data=t,r}return e.prototype.upload=function(t,i,r){var s=t.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.alphaMode===ar.UNPACK);var o=i.realWidth,a=i.realHeight;return r.width===o&&r.height===a?s.texSubImage2D(i.target,0,0,0,o,a,i.format,r.type,this.data):(r.width=o,r.height=a,s.texImage2D(i.target,0,r.internalFormat,o,a,0,i.format,r.type,this.data)),!0},e.prototype.dispose=function(){this.data=null},e.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},e}(dl),t9={scaleMode:wr.NEAREST,format:Me.RGBA,alphaMode:ar.NPM},xt=function(n){$t(e,n);function e(t,i){t===void 0&&(t=null),i===void 0&&(i=null);var r=n.call(this)||this;i=i||{};var s=i.alphaMode,o=i.mipmap,a=i.anisotropicLevel,l=i.scaleMode,u=i.width,c=i.height,h=i.wrapMode,d=i.format,f=i.type,p=i.target,_=i.resolution,m=i.resourceOptions;return t&&!(t instanceof dl)&&(t=og(t,m),t.internal=!0),r.resolution=_||Oe.RESOLUTION,r.width=Math.round((u||0)*r.resolution)/r.resolution,r.height=Math.round((c||0)*r.resolution)/r.resolution,r._mipmap=o!==void 0?o:Oe.MIPMAP_TEXTURES,r.anisotropicLevel=a!==void 0?a:Oe.ANISOTROPIC_LEVEL,r._wrapMode=h||Oe.WRAP_MODE,r._scaleMode=l!==void 0?l:Oe.SCALE_MODE,r.format=d||Me.RGBA,r.type=f||Ge.UNSIGNED_BYTE,r.target=p||Oo.TEXTURE_2D,r.alphaMode=s!==void 0?s:ar.UNPACK,r.uid=Ho(),r.touched=0,r.isPowerOfTwo=!1,r._refreshPOT(),r._glTextures={},r.dirtyId=0,r.dirtyStyleId=0,r.cacheId=null,r.valid=u>0&&c>0,r.textureCacheIds=[],r.destroyed=!1,r.resource=null,r._batchEnabled=0,r._batchLocation=0,r.parentTextureArray=null,r.setResource(t),r}return Object.defineProperty(e.prototype,"realWidth",{get:function(){return Math.round(this.width*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"realHeight",{get:function(){return Math.round(this.height*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mipmap",{get:function(){return this._mipmap},set:function(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wrapMode",{get:function(){return this._wrapMode},set:function(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),e.prototype.setStyle=function(t,i){var r;return t!==void 0&&t!==this.scaleMode&&(this.scaleMode=t,r=!0),i!==void 0&&i!==this.mipmap&&(this.mipmap=i,r=!0),r&&this.dirtyStyleId++,this},e.prototype.setSize=function(t,i,r){return r=r||this.resolution,this.setRealSize(t*r,i*r,r)},e.prototype.setRealSize=function(t,i,r){return this.resolution=r||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(i)/this.resolution,this._refreshPOT(),this.update(),this},e.prototype._refreshPOT=function(){this.isPowerOfTwo=C0(this.realWidth)&&C0(this.realHeight)},e.prototype.setResolution=function(t){var i=this.resolution;return i===t?this:(this.resolution=t,this.valid&&(this.width=Math.round(this.width*i)/t,this.height=Math.round(this.height*i)/t,this.emit("update",this)),this._refreshPOT(),this)},e.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},e.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},e.prototype.onError=function(t){this.emit("error",this,t)},e.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete zi[this.cacheId],delete pi[this.cacheId],this.cacheId=null),this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.prototype.castToBaseTexture=function(){return this},e.from=function(t,i,r){r===void 0&&(r=Oe.STRICT_TEXTURE_CACHE);var s=typeof t=="string",o=null;if(s)o=t;else{if(!t._pixiId){var a=i&&i.pixiIdPrefix||"pixiid";t._pixiId=a+"_"+Ho()}o=t._pixiId}var l=zi[o];if(s&&r&&!l)throw new Error('The cacheId "'+o+'" does not exist in BaseTextureCache.');return l||(l=new e(t,i),l.cacheId=o,e.addToCache(l,o)),l},e.fromBuffer=function(t,i,r,s){t=t||new Float32Array(i*r*4);var o=new Sl(t,{width:i,height:r}),a=t instanceof Float32Array?Ge.FLOAT:Ge.UNSIGNED_BYTE;return new e(o,Object.assign({},t9,s||{width:i,height:r,type:a}))},e.addToCache=function(t,i){i&&(t.textureCacheIds.indexOf(i)===-1&&t.textureCacheIds.push(i),zi[i]&&console.warn("BaseTexture added to the cache with an id ["+i+"] that already had an entry"),zi[i]=t)},e.removeFromCache=function(t){if(typeof t=="string"){var i=zi[t];if(i){var r=i.textureCacheIds.indexOf(t);return r>-1&&i.textureCacheIds.splice(r,1),delete zi[t],i}}else if(t&&t.textureCacheIds){for(var s=0;s<t.textureCacheIds.length;++s)delete zi[t.textureCacheIds[s]];return t.textureCacheIds.length=0,t}return null},e._globalBatch=0,e}(lr),ag=function(n){$t(e,n);function e(t,i){var r=this,s=i||{},o=s.width,a=s.height;r=n.call(this,o,a)||this,r.items=[],r.itemDirtyIds=[];for(var l=0;l<t;l++){var u=new xt;r.items.push(u),r.itemDirtyIds.push(-2)}return r.length=t,r._load=null,r.baseTexture=null,r}return e.prototype.initFromArray=function(t,i){for(var r=0;r<this.length;r++)t[r]&&(t[r].castToBaseTexture?this.addBaseTextureAt(t[r].castToBaseTexture(),r):t[r]instanceof dl?this.addResourceAt(t[r],r):this.addResourceAt(og(t[r],i),r))},e.prototype.dispose=function(){for(var t=0,i=this.length;t<i;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},e.prototype.addResourceAt=function(t,i){if(!this.items[i])throw new Error("Index "+i+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[i].setResource(t),this},e.prototype.bind=function(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");n.prototype.bind.call(this,t);for(var i=0;i<this.length;i++)this.items[i].parentTextureArray=t,this.items[i].on("update",t.update,t)},e.prototype.unbind=function(t){n.prototype.unbind.call(this,t);for(var i=0;i<this.length;i++)this.items[i].parentTextureArray=null,this.items[i].off("update",t.update,t)},e.prototype.load=function(){var t=this;if(this._load)return this._load;var i=this.items.map(function(s){return s.resource}).filter(function(s){return s}),r=i.map(function(s){return s.load()});return this._load=Promise.all(r).then(function(){var s=t.items[0],o=s.realWidth,a=s.realHeight;return t.resize(o,a),Promise.resolve(t)}),this._load},e}(dl),ub=function(n){$t(e,n);function e(t,i){var r=this,s=i||{},o=s.width,a=s.height,l,u;return Array.isArray(t)?(l=t,u=t.length):u=t,r=n.call(this,u,{width:o,height:a})||this,l&&r.initFromArray(l,i),r}return e.prototype.addBaseTextureAt=function(t,i){if(t.resource)this.addResourceAt(t.resource,i);else throw new Error("ArrayResource does not support RenderTexture");return this},e.prototype.bind=function(t){n.prototype.bind.call(this,t),t.target=Oo.TEXTURE_2D_ARRAY},e.prototype.upload=function(t,i,r){var s=this,o=s.length,a=s.itemDirtyIds,l=s.items,u=t.gl;r.dirtyId<0&&u.texImage3D(u.TEXTURE_2D_ARRAY,0,r.internalFormat,this._width,this._height,o,0,i.format,r.type,null);for(var c=0;c<o;c++){var h=l[c];a[c]<h.dirtyId&&(a[c]=h.dirtyId,h.valid&&u.texSubImage3D(u.TEXTURE_2D_ARRAY,0,0,0,c,h.resource.width,h.resource.height,1,i.format,r.type,h.resource.source))}return!0},e}(ag),us=function(n){$t(e,n);function e(t){var i=this,r=t,s=r.naturalWidth||r.videoWidth||r.width,o=r.naturalHeight||r.videoHeight||r.height;return i=n.call(this,s,o)||this,i.source=t,i.noSubImage=!1,i}return e.crossOrigin=function(t,i,r){r===void 0&&i.indexOf("data:")!==0?t.crossOrigin=yI(i):r!==!1&&(t.crossOrigin=typeof r=="string"?r:"anonymous")},e.prototype.upload=function(t,i,r,s){var o=t.gl,a=i.realWidth,l=i.realHeight;if(s=s||this.source,s instanceof HTMLImageElement){if(!s.complete||s.naturalWidth===0)return!1}else if(s instanceof HTMLVideoElement&&s.readyState<=1)return!1;return o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.alphaMode===ar.UNPACK),!this.noSubImage&&i.target===o.TEXTURE_2D&&r.width===a&&r.height===l?o.texSubImage2D(o.TEXTURE_2D,0,0,0,i.format,r.type,s):(r.width=a,r.height=l,o.texImage2D(i.target,0,r.internalFormat,i.format,r.type,s)),!0},e.prototype.update=function(){if(!this.destroyed){var t=this.source,i=t.naturalWidth||t.videoWidth||t.width,r=t.naturalHeight||t.videoHeight||t.height;this.resize(i,r),n.prototype.update.call(this)}},e.prototype.dispose=function(){this.source=null},e}(dl),cb=function(n){$t(e,n);function e(t){return n.call(this,t)||this}return e.test=function(t){var i=globalThis.OffscreenCanvas;return i&&t instanceof i?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement},e}(us),hb=function(n){$t(e,n);function e(t,i){var r=this,s=i||{},o=s.width,a=s.height,l=s.autoLoad,u=s.linkBaseTexture;if(t&&t.length!==e.SIDES)throw new Error("Invalid length. Got "+t.length+", expected 6");r=n.call(this,6,{width:o,height:a})||this;for(var c=0;c<e.SIDES;c++)r.items[c].target=Oo.TEXTURE_CUBE_MAP_POSITIVE_X+c;return r.linkBaseTexture=u!==!1,t&&r.initFromArray(t,i),l!==!1&&r.load(),r}return e.prototype.bind=function(t){n.prototype.bind.call(this,t),t.target=Oo.TEXTURE_CUBE_MAP},e.prototype.addBaseTextureAt=function(t,i,r){if(!this.items[i])throw new Error("Index "+i+" is out of bounds");if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0)if(t.resource)this.addResourceAt(t.resource,i);else throw new Error("CubeResource does not support copying of renderTexture.");else t.target=Oo.TEXTURE_CUBE_MAP_POSITIVE_X+i,t.parentTextureArray=this.baseTexture,this.items[i]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[i]=t,this},e.prototype.upload=function(t,i,r){for(var s=this.itemDirtyIds,o=0;o<e.SIDES;o++){var a=this.items[o];(s[o]<a.dirtyId||r.dirtyId<i.dirtyId)&&(a.valid&&a.resource?(a.resource.upload(t,a,r),s[o]=a.dirtyId):s[o]<-1&&(t.gl.texImage2D(a.target,0,r.internalFormat,i.realWidth,i.realHeight,0,i.format,r.type,null),s[o]=-1))}return!0},e.test=function(t){return Array.isArray(t)&&t.length===e.SIDES},e.SIDES=6,e}(ag),lg=function(n){$t(e,n);function e(t,i){var r=this;if(i=i||{},!(t instanceof HTMLImageElement)){var s=new Image;us.crossOrigin(s,t,i.crossorigin),s.src=t,t=s}return r=n.call(this,t)||this,!t.complete&&r._width&&r._height&&(r._width=0,r._height=0),r.url=t.src,r._process=null,r.preserveBitmap=!1,r.createBitmap=(i.createBitmap!==void 0?i.createBitmap:Oe.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,r.alphaMode=typeof i.alphaMode=="number"?i.alphaMode:null,r.bitmap=null,r._load=null,i.autoLoad!==!1&&r.load(),r}return e.prototype.load=function(t){var i=this;return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise(function(r,s){var o=i.source;i.url=o.src;var a=function(){i.destroyed||(o.onload=null,o.onerror=null,i.resize(o.width,o.height),i._load=null,i.createBitmap?r(i.process()):r(i))};o.complete&&o.src?a():(o.onload=a,o.onerror=function(l){s(l),i.onError.emit(l)})}),this._load)},e.prototype.process=function(){var t=this,i=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);var r=globalThis.createImageBitmap,s=!i.crossOrigin||i.crossOrigin==="anonymous";return this._process=fetch(i.src,{mode:s?"cors":"no-cors"}).then(function(o){return o.blob()}).then(function(o){return r(o,0,0,i.width,i.height,{premultiplyAlpha:t.alphaMode===null||t.alphaMode===ar.UNPACK?"premultiply":"none"})}).then(function(o){return t.destroyed?Promise.reject():(t.bitmap=o,t.update(),t._process=null,Promise.resolve(t))}),this._process},e.prototype.upload=function(t,i,r){if(typeof this.alphaMode=="number"&&(i.alphaMode=this.alphaMode),!this.createBitmap)return n.prototype.upload.call(this,t,i,r);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(n.prototype.upload.call(this,t,i,r,this.bitmap),!this.preserveBitmap){var s=!0,o=i._glTextures;for(var a in o){var l=o[a];if(l!==r&&l.dirtyId!==i.dirtyId){s=!1;break}}s&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},e.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,n.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},e.test=function(t){return typeof t=="string"||t instanceof HTMLImageElement},e}(us),db=function(n){$t(e,n);function e(t,i){var r=this;return i=i||{},r=n.call(this,Oe.ADAPTER.createCanvas())||this,r._width=0,r._height=0,r.svg=t,r.scale=i.scale||1,r._overrideWidth=i.width,r._overrideHeight=i.height,r._resolve=null,r._crossorigin=i.crossorigin,r._load=null,i.autoLoad!==!1&&r.load(),r}return e.prototype.load=function(){var t=this;return this._load?this._load:(this._load=new Promise(function(i){if(t._resolve=function(){t.resize(t.source.width,t.source.height),i(t)},e.SVG_XML.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()}),this._load)},e.prototype._loadSvg=function(){var t=this,i=new Image;us.crossOrigin(i,this.svg,this._crossorigin),i.src=this.svg,i.onerror=function(r){t._resolve&&(i.onerror=null,t.onError.emit(r))},i.onload=function(){if(t._resolve){var r=i.width,s=i.height;if(!r||!s)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var o=r*t.scale,a=s*t.scale;(t._overrideWidth||t._overrideHeight)&&(o=t._overrideWidth||t._overrideHeight/s*r,a=t._overrideHeight||t._overrideWidth/r*s),o=Math.round(o),a=Math.round(a);var l=t.source;l.width=o,l.height=a,l._pixiId="canvas_"+Ho(),l.getContext("2d").drawImage(i,0,0,r,s,0,0,o,a),t._resolve(),t._resolve=null}}},e.getSize=function(t){var i=e.SVG_SIZE.exec(t),r={};return i&&(r[i[1]]=Math.round(parseFloat(i[3])),r[i[5]]=Math.round(parseFloat(i[7]))),r},e.prototype.dispose=function(){n.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},e.test=function(t,i){return i==="svg"||typeof t=="string"&&t.startsWith("data:image/svg+xml")||typeof t=="string"&&e.SVG_XML.test(t)},e.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,e.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,e}(us),fb=function(n){$t(e,n);function e(t,i){var r=this;if(i=i||{},!(t instanceof HTMLVideoElement)){var s=document.createElement("video");s.setAttribute("preload","auto"),s.setAttribute("webkit-playsinline",""),s.setAttribute("playsinline",""),typeof t=="string"&&(t=[t]);var o=t[0].src||t[0];us.crossOrigin(s,o,i.crossorigin);for(var a=0;a<t.length;++a){var l=document.createElement("source"),u=t[a],c=u.src,h=u.mime;c=c||t[a];var d=c.split("?").shift().toLowerCase(),f=d.slice(d.lastIndexOf(".")+1);h=h||e.MIME_TYPES[f]||"video/"+f,l.src=c,l.type=h,s.appendChild(l)}t=s}return r=n.call(this,t)||this,r.noSubImage=!0,r._autoUpdate=!0,r._isConnectedToTicker=!1,r._updateFPS=i.updateFPS||0,r._msToNextUpdate=0,r.autoPlay=i.autoPlay!==!1,r._load=null,r._resolve=null,r._onCanPlay=r._onCanPlay.bind(r),r._onError=r._onError.bind(r),i.autoLoad!==!1&&r.load(),r}return e.prototype.update=function(t){if(!this.destroyed){var i=Fn.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-i),(!this._updateFPS||this._msToNextUpdate<=0)&&(n.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var i=this.source;return(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart.bind(this)),i.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay),i.addEventListener("error",this._onError,!0)),this._load=new Promise(function(r){t.valid?r(t):(t._resolve=r,i.load())}),this._load},e.prototype._onError=function(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t)},e.prototype._isSourcePlaying=function(){var t=this.source;return!t.paused&&!t.ended&&this._isSourceReady()},e.prototype._isSourceReady=function(){var t=this.source;return t.readyState>2},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Fn.shared.add(this.update,this),this._isConnectedToTicker=!0)},e.prototype._onPlayStop=function(){this._isConnectedToTicker&&(Fn.shared.remove(this.update,this),this._isConnectedToTicker=!1)},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var i=this.valid;this.resize(t.videoWidth,t.videoHeight),!i&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},e.prototype.dispose=function(){this._isConnectedToTicker&&(Fn.shared.remove(this.update,this),this._isConnectedToTicker=!1);var t=this.source;t&&(t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),n.prototype.dispose.call(this)},Object.defineProperty(e.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Fn.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Fn.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(t){t!==this._updateFPS&&(this._updateFPS=t)},enumerable:!1,configurable:!0}),e.test=function(t,i){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||e.TYPES.indexOf(i)>-1},e.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],e.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},e}(us),pb=function(n){$t(e,n);function e(t){return n.call(this,t)||this}return e.test=function(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&t instanceof ImageBitmap},e}(us);hd.push(lg,pb,cb,fb,db,Sl,hb,ub);var AI={__proto__:null,Resource:dl,BaseImageResource:us,INSTALLED:hd,autoDetectResource:og,AbstractMultiResource:ag,ArrayResource:ub,BufferResource:Sl,CanvasResource:cb,CubeResource:hb,ImageResource:lg,SVGResource:db,VideoResource:fb,ImageBitmapResource:pb},n9=function(n){$t(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.upload=function(t,i,r){var s=t.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.alphaMode===ar.UNPACK);var o=i.realWidth,a=i.realHeight;return r.width===o&&r.height===a?s.texSubImage2D(i.target,0,0,0,o,a,i.format,r.type,this.data):(r.width=o,r.height=a,s.texImage2D(i.target,0,r.internalFormat,o,a,0,i.format,r.type,this.data)),!0},e}(Sl),rm=function(){function n(e,t){this.width=Math.round(e||100),this.height=Math.round(t||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new On("disposeFramebuffer"),this.multisample=Jt.NONE}return Object.defineProperty(n.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),n.prototype.addColorTexture=function(e,t){return e===void 0&&(e=0),this.colorTextures[e]=t||new xt(null,{scaleMode:wr.NEAREST,resolution:1,mipmap:or.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},n.prototype.addDepthTexture=function(e){return this.depthTexture=e||new xt(new n9(null,{width:this.width,height:this.height}),{scaleMode:wr.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:or.OFF,format:Me.DEPTH_COMPONENT,type:Ge.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},n.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},n.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},n.prototype.resize=function(e,t){if(e=Math.round(e),t=Math.round(t),!(e===this.width&&t===this.height)){this.width=e,this.height=t,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var r=this.colorTextures[i],s=r.resolution;r.setSize(e/s,t/s)}if(this.depthTexture){var s=this.depthTexture.resolution;this.depthTexture.setSize(e/s,t/s)}}},n.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},n.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},n}(),mb=function(n){$t(e,n);function e(t){t===void 0&&(t={});var i=this;if(typeof t=="number"){var r=arguments[0],s=arguments[1],o=arguments[2],a=arguments[3];t={width:r,height:s,scaleMode:o,resolution:a}}return t.width=t.width||100,t.height=t.height||100,t.multisample=t.multisample!==void 0?t.multisample:Jt.NONE,i=n.call(this,null,t)||this,i.mipmap=or.OFF,i.valid=!0,i.clearColor=[0,0,0,0],i.framebuffer=new rm(i.realWidth,i.realHeight).addColorTexture(0,i),i.framebuffer.multisample=t.multisample,i.maskStack=[],i.filterStack=[{}],i}return e.prototype.resize=function(t,i){this.framebuffer.resize(t*this.resolution,i*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)},e.prototype.dispose=function(){this.framebuffer.dispose(),n.prototype.dispose.call(this)},e.prototype.destroy=function(){n.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},e}(xt),gb=function(){function n(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return n.prototype.set=function(e,t,i){var r=t.width,s=t.height;if(i){var o=e.width/2/r,a=e.height/2/s,l=e.x/r+o,u=e.y/s+a;i=en.add(i,en.NW),this.x0=l+o*en.uX(i),this.y0=u+a*en.uY(i),i=en.add(i,2),this.x1=l+o*en.uX(i),this.y1=u+a*en.uY(i),i=en.add(i,2),this.x2=l+o*en.uX(i),this.y2=u+a*en.uY(i),i=en.add(i,2),this.x3=l+o*en.uX(i),this.y3=u+a*en.uY(i)}else this.x0=e.x/r,this.y0=e.y/s,this.x1=(e.x+e.width)/r,this.y1=e.y/s,this.x2=(e.x+e.width)/r,this.y2=(e.y+e.height)/s,this.x3=e.x/r,this.y3=(e.y+e.height)/s;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},n.prototype.toString=function(){return"[@pixi/core:TextureUvs "+("x0="+this.x0+" y0="+this.y0+" ")+("x1="+this.x1+" y1="+this.y1+" x2="+this.x2+" ")+("y2="+this.y2+" x3="+this.x3+" y3="+this.y3)+"]"},n}(),nM=new gb;function bf(n){n.destroy=function(){},n.on=function(){},n.once=function(){},n.emit=function(){}}var Ke=function(n){$t(e,n);function e(t,i,r,s,o,a){var l=n.call(this)||this;if(l.noFrame=!1,i||(l.noFrame=!0,i=new St(0,0,1,1)),t instanceof e&&(t=t.baseTexture),l.baseTexture=t,l._frame=i,l.trim=s,l.valid=!1,l._uvs=nM,l.uvMatrix=null,l.orig=r||i,l._rotate=Number(o||0),o===!0)l._rotate=2;else if(l._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return l.defaultAnchor=a?new Bt(a.x,a.y):new Bt(0,0),l._updateID=0,l.textureCacheIds=[],t.valid?l.noFrame?t.valid&&l.onBaseTextureUpdated(t):l.frame=i:t.once("loaded",l.onBaseTextureUpdated,l),l.noFrame&&t.on("update",l.onBaseTextureUpdated,l),l}return e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var i=this.baseTexture.resource;i&&i.url&&pi[i.url]&&e.removeFromCache(i.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){var t=this._frame.clone(),i=this._frame===this.orig?t:this.orig.clone(),r=new e(this.baseTexture,!this.noFrame&&t,i,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(r._frame=t),r},e.prototype.updateUvs=function(){this._uvs===nM&&(this._uvs=new gb),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.from=function(t,i,r){i===void 0&&(i={}),r===void 0&&(r=Oe.STRICT_TEXTURE_CACHE);var s=typeof t=="string",o=null;if(s)o=t;else if(t instanceof xt){if(!t.cacheId){var a=i&&i.pixiIdPrefix||"pixiid";t.cacheId=a+"-"+Ho(),xt.addToCache(t,t.cacheId)}o=t.cacheId}else{if(!t._pixiId){var a=i&&i.pixiIdPrefix||"pixiid";t._pixiId=a+"_"+Ho()}o=t._pixiId}var l=pi[o];if(s&&r&&!l)throw new Error('The cacheId "'+o+'" does not exist in TextureCache.');return!l&&!(t instanceof xt)?(i.resolution||(i.resolution=ud(t)),l=new e(new xt(t,i)),l.baseTexture.cacheId=o,xt.addToCache(l.baseTexture,o),e.addToCache(l,o)):!l&&t instanceof xt&&(l=new e(t),e.addToCache(l,o)),l},e.fromURL=function(t,i){var r=Object.assign({autoLoad:!1},i==null?void 0:i.resourceOptions),s=e.from(t,Object.assign({resourceOptions:r},i),!1),o=s.baseTexture.resource;return s.baseTexture.valid?Promise.resolve(s):o.load().then(function(){return Promise.resolve(s)})},e.fromBuffer=function(t,i,r,s){return new e(xt.fromBuffer(t,i,r,s))},e.fromLoader=function(t,i,r,s){var o=new xt(t,Object.assign({scaleMode:Oe.SCALE_MODE,resolution:ud(i)},s)),a=o.resource;a instanceof lg&&(a.url=i);var l=new e(o);return r||(r=i),xt.addToCache(l.baseTexture,r),e.addToCache(l,r),r!==i&&(xt.addToCache(l.baseTexture,i),e.addToCache(l,i)),l.baseTexture.valid?Promise.resolve(l):new Promise(function(u){l.baseTexture.once("loaded",function(){return u(l)})})},e.addToCache=function(t,i){i&&(t.textureCacheIds.indexOf(i)===-1&&t.textureCacheIds.push(i),pi[i]&&console.warn("Texture added to the cache with an id ["+i+"] that already had an entry"),pi[i]=t)},e.removeFromCache=function(t){if(typeof t=="string"){var i=pi[t];if(i){var r=i.textureCacheIds.indexOf(t);return r>-1&&i.textureCacheIds.splice(r,1),delete pi[t],i}}else if(t&&t.textureCacheIds){for(var s=0;s<t.textureCacheIds.length;++s)pi[t.textureCacheIds[s]]===t&&delete pi[t.textureCacheIds[s]];return t.textureCacheIds.length=0,t}return null},Object.defineProperty(e.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frame",{get:function(){return this._frame},set:function(t){this._frame=t,this.noFrame=!1;var i=t.x,r=t.y,s=t.width,o=t.height,a=i+s>this.baseTexture.width,l=r+o>this.baseTexture.height;if(a||l){var u=a&&l?"and":"or",c="X: "+i+" + "+s+" = "+(i+s)+" > "+this.baseTexture.width,h="Y: "+r+" + "+o+" = "+(r+o)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+(c+" "+u+" "+h))}this.valid=s&&o&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotate",{get:function(){return this._rotate},set:function(t){this._rotate=t,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),e.prototype.castToBaseTexture=function(){return this.baseTexture},Object.defineProperty(e,"EMPTY",{get:function(){return e._EMPTY||(e._EMPTY=new e(new xt),bf(e._EMPTY),bf(e._EMPTY.baseTexture)),e._EMPTY},enumerable:!1,configurable:!0}),Object.defineProperty(e,"WHITE",{get:function(){if(!e._WHITE){var t=Oe.ADAPTER.createCanvas(16,16),i=t.getContext("2d");t.width=16,t.height=16,i.fillStyle="white",i.fillRect(0,0,16,16),e._WHITE=new e(xt.from(t)),bf(e._WHITE),bf(e._WHITE.baseTexture)}return e._WHITE},enumerable:!1,configurable:!0}),e}(lr),zo=function(n){$t(e,n);function e(t,i){var r=n.call(this,t,i)||this;return r.valid=!0,r.filterFrame=null,r.filterPoolKey=null,r.updateUvs(),r}return Object.defineProperty(e.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"multisample",{get:function(){return this.framebuffer.multisample},set:function(t){this.framebuffer.multisample=t},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,i,r){r===void 0&&(r=!0);var s=this.baseTexture.resolution,o=Math.round(t*s)/s,a=Math.round(i*s)/s;this.valid=o>0&&a>0,this._frame.width=this.orig.width=o,this._frame.height=this.orig.height=a,r&&this.baseTexture.resize(o,a),this.updateUvs()},e.prototype.setResolution=function(t){var i=this.baseTexture;i.resolution!==t&&(i.setResolution(t),this.resize(i.width,i.height,!1))},e.create=function(t){for(var i=arguments,r=[],s=1;s<arguments.length;s++)r[s-1]=i[s];return typeof t=="number"&&(ai("6.0.0","Arguments (width, height, scaleMode, resolution) have been deprecated."),t={width:t,height:r[0],scaleMode:r[1],resolution:r[2]}),new e(new mb(t))},e}(Ke),PI=function(){function n(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return n.prototype.createTexture=function(e,t,i){i===void 0&&(i=Jt.NONE);var r=new mb(Object.assign({width:e,height:t,resolution:1,multisample:i},this.textureOptions));return new zo(r)},n.prototype.getOptimalTexture=function(e,t,i,r){i===void 0&&(i=1),r===void 0&&(r=Jt.NONE);var s;e=Math.ceil(e*i-1e-6),t=Math.ceil(t*i-1e-6),!this.enableFullScreen||e!==this._pixelsWidth||t!==this._pixelsHeight?(e=ld(e),t=ld(t),s=((e&65535)<<16|t&65535)>>>0,r>1&&(s+=r*4294967296)):s=r>1?-r:-1,this.texturePool[s]||(this.texturePool[s]=[]);var o=this.texturePool[s].pop();return o||(o=this.createTexture(e,t,r)),o.filterPoolKey=s,o.setResolution(i),o},n.prototype.getFilterTexture=function(e,t,i){var r=this.getOptimalTexture(e.width,e.height,t||e.resolution,i||Jt.NONE);return r.filterFrame=e.filterFrame,r},n.prototype.returnTexture=function(e){var t=e.filterPoolKey;e.filterFrame=null,this.texturePool[t].push(e)},n.prototype.returnFilterTexture=function(e){this.returnTexture(e)},n.prototype.clear=function(e){if(e=e!==!1,e)for(var t in this.texturePool){var i=this.texturePool[t];if(i)for(var r=0;r<i.length;r++)i[r].destroy(!0)}this.texturePool={}},n.prototype.setScreenSize=function(e){if(!(e.width===this._pixelsWidth&&e.height===this._pixelsHeight)){this.enableFullScreen=e.width>0&&e.height>0;for(var t in this.texturePool)if(Number(t)<0){var i=this.texturePool[t];if(i)for(var r=0;r<i.length;r++)i[r].destroy(!0);this.texturePool[t]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}},n.SCREEN_KEY=-1,n}(),N0=function(){function n(e,t,i,r,s,o,a){t===void 0&&(t=0),i===void 0&&(i=!1),r===void 0&&(r=Ge.FLOAT),this.buffer=e,this.size=t,this.normalized=i,this.type=r,this.stride=s,this.start=o,this.instance=a}return n.prototype.destroy=function(){this.buffer=null},n.from=function(e,t,i,r,s){return new n(e,t,i,r,s)},n}(),i9=0,vn=function(){function n(e,t,i){t===void 0&&(t=!0),i===void 0&&(i=!1),this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=t,this.id=i9++,this.disposeRunner=new On("disposeBuffer")}return n.prototype.update=function(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++},n.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},n.prototype.destroy=function(){this.dispose(),this.data=null},Object.defineProperty(n.prototype,"index",{get:function(){return this.type===Pr.ELEMENT_ARRAY_BUFFER},set:function(e){this.type=e?Pr.ELEMENT_ARRAY_BUFFER:Pr.ARRAY_BUFFER},enumerable:!1,configurable:!0}),n.from=function(e){return e instanceof Array&&(e=new Float32Array(e)),new n(e)},n}(),r9={Float32Array,Uint32Array,Int32Array,Uint8Array};function s9(n,e){for(var t=0,i=0,r={},s=0;s<n.length;s++)i+=e[s],t+=n[s].length;for(var o=new ArrayBuffer(t*4),a=null,l=0,s=0;s<n.length;s++){var u=e[s],c=n[s],h=sg(c);r[h]||(r[h]=new r9[h](o)),a=r[h];for(var d=0;d<c.length;d++){var f=(d/u|0)*i+l,p=d%u;a[f+p]=c[d]}l+=u}return new Float32Array(o)}var iM={5126:4,5123:2,5121:1},o9=0,a9={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},Sc=function(){function n(e,t){e===void 0&&(e=[]),t===void 0&&(t={}),this.buffers=e,this.indexBuffer=null,this.attributes=t,this.glVertexArrayObjects={},this.id=o9++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new On("disposeGeometry"),this.refCount=0}return n.prototype.addAttribute=function(e,t,i,r,s,o,a,l){if(i===void 0&&(i=0),r===void 0&&(r=!1),l===void 0&&(l=!1),!t)throw new Error("You must pass a buffer when creating an attribute");t instanceof vn||(t instanceof Array&&(t=new Float32Array(t)),t=new vn(t));var u=e.split("|");if(u.length>1){for(var c=0;c<u.length;c++)this.addAttribute(u[c],t,i,r,s);return this}var h=this.buffers.indexOf(t);return h===-1&&(this.buffers.push(t),h=this.buffers.length-1),this.attributes[e]=new N0(h,i,r,s,o,a,l),this.instanced=this.instanced||l,this},n.prototype.getAttribute=function(e){return this.attributes[e]},n.prototype.getBuffer=function(e){return this.buffers[this.getAttribute(e).buffer]},n.prototype.addIndex=function(e){return e instanceof vn||(e instanceof Array&&(e=new Uint16Array(e)),e=new vn(e)),e.type=Pr.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.indexOf(e)===-1&&this.buffers.push(e),this},n.prototype.getIndex=function(){return this.indexBuffer},n.prototype.interleave=function(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;var e=[],t=[],i=new vn,r;for(r in this.attributes){var s=this.attributes[r],o=this.buffers[s.buffer];e.push(o.data),t.push(s.size*iM[s.type]/4),s.buffer=0}for(i.data=s9(e,t),r=0;r<this.buffers.length;r++)this.buffers[r]!==this.indexBuffer&&this.buffers[r].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},n.prototype.getSize=function(){for(var e in this.attributes){var t=this.attributes[e],i=this.buffers[t.buffer];return i.data.length/(t.stride/4||t.size)}return 0},n.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},n.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},n.prototype.clone=function(){for(var e=new n,t=0;t<this.buffers.length;t++)e.buffers[t]=new vn(this.buffers[t].data.slice(0));for(var t in this.attributes){var i=this.attributes[t];e.attributes[t]=new N0(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=Pr.ELEMENT_ARRAY_BUFFER),e},n.merge=function(e){for(var t=new n,i=[],r=[],s=[],o,a=0;a<e.length;a++){o=e[a];for(var l=0;l<o.buffers.length;l++)r[l]=r[l]||0,r[l]+=o.buffers[l].data.length,s[l]=0}for(var a=0;a<o.buffers.length;a++)i[a]=new a9[sg(o.buffers[a].data)](r[a]),t.buffers[a]=new vn(i[a]);for(var a=0;a<e.length;a++){o=e[a];for(var l=0;l<o.buffers.length;l++)i[l].set(o.buffers[l].data,s[l]),s[l]+=o.buffers[l].data.length}if(t.attributes=o.attributes,o.indexBuffer){t.indexBuffer=t.buffers[o.buffers.indexOf(o.indexBuffer)],t.indexBuffer.type=Pr.ELEMENT_ARRAY_BUFFER;for(var u=0,c=0,h=0,d=0,a=0;a<o.buffers.length;a++)if(o.buffers[a]!==o.indexBuffer){d=a;break}for(var a in o.attributes){var f=o.attributes[a];(f.buffer|0)===d&&(c+=f.size*iM[f.type]/4)}for(var a=0;a<e.length;a++){for(var p=e[a].indexBuffer.data,l=0;l<p.length;l++)t.indexBuffer.data[l+h]+=u;u+=e[a].buffers[d].data.length/c,h+=p.length}}return t},n}(),CI=function(n){$t(e,n);function e(){var t=n.call(this)||this;return t.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),t}return e}(Sc),_b=function(n){$t(e,n);function e(){var t=n.call(this)||this;return t.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),t.uvs=new Float32Array([0,0,1,0,1,1,0,1]),t.vertexBuffer=new vn(t.vertices),t.uvBuffer=new vn(t.uvs),t.addAttribute("aVertexPosition",t.vertexBuffer).addAttribute("aTextureCoord",t.uvBuffer).addIndex([0,1,2,0,2,3]),t}return e.prototype.map=function(t,i){var r=0,s=0;return this.uvs[0]=r,this.uvs[1]=s,this.uvs[2]=r+i.width/t.width,this.uvs[3]=s,this.uvs[4]=r+i.width/t.width,this.uvs[5]=s+i.height/t.height,this.uvs[6]=r,this.uvs[7]=s+i.height/t.height,r=i.x,s=i.y,this.vertices[0]=r,this.vertices[1]=s,this.vertices[2]=r+i.width,this.vertices[3]=s,this.vertices[4]=r+i.width,this.vertices[5]=s+i.height,this.vertices[6]=r,this.vertices[7]=s+i.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(Sc),l9=0,Do=function(){function n(e,t,i){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=l9++,this.static=!!t,this.ubo=!!i,e instanceof vn?(this.buffer=e,this.buffer.type=Pr.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new vn(new Float32Array(1)),this.buffer.type=Pr.UNIFORM_BUFFER,this.autoManage=!0))}return n.prototype.update=function(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()},n.prototype.add=function(e,t,i){if(!this.ubo)this.uniforms[e]=new n(t,i);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")},n.from=function(e,t,i){return new n(e,t,i)},n.uboFrom=function(e,t){return new n(e,t??!0,!0)},n}(),RI=function(){function n(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=Jt.NONE,this.sourceFrame=new St,this.destinationFrame=new St,this.bindingSourceFrame=new St,this.bindingDestinationFrame=new St,this.filters=[],this.transform=null}return n.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},n}(),Sf=[new Bt,new Bt,new Bt,new Bt],__=new kt,vb=function(){function n(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new PI,this.texturePool.setScreenSize(e.view),this.statePool=[],this.quad=new CI,this.quadUv=new _b,this.tempRect=new St,this.activeState={},this.globalUniforms=new Do({outputFrame:new St,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return n.prototype.push=function(e,t){for(var i,r,s=this.renderer,o=this.defaultFilterStack,a=this.statePool.pop()||new RI,l=this.renderer.renderTexture,u=t[0].resolution,c=t[0].multisample,h=t[0].padding,d=t[0].autoFit,f=(i=t[0].legacy)!==null&&i!==void 0?i:!0,p=1;p<t.length;p++){var _=t[p];u=Math.min(u,_.resolution),c=Math.min(c,_.multisample),h=this.useMaxPadding?Math.max(h,_.padding):h+_.padding,d=d&&_.autoFit,f=f||((r=_.legacy)!==null&&r!==void 0?r:!0)}o.length===1&&(this.defaultFilterStack[0].renderTexture=l.current),o.push(a),a.resolution=u,a.multisample=c,a.legacy=f,a.target=e,a.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),a.sourceFrame.pad(h);var m=this.tempRect.copyFrom(l.sourceFrame);s.projection.transform&&this.transformAABB(__.copyFrom(s.projection.transform).invert(),m),d?(a.sourceFrame.fit(m),(a.sourceFrame.width<=0||a.sourceFrame.height<=0)&&(a.sourceFrame.width=0,a.sourceFrame.height=0)):a.sourceFrame.intersects(m)||(a.sourceFrame.width=0,a.sourceFrame.height=0),this.roundFrame(a.sourceFrame,l.current?l.current.resolution:s.resolution,l.sourceFrame,l.destinationFrame,s.projection.transform),a.renderTexture=this.getOptimalFilterTexture(a.sourceFrame.width,a.sourceFrame.height,u,c),a.filters=t,a.destinationFrame.width=a.renderTexture.width,a.destinationFrame.height=a.renderTexture.height;var g=this.tempRect;g.x=0,g.y=0,g.width=a.sourceFrame.width,g.height=a.sourceFrame.height,a.renderTexture.filterFrame=a.sourceFrame,a.bindingSourceFrame.copyFrom(l.sourceFrame),a.bindingDestinationFrame.copyFrom(l.destinationFrame),a.transform=s.projection.transform,s.projection.transform=null,l.bind(a.renderTexture,a.sourceFrame,g),s.framebuffer.clear(0,0,0,0)},n.prototype.pop=function(){var e=this.defaultFilterStack,t=e.pop(),i=t.filters;this.activeState=t;var r=this.globalUniforms.uniforms;r.outputFrame=t.sourceFrame,r.resolution=t.resolution;var s=r.inputSize,o=r.inputPixel,a=r.inputClamp;if(s[0]=t.destinationFrame.width,s[1]=t.destinationFrame.height,s[2]=1/s[0],s[3]=1/s[1],o[0]=Math.round(s[0]*t.resolution),o[1]=Math.round(s[1]*t.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=t.sourceFrame.width*s[2]-.5*o[2],a[3]=t.sourceFrame.height*s[3]-.5*o[3],t.legacy){var l=r.filterArea;l[0]=t.destinationFrame.width,l[1]=t.destinationFrame.height,l[2]=t.sourceFrame.x,l[3]=t.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var u=e[e.length-1];if(this.renderer.framebuffer.blit(),i.length===1)i[0].apply(this,t.renderTexture,u.renderTexture,Wi.BLEND,t),this.returnFilterTexture(t.renderTexture);else{var c=t.renderTexture,h=this.getOptimalFilterTexture(c.width,c.height,t.resolution);h.filterFrame=c.filterFrame;var d=0;for(d=0;d<i.length-1;++d){d===1&&t.multisample>1&&(h=this.getOptimalFilterTexture(c.width,c.height,t.resolution),h.filterFrame=c.filterFrame),i[d].apply(this,c,h,Wi.CLEAR,t);var f=c;c=h,h=f}i[d].apply(this,c,u.renderTexture,Wi.BLEND,t),d>1&&t.multisample>1&&this.returnFilterTexture(t.renderTexture),this.returnFilterTexture(c),this.returnFilterTexture(h)}t.clear(),this.statePool.push(t)},n.prototype.bindAndClear=function(e,t){t===void 0&&(t=Wi.CLEAR);var i=this.renderer,r=i.renderTexture,s=i.state;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e&&e.filterFrame){var o=this.tempRect;o.x=0,o.y=0,o.width=e.filterFrame.width,o.height=e.filterFrame.height,r.bind(e,e.filterFrame,o)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?r.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var a=s.stateId&1||this.forceClear;(t===Wi.CLEAR||t===Wi.BLIT&&a)&&this.renderer.framebuffer.clear(0,0,0,0)},n.prototype.applyFilter=function(e,t,i,r){var s=this.renderer;s.state.set(e.state),this.bindAndClear(i,r),e.uniforms.uSampler=t,e.uniforms.filterGlobals=this.globalUniforms,s.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(t._frame,t.filterFrame),s.geometry.bind(this.quadUv),s.geometry.draw(Ji.TRIANGLES)):(s.geometry.bind(this.quad),s.geometry.draw(Ji.TRIANGLE_STRIP))},n.prototype.calculateSpriteMatrix=function(e,t){var i=this.activeState,r=i.sourceFrame,s=i.destinationFrame,o=t._texture.orig,a=e.set(s.width,0,0,s.height,r.x,r.y),l=t.worldTransform.copyTo(kt.TEMP_MATRIX);return l.invert(),a.prepend(l),a.scale(1/o.width,1/o.height),a.translate(t.anchor.x,t.anchor.y),a},n.prototype.destroy=function(){this.renderer=null,this.texturePool.clear(!1)},n.prototype.getOptimalFilterTexture=function(e,t,i,r){return i===void 0&&(i=1),r===void 0&&(r=Jt.NONE),this.texturePool.getOptimalTexture(e,t,i,r)},n.prototype.getFilterTexture=function(e,t,i){if(typeof e=="number"){var r=e;e=t,t=r}e=e||this.activeState.renderTexture;var s=this.texturePool.getOptimalTexture(e.width,e.height,t||e.resolution,i||Jt.NONE);return s.filterFrame=e.filterFrame,s},n.prototype.returnFilterTexture=function(e){this.texturePool.returnTexture(e)},n.prototype.emptyPool=function(){this.texturePool.clear(!0)},n.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},n.prototype.transformAABB=function(e,t){var i=Sf[0],r=Sf[1],s=Sf[2],o=Sf[3];i.set(t.left,t.top),r.set(t.left,t.bottom),s.set(t.right,t.top),o.set(t.right,t.bottom),e.apply(i,i),e.apply(r,r),e.apply(s,s),e.apply(o,o);var a=Math.min(i.x,r.x,s.x,o.x),l=Math.min(i.y,r.y,s.y,o.y),u=Math.max(i.x,r.x,s.x,o.x),c=Math.max(i.y,r.y,s.y,o.y);t.x=a,t.y=l,t.width=u-a,t.height=c-l},n.prototype.roundFrame=function(e,t,i,r,s){if(!(e.width<=0||e.height<=0||i.width<=0||i.height<=0)){if(s){var o=s.a,a=s.b,l=s.c,u=s.d;if((Math.abs(a)>1e-4||Math.abs(l)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(u)>1e-4))return}s=s?__.copyFrom(s):__.identity(),s.translate(-i.x,-i.y).scale(r.width/i.width,r.height/i.height).translate(r.x,r.y),this.transformAABB(s,e),e.ceil(t),this.transformAABB(s.invert(),e)}},n}(),kd=function(){function n(e){this.renderer=e}return n.prototype.flush=function(){},n.prototype.destroy=function(){this.renderer=null},n.prototype.start=function(){},n.prototype.stop=function(){this.flush()},n.prototype.render=function(e){},n}(),yb=function(){function n(e){this.renderer=e,this.emptyRenderer=new kd(e),this.currentRenderer=this.emptyRenderer}return n.prototype.setObjectRenderer=function(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())},n.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},n.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},n.prototype.copyBoundTextures=function(e,t){for(var i=this.renderer.texture.boundTextures,r=t-1;r>=0;--r)e[r]=i[r]||null,e[r]&&(e[r]._batchLocation=r)},n.prototype.boundArray=function(e,t,i,r){for(var s=e.elements,o=e.ids,a=e.count,l=0,u=0;u<a;u++){var c=s[u],h=c._batchLocation;if(h>=0&&h<r&&t[h]===c){o[u]=h;continue}for(;l<r;){var d=t[l];if(d&&d._batchEnabled===i&&d._batchLocation===l){l++;continue}o[u]=l,c._batchLocation=l,t[l]=c;break}}},n.prototype.destroy=function(){this.renderer=null},n}(),rM=0,xb=function(){function n(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),e.view.addEventListener("webglcontextlost",this.handleContextLost,!1),e.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}return Object.defineProperty(n.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),n.prototype.contextChange=function(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=rM++},n.prototype.initFromContext=function(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=rM++,this.renderer.runners.contextChange.emit(e)},n.prototype.initFromOptions=function(e){var t=this.createContext(this.renderer.view,e);this.initFromContext(t)},n.prototype.createContext=function(e,t){var i;if(Oe.PREFER_ENV>=as.WEBGL2&&(i=e.getContext("webgl2",t)),i)this.webGLVersion=2;else if(this.webGLVersion=1,i=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),!i)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),this.gl},n.prototype.getExtensions=function(){var e=this.gl,t={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,t,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,t,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})},n.prototype.handleContextLost=function(e){var t=this;e.preventDefault(),setTimeout(function(){t.gl.isContextLost()&&t.extensions.loseContext&&t.extensions.loseContext.restoreContext()},0)},n.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},n.prototype.destroy=function(){var e=this.renderer.view;this.renderer=null,e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},n.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},n.prototype.validateContext=function(e){var t=e.getContextAttributes(),i="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;i&&(this.webGLVersion=2),t&&!t.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var r=i||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=r,r||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},n}(),II=function(){function n(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=Jt.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}return n}(),u9=new St,bb=function(){function n(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new rm(10,10),this.msaaSamples=null}return n.prototype.contextChange=function(){this.disposeAll(!0);var e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new St,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){var t=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;Oe.PREFER_ENV===as.WEBGL_LEGACY&&(t=null,i=null),t?e.drawBuffers=function(r){return t.drawBuffersWEBGL(r)}:(this.hasMRT=!1,e.drawBuffers=function(){}),i||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)},n.prototype.bind=function(e,t,i){i===void 0&&(i=0);var r=this.gl;if(e){var s=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,r.bindFramebuffer(r.FRAMEBUFFER,s.framebuffer)),s.mipLevel!==i&&(e.dirtyId++,e.dirtyFormat++,s.mipLevel=i),s.dirtyId!==e.dirtyId&&(s.dirtyId=e.dirtyId,s.dirtyFormat!==e.dirtyFormat?(s.dirtyFormat=e.dirtyFormat,s.dirtySize=e.dirtySize,this.updateFramebuffer(e,i)):s.dirtySize!==e.dirtySize&&(s.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(var o=0;o<e.colorTextures.length;o++){var a=e.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),t){var l=t.width>>i,u=t.height>>i,c=l/t.width;this.setViewport(t.x*c,t.y*c,l,u)}else{var l=e.width>>i,u=e.height>>i;this.setViewport(0,0,l,u)}}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},n.prototype.setViewport=function(e,t,i,r){var s=this.viewport;e=Math.round(e),t=Math.round(t),i=Math.round(i),r=Math.round(r),(s.width!==i||s.height!==r||s.x!==e||s.y!==t)&&(s.x=e,s.y=t,s.width=i,s.height=r,this.gl.viewport(e,t,i,r))},Object.defineProperty(n.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),n.prototype.clear=function(e,t,i,r,s){s===void 0&&(s=nd.COLOR|nd.DEPTH);var o=this.gl;o.clearColor(e,t,i,r),o.clear(s)},n.prototype.initFramebuffer=function(e){var t=this.gl,i=new II(t.createFramebuffer());return i.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=i,this.managedFramebuffers.push(e),e.disposeRunner.add(this),i},n.prototype.resizeFramebuffer=function(e){var t=this.gl,i=e.glFramebuffers[this.CONTEXT_UID];i.msaaBuffer&&(t.bindRenderbuffer(t.RENDERBUFFER,i.msaaBuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,i.multisample,t.RGBA8,e.width,e.height)),i.stencil&&(t.bindRenderbuffer(t.RENDERBUFFER,i.stencil),i.msaaBuffer?t.renderbufferStorageMultisample(t.RENDERBUFFER,i.multisample,t.DEPTH24_STENCIL8,e.width,e.height):t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,e.width,e.height));var r=e.colorTextures,s=r.length;t.drawBuffers||(s=Math.min(s,1));for(var o=0;o<s;o++){var a=r[o],l=a.parentTextureArray||a;this.renderer.texture.bind(l,0)}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)},n.prototype.updateFramebuffer=function(e,t){var i=this.gl,r=e.glFramebuffers[this.CONTEXT_UID],s=e.colorTextures,o=s.length;i.drawBuffers||(o=Math.min(o,1)),r.multisample>1&&this.canMultisampleFramebuffer(e)?(r.msaaBuffer=r.msaaBuffer||i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,r.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,r.multisample,i.RGBA8,e.width,e.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,r.msaaBuffer)):r.msaaBuffer&&(i.deleteRenderbuffer(r.msaaBuffer),r.msaaBuffer=null,r.blitFramebuffer&&(r.blitFramebuffer.dispose(),r.blitFramebuffer=null));for(var a=[],l=0;l<o;l++){var u=s[l],c=u.parentTextureArray||u;this.renderer.texture.bind(c,0),!(l===0&&r.msaaBuffer)&&(i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+l,u.target,c._glTextures[this.CONTEXT_UID].texture,t),a.push(i.COLOR_ATTACHMENT0+l))}if(a.length>1&&i.drawBuffers(a),e.depthTexture){var h=this.writeDepthTexture;if(h){var d=e.depthTexture;this.renderer.texture.bind(d,0),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,d._glTextures[this.CONTEXT_UID].texture,t)}}(e.stencil||e.depth)&&!(e.depthTexture&&this.writeDepthTexture)?(r.stencil=r.stencil||i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,r.stencil),r.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,r.multisample,i.DEPTH24_STENCIL8,e.width,e.height):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,e.width,e.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,r.stencil)):r.stencil&&(i.deleteRenderbuffer(r.stencil),r.stencil=null)},n.prototype.canMultisampleFramebuffer=function(e){return this.renderer.context.webGLVersion!==1&&e.colorTextures.length<=1&&!e.depthTexture},n.prototype.detectSamples=function(e){var t=this.msaaSamples,i=Jt.NONE;if(e<=1||t===null)return i;for(var r=0;r<t.length;r++)if(t[r]<=e){i=t[r];break}return i===1&&(i=Jt.NONE),i},n.prototype.blit=function(e,t,i){var r=this,s=r.current,o=r.renderer,a=r.gl,l=r.CONTEXT_UID;if(o.context.webGLVersion===2&&s){var u=s.glFramebuffers[l];if(u){if(!e){if(!u.msaaBuffer)return;var c=s.colorTextures[0];if(!c)return;u.blitFramebuffer||(u.blitFramebuffer=new rm(s.width,s.height),u.blitFramebuffer.addColorTexture(0,c)),e=u.blitFramebuffer,e.colorTextures[0]!==c&&(e.colorTextures[0]=c,e.dirtyId++,e.dirtyFormat++),(e.width!==s.width||e.height!==s.height)&&(e.width=s.width,e.height=s.height,e.dirtyId++,e.dirtySize++)}t||(t=u9,t.width=s.width,t.height=s.height),i||(i=t);var h=t.width===i.width&&t.height===i.height;this.bind(e),a.bindFramebuffer(a.READ_FRAMEBUFFER,u.framebuffer),a.blitFramebuffer(t.left,t.top,t.right,t.bottom,i.left,i.top,i.right,i.bottom,a.COLOR_BUFFER_BIT,h?a.NEAREST:a.LINEAR)}}},n.prototype.disposeFramebuffer=function(e,t){var i=e.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(i){delete e.glFramebuffers[this.CONTEXT_UID];var s=this.managedFramebuffers.indexOf(e);s>=0&&this.managedFramebuffers.splice(s,1),e.disposeRunner.remove(this),t||(r.deleteFramebuffer(i.framebuffer),i.msaaBuffer&&r.deleteRenderbuffer(i.msaaBuffer),i.stencil&&r.deleteRenderbuffer(i.stencil)),i.blitFramebuffer&&i.blitFramebuffer.dispose()}},n.prototype.disposeAll=function(e){var t=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<t.length;i++)this.disposeFramebuffer(t[i],e)},n.prototype.forceStencil=function(){var e=this.current;if(e){var t=e.glFramebuffers[this.CONTEXT_UID];if(!(!t||t.stencil)){e.stencil=!0;var i=e.width,r=e.height,s=this.gl,o=s.createRenderbuffer();s.bindRenderbuffer(s.RENDERBUFFER,o),t.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,t.multisample,s.DEPTH24_STENCIL8,i,r):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,i,r),t.stencil=o,s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,o)}}},n.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new St},n.prototype.destroy=function(){this.renderer=null},n}(),v_={5126:4,5123:2,5121:1},Sb=function(){function n(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}return n.prototype.contextChange=function(){this.disposeAll(!0);var e=this.gl=this.renderer.gl,t=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,t.webGLVersion!==2){var i=this.renderer.context.extensions.vertexArrayObject;Oe.PREFER_ENV===as.WEBGL_LEGACY&&(i=null),i?(e.createVertexArray=function(){return i.createVertexArrayOES()},e.bindVertexArray=function(s){return i.bindVertexArrayOES(s)},e.deleteVertexArray=function(s){return i.deleteVertexArrayOES(s)}):(this.hasVao=!1,e.createVertexArray=function(){return null},e.bindVertexArray=function(){return null},e.deleteVertexArray=function(){return null})}if(t.webGLVersion!==2){var r=e.getExtension("ANGLE_instanced_arrays");r?(e.vertexAttribDivisor=function(s,o){return r.vertexAttribDivisorANGLE(s,o)},e.drawElementsInstanced=function(s,o,a,l,u){return r.drawElementsInstancedANGLE(s,o,a,l,u)},e.drawArraysInstanced=function(s,o,a,l){return r.drawArraysInstancedANGLE(s,o,a,l)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=t.webGLVersion===2||!!t.extensions.uint32ElementIndex},n.prototype.bind=function(e,t){t=t||this.renderer.shader.shader;var i=this.gl,r=e.glVertexArrayObjects[this.CONTEXT_UID],s=!1;r||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=r={},s=!0);var o=r[t.program.id]||this.initGeometryVao(e,t,s);this._activeGeometry=e,this._activeVao!==o&&(this._activeVao=o,this.hasVao?i.bindVertexArray(o):this.activateVao(e,t.program)),this.updateBuffers()},n.prototype.reset=function(){this.unbind()},n.prototype.updateBuffers=function(){for(var e=this._activeGeometry,t=this.renderer.buffer,i=0;i<e.buffers.length;i++){var r=e.buffers[i];t.update(r)}},n.prototype.checkCompatibility=function(e,t){var i=e.attributes,r=t.attributeData;for(var s in r)if(!i[s])throw new Error('shader and geometry incompatible, geometry missing the "'+s+'" attribute')},n.prototype.getSignature=function(e,t){var i=e.attributes,r=t.attributeData,s=["g",e.id];for(var o in i)r[o]&&s.push(o,r[o].location);return s.join("-")},n.prototype.initGeometryVao=function(e,t,i){i===void 0&&(i=!0);var r=this.gl,s=this.CONTEXT_UID,o=this.renderer.buffer,a=t.program;a.glPrograms[s]||this.renderer.shader.generateProgram(t),this.checkCompatibility(e,a);var l=this.getSignature(e,a),u=e.glVertexArrayObjects[this.CONTEXT_UID],c=u[l];if(c)return u[a.id]=c,c;var h=e.buffers,d=e.attributes,f={},p={};for(var _ in h)f[_]=0,p[_]=0;for(var _ in d)!d[_].size&&a.attributeData[_]?d[_].size=a.attributeData[_].size:d[_].size||console.warn("PIXI Geometry attribute '"+_+"' size cannot be determined (likely the bound shader does not have the attribute)"),f[d[_].buffer]+=d[_].size*v_[d[_].type];for(var _ in d){var m=d[_],g=m.size;m.stride===void 0&&(f[m.buffer]===g*v_[m.type]?m.stride=0:m.stride=f[m.buffer]),m.start===void 0&&(m.start=p[m.buffer],p[m.buffer]+=g*v_[m.type])}c=r.createVertexArray(),r.bindVertexArray(c);for(var v=0;v<h.length;v++){var y=h[v];o.bind(y),i&&y._glBuffers[s].refCount++}return this.activateVao(e,a),this._activeVao=c,u[a.id]=c,u[l]=c,c},n.prototype.disposeGeometry=function(e,t){var i;if(this.managedGeometries[e.id]){delete this.managedGeometries[e.id];var r=e.glVertexArrayObjects[this.CONTEXT_UID],s=this.gl,o=e.buffers,a=(i=this.renderer)===null||i===void 0?void 0:i.buffer;if(e.disposeRunner.remove(this),!!r){if(a)for(var l=0;l<o.length;l++){var u=o[l]._glBuffers[this.CONTEXT_UID];u&&(u.refCount--,u.refCount===0&&!t&&a.dispose(o[l],t))}if(!t){for(var c in r)if(c[0]==="g"){var h=r[c];this._activeVao===h&&this.unbind(),s.deleteVertexArray(h)}}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}},n.prototype.disposeAll=function(e){for(var t=Object.keys(this.managedGeometries),i=0;i<t.length;i++)this.disposeGeometry(this.managedGeometries[t[i]],e)},n.prototype.activateVao=function(e,t){var i=this.gl,r=this.CONTEXT_UID,s=this.renderer.buffer,o=e.buffers,a=e.attributes;e.indexBuffer&&s.bind(e.indexBuffer);var l=null;for(var u in a){var c=a[u],h=o[c.buffer],d=h._glBuffers[r];if(t.attributeData[u]){l!==d&&(s.bind(h),l=d);var f=t.attributeData[u].location;if(i.enableVertexAttribArray(f),i.vertexAttribPointer(f,c.size,c.type||i.FLOAT,c.normalized,c.stride,c.start),c.instance)if(this.hasInstance)i.vertexAttribDivisor(f,1);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}},n.prototype.draw=function(e,t,i,r){var s=this.gl,o=this._activeGeometry;if(o.indexBuffer){var a=o.indexBuffer.data.BYTES_PER_ELEMENT,l=a===2?s.UNSIGNED_SHORT:s.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?o.instanced?s.drawElementsInstanced(e,t||o.indexBuffer.data.length,l,(i||0)*a,r||1):s.drawElements(e,t||o.indexBuffer.data.length,l,(i||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?s.drawArraysInstanced(e,i,t||o.getSize(),r||1):s.drawArrays(e,i,t||o.getSize());return this},n.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},n.prototype.destroy=function(){this.renderer=null},n}(),LI=function(){function n(e){e===void 0&&(e=null),this.type=fn.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Oe.FILTER_MULTISAMPLE,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}return Object.defineProperty(n.prototype,"filter",{get:function(){return this._filters?this._filters[0]:null},set:function(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null},enumerable:!1,configurable:!0}),n.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=fn.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null},n.prototype.copyCountersOrReset=function(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},n}();function sM(n,e,t){var i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}function oM(n,e){var t=n.getShaderSource(e).split(`
`).map(function(u,c){return c+": "+u}),i=n.getShaderInfoLog(e),r=i.split(`
`),s={},o=r.map(function(u){return parseFloat(u.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))}).filter(function(u){return u&&!s[u]?(s[u]=!0,!0):!1}),a=[""];o.forEach(function(u){t[u-1]="%c"+t[u-1]+"%c",a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});var l=t.join(`
`);a[0]=l,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn.apply(console,a),console.groupEnd()}function c9(n,e,t,i){n.getProgramParameter(e,n.LINK_STATUS)||(n.getShaderParameter(t,n.COMPILE_STATUS)||oM(n,t),n.getShaderParameter(i,n.COMPILE_STATUS)||oM(n,i),console.error("PixiJS Error: Could not initialize shader."),n.getProgramInfoLog(e)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",n.getProgramInfoLog(e)))}function y_(n){for(var e=new Array(n),t=0;t<e.length;t++)e[t]=!1;return e}function OI(n,e){switch(n){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return y_(2*e);case"bvec3":return y_(3*e);case"bvec4":return y_(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var DI={},Uc=DI;function FI(){if(Uc===DI||Uc&&Uc.isContextLost()){var n=Oe.ADAPTER.createCanvas(),e=void 0;Oe.PREFER_ENV>=as.WEBGL2&&(e=n.getContext("webgl2",{})),e||(e=n.getContext("webgl",{})||n.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),Uc=e}return Uc}var Ef;function h9(){if(!Ef){Ef=gi.MEDIUM;var n=FI();if(n&&n.getShaderPrecisionFormat){var e=n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT);Ef=e.precision?gi.HIGH:gi.MEDIUM}}return Ef}function aM(n,e,t){if(n.substring(0,9)!=="precision"){var i=e;return e===gi.HIGH&&t!==gi.HIGH&&(i=gi.MEDIUM),"precision "+i+` float;
`+n}else if(t!==gi.HIGH&&n.substring(0,15)==="precision highp")return n.replace("precision highp","precision mediump");return n}var d9={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function NI(n){return d9[n]}var Tf=null,lM={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function UI(n,e){if(!Tf){var t=Object.keys(lM);Tf={};for(var i=0;i<t.length;++i){var r=t[i];Tf[n[r]]=lM[r]}}return Tf[e]}var rl=[{test:function(n){return n.type==="float"&&n.size===1&&!n.isArray},code:function(n){return`
            if(uv["`+n+'"] !== ud["'+n+`"].value)
            {
                ud["`+n+'"].value = uv["'+n+`"]
                gl.uniform1f(ud["`+n+'"].location, uv["'+n+`"])
            }
            `}},{test:function(n,e){return(n.type==="sampler2D"||n.type==="samplerCube"||n.type==="sampler2DArray")&&n.size===1&&!n.isArray&&(e==null||e.castToBaseTexture!==void 0)},code:function(n){return`t = syncData.textureCount++;

            renderer.texture.bind(uv["`+n+`"], t);

            if(ud["`+n+`"].value !== t)
            {
                ud["`+n+`"].value = t;
                gl.uniform1i(ud["`+n+`"].location, t);
; // eslint-disable-line max-len
            }`}},{test:function(n,e){return n.type==="mat3"&&n.size===1&&!n.isArray&&e.a!==void 0},code:function(n){return`
            gl.uniformMatrix3fv(ud["`+n+'"].location, false, uv["'+n+`"].toArray(true));
            `},codeUbo:function(n){return`
                var `+n+"_matrix = uv."+n+`.toArray(true);

                data[offset] = `+n+`_matrix[0];
                data[offset+1] = `+n+`_matrix[1];
                data[offset+2] = `+n+`_matrix[2];
        
                data[offset + 4] = `+n+`_matrix[3];
                data[offset + 5] = `+n+`_matrix[4];
                data[offset + 6] = `+n+`_matrix[5];
        
                data[offset + 8] = `+n+`_matrix[6];
                data[offset + 9] = `+n+`_matrix[7];
                data[offset + 10] = `+n+`_matrix[8];
            `}},{test:function(n,e){return n.type==="vec2"&&n.size===1&&!n.isArray&&e.x!==void 0},code:function(n){return`
                cv = ud["`+n+`"].value;
                v = uv["`+n+`"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["`+n+`"].location, v.x, v.y);
                }`},codeUbo:function(n){return`
                v = uv.`+n+`;

                data[offset] = v.x;
                data[offset+1] = v.y;
            `}},{test:function(n){return n.type==="vec2"&&n.size===1&&!n.isArray},code:function(n){return`
                cv = ud["`+n+`"].value;
                v = uv["`+n+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["`+n+`"].location, v[0], v[1]);
                }
            `}},{test:function(n,e){return n.type==="vec4"&&n.size===1&&!n.isArray&&e.width!==void 0},code:function(n){return`
                cv = ud["`+n+`"].value;
                v = uv["`+n+`"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["`+n+`"].location, v.x, v.y, v.width, v.height)
                }`},codeUbo:function(n){return`
                    v = uv.`+n+`;

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `}},{test:function(n){return n.type==="vec4"&&n.size===1&&!n.isArray},code:function(n){return`
                cv = ud["`+n+`"].value;
                v = uv["`+n+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["`+n+`"].location, v[0], v[1], v[2], v[3])
                }`}}],f9={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},p9={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function m9(n,e){var t,i=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(var r in n.uniforms){var s=e[r];if(!s){!((t=n.uniforms[r])===null||t===void 0)&&t.group&&(n.uniforms[r].ubo?i.push(`
                        renderer.shader.syncUniformBufferGroup(uv.`+r+", '"+r+`');
                    `):i.push(`
                        renderer.shader.syncUniformGroup(uv.`+r+`, syncData);
                    `));continue}for(var o=n.uniforms[r],a=!1,l=0;l<rl.length;l++)if(rl[l].test(s,o)){i.push(rl[l].code(r,o)),a=!0;break}if(!a){var u=s.size===1&&!s.isArray?f9:p9,c=u[s.type].replace("location",'ud["'+r+'"].location');i.push(`
            cu = ud["`+r+`"];
            cv = cu.value;
            v = uv["`+r+`"];
            `+c+";")}}return new Function("ud","uv","renderer","syncData",i.join(`
`))}var g9=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function _9(n){for(var e="",t=0;t<n;++t)t>0&&(e+=`
else `),t<n-1&&(e+="if(test == "+t+".0){}");return e}function BI(n,e){if(n===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var t=e.createShader(e.FRAGMENT_SHADER);;){var i=g9.replace(/%forloop%/gi,_9(n));if(e.shaderSource(t,i),e.compileShader(t),!e.getShaderParameter(t,e.COMPILE_STATUS))n=n/2|0;else break}return n}var Bc;function v9(){if(typeof Bc=="boolean")return Bc;try{var n=new Function("param1","param2","param3","return param1[param2] === param3;");Bc=n({a:"b"},"a","b")===!0}catch{Bc=!1}return Bc}var y9=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,x9=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`,b9=0,Mf={},Ec=function(){function n(e,t,i){i===void 0&&(i="pixi-shader"),this.id=b9++,this.vertexSrc=e||n.defaultVertexSrc,this.fragmentSrc=t||n.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.vertexSrc.substring(0,8)!=="#version"&&(i=i.replace(/\s+/g,"-"),Mf[i]?(Mf[i]++,i+="-"+Mf[i]):Mf[i]=1,this.vertexSrc="#define SHADER_NAME "+i+`
`+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+`
`+this.fragmentSrc,this.vertexSrc=aM(this.vertexSrc,Oe.PRECISION_VERTEX,gi.HIGH),this.fragmentSrc=aM(this.fragmentSrc,Oe.PRECISION_FRAGMENT,h9())),this.glPrograms={},this.syncUniforms=null}return Object.defineProperty(n,"defaultVertexSrc",{get:function(){return x9},enumerable:!1,configurable:!0}),Object.defineProperty(n,"defaultFragmentSrc",{get:function(){return y9},enumerable:!1,configurable:!0}),n.from=function(e,t,i){var r=e+t,s=I0[r];return s||(I0[r]=s=new n(e,t,i)),s},n}(),Xs=function(){function n(e,t){this.uniformBindCount=0,this.program=e,t?t instanceof Do?this.uniformGroup=t:this.uniformGroup=new Do(t):this.uniformGroup=new Do({}),this.disposeRunner=new On("disposeShader")}return n.prototype.checkUniformExists=function(e,t){if(t.uniforms[e])return!0;for(var i in t.uniforms){var r=t.uniforms[i];if(r.group&&this.checkUniformExists(e,r))return!0}return!1},n.prototype.destroy=function(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()},Object.defineProperty(n.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),n.from=function(e,t,i){var r=Ec.from(e,t);return new n(r,i)},n}(),x_=0,b_=1,S_=2,E_=3,T_=4,M_=5,qo=function(){function n(){this.data=0,this.blendMode=He.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return Object.defineProperty(n.prototype,"blend",{get:function(){return!!(this.data&1<<x_)},set:function(e){!!(this.data&1<<x_)!==e&&(this.data^=1<<x_)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"offsets",{get:function(){return!!(this.data&1<<b_)},set:function(e){!!(this.data&1<<b_)!==e&&(this.data^=1<<b_)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"culling",{get:function(){return!!(this.data&1<<S_)},set:function(e){!!(this.data&1<<S_)!==e&&(this.data^=1<<S_)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"depthTest",{get:function(){return!!(this.data&1<<E_)},set:function(e){!!(this.data&1<<E_)!==e&&(this.data^=1<<E_)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"depthMask",{get:function(){return!!(this.data&1<<M_)},set:function(e){!!(this.data&1<<M_)!==e&&(this.data^=1<<M_)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"clockwiseFrontFace",{get:function(){return!!(this.data&1<<T_)},set:function(e){!!(this.data&1<<T_)!==e&&(this.data^=1<<T_)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"blendMode",{get:function(){return this._blendMode},set:function(e){this.blend=e!==He.NONE,this._blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(e){this.offsets=!!e,this._polygonOffset=e},enumerable:!1,configurable:!0}),n.prototype.toString=function(){return"[@pixi/core:State "+("blendMode="+this.blendMode+" ")+("clockwiseFrontFace="+this.clockwiseFrontFace+" ")+("culling="+this.culling+" ")+("depthMask="+this.depthMask+" ")+("polygonOffset="+this.polygonOffset)+"]"},n.for2d=function(){var e=new n;return e.depthTest=!1,e.blend=!0,e},n}(),S9=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,E9=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,eo=function(n){$t(e,n);function e(t,i,r){var s=this,o=Ec.from(t||e.defaultVertexSrc,i||e.defaultFragmentSrc);return s=n.call(this,o,r)||this,s.padding=0,s.resolution=Oe.FILTER_RESOLUTION,s.multisample=Oe.FILTER_MULTISAMPLE,s.enabled=!0,s.autoFit=!0,s.state=new qo,s}return e.prototype.apply=function(t,i,r,s,o){t.applyFilter(this,i,r,s)},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._resolution=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultVertexSrc",{get:function(){return E9},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentSrc",{get:function(){return S9},enumerable:!1,configurable:!0}),e}(Xs),T9=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`,M9=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,uM=new kt,ug=function(){function n(e,t){this._texture=e,this.mapCoord=new kt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof t>"u"?.5:t,this.isSimple=!1}return Object.defineProperty(n.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture=e,this._textureID=-1},enumerable:!1,configurable:!0}),n.prototype.multiplyUvs=function(e,t){t===void 0&&(t=e);for(var i=this.mapCoord,r=0;r<e.length;r+=2){var s=e[r],o=e[r+1];t[r]=s*i.a+o*i.c+i.tx,t[r+1]=s*i.b+o*i.d+i.ty}return t},n.prototype.update=function(e){var t=this._texture;if(!t||!t.valid||!e&&this._textureID===t._updateID)return!1;this._textureID=t._updateID,this._updateID++;var i=t._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var r=t.orig,s=t.trim;s&&(uM.set(r.width/s.width,0,0,r.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append(uM));var o=t.baseTexture,a=this.uClampFrame,l=this.clampMargin/o.resolution,u=this.clampOffset;return a[0]=(t._frame.x+l+u)/o.width,a[1]=(t._frame.y+l+u)/o.height,a[2]=(t._frame.x+t._frame.width-l+u)/o.width,a[3]=(t._frame.y+t._frame.height-l+u)/o.height,this.uClampOffset[0]=u/o.realWidth,this.uClampOffset[1]=u/o.realHeight,this.isSimple=t._frame.width===o.width&&t._frame.height===o.height&&t.rotate===0,!0},n}(),kI=function(n){$t(e,n);function e(t,i,r){var s=this,o=null;return typeof t!="string"&&i===void 0&&r===void 0&&(o=t,t=void 0,i=void 0,r=void 0),s=n.call(this,t||T9,i||M9,r)||this,s.maskSprite=o,s.maskMatrix=new kt,s}return Object.defineProperty(e.prototype,"maskSprite",{get:function(){return this._maskSprite},set:function(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)},enumerable:!1,configurable:!0}),e.prototype.apply=function(t,i,r,s){var o=this._maskSprite,a=o._texture;a.valid&&(a.uvMatrix||(a.uvMatrix=new ug(a,0)),a.uvMatrix.update(),this.uniforms.npmAlpha=a.baseTexture.alphaMode?0:1,this.uniforms.mask=a,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,o).prepend(a.uvMatrix.mapCoord),this.uniforms.alpha=o.worldAlpha,this.uniforms.maskClamp=a.uvMatrix.uClampFrame,t.applyFilter(this,i,r,s))},e}(eo),Eb=function(){function n(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return n.prototype.setMaskStack=function(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)},n.prototype.push=function(e,t){var i=t;if(!i.isMaskData){var r=this.maskDataPool.pop()||new LI;r.pooled=!0,r.maskObject=t,i=r}var s=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(i.copyCountersOrReset(s),i._colorMask=s?s._colorMask:15,i.autoDetect&&this.detect(i),i._target=e,i.type!==fn.SPRITE&&this.maskStack.push(i),i.enabled)switch(i.type){case fn.SCISSOR:this.renderer.scissor.push(i);break;case fn.STENCIL:this.renderer.stencil.push(i);break;case fn.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i);break;case fn.COLOR:this.pushColorMask(i);break}i.type===fn.SPRITE&&this.maskStack.push(i)},n.prototype.pop=function(e){var t=this.maskStack.pop();if(!(!t||t._target!==e)){if(t.enabled)switch(t.type){case fn.SCISSOR:this.renderer.scissor.pop(t);break;case fn.STENCIL:this.renderer.stencil.pop(t.maskObject);break;case fn.SPRITE:this.popSpriteMask(t);break;case fn.COLOR:this.popColorMask(t);break}if(t.reset(),t.pooled&&this.maskDataPool.push(t),this.maskStack.length!==0){var i=this.maskStack[this.maskStack.length-1];i.type===fn.SPRITE&&i._filters&&(i._filters[0].maskSprite=i.maskObject)}}},n.prototype.detect=function(e){var t=e.maskObject;t?t.isSprite?e.type=fn.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=fn.SCISSOR:e.type=fn.STENCIL:e.type=fn.COLOR},n.prototype.pushSpriteMask=function(e){var t,i,r=e.maskObject,s=e._target,o=e._filters;o||(o=this.alphaMaskPool[this.alphaMaskIndex],o||(o=this.alphaMaskPool[this.alphaMaskIndex]=[new kI]));var a=this.renderer,l=a.renderTexture,u,c;if(l.current){var h=l.current;u=e.resolution||h.resolution,c=(t=e.multisample)!==null&&t!==void 0?t:h.multisample}else u=e.resolution||a.resolution,c=(i=e.multisample)!==null&&i!==void 0?i:a.multisample;o[0].resolution=u,o[0].multisample=c,o[0].maskSprite=r;var d=s.filterArea;s.filterArea=r.getBounds(!0),a.filter.push(s,o),s.filterArea=d,e._filters||this.alphaMaskIndex++},n.prototype.popSpriteMask=function(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)},n.prototype.pushColorMask=function(e){var t=e._colorMask,i=e._colorMask=t&e.colorMask;i!==t&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)},n.prototype.popColorMask=function(e){var t=e._colorMask,i=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;i!==t&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)},n.prototype.destroy=function(){this.renderer=null},n}(),VI=function(){function n(e){this.renderer=e,this.maskStack=[],this.glConst=0}return n.prototype.getStackLength=function(){return this.maskStack.length},n.prototype.setMaskStack=function(e){var t=this.renderer.gl,i=this.getStackLength();this.maskStack=e;var r=this.getStackLength();r!==i&&(r===0?t.disable(this.glConst):(t.enable(this.glConst),this._useCurrent()))},n.prototype._useCurrent=function(){},n.prototype.destroy=function(){this.renderer=null,this.maskStack=null},n}(),cM=new kt,hM=[],Tb=function(n){$t(e,n);function e(t){var i=n.call(this,t)||this;return i.glConst=Oe.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST,i}return e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},e.prototype.calcScissorRect=function(t){var i;if(!t._scissorRectLocal){var r=t._scissorRect,s=t.maskObject,o=this.renderer,a=o.renderTexture,l=s.getBounds(!0,(i=hM.pop())!==null&&i!==void 0?i:new St);this.roundFrameToPixels(l,a.current?a.current.resolution:o.resolution,a.sourceFrame,a.destinationFrame,o.projection.transform),r&&l.fit(r),t._scissorRectLocal=l}},e.isMatrixRotated=function(t){if(!t)return!1;var i=t.a,r=t.b,s=t.c,o=t.d;return(Math.abs(r)>1e-4||Math.abs(s)>1e-4)&&(Math.abs(i)>1e-4||Math.abs(o)>1e-4)},e.prototype.testScissor=function(t){var i=t.maskObject;if(!i.isFastRect||!i.isFastRect()||e.isMatrixRotated(i.worldTransform)||e.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);var r=t._scissorRectLocal;return r.width>0&&r.height>0},e.prototype.roundFrameToPixels=function(t,i,r,s,o){e.isMatrixRotated(o)||(o=o?cM.copyFrom(o):cM.identity(),o.translate(-r.x,-r.y).scale(s.width/r.width,s.height/r.height).translate(s.x,s.y),this.renderer.filter.transformAABB(o,t),t.fit(s),t.x=Math.round(t.x*i),t.y=Math.round(t.y*i),t.width=Math.round(t.width*i),t.height=Math.round(t.height*i))},e.prototype.push=function(t){t._scissorRectLocal||this.calcScissorRect(t);var i=this.renderer.gl;t._scissorRect||i.enable(i.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=t._scissorRectLocal,this._useCurrent()},e.prototype.pop=function(t){var i=this.renderer.gl;t&&hM.push(t._scissorRectLocal),this.getStackLength()>0?this._useCurrent():i.disable(i.SCISSOR_TEST)},e.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,i;this.renderer.renderTexture.current?i=t.y:i=this.renderer.height-t.height-t.y,this.renderer.gl.scissor(t.x,i,t.width,t.height)},e}(VI),Mb=function(n){$t(e,n);function e(t){var i=n.call(this,t)||this;return i.glConst=Oe.ADAPTER.getWebGLRenderingContext().STENCIL_TEST,i}return e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},e.prototype.push=function(t){var i=t.maskObject,r=this.renderer.gl,s=t._stencilCounter;s===0&&(this.renderer.framebuffer.forceStencil(),r.clearStencil(0),r.clear(r.STENCIL_BUFFER_BIT),r.enable(r.STENCIL_TEST)),t._stencilCounter++;var o=t._colorMask;o!==0&&(t._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilFunc(r.EQUAL,s,4294967295),r.stencilOp(r.KEEP,r.KEEP,r.INCR),i.renderable=!0,i.render(this.renderer),this.renderer.batch.flush(),i.renderable=!1,o!==0&&(t._colorMask=o,r.colorMask((o&1)!==0,(o&2)!==0,(o&4)!==0,(o&8)!==0)),this._useCurrent()},e.prototype.pop=function(t){var i=this.renderer.gl;if(this.getStackLength()===0)i.disable(i.STENCIL_TEST);else{var r=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,s=r?r._colorMask:15;s!==0&&(r._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilOp(i.KEEP,i.KEEP,i.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,s!==0&&(r._colorMask=s,i.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)),this._useCurrent()}},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e}(VI),wb=function(){function n(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new kt,this.transform=null}return n.prototype.update=function(e,t,i,r){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=t||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);var s=this.renderer;s.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,s.globalUniforms.update(),s.shader.shader&&s.shader.syncUniformGroup(s.shader.shader.uniforms.globals)},n.prototype.calculateProjection=function(e,t,i,r){var s=this.projectionMatrix,o=r?-1:1;s.identity(),s.a=1/t.width*2,s.d=o*(1/t.height*2),s.tx=-1-t.x*s.a,s.ty=-o-t.y*s.d},n.prototype.setTransform=function(e){},n.prototype.destroy=function(){this.renderer=null},n}(),oa=new St,kc=new St,Ab=function(){function n(e){this.renderer=e,this.clearColor=e._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new St,this.destinationFrame=new St,this.viewportFrame=new St}return n.prototype.bind=function(e,t,i){e===void 0&&(e=null);var r=this.renderer;this.current=e;var s,o,a;e?(s=e.baseTexture,a=s.resolution,t||(oa.width=e.frame.width,oa.height=e.frame.height,t=oa),i||(kc.x=e.frame.x,kc.y=e.frame.y,kc.width=t.width,kc.height=t.height,i=kc),o=s.framebuffer):(a=r.resolution,t||(oa.width=r.screen.width,oa.height=r.screen.height,t=oa),i||(i=oa,i.width=t.width,i.height=t.height));var l=this.viewportFrame;l.x=i.x*a,l.y=i.y*a,l.width=i.width*a,l.height=i.height*a,e||(l.y=r.view.height-(l.y+l.height)),l.ceil(),this.renderer.framebuffer.bind(o,l),this.renderer.projection.update(i,t,a,!o),e?this.renderer.mask.setMaskStack(s.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(t),this.destinationFrame.copyFrom(i)},n.prototype.clear=function(e,t){this.current?e=e||this.current.baseTexture.clearColor:e=e||this.clearColor;var i=this.destinationFrame,r=this.current?this.current.baseTexture:this.renderer.screen,s=i.width!==r.width||i.height!==r.height;if(s){var o=this.viewportFrame,a=o.x,l=o.y,u=o.width,c=o.height;a=Math.round(a),l=Math.round(l),u=Math.round(u),c=Math.round(c),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(a,l,u,c)}this.renderer.framebuffer.clear(e[0],e[1],e[2],e[3],t),s&&this.renderer.scissor.pop()},n.prototype.resize=function(){this.bind(null)},n.prototype.reset=function(){this.bind(null)},n.prototype.destroy=function(){this.renderer=null},n}();function w9(n,e,t,i,r){t.buffer.update(r)}var A9={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},GI={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function HI(n){for(var e=n.map(function(l){return{data:l,offset:0,dataLen:0,dirty:0}}),t=0,i=0,r=0,s=0;s<e.length;s++){var o=e[s];if(t=GI[o.data.type],o.data.size>1&&(t=Math.max(t,16)*o.data.size),o.dataLen=t,i%t!==0&&i<16){var a=i%t%16;i+=a,r+=a}i+t>16?(r=Math.ceil(r/16)*16,o.offset=r,r+=t,i=t):(o.offset=r,i+=t,r+=t)}return r=Math.ceil(r/16)*16,{uboElements:e,size:r}}function zI(n,e){var t=[];for(var i in n)e[i]&&t.push(e[i]);return t.sort(function(r,s){return r.index-s.index}),t}function WI(n,e){if(!n.autoManage)return{size:0,syncFunc:w9};for(var t=zI(n.uniforms,e),i=HI(t),r=i.uboElements,s=i.size,o=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `],a=0;a<r.length;a++){for(var l=r[a],u=n.uniforms[l.data.name],c=l.data.name,h=!1,d=0;d<rl.length;d++){var f=rl[d];if(f.codeUbo&&f.test(l.data,u)){o.push("offset = "+l.offset/4+";",rl[d].codeUbo(l.data.name,u)),h=!0;break}}if(!h)if(l.data.size>1){var p=NI(l.data.type),_=Math.max(GI[l.data.type]/16,1),m=p/_,g=(4-m%4)%4;o.push(`
                cv = ud.`+c+`.value;
                v = uv.`+c+`;
                offset = `+l.offset/4+`;

                t = 0;

                for(var i=0; i < `+l.data.size*_+`; i++)
                {
                    for(var j = 0; j < `+m+`; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += `+g+`;
                }

                `)}else{var v=A9[l.data.type];o.push(`
                cv = ud.`+c+`.value;
                v = uv.`+c+`;
                offset = `+l.offset/4+`;
                `+v+`;
                `)}}return o.push(`
       renderer.buffer.update(buffer);
    `),{size:s,syncFunc:new Function("ud","uv","renderer","syncData","buffer",o.join(`
`))}}var P9=function(){function n(){}return n}(),XI=function(){function n(e,t){this.program=e,this.uniformData=t,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}return n.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null},n}();function C9(n,e){for(var t={},i=e.getProgramParameter(n,e.ACTIVE_ATTRIBUTES),r=0;r<i;r++){var s=e.getActiveAttrib(n,r);if(s.name.indexOf("gl_")!==0){var o=UI(e,s.type),a={type:o,name:s.name,size:NI(o),location:e.getAttribLocation(n,s.name)};t[s.name]=a}}return t}function R9(n,e){for(var t={},i=e.getProgramParameter(n,e.ACTIVE_UNIFORMS),r=0;r<i;r++){var s=e.getActiveUniform(n,r),o=s.name.replace(/\[.*?\]$/,""),a=!!s.name.match(/\[.*?\]$/),l=UI(e,s.type);t[o]={name:o,index:r,type:l,size:s.size,isArray:a,value:OI(l,s.size)}}return t}function jI(n,e){var t=sM(n,n.VERTEX_SHADER,e.vertexSrc),i=sM(n,n.FRAGMENT_SHADER,e.fragmentSrc),r=n.createProgram();if(n.attachShader(r,t),n.attachShader(r,i),n.linkProgram(r),n.getProgramParameter(r,n.LINK_STATUS)||c9(n,r,t,i),e.attributeData=C9(r,n),e.uniformData=R9(r,n),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){var s=Object.keys(e.attributeData);s.sort(function(c,h){return c>h?1:-1});for(var o=0;o<s.length;o++)e.attributeData[s[o]].location=o,n.bindAttribLocation(r,o,s[o]);n.linkProgram(r)}n.deleteShader(t),n.deleteShader(i);var a={};for(var o in e.uniformData){var l=e.uniformData[o];a[o]={location:n.getUniformLocation(r,o),value:OI(l.type,l.size)}}var u=new XI(r,a);return u}var I9=0,wf={textureCount:0,uboCount:0},Pb=function(){function n(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=I9++}return n.prototype.systemCheck=function(){if(!v9())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},n.prototype.contextChange=function(e){this.gl=e,this.reset()},n.prototype.bind=function(e,t){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;var i=e.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),t||(wf.textureCount=0,wf.uboCount=0,this.syncUniformGroup(e.uniformGroup,wf)),r},n.prototype.setUniforms=function(e){var t=this.shader.program,i=t.glPrograms[this.renderer.CONTEXT_UID];t.syncUniforms(i.uniformData,e,this.renderer)},n.prototype.syncUniformGroup=function(e,t){var i=this.getGlProgram();(!e.static||e.dirtyId!==i.uniformDirtyGroups[e.id])&&(i.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,i,t))},n.prototype.syncUniforms=function(e,t,i){var r=e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e);r(t.uniformData,e.uniforms,this.renderer,i)},n.prototype.createSyncGroups=function(e){var t=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[t]||(this.cache[t]=m9(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[t],e.syncUniforms[this.shader.program.id]},n.prototype.syncUniformBufferGroup=function(e,t){var i=this.getGlProgram();if(!e.static||e.dirtyId!==0||!i.uniformGroups[e.id]){e.dirtyId=0;var r=i.uniformGroups[e.id]||this.createSyncBufferGroup(e,i,t);e.buffer.update(),r(i.uniformData,e.uniforms,this.renderer,wf,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,i.uniformBufferBindings[t])},n.prototype.createSyncBufferGroup=function(e,t,i){var r=this.renderer.gl;this.renderer.buffer.bind(e.buffer);var s=this.gl.getUniformBlockIndex(t.program,i);t.uniformBufferBindings[i]=this.shader.uniformBindCount,r.uniformBlockBinding(t.program,s,this.shader.uniformBindCount),this.shader.uniformBindCount++;var o=this.getSignature(e,this.shader.program.uniformData,"ubo"),a=this._uboCache[o];if(a||(a=this._uboCache[o]=WI(e,this.shader.program.uniformData)),e.autoManage){var l=new Float32Array(a.size/4);e.buffer.update(l)}return t.uniformGroups[e.id]=a.syncFunc,t.uniformGroups[e.id]},n.prototype.getSignature=function(e,t,i){var r=e.uniforms,s=[i+"-"];for(var o in r)s.push(o),t[o]&&s.push(t[o].type);return s.join("-")},n.prototype.getGlProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},n.prototype.generateProgram=function(e){var t=this.gl,i=e.program,r=jI(t,i);return i.glPrograms[this.renderer.CONTEXT_UID]=r,r},n.prototype.reset=function(){this.program=null,this.shader=null},n.prototype.disposeShader=function(e){this.shader===e&&(this.shader=null)},n.prototype.destroy=function(){this.renderer=null,this.destroyed=!0},n}();function L9(n,e){return e===void 0&&(e=[]),e[He.NORMAL]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[He.ADD]=[n.ONE,n.ONE],e[He.MULTIPLY]=[n.DST_COLOR,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA],e[He.SCREEN]=[n.ONE,n.ONE_MINUS_SRC_COLOR,n.ONE,n.ONE_MINUS_SRC_ALPHA],e[He.OVERLAY]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[He.DARKEN]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[He.LIGHTEN]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[He.COLOR_DODGE]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[He.COLOR_BURN]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[He.HARD_LIGHT]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[He.SOFT_LIGHT]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[He.DIFFERENCE]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[He.EXCLUSION]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[He.HUE]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[He.SATURATION]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[He.COLOR]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[He.LUMINOSITY]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[He.NONE]=[0,0],e[He.NORMAL_NPM]=[n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA],e[He.ADD_NPM]=[n.SRC_ALPHA,n.ONE,n.ONE,n.ONE],e[He.SCREEN_NPM]=[n.SRC_ALPHA,n.ONE_MINUS_SRC_COLOR,n.ONE,n.ONE_MINUS_SRC_ALPHA],e[He.SRC_IN]=[n.DST_ALPHA,n.ZERO],e[He.SRC_OUT]=[n.ONE_MINUS_DST_ALPHA,n.ZERO],e[He.SRC_ATOP]=[n.DST_ALPHA,n.ONE_MINUS_SRC_ALPHA],e[He.DST_OVER]=[n.ONE_MINUS_DST_ALPHA,n.ONE],e[He.DST_IN]=[n.ZERO,n.SRC_ALPHA],e[He.DST_OUT]=[n.ZERO,n.ONE_MINUS_SRC_ALPHA],e[He.DST_ATOP]=[n.ONE_MINUS_DST_ALPHA,n.SRC_ALPHA],e[He.XOR]=[n.ONE_MINUS_DST_ALPHA,n.ONE_MINUS_SRC_ALPHA],e[He.SUBTRACT]=[n.ONE,n.ONE,n.ONE,n.ONE,n.FUNC_REVERSE_SUBTRACT,n.FUNC_ADD],e}var O9=0,D9=1,F9=2,N9=3,U9=4,B9=5,Cb=function(){function n(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=He.NONE,this._blendEq=!1,this.map=[],this.map[O9]=this.setBlend,this.map[D9]=this.setOffset,this.map[F9]=this.setCullFace,this.map[N9]=this.setDepthTest,this.map[U9]=this.setFrontFace,this.map[B9]=this.setDepthMask,this.checks=[],this.defaultState=new qo,this.defaultState.blend=!0}return n.prototype.contextChange=function(e){this.gl=e,this.blendModes=L9(e),this.set(this.defaultState),this.reset()},n.prototype.set=function(e){if(e=e||this.defaultState,this.stateId!==e.data){for(var t=this.stateId^e.data,i=0;t;)t&1&&this.map[i].call(this,!!(e.data&1<<i)),t=t>>1,i++;this.stateId=e.data}for(var i=0;i<this.checks.length;i++)this.checks[i](this,e)},n.prototype.forceState=function(e){e=e||this.defaultState;for(var t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(var t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data},n.prototype.setBlend=function(e){this.updateCheck(n.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)},n.prototype.setOffset=function(e){this.updateCheck(n.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},n.prototype.setDepthTest=function(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)},n.prototype.setDepthMask=function(e){this.gl.depthMask(e)},n.prototype.setCullFace=function(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)},n.prototype.setFrontFace=function(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])},n.prototype.setBlendMode=function(e){if(e!==this.blendMode){this.blendMode=e;var t=this.blendModes[e],i=this.gl;t.length===2?i.blendFunc(t[0],t[1]):i.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,i.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}},n.prototype.setPolygonOffset=function(e,t){this.gl.polygonOffset(e,t)},n.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},n.prototype.updateCheck=function(e,t){var i=this.checks.indexOf(e);t&&i===-1?this.checks.push(e):!t&&i!==-1&&this.checks.splice(i,1)},n.checkBlendMode=function(e,t){e.setBlendMode(t.blendMode)},n.checkPolygonOffset=function(e,t){e.setPolygonOffset(1,t.polygonOffset)},n.prototype.destroy=function(){this.gl=null},n}(),Rb=function(){function n(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=Oe.GC_MAX_IDLE,this.checkCountMax=Oe.GC_MAX_CHECK_COUNT,this.mode=Oe.GC_MODE}return n.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==rd.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},n.prototype.run=function(){for(var e=this.renderer.texture,t=e.managedTextures,i=!1,r=0;r<t.length;r++){var s=t[r];!s.framebuffer&&this.count-s.touched>this.maxIdle&&(e.destroyTexture(s,!0),t[r]=null,i=!0)}if(i){for(var o=0,r=0;r<t.length;r++)t[r]!==null&&(t[o++]=t[r]);t.length=o}},n.prototype.unload=function(e){var t=this.renderer.texture,i=e._texture;i&&!i.framebuffer&&t.destroyTexture(i);for(var r=e.children.length-1;r>=0;r--)this.unload(e.children[r])},n.prototype.destroy=function(){this.renderer=null},n}();function k9(n){var e,t,i,r,s,o,a,l,u,c,h,d,f,p,_,m,g,v,y,x,b,S,T;return"WebGL2RenderingContext"in globalThis&&n instanceof globalThis.WebGL2RenderingContext?T=(e={},e[Ge.UNSIGNED_BYTE]=(t={},t[Me.RGBA]=n.RGBA8,t[Me.RGB]=n.RGB8,t[Me.RG]=n.RG8,t[Me.RED]=n.R8,t[Me.RGBA_INTEGER]=n.RGBA8UI,t[Me.RGB_INTEGER]=n.RGB8UI,t[Me.RG_INTEGER]=n.RG8UI,t[Me.RED_INTEGER]=n.R8UI,t[Me.ALPHA]=n.ALPHA,t[Me.LUMINANCE]=n.LUMINANCE,t[Me.LUMINANCE_ALPHA]=n.LUMINANCE_ALPHA,t),e[Ge.BYTE]=(i={},i[Me.RGBA]=n.RGBA8_SNORM,i[Me.RGB]=n.RGB8_SNORM,i[Me.RG]=n.RG8_SNORM,i[Me.RED]=n.R8_SNORM,i[Me.RGBA_INTEGER]=n.RGBA8I,i[Me.RGB_INTEGER]=n.RGB8I,i[Me.RG_INTEGER]=n.RG8I,i[Me.RED_INTEGER]=n.R8I,i),e[Ge.UNSIGNED_SHORT]=(r={},r[Me.RGBA_INTEGER]=n.RGBA16UI,r[Me.RGB_INTEGER]=n.RGB16UI,r[Me.RG_INTEGER]=n.RG16UI,r[Me.RED_INTEGER]=n.R16UI,r[Me.DEPTH_COMPONENT]=n.DEPTH_COMPONENT16,r),e[Ge.SHORT]=(s={},s[Me.RGBA_INTEGER]=n.RGBA16I,s[Me.RGB_INTEGER]=n.RGB16I,s[Me.RG_INTEGER]=n.RG16I,s[Me.RED_INTEGER]=n.R16I,s),e[Ge.UNSIGNED_INT]=(o={},o[Me.RGBA_INTEGER]=n.RGBA32UI,o[Me.RGB_INTEGER]=n.RGB32UI,o[Me.RG_INTEGER]=n.RG32UI,o[Me.RED_INTEGER]=n.R32UI,o[Me.DEPTH_COMPONENT]=n.DEPTH_COMPONENT24,o),e[Ge.INT]=(a={},a[Me.RGBA_INTEGER]=n.RGBA32I,a[Me.RGB_INTEGER]=n.RGB32I,a[Me.RG_INTEGER]=n.RG32I,a[Me.RED_INTEGER]=n.R32I,a),e[Ge.FLOAT]=(l={},l[Me.RGBA]=n.RGBA32F,l[Me.RGB]=n.RGB32F,l[Me.RG]=n.RG32F,l[Me.RED]=n.R32F,l[Me.DEPTH_COMPONENT]=n.DEPTH_COMPONENT32F,l),e[Ge.HALF_FLOAT]=(u={},u[Me.RGBA]=n.RGBA16F,u[Me.RGB]=n.RGB16F,u[Me.RG]=n.RG16F,u[Me.RED]=n.R16F,u),e[Ge.UNSIGNED_SHORT_5_6_5]=(c={},c[Me.RGB]=n.RGB565,c),e[Ge.UNSIGNED_SHORT_4_4_4_4]=(h={},h[Me.RGBA]=n.RGBA4,h),e[Ge.UNSIGNED_SHORT_5_5_5_1]=(d={},d[Me.RGBA]=n.RGB5_A1,d),e[Ge.UNSIGNED_INT_2_10_10_10_REV]=(f={},f[Me.RGBA]=n.RGB10_A2,f[Me.RGBA_INTEGER]=n.RGB10_A2UI,f),e[Ge.UNSIGNED_INT_10F_11F_11F_REV]=(p={},p[Me.RGB]=n.R11F_G11F_B10F,p),e[Ge.UNSIGNED_INT_5_9_9_9_REV]=(_={},_[Me.RGB]=n.RGB9_E5,_),e[Ge.UNSIGNED_INT_24_8]=(m={},m[Me.DEPTH_STENCIL]=n.DEPTH24_STENCIL8,m),e[Ge.FLOAT_32_UNSIGNED_INT_24_8_REV]=(g={},g[Me.DEPTH_STENCIL]=n.DEPTH32F_STENCIL8,g),e):T=(v={},v[Ge.UNSIGNED_BYTE]=(y={},y[Me.RGBA]=n.RGBA,y[Me.RGB]=n.RGB,y[Me.ALPHA]=n.ALPHA,y[Me.LUMINANCE]=n.LUMINANCE,y[Me.LUMINANCE_ALPHA]=n.LUMINANCE_ALPHA,y),v[Ge.UNSIGNED_SHORT_5_6_5]=(x={},x[Me.RGB]=n.RGB,x),v[Ge.UNSIGNED_SHORT_4_4_4_4]=(b={},b[Me.RGBA]=n.RGBA,b),v[Ge.UNSIGNED_SHORT_5_5_5_1]=(S={},S[Me.RGBA]=n.RGBA,S),v),T}var Ap=function(){function n(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=Ge.UNSIGNED_BYTE,this.internalFormat=Me.RGBA,this.samplerType=0}return n}(),Ib=function(){function n(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new xt,this.hasIntegerTextures=!1}return n.prototype.contextChange=function(){var e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=k9(e);var t=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=t;for(var i=0;i<t;i++)this.boundTextures[i]=null;this.emptyTextures={};var r=new Ap(e.createTexture());e.bindTexture(e.TEXTURE_2D,r.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=r,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new Ap(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(var i=0;i<6;i++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(var i=0;i<this.boundTextures.length;i++)this.bind(null,i)},n.prototype.bind=function(e,t){t===void 0&&(t=0);var i=this.gl;if(e=e==null?void 0:e.castToBaseTexture(),e&&e.valid&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;var r=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[t]!==e&&(this.currentLocation!==t&&(this.currentLocation=t,i.activeTexture(i.TEXTURE0+t)),i.bindTexture(e.target,r.texture)),r.dirtyId!==e.dirtyId?(this.currentLocation!==t&&(this.currentLocation=t,i.activeTexture(i.TEXTURE0+t)),this.updateTexture(e)):r.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[t]=e}else this.currentLocation!==t&&(this.currentLocation=t,i.activeTexture(i.TEXTURE0+t)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[t]=null},n.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture},n.prototype.unbind=function(e){var t=this,i=t.gl,r=t.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var s=0;s<r.length;s++)r[s]===this.unknownTexture&&this.bind(null,s)}for(var s=0;s<r.length;s++)r[s]===e&&(this.currentLocation!==s&&(i.activeTexture(i.TEXTURE0+s),this.currentLocation=s),i.bindTexture(e.target,this.emptyTextures[e.target].texture),r[s]=null)},n.prototype.ensureSamplerType=function(e){var t=this,i=t.boundTextures,r=t.hasIntegerTextures,s=t.CONTEXT_UID;if(r)for(var o=e-1;o>=0;--o){var a=i[o];if(a){var l=a._glTextures[s];l.samplerType!==id.FLOAT&&this.renderer.texture.unbind(a)}}},n.prototype.initTexture=function(e){var t=new Ap(this.gl.createTexture());return t.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=t,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),t},n.prototype.initTextureType=function(e,t){var i,r;t.internalFormat=(r=(i=this.internalFormats[e.type])===null||i===void 0?void 0:i[e.format])!==null&&r!==void 0?r:e.format,this.webGLVersion===2&&e.type===Ge.HALF_FLOAT?t.type=this.gl.HALF_FLOAT:t.type=e.type},n.prototype.updateTexture=function(e){var t=e._glTextures[this.CONTEXT_UID];if(t){var i=this.renderer;if(this.initTextureType(e,t),e.resource&&e.resource.upload(i,e,t))t.samplerType!==id.FLOAT&&(this.hasIntegerTextures=!0);else{var r=e.realWidth,s=e.realHeight,o=i.gl;(t.width!==r||t.height!==s||t.dirtyId<0)&&(t.width=r,t.height=s,o.texImage2D(e.target,0,t.internalFormat,r,s,0,e.format,t.type,null))}e.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(e),t.dirtyId=e.dirtyId}},n.prototype.destroyTexture=function(e,t){var i=this.gl;if(e=e.castToBaseTexture(),e._glTextures[this.CONTEXT_UID]&&(this.unbind(e),i.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!t)){var r=this.managedTextures.indexOf(e);r!==-1&&il(this.managedTextures,r,1)}},n.prototype.updateTextureStyle=function(e){var t=e._glTextures[this.CONTEXT_UID];t&&((e.mipmap===or.POW2||this.webGLVersion!==2)&&!e.isPowerOfTwo?t.mipmap=!1:t.mipmap=e.mipmap>=1,this.webGLVersion!==2&&!e.isPowerOfTwo?t.wrapMode=Ar.CLAMP:t.wrapMode=e.wrapMode,e.resource&&e.resource.style(this.renderer,e,t)||this.setStyle(e,t),t.dirtyStyleId=e.dirtyStyleId)},n.prototype.setStyle=function(e,t){var i=this.gl;if(t.mipmap&&e.mipmap!==or.ON_MANUAL&&i.generateMipmap(e.target),i.texParameteri(e.target,i.TEXTURE_WRAP_S,t.wrapMode),i.texParameteri(e.target,i.TEXTURE_WRAP_T,t.wrapMode),t.mipmap){i.texParameteri(e.target,i.TEXTURE_MIN_FILTER,e.scaleMode===wr.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&e.anisotropicLevel>0&&e.scaleMode===wr.LINEAR){var s=Math.min(e.anisotropicLevel,i.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(e.target,r.TEXTURE_MAX_ANISOTROPY_EXT,s)}}else i.texParameteri(e.target,i.TEXTURE_MIN_FILTER,e.scaleMode===wr.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(e.target,i.TEXTURE_MAG_FILTER,e.scaleMode===wr.LINEAR?i.LINEAR:i.NEAREST)},n.prototype.destroy=function(){this.renderer=null},n}(),$I={__proto__:null,FilterSystem:vb,BatchSystem:yb,ContextSystem:xb,FramebufferSystem:bb,GeometrySystem:Sb,MaskSystem:Eb,ScissorSystem:Tb,StencilSystem:Mb,ProjectionSystem:wb,RenderTextureSystem:Ab,ShaderSystem:Pb,StateSystem:Cb,TextureGCSystem:Rb,TextureSystem:Ib},w_=new kt,YI=function(n){$t(e,n);function e(t,i){t===void 0&&(t=$u.UNKNOWN);var r=n.call(this)||this;return i=Object.assign({},Oe.RENDER_OPTIONS,i),r.options=i,r.type=t,r.screen=new St(0,0,i.width,i.height),r.view=i.view||Oe.ADAPTER.createCanvas(),r.resolution=i.resolution||Oe.RESOLUTION,r.useContextAlpha=i.useContextAlpha,r.autoDensity=!!i.autoDensity,r.preserveDrawingBuffer=i.preserveDrawingBuffer,r.clearBeforeRender=i.clearBeforeRender,r._backgroundColor=0,r._backgroundColorRgba=[0,0,0,1],r._backgroundColorString="#000000",r.backgroundColor=i.backgroundColor||r._backgroundColor,r.backgroundAlpha=i.backgroundAlpha,i.transparent!==void 0&&(ai("6.0.0","Option transparent is deprecated, please use backgroundAlpha instead."),r.useContextAlpha=i.transparent,r.backgroundAlpha=i.transparent?0:1),r._lastObjectRendered=null,r.plugins={},r}return e.prototype.initPlugins=function(t){for(var i in t)this.plugins[i]=new t[i](this)},Object.defineProperty(e.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,i){this.view.width=Math.round(t*this.resolution),this.view.height=Math.round(i*this.resolution);var r=this.view.width/this.resolution,s=this.view.height/this.resolution;this.screen.width=r,this.screen.height=s,this.autoDensity&&(this.view.style.width=r+"px",this.view.style.height=s+"px"),this.emit("resize",r,s)},e.prototype.generateTexture=function(t,i,r,s){i===void 0&&(i={}),typeof i=="number"&&(ai("6.1.0","generateTexture options (scaleMode, resolution, region) are now object options."),i={scaleMode:i,resolution:r,region:s});var o=i.region,a=e9(i,["region"]);s=o||t.getLocalBounds(null,!0),s.width===0&&(s.width=1),s.height===0&&(s.height=1);var l=zo.create(F0({width:s.width,height:s.height},a));return w_.tx=-s.x,w_.ty=-s.y,this.render(t,{renderTexture:l,clear:!1,transform:w_,skipUpdateTransform:!!t.parent}),l},e.prototype.destroy=function(t){for(var i in this.plugins)this.plugins[i].destroy(),this.plugins[i]=null;t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);var r=this;r.plugins=null,r.type=$u.UNKNOWN,r.view=null,r.screen=null,r._tempDisplayObjectParent=null,r.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(e.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._backgroundColorString=rb(t),hl(t,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backgroundAlpha",{get:function(){return this._backgroundColorRgba[3]},set:function(t){this._backgroundColorRgba[3]=t},enumerable:!1,configurable:!0}),e}(lr),V9=function(){function n(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}return n}(),G9=function(){function n(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}return n.prototype.destroy=function(){this.renderer=null},n.prototype.contextChange=function(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID},n.prototype.bind=function(e){var t=this,i=t.gl,r=t.CONTEXT_UID,s=e._glBuffers[r]||this.createGLBuffer(e);i.bindBuffer(e.type,s.buffer)},n.prototype.bindBufferBase=function(e,t){var i=this,r=i.gl,s=i.CONTEXT_UID;if(this.boundBufferBases[t]!==e){var o=e._glBuffers[s]||this.createGLBuffer(e);this.boundBufferBases[t]=e,r.bindBufferBase(r.UNIFORM_BUFFER,t,o.buffer)}},n.prototype.bindBufferRange=function(e,t,i){var r=this,s=r.gl,o=r.CONTEXT_UID;i=i||0;var a=e._glBuffers[o]||this.createGLBuffer(e);s.bindBufferRange(s.UNIFORM_BUFFER,t||0,a.buffer,i*256,256)},n.prototype.update=function(e){var t=this,i=t.gl,r=t.CONTEXT_UID,s=e._glBuffers[r];if(e._updateID!==s.updateID)if(s.updateID=e._updateID,i.bindBuffer(e.type,s.buffer),s.byteLength>=e.data.byteLength)i.bufferSubData(e.type,0,e.data);else{var o=e.static?i.STATIC_DRAW:i.DYNAMIC_DRAW;s.byteLength=e.data.byteLength,i.bufferData(e.type,e.data,o)}},n.prototype.dispose=function(e,t){if(this.managedBuffers[e.id]){delete this.managedBuffers[e.id];var i=e._glBuffers[this.CONTEXT_UID],r=this.gl;e.disposeRunner.remove(this),i&&(t||r.deleteBuffer(i.buffer),delete e._glBuffers[this.CONTEXT_UID])}},n.prototype.disposeAll=function(e){for(var t=Object.keys(this.managedBuffers),i=0;i<t.length;i++)this.dispose(this.managedBuffers[t[i]],e)},n.prototype.createGLBuffer=function(e){var t=this,i=t.CONTEXT_UID,r=t.gl;return e._glBuffers[i]=new V9(r.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[i]},n}(),Lb=function(n){$t(e,n);function e(t){var i=n.call(this,$u.WEBGL,t)||this;return t=i.options,i.gl=null,i.CONTEXT_UID=0,i.runners={destroy:new On("destroy"),contextChange:new On("contextChange"),reset:new On("reset"),update:new On("update"),postrender:new On("postrender"),prerender:new On("prerender"),resize:new On("resize")},i.runners.contextChange.add(i),i.globalUniforms=new Do({projectionMatrix:new kt},!0),i.addSystem(Eb,"mask").addSystem(xb,"context").addSystem(Cb,"state").addSystem(Pb,"shader").addSystem(Ib,"texture").addSystem(G9,"buffer").addSystem(Sb,"geometry").addSystem(bb,"framebuffer").addSystem(Tb,"scissor").addSystem(Mb,"stencil").addSystem(wb,"projection").addSystem(Rb,"textureGC").addSystem(vb,"filter").addSystem(Ab,"renderTexture").addSystem(yb,"batch"),i.initPlugins(e.__plugins),i.multisample=void 0,t.context?i.context.initFromContext(t.context):i.context.initFromOptions({alpha:!!i.useContextAlpha,antialias:t.antialias,premultipliedAlpha:i.useContextAlpha&&i.useContextAlpha!=="notMultiplied",stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:i.options.powerPreference}),i.renderingToScreen=!0,fI(i.context.webGLVersion===2?"WebGL 2":"WebGL 1"),i.resize(i.options.width,i.options.height),i}return e.create=function(t){if(pI())return new e(t);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},e.prototype.contextChange=function(){var t=this.gl,i;if(this.context.webGLVersion===1){var r=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),i=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,r)}else{var r=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),i=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,r)}i>=Jt.HIGH?this.multisample=Jt.HIGH:i>=Jt.MEDIUM?this.multisample=Jt.MEDIUM:i>=Jt.LOW?this.multisample=Jt.LOW:this.multisample=Jt.NONE},e.prototype.addSystem=function(t,i){var r=new t(this);if(this[i])throw new Error('Whoops! The name "'+i+'" is already in use');this[i]=r;for(var s in this.runners)this.runners[s].add(r);return this},e.prototype.render=function(t,i){var r,s,o,a;if(i&&(i instanceof zo?(ai("6.0.0","Renderer#render arguments changed, use options instead."),r=i,s=arguments[2],o=arguments[3],a=arguments[4]):(r=i.renderTexture,s=i.clear,o=i.transform,a=i.skipUpdateTransform)),this.renderingToScreen=!r,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=o,!this.context.isLost){if(r||(this._lastObjectRendered=t),!a){var l=t.enableTempParent();t.updateTransform(),t.disableTempParent(l)}this.renderTexture.bind(r),this.batch.currentRenderer.start(),(s!==void 0?s:this.clearBeforeRender)&&this.renderTexture.clear(),t.render(this),this.batch.currentRenderer.flush(),r&&r.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},e.prototype.generateTexture=function(t,i,r,s){i===void 0&&(i={});var o=n.prototype.generateTexture.call(this,t,i,r,s);return this.framebuffer.blit(),o},e.prototype.resize=function(t,i){n.prototype.resize.call(this,t,i),this.runners.resize.emit(this.screen.height,this.screen.width)},e.prototype.reset=function(){return this.runners.reset.emit(),this},e.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},e.prototype.destroy=function(t){this.runners.destroy.emit();for(var i in this.runners)this.runners[i].destroy();n.prototype.destroy.call(this,t),this.gl=null},Object.defineProperty(e.prototype,"extract",{get:function(){return ai("6.0.0","Renderer#extract has been deprecated, please use Renderer#plugins.extract instead."),this.plugins.extract},enumerable:!1,configurable:!0}),e.registerPlugin=function(t,i){ai("6.5.0","Renderer.registerPlugin() has been deprecated, please use extensions.add() instead."),ds.add({name:t,type:Ut.RendererPlugin,ref:i})},e.__plugins={},e}(YI);ds.handleByMap(Ut.RendererPlugin,Lb.__plugins);function qI(n){return Lb.create(n)}var H9=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,z9=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,KI=H9,Ob=z9,W9=function(){function n(e){ai("6.1.0","System class is deprecated, implemement ISystem interface instead."),this.renderer=e}return n.prototype.destroy=function(){this.renderer=null},n}(),sm=function(){function n(){this.texArray=null,this.blend=0,this.type=Ji.TRIANGLES,this.start=0,this.size=0,this.data=null}return n}(),om=function(){function n(){this.elements=[],this.ids=[],this.count=0}return n.prototype.clear=function(){for(var e=0;e<this.count;e++)this.elements[e]=null;this.count=0},n}(),am=function(){function n(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(n.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),n.prototype.view=function(e){return this[e+"View"]},n.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},n.sizeOf=function(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(e+" isn't a valid view type")}},n}(),ZI=function(n){$t(e,n);function e(t){var i=n.call(this,t)||this;return i.shaderGenerator=null,i.geometryClass=null,i.vertexSize=null,i.state=qo.for2d(),i.size=Oe.SPRITE_BATCH_SIZE*4,i._vertexCount=0,i._indexCount=0,i._bufferedElements=[],i._bufferedTextures=[],i._bufferSize=0,i._shader=null,i._packedGeometries=[],i._packedGeometryPoolSize=2,i._flushId=0,i._aBuffers={},i._iBuffers={},i.MAX_TEXTURES=1,i.renderer.on("prerender",i.onPrerender,i),t.runners.contextChange.add(i),i._dcIndex=0,i._aIndex=0,i._iIndex=0,i._attributeBuffer=null,i._indexBuffer=null,i._tempBoundTextures=[],i}return e.prototype.contextChange=function(){var t=this.renderer.gl;Oe.PREFER_ENV===as.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),Oe.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=BI(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var i=0;i<this._packedGeometryPoolSize;i++)this._packedGeometries[i]=new this.geometryClass;this.initFlushBuffers()},e.prototype.initFlushBuffers=function(){for(var t=e._drawCallPool,i=e._textureArrayPool,r=this.size/4,s=Math.floor(r/this.MAX_TEXTURES)+1;t.length<r;)t.push(new sm);for(;i.length<s;)i.push(new om);for(var o=0;o<this.MAX_TEXTURES;o++)this._tempBoundTextures[o]=null},e.prototype.onPrerender=function(){this._flushId=0},e.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},e.prototype.buildTexturesAndDrawCalls=function(){var t=this,i=t._bufferedTextures,r=t.MAX_TEXTURES,s=e._textureArrayPool,o=this.renderer.batch,a=this._tempBoundTextures,l=this.renderer.textureGC.count,u=++xt._globalBatch,c=0,h=s[0],d=0;o.copyBoundTextures(a,r);for(var f=0;f<this._bufferSize;++f){var p=i[f];i[f]=null,p._batchEnabled!==u&&(h.count>=r&&(o.boundArray(h,a,u,r),this.buildDrawCalls(h,d,f),d=f,h=s[++c],++u),p._batchEnabled=u,p.touched=l,h.elements[h.count++]=p)}h.count>0&&(o.boundArray(h,a,u,r),this.buildDrawCalls(h,d,this._bufferSize),++c,++u);for(var f=0;f<a.length;f++)a[f]=null;xt._globalBatch=u},e.prototype.buildDrawCalls=function(t,i,r){var s=this,o=s._bufferedElements,a=s._attributeBuffer,l=s._indexBuffer,u=s.vertexSize,c=e._drawCallPool,h=this._dcIndex,d=this._aIndex,f=this._iIndex,p=c[h];p.start=this._iIndex,p.texArray=t;for(var _=i;_<r;++_){var m=o[_],g=m._texture.baseTexture,v=ob[g.alphaMode?1:0][m.blendMode];o[_]=null,i<_&&p.blend!==v&&(p.size=f-p.start,i=_,p=c[++h],p.texArray=t,p.start=f),this.packInterleavedGeometry(m,a,l,d,f),d+=m.vertexData.length/2*u,f+=m.indices.length,p.blend=v}i<r&&(p.size=f-p.start,++h),this._dcIndex=h,this._aIndex=d,this._iIndex=f},e.prototype.bindAndClearTexArray=function(t){for(var i=this.renderer.texture,r=0;r<t.count;r++)i.bind(t.elements[r],t.ids[r]),t.elements[r]=null;t.count=0},e.prototype.updateGeometry=function(){var t=this,i=t._packedGeometries,r=t._attributeBuffer,s=t._indexBuffer;Oe.CAN_UPLOAD_SAME_BUFFER?(i[this._flushId]._buffer.update(r.rawBinaryData),i[this._flushId]._indexBuffer.update(s),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,i[this._flushId]=new this.geometryClass),i[this._flushId]._buffer.update(r.rawBinaryData),i[this._flushId]._indexBuffer.update(s),this.renderer.geometry.bind(i[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},e.prototype.drawBatches=function(){for(var t=this._dcIndex,i=this.renderer,r=i.gl,s=i.state,o=e._drawCallPool,a=null,l=0;l<t;l++){var u=o[l],c=u.texArray,h=u.type,d=u.size,f=u.start,p=u.blend;a!==c&&(a=c,this.bindAndClearTexArray(c)),this.state.blendMode=p,s.set(this.state),r.drawElements(h,d,r.UNSIGNED_SHORT,f*2)}},e.prototype.flush=function(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},e.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),Oe.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),n.prototype.destroy.call(this)},e.prototype.getAttributeBuffer=function(t){var i=ld(Math.ceil(t/8)),r=R0(i),s=i*8;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);var o=this._aBuffers[s];return o||(this._aBuffers[s]=o=new am(s*this.vertexSize*4)),o},e.prototype.getIndexBuffer=function(t){var i=ld(Math.ceil(t/12)),r=R0(i),s=i*12;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);var o=this._iBuffers[r];return o||(this._iBuffers[r]=o=new Uint16Array(s)),o},e.prototype.packInterleavedGeometry=function(t,i,r,s,o){for(var a=i.uint32View,l=i.float32View,u=s/this.vertexSize,c=t.uvs,h=t.indices,d=t.vertexData,f=t._texture.baseTexture._batchLocation,p=Math.min(t.worldAlpha,1),_=p<1&&t._texture.baseTexture.alphaMode?rg(t._tintRGB,p):t._tintRGB+(p*255<<24),m=0;m<d.length;m+=2)l[s++]=d[m],l[s++]=d[m+1],l[s++]=c[m],l[s++]=c[m+1],a[s++]=_,l[s++]=f;for(var m=0;m<h.length;m++)r[o++]=u+h[m]},e._drawCallPool=[],e._textureArrayPool=[],e}(kd),JI=function(){function n(e,t){if(this.vertexSrc=e,this.fragTemplate=t,this.programCache={},this.defaultGroupCache={},t.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(t.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return n.prototype.generateShader=function(e){if(!this.programCache[e]){for(var t=new Int32Array(e),i=0;i<e;i++)t[i]=i;this.defaultGroupCache[e]=Do.from({uSamplers:t},!0);var r=this.fragTemplate;r=r.replace(/%count%/gi,""+e),r=r.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new Ec(this.vertexSrc,r)}var s={tint:new Float32Array([1,1,1,1]),translationMatrix:new kt,default:this.defaultGroupCache[e]};return new Xs(this.programCache[e],s)},n.prototype.generateSampleSrc=function(e){var t="";t+=`
`,t+=`
`;for(var i=0;i<e;i++)i>0&&(t+=`
else `),i<e-1&&(t+="if(vTextureId < "+i+".5)"),t+=`
{`,t+=`
	color = texture2D(uSamplers[`+i+"], vTextureCoord);",t+=`
}`;return t+=`
`,t+=`
`,t},n}(),Db=function(n){$t(e,n);function e(t){t===void 0&&(t=!1);var i=n.call(this)||this;return i._buffer=new vn(null,t,!1),i._indexBuffer=new vn(null,t,!0),i.addAttribute("aVertexPosition",i._buffer,2,!1,Ge.FLOAT).addAttribute("aTextureCoord",i._buffer,2,!1,Ge.FLOAT).addAttribute("aColor",i._buffer,4,!0,Ge.UNSIGNED_BYTE).addAttribute("aTextureId",i._buffer,1,!0,Ge.FLOAT).addIndex(i._indexBuffer),i}return e}(Sc),dM=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`,fM=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,QI=function(){function n(){}return n.create=function(e){var t=Object.assign({vertex:dM,fragment:fM,geometryClass:Db,vertexSize:6},e),i=t.vertex,r=t.fragment,s=t.vertexSize,o=t.geometryClass;return function(a){$t(l,a);function l(u){var c=a.call(this,u)||this;return c.shaderGenerator=new JI(i,r),c.geometryClass=o,c.vertexSize=s,c}return l}(ZI)},Object.defineProperty(n,"defaultVertexSrc",{get:function(){return dM},enumerable:!1,configurable:!0}),Object.defineProperty(n,"defaultFragmentTemplate",{get:function(){return fM},enumerable:!1,configurable:!0}),n}(),Fb=QI.create();Object.assign(Fb,{extension:{name:"batch",type:Ut.RendererPlugin}});var eL={},X9=function(n){Object.defineProperty(eL,n,{get:function(){return ai("6.0.0","PIXI.systems."+n+" has moved to PIXI."+n),AI[n]}})};for(var Nb in AI)X9(Nb);var tL={},j9=function(n){Object.defineProperty(tL,n,{get:function(){return ai("6.0.0","PIXI.resources."+n+" has moved to PIXI."+n),$I[n]}})};for(var Nb in $I)j9(Nb);var $9="6.5.10";/*!
 * @pixi/display - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */Oe.SORTABLE_CHILDREN=!1;var dd=function(){function n(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return n.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},n.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},n.prototype.getRectangle=function(e){return this.minX>this.maxX||this.minY>this.maxY?St.EMPTY:(e=e||new St(0,0,1,1),e.x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)},n.prototype.addPoint=function(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)},n.prototype.addPointMatrix=function(e,t){var i=e.a,r=e.b,s=e.c,o=e.d,a=e.tx,l=e.ty,u=i*t.x+s*t.y+a,c=r*t.x+o*t.y+l;this.minX=Math.min(this.minX,u),this.maxX=Math.max(this.maxX,u),this.minY=Math.min(this.minY,c),this.maxY=Math.max(this.maxY,c)},n.prototype.addQuad=function(e){var t=this.minX,i=this.minY,r=this.maxX,s=this.maxY,o=e[0],a=e[1];t=o<t?o:t,i=a<i?a:i,r=o>r?o:r,s=a>s?a:s,o=e[2],a=e[3],t=o<t?o:t,i=a<i?a:i,r=o>r?o:r,s=a>s?a:s,o=e[4],a=e[5],t=o<t?o:t,i=a<i?a:i,r=o>r?o:r,s=a>s?a:s,o=e[6],a=e[7],t=o<t?o:t,i=a<i?a:i,r=o>r?o:r,s=a>s?a:s,this.minX=t,this.minY=i,this.maxX=r,this.maxY=s},n.prototype.addFrame=function(e,t,i,r,s){this.addFrameMatrix(e.worldTransform,t,i,r,s)},n.prototype.addFrameMatrix=function(e,t,i,r,s){var o=e.a,a=e.b,l=e.c,u=e.d,c=e.tx,h=e.ty,d=this.minX,f=this.minY,p=this.maxX,_=this.maxY,m=o*t+l*i+c,g=a*t+u*i+h;d=m<d?m:d,f=g<f?g:f,p=m>p?m:p,_=g>_?g:_,m=o*r+l*i+c,g=a*r+u*i+h,d=m<d?m:d,f=g<f?g:f,p=m>p?m:p,_=g>_?g:_,m=o*t+l*s+c,g=a*t+u*s+h,d=m<d?m:d,f=g<f?g:f,p=m>p?m:p,_=g>_?g:_,m=o*r+l*s+c,g=a*r+u*s+h,d=m<d?m:d,f=g<f?g:f,p=m>p?m:p,_=g>_?g:_,this.minX=d,this.minY=f,this.maxX=p,this.maxY=_},n.prototype.addVertexData=function(e,t,i){for(var r=this.minX,s=this.minY,o=this.maxX,a=this.maxY,l=t;l<i;l+=2){var u=e[l],c=e[l+1];r=u<r?u:r,s=c<s?c:s,o=u>o?u:o,a=c>a?c:a}this.minX=r,this.minY=s,this.maxX=o,this.maxY=a},n.prototype.addVertices=function(e,t,i,r){this.addVerticesMatrix(e.worldTransform,t,i,r)},n.prototype.addVerticesMatrix=function(e,t,i,r,s,o){s===void 0&&(s=0),o===void 0&&(o=s);for(var a=e.a,l=e.b,u=e.c,c=e.d,h=e.tx,d=e.ty,f=this.minX,p=this.minY,_=this.maxX,m=this.maxY,g=i;g<r;g+=2){var v=t[g],y=t[g+1],x=a*v+u*y+h,b=c*y+l*v+d;f=Math.min(f,x-s),_=Math.max(_,x+s),p=Math.min(p,b-o),m=Math.max(m,b+o)}this.minX=f,this.minY=p,this.maxX=_,this.maxY=m},n.prototype.addBounds=function(e){var t=this.minX,i=this.minY,r=this.maxX,s=this.maxY;this.minX=e.minX<t?e.minX:t,this.minY=e.minY<i?e.minY:i,this.maxX=e.maxX>r?e.maxX:r,this.maxY=e.maxY>s?e.maxY:s},n.prototype.addBoundsMask=function(e,t){var i=e.minX>t.minX?e.minX:t.minX,r=e.minY>t.minY?e.minY:t.minY,s=e.maxX<t.maxX?e.maxX:t.maxX,o=e.maxY<t.maxY?e.maxY:t.maxY;if(i<=s&&r<=o){var a=this.minX,l=this.minY,u=this.maxX,c=this.maxY;this.minX=i<a?i:a,this.minY=r<l?r:l,this.maxX=s>u?s:u,this.maxY=o>c?o:c}},n.prototype.addBoundsMatrix=function(e,t){this.addFrameMatrix(t,e.minX,e.minY,e.maxX,e.maxY)},n.prototype.addBoundsArea=function(e,t){var i=e.minX>t.x?e.minX:t.x,r=e.minY>t.y?e.minY:t.y,s=e.maxX<t.x+t.width?e.maxX:t.x+t.width,o=e.maxY<t.y+t.height?e.maxY:t.y+t.height;if(i<=s&&r<=o){var a=this.minX,l=this.minY,u=this.maxX,c=this.maxY;this.minX=i<a?i:a,this.minY=r<l?r:l,this.maxX=s>u?s:u,this.maxY=o>c?o:c}},n.prototype.pad=function(e,t){e===void 0&&(e=0),t===void 0&&(t=e),this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t)},n.prototype.addFramePad=function(e,t,i,r,s,o){e-=s,t-=o,i+=s,r+=o,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<t?this.minY:t,this.maxY=this.maxY>r?this.maxY:r},n}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var U0=function(n,e){return U0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},U0(n,e)};function Ub(n,e){U0(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var cn=function(n){Ub(e,n);function e(){var t=n.call(this)||this;return t.tempDisplayObjectParent=null,t.transform=new Bd,t.alpha=1,t.visible=!0,t.renderable=!0,t.cullable=!1,t.cullArea=null,t.parent=null,t.worldAlpha=1,t._lastSortedIndex=0,t._zIndex=0,t.filterArea=null,t.filters=null,t._enabledFilters=null,t._bounds=new dd,t._localBounds=null,t._boundsID=0,t._boundsRect=null,t._localBoundsRect=null,t._mask=null,t._maskRefCount=0,t._destroyed=!1,t.isSprite=!1,t.isMask=!1,t}return e.mixin=function(t){for(var i=Object.keys(t),r=0;r<i.length;++r){var s=i[r];Object.defineProperty(e.prototype,s,Object.getOwnPropertyDescriptor(t,s))}},Object.defineProperty(e.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!1,configurable:!0}),e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.getBounds=function(t,i){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),i||(this._boundsRect||(this._boundsRect=new St),i=this._boundsRect),this._bounds.getRectangle(i)},e.prototype.getLocalBounds=function(t){t||(this._localBoundsRect||(this._localBoundsRect=new St),t=this._localBoundsRect),this._localBounds||(this._localBounds=new dd);var i=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var s=this._bounds,o=this._boundsID;this._bounds=this._localBounds;var a=this.getBounds(!1,t);return this.parent=r,this.transform=i,this._bounds=s,this._bounds.updateID+=this._boundsID-o,a},e.prototype.toGlobal=function(t,i,r){return r===void 0&&(r=!1),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,i)},e.prototype.toLocal=function(t,i,r,s){return i&&(t=i.toGlobal(t,r,s)),s||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,r)},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,i,r,s,o,a,l,u,c){return t===void 0&&(t=0),i===void 0&&(i=0),r===void 0&&(r=1),s===void 0&&(s=1),o===void 0&&(o=0),a===void 0&&(a=0),l===void 0&&(l=0),u===void 0&&(u=0),c===void 0&&(c=0),this.position.x=t,this.position.y=i,this.scale.x=r||1,this.scale.y=s||1,this.rotation=o,this.skew.x=a,this.skew.y=l,this.pivot.x=u,this.pivot.y=c,this},e.prototype.destroy=function(t){this.parent&&this.parent.removeChild(this),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()},Object.defineProperty(e.prototype,"_tempDisplayObjectParent",{get:function(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new Bb),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),e.prototype.enableTempParent=function(){var t=this.parent;return this.parent=this._tempDisplayObjectParent,t},e.prototype.disableTempParent=function(t){this.parent=t},Object.defineProperty(e.prototype,"x",{get:function(){return this.position.x},set:function(t){this.transform.position.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.position.y},set:function(t){this.transform.position.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this.transform.position},set:function(t){this.transform.position.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this.transform.scale},set:function(t){this.transform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(t){this.transform.pivot.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skew",{get:function(){return this.transform.skew},set:function(t){this.transform.skew.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this.transform.rotation*xI},set:function(t){this.transform.rotation=t*bI},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zIndex",{get:function(){return this._zIndex},set:function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldVisible",{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask},set:function(t){if(this._mask!==t){if(this._mask){var i=this._mask.isMaskData?this._mask.maskObject:this._mask;i&&(i._maskRefCount--,i._maskRefCount===0&&(i.renderable=!0,i.isMask=!1))}if(this._mask=t,this._mask){var i=this._mask.isMaskData?this._mask.maskObject:this._mask;i&&(i._maskRefCount===0&&(i.renderable=!1,i.isMask=!0),i._maskRefCount++)}}},enumerable:!1,configurable:!0}),e}(lr),Bb=function(n){Ub(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.sortDirty=null,t}return e}(cn);cn.prototype.displayObjectUpdateTransform=cn.prototype.updateTransform;function Y9(n,e){return n.zIndex===e.zIndex?n._lastSortedIndex-e._lastSortedIndex:n.zIndex-e.zIndex}var Oi=function(n){Ub(e,n);function e(){var t=n.call(this)||this;return t.children=[],t.sortableChildren=Oe.SORTABLE_CHILDREN,t.sortDirty=!1,t}return e.prototype.onChildrenChange=function(t){},e.prototype.addChild=function(){for(var t=arguments,i=[],r=0;r<arguments.length;r++)i[r]=t[r];if(i.length>1)for(var s=0;s<i.length;s++)this.addChild(i[s]);else{var o=i[0];o.parent&&o.parent.removeChild(o),o.parent=this,this.sortDirty=!0,o.transform._parentID=-1,this.children.push(o),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",o,this,this.children.length-1),o.emit("added",this)}return i[0]},e.prototype.addChildAt=function(t,i){if(i<0||i>this.children.length)throw new Error(t+"addChildAt: The index "+i+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(i,0,t),this._boundsID++,this.onChildrenChange(i),t.emit("added",this),this.emit("childAdded",t,this,i),t},e.prototype.swapChildren=function(t,i){if(t!==i){var r=this.getChildIndex(t),s=this.getChildIndex(i);this.children[r]=i,this.children[s]=t,this.onChildrenChange(r<s?r:s)}},e.prototype.getChildIndex=function(t){var i=this.children.indexOf(t);if(i===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return i},e.prototype.setChildIndex=function(t,i){if(i<0||i>=this.children.length)throw new Error("The index "+i+" supplied is out of bounds "+this.children.length);var r=this.getChildIndex(t);il(this.children,r,1),this.children.splice(i,0,t),this.onChildrenChange(i)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(){for(var t=arguments,i=[],r=0;r<arguments.length;r++)i[r]=t[r];if(i.length>1)for(var s=0;s<i.length;s++)this.removeChild(i[s]);else{var o=i[0],a=this.children.indexOf(o);if(a===-1)return null;o.parent=null,o.transform._parentID=-1,il(this.children,a,1),this._boundsID++,this.onChildrenChange(a),o.emit("removed",this),this.emit("childRemoved",o,this,a)}return i[0]},e.prototype.removeChildAt=function(t){var i=this.getChildAt(t);return i.parent=null,i.transform._parentID=-1,il(this.children,t,1),this._boundsID++,this.onChildrenChange(t),i.emit("removed",this),this.emit("childRemoved",i,this,t),i},e.prototype.removeChildren=function(t,i){t===void 0&&(t=0),i===void 0&&(i=this.children.length);var r=t,s=i,o=s-r,a;if(o>0&&o<=s){a=this.children.splice(r,o);for(var l=0;l<a.length;++l)a[l].parent=null,a[l].transform&&(a[l].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var l=0;l<a.length;++l)a[l].emit("removed",this),this.emit("childRemoved",a[l],this,l);return a}else if(o===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,i=0,r=this.children.length;i<r;++i){var s=this.children[i];s._lastSortedIndex=i,!t&&s.zIndex!==0&&(t=!0)}t&&this.children.length>1&&this.children.sort(Y9),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,i=this.children.length;t<i;++t){var r=this.children[t];r.visible&&r.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var i=this.children[t];if(!(!i.visible||!i.renderable))if(i.calculateBounds(),i._mask){var r=i._mask.isMaskData?i._mask.maskObject:i._mask;r?(r.calculateBounds(),this._bounds.addBoundsMask(i._bounds,r._bounds)):this._bounds.addBounds(i._bounds)}else i.filterArea?this._bounds.addBoundsArea(i._bounds,i.filterArea):this._bounds.addBounds(i._bounds)}this._bounds.updateID=this._boundsID},e.prototype.getLocalBounds=function(t,i){i===void 0&&(i=!1);var r=n.prototype.getLocalBounds.call(this,t);if(!i)for(var s=0,o=this.children.length;s<o;++s){var a=this.children[s];a.visible&&a.updateTransform()}return r},e.prototype._calculateBounds=function(){},e.prototype._renderWithCulling=function(t){var i=t.renderTexture.sourceFrame;if(i.width>0&&i.height>0){var r,s;if(this.cullArea?(r=this.cullArea,s=this.worldTransform):this._render!==e.prototype._render&&(r=this.getBounds(!0)),r&&i.intersects(r,s))this._render(t);else if(this.cullArea)return;for(var o=0,a=this.children.length;o<a;++o){var l=this.children[o],u=l.cullable;l.cullable=u||!this.cullArea,l.render(t),l.cullable=u}}},e.prototype.render=function(t){if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else if(this.cullable)this._renderWithCulling(t);else{this._render(t);for(var i=0,r=this.children.length;i<r;++i)this.children[i].render(t)}},e.prototype.renderAdvanced=function(t){var i=this.filters,r=this._mask;if(i){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var s=0;s<i.length;s++)i[s].enabled&&this._enabledFilters.push(i[s])}var o=i&&this._enabledFilters&&this._enabledFilters.length||r&&(!r.isMaskData||r.enabled&&(r.autoDetect||r.type!==fn.NONE));if(o&&t.batch.flush(),i&&this._enabledFilters&&this._enabledFilters.length&&t.filter.push(this,this._enabledFilters),r&&t.mask.push(this,this._mask),this.cullable)this._renderWithCulling(t);else{this._render(t);for(var s=0,a=this.children.length;s<a;++s)this.children[s].render(t)}o&&t.batch.flush(),r&&t.mask.pop(this),i&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(t){n.prototype.destroy.call(this),this.sortDirty=!1;var i=typeof t=="boolean"?t:t&&t.children,r=this.removeChildren(0,this.children.length);if(i)for(var s=0;s<r.length;++s)r[s].destroy(t)},Object.defineProperty(e.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var i=this.getLocalBounds().width;i!==0?this.scale.x=t/i:this.scale.x=1,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var i=this.getLocalBounds().height;i!==0?this.scale.y=t/i:this.scale.y=1,this._height=t},enumerable:!1,configurable:!0}),e}(cn);Oi.prototype.containerUpdateTransform=Oi.prototype.updateTransform;var aa=Math.pow,nn=(n,e,t)=>new Promise((i,r)=>{var s=l=>{try{a(t.next(l))}catch(u){r(u)}},o=l=>{try{a(t.throw(l))}catch(u){r(u)}},a=l=>l.done?i(l.value):Promise.resolve(l.value).then(s,o);a((t=t.apply(n,e)).next())});const pM=2,mM=2;var fd;(n=>{n.supportMoreMaskDivisions=!0,n.setOpacityFromMotion=!1})(fd||(fd={}));var En;(n=>{n.LOG_LEVEL_VERBOSE=0,n.LOG_LEVEL_WARNING=1,n.LOG_LEVEL_ERROR=2,n.LOG_LEVEL_NONE=999,n.logLevel=n.LOG_LEVEL_WARNING,n.sound=!0,n.motionSync=!0,n.motionFadingDuration=500,n.idleMotionFadingDuration=2e3,n.expressionFadingDuration=500,n.preserveExpressionOnMotion=!0,n.cubism4=fd})(En||(En={}));const Gt={log(n,...e){En.logLevel<=En.LOG_LEVEL_VERBOSE&&console.log(`[${n}]`,...e)},warn(n,...e){En.logLevel<=En.LOG_LEVEL_WARNING&&console.warn(`[${n}]`,...e)},error(n,...e){En.logLevel<=En.LOG_LEVEL_ERROR&&console.error(`[${n}]`,...e)}};function lm(n,e,t){return n<e?e:n>t?t:n}function q9(n,e){return Math.random()*(e-n)+n}function Vc(n,e,t,i,r){const s=e[i];s!==null&&typeof s===n&&(t[r]=s)}function Gc(n,e,t,i,r){const s=e[i];Array.isArray(s)&&(t[r]=s.filter(o=>o!==null&&typeof o===n))}function nL(n,e){e.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(i=>{i!=="constructor"&&Object.defineProperty(n.prototype,i,Object.getOwnPropertyDescriptor(t.prototype,i))})})}function K9(n){let e=n.lastIndexOf("/");return e!=-1&&(n=n.slice(0,e)),e=n.lastIndexOf("/"),e!==-1&&(n=n.slice(e+1)),n}function Z9(n,e){const t=n.indexOf(e);t!==-1&&n.splice(t,1)}let kb=class extends lr{constructor(e,t){super(),this.expressions=[],this.reserveExpressionIndex=-1,this.destroyed=!1,this.settings=e,this.tag=`ExpressionManager(${e.name})`}init(){this.defaultExpression=this.createExpression({},void 0),this.currentExpression=this.defaultExpression,this.stopAllExpressions()}loadExpression(e){return nn(this,null,function*(){if(!this.definitions[e]){Gt.warn(this.tag,`Undefined expression at [${e}]`);return}if(this.expressions[e]===null){Gt.warn(this.tag,`Cannot set expression at [${e}] because it's already failed in loading.`);return}if(this.expressions[e])return this.expressions[e];const t=yield this._loadExpression(e);return this.expressions[e]=t,t})}_loadExpression(e){throw new Error("Not implemented.")}setRandomExpression(){return nn(this,null,function*(){if(this.definitions.length){const e=[];for(let t=0;t<this.definitions.length;t++)this.expressions[t]!==null&&this.expressions[t]!==this.currentExpression&&t!==this.reserveExpressionIndex&&e.push(t);if(e.length){const t=Math.floor(Math.random()*e.length);return this.setExpression(t)}}return!1})}resetExpression(){this._setExpression(this.defaultExpression)}restoreExpression(){this._setExpression(this.currentExpression)}setExpression(e){return nn(this,null,function*(){if(typeof e!="number"&&(e=this.getExpressionIndex(e)),!(e>-1&&e<this.definitions.length)||e===this.expressions.indexOf(this.currentExpression))return!1;this.reserveExpressionIndex=e;const t=yield this.loadExpression(e);return!t||this.reserveExpressionIndex!==e?!1:(this.reserveExpressionIndex=-1,this.currentExpression=t,this._setExpression(t),!0)})}update(e,t){return this.isFinished()?!1:this.updateParameters(e,t)}destroy(){this.destroyed=!0,this.emit("destroy");const e=this;e.definitions=void 0,e.expressions=void 0}};const gM=.01,J9=40/7.5,Q9=1/(.15*1e3);let eY=class{constructor(){this.targetX=0,this.targetY=0,this.x=0,this.y=0,this.vx=0,this.vy=0}focus(e,t,i=!1){this.targetX=lm(e,-1,1),this.targetY=lm(t,-1,1),i&&(this.x=this.targetX,this.y=this.targetY)}update(e){const t=this.targetX-this.x,i=this.targetY-this.y;if(Math.abs(t)<gM&&Math.abs(i)<gM)return;const r=Math.sqrt(aa(t,2)+aa(i,2)),s=J9/(1e3/e);let o=s*(t/r)-this.vx,a=s*(i/r)-this.vy;const l=Math.sqrt(aa(o,2)+aa(a,2)),u=s*Q9*e;l>u&&(o*=u/l,a*=u/l),this.vx+=o,this.vy+=a;const c=Math.sqrt(aa(this.vx,2)+aa(this.vy,2)),h=.5*(Math.sqrt(aa(u,2)+8*u*r)-u);c>h&&(this.vx*=h/c,this.vy*=h/c),this.x+=this.vx,this.y+=this.vy}},cg=class{constructor(e){this.json=e;let t=e.url;if(typeof t!="string")throw new TypeError("The `url` field in settings JSON must be defined as a string.");this.url=t,this.name=K9(this.url)}resolveURL(e){return Ci.resolve(this.url,e)}replaceFiles(e){this.moc=e(this.moc,"moc"),this.pose!==void 0&&(this.pose=e(this.pose,"pose")),this.physics!==void 0&&(this.physics=e(this.physics,"physics"));for(let t=0;t<this.textures.length;t++)this.textures[t]=e(this.textures[t],`textures[${t}]`)}getDefinedFiles(){const e=[];return this.replaceFiles(t=>(e.push(t),t)),e}validateFiles(e){const t=(s,o)=>{const a=this.resolveURL(s);if(!e.includes(a)){if(o)throw new Error(`File "${s}" is defined in settings, but doesn't exist in given files`);return!1}return!0};return[this.moc,...this.textures].forEach(s=>t(s,!0)),this.getDefinedFiles().filter(s=>t(s,!1))}};var B0=(n=>(n[n.NONE=0]="NONE",n[n.IDLE=1]="IDLE",n[n.NORMAL=2]="NORMAL",n[n.FORCE=3]="FORCE",n))(B0||{});let tY=class{constructor(){this.debug=!1,this.currentPriority=0,this.reservePriority=0}reserve(e,t,i){if(i<=0)return Gt.log(this.tag,"Cannot start a motion with MotionPriority.NONE."),!1;if(e===this.currentGroup&&t===this.currentIndex)return Gt.log(this.tag,"Motion is already playing.",this.dump(e,t)),!1;if(e===this.reservedGroup&&t===this.reservedIndex||e===this.reservedIdleGroup&&t===this.reservedIdleIndex)return Gt.log(this.tag,"Motion is already reserved.",this.dump(e,t)),!1;if(i===1){if(this.currentPriority!==0)return Gt.log(this.tag,"Cannot start idle motion because another motion is playing.",this.dump(e,t)),!1;if(this.reservedIdleGroup!==void 0)return Gt.log(this.tag,"Cannot start idle motion because another idle motion has reserved.",this.dump(e,t)),!1;this.setReservedIdle(e,t)}else{if(i<3){if(i<=this.currentPriority)return Gt.log(this.tag,"Cannot start motion because another motion is playing as an equivalent or higher priority.",this.dump(e,t)),!1;if(i<=this.reservePriority)return Gt.log(this.tag,"Cannot start motion because another motion has reserved as an equivalent or higher priority.",this.dump(e,t)),!1}this.setReserved(e,t,i)}return!0}start(e,t,i,r){if(r===1){if(this.setReservedIdle(void 0,void 0),this.currentPriority!==0)return Gt.log(this.tag,"Cannot start idle motion because another motion is playing.",this.dump(t,i)),!1}else{if(t!==this.reservedGroup||i!==this.reservedIndex)return Gt.log(this.tag,"Cannot start motion because another motion has taken the place.",this.dump(t,i)),!1;this.setReserved(void 0,void 0,0)}return e?(this.setCurrent(t,i,r),!0):!1}complete(){this.setCurrent(void 0,void 0,0)}setCurrent(e,t,i){this.currentPriority=i,this.currentGroup=e,this.currentIndex=t}setReserved(e,t,i){this.reservePriority=i,this.reservedGroup=e,this.reservedIndex=t}setReservedIdle(e,t){this.reservedIdleGroup=e,this.reservedIdleIndex=t}isActive(e,t){return e===this.currentGroup&&t===this.currentIndex||e===this.reservedGroup&&t===this.reservedIndex||e===this.reservedIdleGroup&&t===this.reservedIdleIndex}reset(){this.setCurrent(void 0,void 0,0),this.setReserved(void 0,void 0,0),this.setReservedIdle(void 0,void 0)}shouldRequestIdleMotion(){return this.currentGroup===void 0&&this.reservedIdleGroup===void 0}shouldOverrideExpression(){return!En.preserveExpressionOnMotion&&this.currentPriority>1}dump(e,t){if(this.debug){const i=["currentPriority","reservePriority","currentGroup","currentIndex","reservedGroup","reservedIndex","reservedIdleGroup","reservedIdleIndex"];return`
<Requested> group = "${e}", index = ${t}
`+i.map(r=>"["+r+"] "+this[r]).join(`
`)}return""}};const nY="SoundManager",iY=.5;let Va=class{static get volume(){return this._volume}static set volume(e){this._volume=(e>1?1:e<0?0:e)||0,this.audios.forEach(t=>t.volume=this._volume)}static add(e,t,i){const r=new Audio(e);return r.volume=this._volume,r.preload="auto",r.addEventListener("ended",()=>{this.dispose(r),t==null||t()}),r.addEventListener("error",s=>{this.dispose(r),Gt.warn(nY,`Error occurred on "${e}"`,s.error),i==null||i(s.error)}),this.audios.push(r),r}static play(e){return new Promise((t,i)=>{var r;(r=e.play())==null||r.catch(s=>{e.dispatchEvent(new ErrorEvent("error",{error:s})),i(s)}),e.readyState===e.HAVE_ENOUGH_DATA?t():e.addEventListener("canplaythrough",t)})}static dispose(e){e.pause(),e.removeAttribute("src"),Z9(this.audios,e)}static destroy(){for(let e=this.audios.length-1;e>=0;e--)this.dispose(this.audios[e])}};Va.audios=[];Va._volume=iY;let hg=class extends lr{constructor(e,t){super(),this.motionGroups={},this.state=new tY,this.playing=!1,this.destroyed=!1,this.settings=e,this.tag=`MotionManager(${e.name})`,this.state.tag=this.tag}init(e){e!=null&&e.idleMotionGroup&&(this.groups.idle=e.idleMotionGroup),this.setupMotions(e),this.stopAllMotions()}setupMotions(e){for(const i of Object.keys(this.definitions))this.motionGroups[i]=[];let t;switch(e==null?void 0:e.motionPreload){case"NONE":return;case"ALL":t=Object.keys(this.definitions);break;case"IDLE":default:t=[this.groups.idle];break}for(const i of t)if(this.definitions[i])for(let r=0;r<this.definitions[i].length;r++)this.loadMotion(i,r).then()}loadMotion(e,t){return nn(this,null,function*(){var i;if(!((i=this.definitions[e])!=null&&i[t])){Gt.warn(this.tag,`Undefined motion at "${e}"[${t}]`);return}if(this.motionGroups[e][t]===null){Gt.warn(this.tag,`Cannot start motion at "${e}"[${t}] because it's already failed in loading.`);return}if(this.motionGroups[e][t])return this.motionGroups[e][t];const r=yield this._loadMotion(e,t);if(!this.destroyed)return this.motionGroups[e][t]=r??null,r})}_loadMotion(e,t){throw new Error("Not implemented.")}startMotion(e,t){return nn(this,arguments,function*(i,r,s=B0.NORMAL){var o;if(!this.state.reserve(i,r,s))return!1;const a=(o=this.definitions[i])==null?void 0:o[r];if(!a)return!1;this.currentAudio&&Va.dispose(this.currentAudio);let l;if(En.sound){const c=this.getSoundFile(a);if(c)try{l=Va.add(this.settings.resolveURL(c),()=>this.currentAudio=void 0,()=>this.currentAudio=void 0),this.currentAudio=l}catch(h){Gt.warn(this.tag,"Failed to create audio",c,h)}}const u=yield this.loadMotion(i,r);if(l){const c=Va.play(l).catch(h=>Gt.warn(this.tag,"Failed to play audio",l.src,h));En.motionSync&&(yield c)}return this.state.start(u,i,r,s)?(Gt.log(this.tag,"Start motion:",this.getMotionName(a)),this.emit("motionStart",i,r,l),this.state.shouldOverrideExpression()&&this.expressionManager&&this.expressionManager.resetExpression(),this.playing=!0,this._startMotion(u),!0):(l&&(Va.dispose(l),this.currentAudio=void 0),!1)})}startRandomMotion(e,t){return nn(this,null,function*(){const i=this.definitions[e];if(i!=null&&i.length){const r=[];for(let s=0;s<i.length;s++)this.motionGroups[e][s]!==null&&!this.state.isActive(e,s)&&r.push(s);if(r.length){const s=Math.floor(Math.random()*r.length);return this.startMotion(e,r[s],t)}}return!1})}stopAllMotions(){this._stopAllMotions(),this.state.reset(),this.currentAudio&&(Va.dispose(this.currentAudio),this.currentAudio=void 0)}update(e,t){var i;return this.isFinished()&&(this.playing&&(this.playing=!1,this.emit("motionFinish")),this.state.shouldOverrideExpression()&&((i=this.expressionManager)==null||i.restoreExpression()),this.state.complete(),this.state.shouldRequestIdleMotion()&&this.startRandomMotion(this.groups.idle,B0.IDLE)),this.updateParameters(e,t)}destroy(){var e;this.destroyed=!0,this.emit("destroy"),this.stopAllMotions(),(e=this.expressionManager)==null||e.destroy();const t=this;t.definitions=void 0,t.motionGroups=void 0}};const rY={x:0,y:0,width:0,height:0};let iL=class extends lr{constructor(){super(...arguments),this.focusController=new eY,this.originalWidth=0,this.originalHeight=0,this.width=0,this.height=0,this.localTransform=new kt,this.drawingMatrix=new kt,this.hitAreas={},this.textureFlipY=!1,this.viewport=[0,0,0,0],this.destroyed=!1}init(){this.setupLayout(),this.setupHitAreas()}setupLayout(){const e=this,t=this.getSize();e.originalWidth=t[0],e.originalHeight=t[1];const i=Object.assign({width:pM,height:mM},this.getLayout());this.localTransform.scale(i.width/pM,i.height/mM),e.width=this.originalWidth*this.localTransform.a,e.height=this.originalHeight*this.localTransform.d;const r=i.x!==void 0&&i.x-i.width/2||i.centerX!==void 0&&i.centerX||i.left!==void 0&&i.left-i.width/2||i.right!==void 0&&i.right+i.width/2||0,s=i.y!==void 0&&i.y-i.height/2||i.centerY!==void 0&&i.centerY||i.top!==void 0&&i.top-i.height/2||i.bottom!==void 0&&i.bottom+i.height/2||0;this.localTransform.translate(this.width*r,-this.height*s)}setupHitAreas(){const e=this.getHitAreaDefs().filter(t=>t.index>=0);for(const t of e)this.hitAreas[t.name]=t}hitTest(e,t){return Object.keys(this.hitAreas).filter(i=>this.isHit(i,e,t))}isHit(e,t,i){if(!this.hitAreas[e])return!1;const r=this.hitAreas[e].index,s=this.getDrawableBounds(r,rY);return s.x<=t&&t<=s.x+s.width&&s.y<=i&&i<=s.y+s.height}getDrawableBounds(e,t){const i=this.getDrawableVertices(e);let r=i[0],s=i[0],o=i[1],a=i[1];for(let l=0;l<i.length;l+=2){const u=i[l],c=i[l+1];r=Math.min(u,r),s=Math.max(u,s),o=Math.min(c,o),a=Math.max(c,a)}return t??(t={}),t.x=r,t.y=o,t.width=s-r,t.height=a-o,t}updateTransform(e){this.drawingMatrix.copyFrom(e).append(this.localTransform)}update(e,t){this.focusController.update(e)}destroy(){this.destroyed=!0,this.emit("destroy"),this.motionManager.destroy(),this.motionManager=void 0}};const sY="XHRLoader";let _M=class extends Error{constructor(e,t,i,r=!1){super(e),this.url=t,this.status=i,this.aborted=r}};const ni=class{static createXHR(e,t,i,r,s){const o=new XMLHttpRequest;if(ni.allXhrSet.add(o),e){let a=ni.xhrMap.get(e);a?a.add(o):(a=new Set([o]),ni.xhrMap.set(e,a)),e.listeners("destroy").includes(ni.cancelXHRs)||e.once("destroy",ni.cancelXHRs)}return o.open("GET",t),o.responseType=i,o.onload=()=>{(o.status===200||o.status===0)&&o.response?r(o.response):o.onerror()},o.onerror=()=>{Gt.warn(sY,`Failed to load resource as ${o.responseType} (Status ${o.status}): ${t}`),s(new _M("Network error.",t,o.status))},o.onabort=()=>s(new _M("Aborted.",t,o.status,!0)),o.onloadend=()=>{var a;ni.allXhrSet.delete(o),e&&((a=ni.xhrMap.get(e))==null||a.delete(o))},o}static cancelXHRs(){var e;(e=ni.xhrMap.get(this))==null||e.forEach(t=>{t.abort(),ni.allXhrSet.delete(t)}),ni.xhrMap.delete(this)}static release(){ni.allXhrSet.forEach(e=>e.abort()),ni.allXhrSet.clear(),ni.xhrMap=new WeakMap}};let dg=ni;dg.xhrMap=new WeakMap;dg.allXhrSet=new Set;dg.loader=(n,e)=>new Promise((t,i)=>{ni.createXHR(n.target,n.settings?n.settings.resolveURL(n.url):n.url,n.type,s=>{n.result=s,t()},i).send()});function rL(n,e){let t=-1;return i(0);function i(r,s){if(s)return Promise.reject(s);if(r<=t)return Promise.reject(new Error("next() called multiple times"));t=r;const o=n[r];if(!o)return Promise.resolve();try{return Promise.resolve(o(e,i.bind(null,r+1)))}catch(a){return Promise.reject(a)}}}let Wo=class{static load(e){return rL(this.middlewares,e).then(()=>e.result)}};Wo.middlewares=[dg.loader];function oY(n,e={}){var t;const i={resourceOptions:{crossorigin:e.crossOrigin}};if(Ke.fromURL)return Ke.fromURL(n,i).catch(o=>{if(o instanceof Error)throw o;const a=new Error("Texture loading error");throw a.event=o,a});i.resourceOptions.autoLoad=!1;const r=Ke.from(n,i);if(r.baseTexture.valid)return Promise.resolve(r);const s=r.baseTexture.resource;return(t=s._live2d_load)!=null||(s._live2d_load=new Promise((o,a)=>{const l=u=>{s.source.removeEventListener("error",l);const c=new Error("Texture loading error");c.event=u,a(c)};s.source.addEventListener("error",l),s.load().then(()=>o(r)).catch(l)})),s._live2d_load}const vM="Live2DFactory",sL=(n,e)=>nn(void 0,null,function*(){if(typeof n.source=="string"){const t=yield Wo.load({url:n.source,type:"json",target:n.live2dModel});t.url=n.source,n.source=t,n.live2dModel.emit("settingsJSONLoaded",t)}return e()}),oL=(n,e)=>nn(void 0,null,function*(){if(n.source instanceof cg)return n.settings=n.source,e();if(typeof n.source=="object"){const t=tn.findRuntime(n.source);if(t){const i=t.createModelSettings(n.source);return n.settings=i,n.live2dModel.emit("settingsLoaded",i),e()}}throw new TypeError("Unknown settings format.")}),aL=(n,e)=>{if(n.settings){const t=tn.findRuntime(n.settings);if(t)return t.ready().then(e)}return e()},lL=(n,e)=>nn(void 0,null,function*(){yield e();const t=n.internalModel;if(t){const i=n.settings,r=tn.findRuntime(i);if(r){const s=[];i.pose&&s.push(Wo.load({settings:i,url:i.pose,type:"json",target:t}).then(o=>{t.pose=r.createPose(t.coreModel,o),n.live2dModel.emit("poseLoaded",t.pose)}).catch(o=>{n.live2dModel.emit("poseLoadError",o),Gt.warn(vM,"Failed to load pose.",o)})),i.physics&&s.push(Wo.load({settings:i,url:i.physics,type:"json",target:t}).then(o=>{t.physics=r.createPhysics(t.coreModel,o),n.live2dModel.emit("physicsLoaded",t.physics)}).catch(o=>{n.live2dModel.emit("physicsLoadError",o),Gt.warn(vM,"Failed to load physics.",o)})),s.length&&(yield Promise.all(s))}}}),uL=(n,e)=>nn(void 0,null,function*(){if(n.settings){const t=n.live2dModel,i=n.settings.textures.map(r=>{const s=n.settings.resolveURL(r);return oY(s,{crossOrigin:n.options.crossOrigin})});if(yield e(),n.internalModel)t.internalModel=n.internalModel,t.emit("modelLoaded",n.internalModel);else throw new TypeError("Missing internal model.");t.textures=yield Promise.all(i),t.emit("textureLoaded",t.textures)}else throw new TypeError("Missing settings.")}),cL=(n,e)=>nn(void 0,null,function*(){const t=n.settings;if(t instanceof cg){const i=tn.findRuntime(t);if(!i)throw new TypeError("Unknown model settings.");const r=yield Wo.load({settings:t,url:t.moc,type:"arraybuffer",target:n.live2dModel});if(!i.isValidMoc(r))throw new Error("Invalid moc data");const s=i.createCoreModel(r);return n.internalModel=i.createInternalModel(s,t,n.options),e()}throw new TypeError("Missing settings.")}),Gn=class{static registerRuntime(e){Gn.runtimes.push(e),Gn.runtimes.sort((t,i)=>i.version-t.version)}static findRuntime(e){for(const t of Gn.runtimes)if(t.test(e))return t}static setupLive2DModel(e,t,i){return nn(this,null,function*(){const r=new Promise(a=>e.once("textureLoaded",a)),s=new Promise(a=>e.once("modelLoaded",a)),o=Promise.all([r,s]).then(()=>e.emit("ready"));yield rL(Gn.live2DModelMiddlewares,{live2dModel:e,source:t,options:i||{}}),yield o,e.emit("load")})}static loadMotion(e,t,i){var r,s;const o=a=>e.emit("motionLoadError",t,i,a);try{const a=(r=e.definitions[t])==null?void 0:r[i];if(!a)return Promise.resolve(void 0);e.listeners("destroy").includes(Gn.releaseTasks)||e.once("destroy",Gn.releaseTasks);let l=Gn.motionTasksMap.get(e);l||(l={},Gn.motionTasksMap.set(e,l));let u=l[t];u||(u=[],l[t]=u);const c=e.getMotionFile(a);return(s=u[i])!=null||(u[i]=Wo.load({url:c,settings:e.settings,type:e.motionDataType,target:e}).then(h=>{var d;const f=(d=Gn.motionTasksMap.get(e))==null?void 0:d[t];f&&delete f[i];const p=e.createMotion(h,t,a);return e.emit("motionLoaded",t,i,p),p}).catch(h=>{Gt.warn(e.tag,`Failed to load motion: ${c}
`,h),o(h)})),u[i]}catch(a){Gt.warn(e.tag,`Failed to load motion at "${t}"[${i}]
`,a),o(a)}return Promise.resolve(void 0)}static loadExpression(e,t){var i;const r=s=>e.emit("expressionLoadError",t,s);try{const s=e.definitions[t];if(!s)return Promise.resolve(void 0);e.listeners("destroy").includes(Gn.releaseTasks)||e.once("destroy",Gn.releaseTasks);let o=Gn.expressionTasksMap.get(e);o||(o=[],Gn.expressionTasksMap.set(e,o));const a=e.getExpressionFile(s);return(i=o[t])!=null||(o[t]=Wo.load({url:a,settings:e.settings,type:"json",target:e}).then(l=>{const u=Gn.expressionTasksMap.get(e);u&&delete u[t];const c=e.createExpression(l,s);return e.emit("expressionLoaded",t,c),c}).catch(l=>{Gt.warn(e.tag,`Failed to load expression: ${a}
`,l),r(l)})),o[t]}catch(s){Gt.warn(e.tag,`Failed to load expression at [${t}]
`,s),r(s)}return Promise.resolve(void 0)}static releaseTasks(){this instanceof hg?Gn.motionTasksMap.delete(this):Gn.expressionTasksMap.delete(this)}};let tn=Gn;tn.runtimes=[];tn.urlToJSON=sL;tn.jsonToSettings=oL;tn.waitUntilReady=aL;tn.setupOptionals=lL;tn.setupEssentials=uL;tn.createInternalModel=cL;tn.live2DModelMiddlewares=[sL,oL,aL,lL,uL,cL];tn.motionTasksMap=new WeakMap;tn.expressionTasksMap=new WeakMap;hg.prototype._loadMotion=function(n,e){return tn.loadMotion(this,n,e)};kb.prototype._loadExpression=function(n){return tn.loadExpression(this,n)};let aY=class{constructor(){this._autoInteract=!1}get autoInteract(){return this._autoInteract}set autoInteract(e){e!==this._autoInteract&&(e?this.on("pointertap",yM,this):this.off("pointertap",yM,this),this._autoInteract=e)}registerInteraction(e){e!==this.interactionManager&&(this.unregisterInteraction(),this._autoInteract&&e&&(this.interactionManager=e,e.on("pointermove",xM,this)))}unregisterInteraction(){var e;this.interactionManager&&((e=this.interactionManager)==null||e.off("pointermove",xM,this),this.interactionManager=void 0)}};function yM(n){this.tap(n.data.global.x,n.data.global.y)}function xM(n){this.focus(n.data.global.x,n.data.global.y)}let lY=class extends Bd{};const Ni=new Bt,uY=new kt;let ao,cY=class extends Oi{constructor(e){super(),this.tag="Live2DModel(uninitialized)",this.textures=[],this.transform=new lY,this.anchor=new Us(this.onAnchorChange,this,0,0),this.glContextID=-1,this.elapsedTime=performance.now(),this.deltaTime=0,this._autoUpdate=!1,this.once("modelLoaded",()=>this.init(e))}static from(e,t){const i=new this(t);return tn.setupLive2DModel(i,e,t).then(()=>i)}static fromSync(e,t){const i=new this(t);return tn.setupLive2DModel(i,e,t).then(t==null?void 0:t.onLoad).catch(t==null?void 0:t.onError),i}static registerTicker(e){ao=e}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){var t;ao||(ao=(t=window.PIXI)==null?void 0:t.Ticker),e?this._destroyed||(ao?(ao.shared.add(this.onTickerUpdate,this),this._autoUpdate=!0):Gt.warn(this.tag,"No Ticker registered, please call Live2DModel.registerTicker(Ticker).")):(ao==null||ao.shared.remove(this.onTickerUpdate,this),this._autoUpdate=!1)}init(e){this.tag=`Live2DModel(${this.internalModel.settings.name})`;const t=Object.assign({autoUpdate:!0,autoInteract:!0},e);t.autoInteract&&(this.interactive=!0),this.autoInteract=t.autoInteract,this.autoUpdate=t.autoUpdate}onAnchorChange(){this.pivot.set(this.anchor.x*this.internalModel.width,this.anchor.y*this.internalModel.height)}motion(e,t,i){return t===void 0?this.internalModel.motionManager.startRandomMotion(e,i):this.internalModel.motionManager.startMotion(e,t,i)}expression(e){return this.internalModel.motionManager.expressionManager?e===void 0?this.internalModel.motionManager.expressionManager.setRandomExpression():this.internalModel.motionManager.expressionManager.setExpression(e):Promise.resolve(!1)}focus(e,t,i=!1){Ni.x=e,Ni.y=t,this.toModelPosition(Ni,Ni,!0);let r=Ni.x/this.internalModel.originalWidth*2-1,s=Ni.y/this.internalModel.originalHeight*2-1,o=Math.atan2(s,r);this.internalModel.focusController.focus(Math.cos(o),-Math.sin(o),i)}tap(e,t){const i=this.hitTest(e,t);i.length&&(Gt.log(this.tag,"Hit",i),this.emit("hit",i))}hitTest(e,t){return Ni.x=e,Ni.y=t,this.toModelPosition(Ni,Ni),this.internalModel.hitTest(Ni.x,Ni.y)}toModelPosition(e,t=e.clone(),i){return i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.transform.worldTransform.applyInverse(e,t),this.internalModel.localTransform.applyInverse(t,t),t}containsPoint(e){return this.getBounds(!0).contains(e.x,e.y)}_calculateBounds(){this._bounds.addFrame(this.transform,0,0,this.internalModel.width,this.internalModel.height)}onTickerUpdate(){this.update(ao.shared.deltaMS)}update(e){this.deltaTime+=e,this.elapsedTime+=e}_render(e){this.registerInteraction(e.plugins.interaction),e.batch.reset(),e.geometry.reset(),e.shader.reset(),e.state.reset();let t=!1;this.glContextID!==e.CONTEXT_UID&&(this.glContextID=e.CONTEXT_UID,this.internalModel.updateWebGLContext(e.gl,this.glContextID),t=!0);for(let s=0;s<this.textures.length;s++){const o=this.textures[s];o.valid&&((t||!o.baseTexture._glTextures[this.glContextID])&&(e.gl.pixelStorei(WebGLRenderingContext.UNPACK_FLIP_Y_WEBGL,this.internalModel.textureFlipY),e.texture.bind(o.baseTexture,0)),this.internalModel.bindTexture(s,o.baseTexture._glTextures[this.glContextID].texture),o.baseTexture.touched=e.textureGC.count)}const i=e.framebuffer.viewport;this.internalModel.viewport=[i.x,i.y,i.width,i.height],this.deltaTime&&(this.internalModel.update(this.deltaTime,this.elapsedTime),this.deltaTime=0);const r=uY.copyFrom(e.globalUniforms.uniforms.projectionMatrix).append(this.worldTransform);this.internalModel.updateTransform(r),this.internalModel.draw(e.gl),e.state.reset(),e.texture.reset()}destroy(e){this.emit("destroy"),this.autoUpdate=!1,this.unregisterInteraction(),e!=null&&e.texture&&this.textures.forEach(t=>t.destroy(e.baseTexture)),this.internalModel.destroy(),super.destroy(e)}};nL(cY,[aY]);const Kr=class{static resolveURL(e,t){var i;const r=(i=Kr.filesMap[e])==null?void 0:i[t];if(r===void 0)throw new Error("Cannot find this file from uploaded files: "+t);return r}static upload(e,t){return nn(this,null,function*(){const i={};for(const r of t.getDefinedFiles()){const s=decodeURI(Ci.resolve(t.url,r)),o=e.find(a=>a.webkitRelativePath===s);o&&(i[r]=URL.createObjectURL(o))}Kr.filesMap[t._objectURL]=i})}static createSettings(e){return nn(this,null,function*(){const t=e.find(a=>a.name.endsWith("model.json")||a.name.endsWith("model3.json"));if(!t)throw new TypeError("Settings file not found");const i=yield Kr.readText(t),r=JSON.parse(i);r.url=t.webkitRelativePath;const s=tn.findRuntime(r);if(!s)throw new Error("Unknown settings JSON");const o=s.createModelSettings(r);return o._objectURL=URL.createObjectURL(t),o})}static readText(e){return nn(this,null,function*(){return new Promise((t,i)=>{const r=new FileReader;r.onload=()=>t(r.result),r.onerror=i,r.readAsText(e,"utf8")})})}};let Vb=Kr;Vb.filesMap={};Vb.factory=(n,e)=>nn(void 0,null,function*(){if(Array.isArray(n.source)&&n.source[0]instanceof File){const t=n.source;let i=t.settings;if(!i)i=yield Kr.createSettings(t);else if(!i._objectURL)throw new Error('"_objectURL" must be specified in ModelSettings');i.validateFiles(t.map(r=>encodeURI(r.webkitRelativePath))),yield Kr.upload(t,i),i.resolveURL=function(r){return Kr.resolveURL(this._objectURL,r)},n.source=i,n.live2dModel.once("modelLoaded",r=>{r.once("destroy",function(){const s=this.settings._objectURL;if(URL.revokeObjectURL(s),Kr.filesMap[s])for(const o of Object.values(Kr.filesMap[s]))URL.revokeObjectURL(o);delete Kr.filesMap[s]})})}return e()});tn.live2DModelMiddlewares.unshift(Vb.factory);const di=class{static unzip(e,t){return nn(this,null,function*(){const i=yield di.getFilePaths(e),r=[];for(const o of t.getDefinedFiles()){const a=decodeURI(Ci.resolve(t.url,o));i.includes(a)&&r.push(a)}const s=yield di.getFiles(e,r);for(let o=0;o<s.length;o++){const a=r[o],l=s[o];Object.defineProperty(l,"webkitRelativePath",{value:a})}return s})}static createSettings(e){return nn(this,null,function*(){const i=(yield di.getFilePaths(e)).find(a=>a.endsWith("model.json")||a.endsWith("model3.json"));if(!i)throw new Error("Settings file not found");const r=yield di.readText(e,i);if(!r)throw new Error("Empty settings file: "+i);const s=JSON.parse(r);s.url=i;const o=tn.findRuntime(s);if(!o)throw new Error("Unknown settings JSON");return o.createModelSettings(s)})}static zipReader(e,t){return nn(this,null,function*(){throw new Error("Not implemented")})}static getFilePaths(e){return nn(this,null,function*(){throw new Error("Not implemented")})}static getFiles(e,t){return nn(this,null,function*(){throw new Error("Not implemented")})}static readText(e,t){return nn(this,null,function*(){throw new Error("Not implemented")})}static releaseReader(e){}};let fg=di;fg.ZIP_PROTOCOL="zip://";fg.uid=0;fg.factory=(n,e)=>nn(void 0,null,function*(){const t=n.source;let i,r,s;if(typeof t=="string"&&(t.endsWith(".zip")||t.startsWith(di.ZIP_PROTOCOL))?(t.startsWith(di.ZIP_PROTOCOL)?i=t.slice(di.ZIP_PROTOCOL.length):i=t,r=yield Wo.load({url:i,type:"blob",target:n.live2dModel})):Array.isArray(t)&&t.length===1&&t[0]instanceof File&&t[0].name.endsWith(".zip")&&(r=t[0],i=URL.createObjectURL(r),s=t.settings),r){if(!r.size)throw new Error("Empty zip file");const o=yield di.zipReader(r,i);s||(s=yield di.createSettings(o)),s._objectURL=di.ZIP_PROTOCOL+di.uid+"/"+s.url;const a=yield di.unzip(o,s);a.settings=s,n.source=a,i.startsWith("blob:")&&n.live2dModel.once("modelLoaded",l=>{l.once("destroy",function(){URL.revokeObjectURL(i)})}),di.releaseReader(o)}return e()});tn.live2DModelMiddlewares.unshift(fg.factory);if(!window.Live2D)throw new Error("Could not find Cubism 2 runtime. This plugin requires live2d.min.js to be loaded.");const hY=Live2DMotion.prototype.updateParam;Live2DMotion.prototype.updateParam=function(n,e){hY.call(this,n,e),e.isFinished()&&this.onFinishHandler&&(this.onFinishHandler(this),delete this.onFinishHandler)};class dY extends AMotion{constructor(e){super(),this.params=[],this.setFadeIn(e.fade_in>0?e.fade_in:En.expressionFadingDuration),this.setFadeOut(e.fade_out>0?e.fade_out:En.expressionFadingDuration),Array.isArray(e.params)&&e.params.forEach(t=>{const i=t.calc||"add";if(i==="add"){const r=t.def||0;t.val-=r}else if(i==="mult"){const r=t.def||1;t.val/=r}this.params.push({calc:i,val:t.val,id:t.id})})}updateParamExe(e,t,i,r){this.params.forEach(s=>{e.setParamFloat(s.id,s.val*i)})}}class fY extends kb{constructor(e,t){var i;super(e,t),this.queueManager=new MotionQueueManager,this.definitions=(i=this.settings.expressions)!=null?i:[],this.init()}isFinished(){return this.queueManager.isFinished()}getExpressionIndex(e){return this.definitions.findIndex(t=>t.name===e)}getExpressionFile(e){return e.file}createExpression(e,t){return new dY(e)}_setExpression(e){return this.queueManager.startMotion(e)}stopAllExpressions(){this.queueManager.stopAllMotions()}updateParameters(e,t){return this.queueManager.updateParam(e)}}class pY extends hg{constructor(e,t){super(e,t),this.groups={idle:"idle"},this.motionDataType="arraybuffer",this.queueManager=new MotionQueueManager,this.definitions=this.settings.motions,this.init(t)}init(e){super.init(e),this.settings.expressions&&(this.expressionManager=new fY(this.settings,e))}isFinished(){return this.queueManager.isFinished()}createMotion(e,t,i){const r=Live2DMotion.loadMotion(e),s=t===this.groups.idle?En.idleMotionFadingDuration:En.motionFadingDuration;return r.setFadeIn(i.fade_in>0?i.fade_in:s),r.setFadeOut(i.fade_out>0?i.fade_out:s),r}getMotionFile(e){return e.file}getMotionName(e){return e.file}getSoundFile(e){return e.sound}_startMotion(e,t){return e.onFinishHandler=t,this.queueManager.stopAllMotions(),this.queueManager.startMotion(e)}_stopAllMotions(){this.queueManager.stopAllMotions()}updateParameters(e,t){return this.queueManager.updateParam(e)}destroy(){super.destroy(),this.queueManager=void 0}}class mY{constructor(e){this.coreModel=e,this.blinkInterval=4e3,this.closingDuration=100,this.closedDuration=50,this.openingDuration=150,this.eyeState=0,this.eyeParamValue=1,this.closedTimer=0,this.nextBlinkTimeLeft=this.blinkInterval,this.leftParam=e.getParamIndex("PARAM_EYE_L_OPEN"),this.rightParam=e.getParamIndex("PARAM_EYE_R_OPEN")}setEyeParams(e){this.eyeParamValue=lm(e,0,1),this.coreModel.setParamFloat(this.leftParam,this.eyeParamValue),this.coreModel.setParamFloat(this.rightParam,this.eyeParamValue)}update(e){switch(this.eyeState){case 0:this.nextBlinkTimeLeft-=e,this.nextBlinkTimeLeft<0&&(this.eyeState=1,this.nextBlinkTimeLeft=this.blinkInterval+this.closingDuration+this.closedDuration+this.openingDuration+q9(0,2e3));break;case 1:this.setEyeParams(this.eyeParamValue+e/this.closingDuration),this.eyeParamValue<=0&&(this.eyeState=2,this.closedTimer=0);break;case 2:this.closedTimer+=e,this.closedTimer>=this.closedDuration&&(this.eyeState=3);break;case 3:this.setEyeParams(this.eyeParamValue+e/this.openingDuration),this.eyeParamValue>=1&&(this.eyeState=0)}}}const la=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class gY extends iL{constructor(e,t,i){super(),this.textureFlipY=!0,this.drawDataCount=0,this.disableCulling=!1,this.coreModel=e,this.settings=t,this.motionManager=new pY(t,i),this.eyeBlink=new mY(e),this.eyeballXParamIndex=e.getParamIndex("PARAM_EYE_BALL_X"),this.eyeballYParamIndex=e.getParamIndex("PARAM_EYE_BALL_Y"),this.angleXParamIndex=e.getParamIndex("PARAM_ANGLE_X"),this.angleYParamIndex=e.getParamIndex("PARAM_ANGLE_Y"),this.angleZParamIndex=e.getParamIndex("PARAM_ANGLE_Z"),this.bodyAngleXParamIndex=e.getParamIndex("PARAM_BODY_ANGLE_X"),this.breathParamIndex=e.getParamIndex("PARAM_BREATH"),this.init()}init(){super.init(),this.settings.initParams&&this.settings.initParams.forEach(({id:s,value:o})=>this.coreModel.setParamFloat(s,o)),this.settings.initOpacities&&this.settings.initOpacities.forEach(({id:s,value:o})=>this.coreModel.setPartsOpacity(s,o)),this.coreModel.saveParam();const e=this.coreModel.getModelContext()._$aS;e!=null&&e.length&&(this.drawDataCount=e.length);let t=this.coreModel.drawParamWebGL.culling;Object.defineProperty(this.coreModel.drawParamWebGL,"culling",{set:s=>t=s,get:()=>this.disableCulling?!1:t});const i=this.coreModel.getModelContext().clipManager,r=i.setupClip;i.setupClip=(s,o)=>{r.call(i,s,o),o.gl.viewport(...this.viewport)}}getSize(){return[this.coreModel.getCanvasWidth(),this.coreModel.getCanvasHeight()]}getLayout(){const e={};if(this.settings.layout)for(const t of Object.keys(this.settings.layout)){let i=t;t==="center_x"?i="centerX":t==="center_y"&&(i="centerY"),e[i]=this.settings.layout[t]}return e}updateWebGLContext(e,t){const i=this.coreModel.drawParamWebGL;i.firstDraw=!0,i.setGL(e),i.glno=t;for(const o in i)i.hasOwnProperty(o)&&i[o]instanceof WebGLBuffer&&(i[o]=null);const r=this.coreModel.getModelContext().clipManager;r.curFrameNo=t;const s=e.getParameter(e.FRAMEBUFFER_BINDING);r.getMaskRenderTexture(),e.bindFramebuffer(e.FRAMEBUFFER,s)}bindTexture(e,t){this.coreModel.setTexture(e,t)}getHitAreaDefs(){var e;return((e=this.settings.hitAreas)==null?void 0:e.map(t=>({id:t.id,name:t.name,index:this.coreModel.getDrawDataIndex(t.id)})))||[]}getDrawableIDs(){const e=this.coreModel.getModelContext(),t=[];for(let i=0;i<this.drawDataCount;i++){const r=e.getDrawData(i);r&&t.push(r.getDrawDataID().id)}return t}getDrawableIndex(e){return this.coreModel.getDrawDataIndex(e)}getDrawableVertices(e){if(typeof e=="string"&&(e=this.coreModel.getDrawDataIndex(e),e===-1))throw new TypeError("Unable to find drawable ID: "+e);return this.coreModel.getTransformedPoints(e).slice()}update(e,t){var i,r,s,o;super.update(e,t);const a=this.coreModel;this.emit("beforeMotionUpdate");const l=this.motionManager.update(this.coreModel,t);this.emit("afterMotionUpdate"),a.saveParam(),(i=this.motionManager.expressionManager)==null||i.update(a,t),l||(r=this.eyeBlink)==null||r.update(e),this.updateFocus(),this.updateNaturalMovements(e,t),(s=this.physics)==null||s.update(t),(o=this.pose)==null||o.update(e),this.emit("beforeModelUpdate"),a.update(),a.loadParam()}updateFocus(){this.coreModel.addToParamFloat(this.eyeballXParamIndex,this.focusController.x),this.coreModel.addToParamFloat(this.eyeballYParamIndex,this.focusController.y),this.coreModel.addToParamFloat(this.angleXParamIndex,this.focusController.x*30),this.coreModel.addToParamFloat(this.angleYParamIndex,this.focusController.y*30),this.coreModel.addToParamFloat(this.angleZParamIndex,this.focusController.x*this.focusController.y*-30),this.coreModel.addToParamFloat(this.bodyAngleXParamIndex,this.focusController.x*10)}updateNaturalMovements(e,t){const i=t/1e3*2*Math.PI;this.coreModel.addToParamFloat(this.angleXParamIndex,15*Math.sin(i/6.5345)*.5),this.coreModel.addToParamFloat(this.angleYParamIndex,8*Math.sin(i/3.5345)*.5),this.coreModel.addToParamFloat(this.angleZParamIndex,10*Math.sin(i/5.5345)*.5),this.coreModel.addToParamFloat(this.bodyAngleXParamIndex,4*Math.sin(i/15.5345)*.5),this.coreModel.setParamFloat(this.breathParamIndex,.5+.5*Math.sin(i/3.2345))}draw(e){const t=this.disableCulling;e.getParameter(e.FRAMEBUFFER_BINDING)&&(this.disableCulling=!0);const i=this.drawingMatrix;la[0]=i.a,la[1]=i.b,la[4]=i.c,la[5]=i.d,la[12]=i.tx,la[13]=i.ty,this.coreModel.setMatrix(la),this.coreModel.draw(),this.disableCulling=t}destroy(){super.destroy(),this.coreModel=void 0}}class Nh extends cg{constructor(e){if(super(e),this.motions={},!Nh.isValidJSON(e))throw new TypeError("Invalid JSON.");this.moc=e.model,Gc("string",e,this,"textures","textures"),this.copy(e)}static isValidJSON(e){var t;return!!e&&typeof e.model=="string"&&((t=e.textures)==null?void 0:t.length)>0&&e.textures.every(i=>typeof i=="string")}copy(e){Vc("string",e,this,"name","name"),Vc("string",e,this,"pose","pose"),Vc("string",e,this,"physics","physics"),Vc("object",e,this,"layout","layout"),Vc("object",e,this,"motions","motions"),Gc("object",e,this,"hit_areas","hitAreas"),Gc("object",e,this,"expressions","expressions"),Gc("object",e,this,"init_params","initParams"),Gc("object",e,this,"init_opacities","initOpacities")}replaceFiles(e){super.replaceFiles(e);for(const[t,i]of Object.entries(this.motions))for(let r=0;r<i.length;r++)i[r].file=e(i[r].file,`motions.${t}[${r}].file`),i[r].sound!==void 0&&(i[r].sound=e(i[r].sound,`motions.${t}[${r}].sound`));if(this.expressions)for(let t=0;t<this.expressions.length;t++)this.expressions[t].file=e(this.expressions[t].file,`expressions[${t}].file`)}}const _Y={x:PhysicsHair.Src.SRC_TO_X,y:PhysicsHair.Src.SRC_TO_Y,angle:PhysicsHair.Src.SRC_TO_G_ANGLE},vY={x:PhysicsHair.Src.SRC_TO_X,y:PhysicsHair.Src.SRC_TO_Y,angle:PhysicsHair.Src.SRC_TO_G_ANGLE};class yY{constructor(e,t){this.coreModel=e,this.physicsHairs=[],t.physics_hair&&(this.physicsHairs=t.physics_hair.map(i=>{const r=new PhysicsHair;return r.setup(i.setup.length,i.setup.regist,i.setup.mass),i.src.forEach(({id:s,ptype:o,scale:a,weight:l})=>{const u=_Y[o];u&&r.addSrcParam(u,s,a,l)}),i.targets.forEach(({id:s,ptype:o,scale:a,weight:l})=>{const u=vY[o];u&&r.addTargetParam(u,s,a,l)}),r}))}update(e){this.physicsHairs.forEach(t=>t.update(this.coreModel,e))}}class bM{constructor(e){this.id=e,this.paramIndex=-1,this.partsIndex=-1,this.link=[]}initIndex(e){this.paramIndex=e.getParamIndex("VISIBLE:"+this.id),this.partsIndex=e.getPartsDataIndex(PartsDataID.getID(this.id)),e.setParamFloat(this.paramIndex,1)}}class xY{constructor(e,t){this.coreModel=e,this.opacityAnimDuration=500,this.partsGroups=[],t.parts_visible&&(this.partsGroups=t.parts_visible.map(({group:i})=>i.map(({id:r,link:s})=>{const o=new bM(r);return s&&(o.link=s.map(a=>new bM(a))),o})),this.init())}init(){this.partsGroups.forEach(e=>{e.forEach(t=>{if(t.initIndex(this.coreModel),t.paramIndex>=0){const i=this.coreModel.getParamFloat(t.paramIndex)!==0;this.coreModel.setPartsOpacity(t.partsIndex,i?1:0),this.coreModel.setParamFloat(t.paramIndex,i?1:0),t.link.length>0&&t.link.forEach(r=>r.initIndex(this.coreModel))}})})}normalizePartsOpacityGroup(e,t){const i=this.coreModel,r=.5,s=.15;let o=1,a=e.findIndex(({paramIndex:l,partsIndex:u})=>u>=0&&i.getParamFloat(l)!==0);if(a>=0){const l=i.getPartsOpacity(e[a].partsIndex);o=lm(l+t/this.opacityAnimDuration,0,1)}else a=0,o=1;e.forEach(({partsIndex:l},u)=>{if(l>=0)if(a==u)i.setPartsOpacity(l,o);else{let c=i.getPartsOpacity(l),h;o<r?h=o*(r-1)/r+1:h=(1-o)*r/(1-r),(1-h)*(1-o)>s&&(h=1-s/(1-o)),c>h&&(c=h),i.setPartsOpacity(l,c)}})}copyOpacity(e){const t=this.coreModel;e.forEach(({partsIndex:i,link:r})=>{if(i>=0&&r){const s=t.getPartsOpacity(i);r.forEach(({partsIndex:o})=>{o>=0&&t.setPartsOpacity(o,s)})}})}update(e){this.partsGroups.forEach(t=>{this.normalizePartsOpacityGroup(t,e),this.copyOpacity(t)})}}tn.registerRuntime({version:2,test(n){return n instanceof Nh||Nh.isValidJSON(n)},ready(){return Promise.resolve()},isValidMoc(n){if(n.byteLength<3)return!1;const e=new Int8Array(n,0,3);return String.fromCharCode(...e)==="moc"},createModelSettings(n){return new Nh(n)},createCoreModel(n){const e=Live2DModelWebGL.loadModel(n),t=Live2D.getError();if(t)throw t;return e},createInternalModel(n,e,t){return new gY(n,e,t)},createPose(n,e){return new xY(n,e)},createPhysics(n,e){return new yY(n,e)}});if(!window.Live2DCubismCore)throw new Error("Could not find Cubism 4 runtime. This plugin requires live2dcubismcore.js to be loaded.");let gt=class Aa{constructor(e,t){this.x=e||0,this.y=t||0}add(e){const t=new Aa(0,0);return t.x=this.x+e.x,t.y=this.y+e.y,t}substract(e){const t=new Aa(0,0);return t.x=this.x-e.x,t.y=this.y-e.y,t}multiply(e){const t=new Aa(0,0);return t.x=this.x*e.x,t.y=this.y*e.y,t}multiplyByScaler(e){return this.multiply(new Aa(e,e))}division(e){const t=new Aa(0,0);return t.x=this.x/e.x,t.y=this.y/e.y,t}divisionByScalar(e){return this.division(new Aa(e,e))}getLength(){return Math.sqrt(this.x*this.x+this.y*this.y)}getDistanceWith(e){return Math.sqrt((this.x-e.x)*(this.x-e.x)+(this.y-e.y)*(this.y-e.y))}dot(e){return this.x*e.x+this.y*e.y}normalize(){const e=Math.pow(this.x*this.x+this.y*this.y,.5);this.x=this.x/e,this.y=this.y/e}isEqual(e){return this.x==e.x&&this.y==e.y}isNotEqual(e){return!this.isEqual(e)}};const Pp=class{static range(e,t,i){return e<t?e=t:e>i&&(e=i),e}static sin(e){return Math.sin(e)}static cos(e){return Math.cos(e)}static abs(e){return Math.abs(e)}static sqrt(e){return Math.sqrt(e)}static cbrt(e){if(e===0)return e;let t=e;const i=t<0;i&&(t=-t);let r;return t===1/0?r=1/0:(r=Math.exp(Math.log(t)/3),r=(t/(r*r)+2*r)/3),i?-r:r}static getEasingSine(e){return e<0?0:e>1?1:.5-.5*this.cos(e*Math.PI)}static max(e,t){return e>t?e:t}static min(e,t){return e>t?t:e}static degreesToRadian(e){return e/180*Math.PI}static radianToDegrees(e){return e*180/Math.PI}static directionToRadian(e,t){const i=Math.atan2(t.y,t.x),r=Math.atan2(e.y,e.x);let s=i-r;for(;s<-Math.PI;)s+=Math.PI*2;for(;s>Math.PI;)s-=Math.PI*2;return s}static directionToDegrees(e,t){const i=this.directionToRadian(e,t);let r=this.radianToDegrees(i);return t.x-e.x>0&&(r=-r),r}static radianToDirection(e){const t=new gt;return t.x=this.sin(e),t.y=this.cos(e),t}static quadraticEquation(e,t,i){return this.abs(e)<Pp.Epsilon?this.abs(t)<Pp.Epsilon?-i:-i/t:-(t+this.sqrt(t*t-4*e*i))/(2*e)}static cardanoAlgorithmForBezier(e,t,i,r){if(this.sqrt(e)<Pp.Epsilon)return this.range(this.quadraticEquation(t,i,r),0,1);const s=t/e,o=i/e,a=r/e,l=(3*o-s*s)/3,u=l/3,c=(2*s*s*s-9*s*o+27*a)/27,h=c/2,d=h*h+u*u*u,f=.5,p=f+.01;if(d<0){const y=-l/3,x=y*y*y,b=this.sqrt(x),S=-c/(2*b),T=this.range(S,-1,1),P=Math.acos(T),M=2*this.cbrt(b),O=M*this.cos(P/3)-s/3;if(this.abs(O-f)<p)return this.range(O,0,1);const L=M*this.cos((P+2*Math.PI)/3)-s/3;if(this.abs(L-f)<p)return this.range(L,0,1);const C=M*this.cos((P+4*Math.PI)/3)-s/3;return this.range(C,0,1)}if(d==0){let y;h<0?y=this.cbrt(-h):y=-this.cbrt(h);const x=2*y-s/3;if(this.abs(x-f)<p)return this.range(x,0,1);const b=-y-s/3;return this.range(b,0,1)}const _=this.sqrt(d),m=this.cbrt(_-h),g=this.cbrt(_+h),v=m-g-s/3;return this.range(v,0,1)}constructor(){}};let Wt=Pp;Wt.Epsilon=1e-5;let sl=class ph{constructor(){this._tr=new Float32Array(16),this.loadIdentity()}static multiply(e,t,i){const r=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),s=4;for(let o=0;o<s;++o)for(let a=0;a<s;++a)for(let l=0;l<s;++l)r[a+o*4]+=e[l+o*4]*t[a+l*4];for(let o=0;o<16;++o)i[o]=r[o]}loadIdentity(){const e=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);this.setMatrix(e)}setMatrix(e){for(let t=0;t<16;++t)this._tr[t]=e[t]}getArray(){return this._tr}getScaleX(){return this._tr[0]}getScaleY(){return this._tr[5]}getTranslateX(){return this._tr[12]}getTranslateY(){return this._tr[13]}transformX(e){return this._tr[0]*e+this._tr[12]}transformY(e){return this._tr[5]*e+this._tr[13]}invertTransformX(e){return(e-this._tr[12])/this._tr[0]}invertTransformY(e){return(e-this._tr[13])/this._tr[5]}translateRelative(e,t){const i=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,e,t,0,1]);ph.multiply(i,this._tr,this._tr)}translate(e,t){this._tr[12]=e,this._tr[13]=t}translateX(e){this._tr[12]=e}translateY(e){this._tr[13]=e}scaleRelative(e,t){const i=new Float32Array([e,0,0,0,0,t,0,0,0,0,1,0,0,0,0,1]);ph.multiply(i,this._tr,this._tr)}scale(e,t){this._tr[0]=e,this._tr[5]=t}multiplyByMatrix(e){ph.multiply(e.getArray(),this._tr,this._tr)}clone(){const e=new ph;for(let t=0;t<this._tr.length;t++)e._tr[t]=this._tr[t];return e}},Gb=class{initialize(e){this._model=e}drawModel(){this.getModel()!=null&&this.doDrawModel()}setMvpMatrix(e){this._mvpMatrix4x4.setMatrix(e.getArray())}getMvpMatrix(){return this._mvpMatrix4x4}setModelColor(e,t,i,r){e<0?e=0:e>1&&(e=1),t<0?t=0:t>1&&(t=1),i<0?i=0:i>1&&(i=1),r<0?r=0:r>1&&(r=1),this._modelColor.R=e,this._modelColor.G=t,this._modelColor.B=i,this._modelColor.A=r}getModelColor(){return Object.assign({},this._modelColor)}setIsPremultipliedAlpha(e){this._isPremultipliedAlpha=e}isPremultipliedAlpha(){return this._isPremultipliedAlpha}setIsCulling(e){this._isCulling=e}isCulling(){return this._isCulling}setAnisotropy(e){this._anisortopy=e}getAnisotropy(){return this._anisortopy}getModel(){return this._model}constructor(){this._isCulling=!1,this._isPremultipliedAlpha=!1,this._anisortopy=0,this._modelColor=new mh,this._mvpMatrix4x4=new sl,this._mvpMatrix4x4.loadIdentity()}};var Fo=(n=>(n[n.CubismBlendMode_Normal=0]="CubismBlendMode_Normal",n[n.CubismBlendMode_Additive=1]="CubismBlendMode_Additive",n[n.CubismBlendMode_Multiplicative=2]="CubismBlendMode_Multiplicative",n))(Fo||{});let mh=class{constructor(){this.R=1,this.G=1,this.B=1,this.A=1}},Gr=!1,Dl=!1,Fl;const A_={vertexOffset:0,vertexStep:2};let pd=class{static startUp(e){if(Gr)return Hc("CubismFramework.startUp() is already done."),Gr;if(Live2DCubismCore._isStarted)return Gr=!0,!0;if(Live2DCubismCore._isStarted=!0,Fl=e,Fl&&Live2DCubismCore.Logging.csmSetLogFunction(Fl.logFunction),Gr=!0,Gr){const t=Live2DCubismCore.Version.csmGetVersion(),i=(t&4278190080)>>24,r=(t&16711680)>>16,s=t&65535,o=t;Hc("Live2D Cubism Core version: {0}.{1}.{2} ({3})",("00"+i).slice(-2),("00"+r).slice(-2),("0000"+s).slice(-4),o)}return Hc("CubismFramework.startUp() is complete."),Gr}static cleanUp(){Gr=!1,Dl=!1,Fl=void 0}static initialize(){if(!Gr){gh("CubismFramework is not started.");return}if(Dl){gh("CubismFramework.initialize() skipped, already initialized.");return}Dl=!0,Hc("CubismFramework.initialize() is complete.")}static dispose(){if(!Gr){gh("CubismFramework is not started.");return}if(!Dl){gh("CubismFramework.dispose() skipped, not initialized.");return}Gb.staticRelease(),Dl=!1,Hc("CubismFramework.dispose() is complete.")}static isStarted(){return Gr}static isInitialized(){return Dl}static coreLogFunction(e){Live2DCubismCore.Logging.csmGetLogFunction()&&Live2DCubismCore.Logging.csmGetLogFunction()(e)}static getLoggingLevel(){return Fl!=null?Fl.loggingLevel:El.LogLevel_Off}constructor(){}};var El=(n=>(n[n.LogLevel_Verbose=0]="LogLevel_Verbose",n[n.LogLevel_Debug=1]="LogLevel_Debug",n[n.LogLevel_Info=2]="LogLevel_Info",n[n.LogLevel_Warning=3]="LogLevel_Warning",n[n.LogLevel_Error=4]="LogLevel_Error",n[n.LogLevel_Off=5]="LogLevel_Off",n))(El||{});const Af=()=>{};function SM(n,...e){pg.print(El.LogLevel_Debug,"[CSM][D]"+n+`
`,e)}function Hc(n,...e){pg.print(El.LogLevel_Info,"[CSM][I]"+n+`
`,e)}function gh(n,...e){pg.print(El.LogLevel_Warning,"[CSM][W]"+n+`
`,e)}function du(n,...e){pg.print(El.LogLevel_Error,"[CSM][E]"+n+`
`,e)}let pg=class{static print(e,t,i){if(e<pd.getLoggingLevel())return;const r=pd.coreLogFunction;if(!r)return;const s=t.replace(/{(\d+)}/g,(o,a)=>i[a]);r(s)}static dumpBytes(e,t,i){for(let r=0;r<i;r++)r%16==0&&r>0?this.print(e,`
`):r%8==0&&r>0&&this.print(e,"  "),this.print(e,"{0} ",[t[r]&255]);this.print(e,`
`)}constructor(){}},hL=class{constructor(){this._fadeInSeconds=-1,this._fadeOutSeconds=-1,this._weight=1,this._offsetSeconds=0,this._firedEventValues=[]}release(){this._weight=0}updateParameters(e,t,i){if(!t.isAvailable()||t.isFinished())return;if(!t.isStarted()){t.setIsStarted(!0),t.setStartTime(i-this._offsetSeconds),t.setFadeInStartTime(i);const a=this.getDuration();t.getEndTime()<0&&t.setEndTime(a<=0?-1:t.getStartTime()+a)}let r=this._weight;const s=this._fadeInSeconds==0?1:Wt.getEasingSine((i-t.getFadeInStartTime())/this._fadeInSeconds),o=this._fadeOutSeconds==0||t.getEndTime()<0?1:Wt.getEasingSine((t.getEndTime()-i)/this._fadeOutSeconds);r=r*s*o,t.setState(i,r),this.doUpdateParameters(e,i,r,t),t.getEndTime()>0&&t.getEndTime()<i&&t.setIsFinished(!0)}setFadeInTime(e){this._fadeInSeconds=e}setFadeOutTime(e){this._fadeOutSeconds=e}getFadeOutTime(){return this._fadeOutSeconds}getFadeInTime(){return this._fadeInSeconds}setWeight(e){this._weight=e}getWeight(){return this._weight}getDuration(){return-1}getLoopDuration(){return-1}setOffsetTime(e){this._offsetSeconds=e}getFiredEvent(e,t){return this._firedEventValues}setFinishedMotionHandler(e){this._onFinishedMotion=e}getFinishedMotionHandler(){return this._onFinishedMotion}};const EM=1;let bY=class dL extends hL{constructor(){super(),this._parameters=[]}static create(e){const t=new dL,i=e.FadeInTime,r=e.FadeOutTime;t.setFadeInTime(i!==void 0?i:EM),t.setFadeOutTime(r!==void 0?r:EM);const s=e.Parameters||[];for(let o=0;o<s.length;++o){const a=s[o],l=a.Id,u=a.Value;let c;switch(a.Blend){case"Multiply":c=Pa.ExpressionBlendType_Multiply;break;case"Overwrite":c=Pa.ExpressionBlendType_Overwrite;break;case"Add":default:c=Pa.ExpressionBlendType_Add;break}const h={parameterId:l,blendType:c,value:u};t._parameters.push(h)}return t}doUpdateParameters(e,t,i,r){for(let s=0;s<this._parameters.length;++s){const o=this._parameters[s];switch(o.blendType){case Pa.ExpressionBlendType_Add:{e.addParameterValueById(o.parameterId,o.value,i);break}case Pa.ExpressionBlendType_Multiply:{e.multiplyParameterValueById(o.parameterId,o.value,i);break}case Pa.ExpressionBlendType_Overwrite:{e.setParameterValueById(o.parameterId,o.value,i);break}}}}};var Pa=(n=>(n[n.ExpressionBlendType_Add=0]="ExpressionBlendType_Add",n[n.ExpressionBlendType_Multiply=1]="ExpressionBlendType_Multiply",n[n.ExpressionBlendType_Overwrite=2]="ExpressionBlendType_Overwrite",n))(Pa||{});let SY=class{constructor(){this._autoDelete=!1,this._available=!0,this._finished=!1,this._started=!1,this._startTimeSeconds=-1,this._fadeInStartTimeSeconds=0,this._endTimeSeconds=-1,this._stateTimeSeconds=0,this._stateWeight=0,this._lastEventCheckSeconds=0,this._motionQueueEntryHandle=this,this._fadeOutSeconds=0,this._isTriggeredFadeOut=!1}release(){this._autoDelete&&this._motion&&this._motion.release()}setFadeOut(e){this._fadeOutSeconds=e,this._isTriggeredFadeOut=!0}startFadeOut(e,t){const i=t+e;this._isTriggeredFadeOut=!0,(this._endTimeSeconds<0||i<this._endTimeSeconds)&&(this._endTimeSeconds=i)}isFinished(){return this._finished}isStarted(){return this._started}getStartTime(){return this._startTimeSeconds}getFadeInStartTime(){return this._fadeInStartTimeSeconds}getEndTime(){return this._endTimeSeconds}setStartTime(e){this._startTimeSeconds=e}setFadeInStartTime(e){this._fadeInStartTimeSeconds=e}setEndTime(e){this._endTimeSeconds=e}setIsFinished(e){this._finished=e}setIsStarted(e){this._started=e}isAvailable(){return this._available}setIsAvailable(e){this._available=e}setState(e,t){this._stateTimeSeconds=e,this._stateWeight=t}getStateTime(){return this._stateTimeSeconds}getStateWeight(){return this._stateWeight}getLastCheckEventSeconds(){return this._lastEventCheckSeconds}setLastCheckEventSeconds(e){this._lastEventCheckSeconds=e}isTriggeredFadeOut(){return this._isTriggeredFadeOut}getFadeOutSeconds(){return this._fadeOutSeconds}},fL=class{constructor(){this._userTimeSeconds=0,this._eventCustomData=null,this._motions=[]}release(){for(let e=0;e<this._motions.length;++e)this._motions[e]&&this._motions[e].release();this._motions=void 0}startMotion(e,t,i){if(e==null)return EY;let r;for(let s=0;s<this._motions.length;++s)r=this._motions[s],r!=null&&r.setFadeOut(r._motion.getFadeOutTime());return r=new SY,r._autoDelete=t,r._motion=e,this._motions.push(r),r._motionQueueEntryHandle}isFinished(){let e=0;for(;e<this._motions.length;){const t=this._motions[e];if(t==null){this._motions.splice(e,1);continue}if(t._motion==null){t.release(),this._motions.splice(e,1);continue}if(!t.isFinished())return!1;e++}return!0}isFinishedByHandle(e){for(let t=0;t<this._motions.length;t++){const i=this._motions[t];if(i!=null&&i._motionQueueEntryHandle==e&&!i.isFinished())return!1}return!0}stopAllMotions(){for(let e=0;e<this._motions.length;e++){const t=this._motions[e];t!=null&&t.release()}this._motions=[]}getCubismMotionQueueEntry(e){return this._motions.find(t=>t!=null&&t._motionQueueEntryHandle==e)}setEventCallback(e,t=null){this._eventCallBack=e,this._eventCustomData=t}doUpdateMotion(e,t){let i=!1,r=0;for(;r<this._motions.length;){const s=this._motions[r];if(s==null){this._motions.splice(r,1);continue}const o=s._motion;if(o==null){s.release(),this._motions.splice(r,1);continue}o.updateParameters(e,s,t),i=!0;const a=o.getFiredEvent(s.getLastCheckEventSeconds()-s.getStartTime(),t-s.getStartTime());for(let l=0;l<a.length;++l)this._eventCallBack(this,a[l],this._eventCustomData);s.setLastCheckEventSeconds(t),s.isFinished()?(s.release(),this._motions.splice(r,1)):(s.isTriggeredFadeOut()&&s.startFadeOut(s.getFadeOutSeconds(),t),r++)}return i}};const EY=-1;let TY=class extends kb{constructor(e,t){var i;super(e,t),this.queueManager=new fL,this.definitions=(i=e.expressions)!=null?i:[],this.init()}isFinished(){return this.queueManager.isFinished()}getExpressionIndex(e){return this.definitions.findIndex(t=>t.Name===e)}getExpressionFile(e){return e.File}createExpression(e,t){return bY.create(e)}_setExpression(e){return this.queueManager.startMotion(e,!1,performance.now())}stopAllExpressions(){this.queueManager.stopAllMotions()}updateParameters(e,t){return this.queueManager.doUpdateMotion(e,t)}},pL=class{constructor(e){this.groups=e.Groups,this.hitAreas=e.HitAreas,this.layout=e.Layout,this.moc=e.FileReferences.Moc,this.expressions=e.FileReferences.Expressions,this.motions=e.FileReferences.Motions,this.textures=e.FileReferences.Textures,this.physics=e.FileReferences.Physics,this.pose=e.FileReferences.Pose}getEyeBlinkParameters(){var e,t;return(t=(e=this.groups)==null?void 0:e.find(i=>i.Name==="EyeBlink"))==null?void 0:t.Ids}getLipSyncParameters(){var e,t;return(t=(e=this.groups)==null?void 0:e.find(i=>i.Name==="LipSync"))==null?void 0:t.Ids}},Cp=class mL extends cg{constructor(e){if(super(e),!mL.isValidJSON(e))throw new TypeError("Invalid JSON.");Object.assign(this,new pL(e))}static isValidJSON(e){var t;return!!(e!=null&&e.FileReferences)&&typeof e.FileReferences.Moc=="string"&&((t=e.FileReferences.Textures)==null?void 0:t.length)>0&&e.FileReferences.Textures.every(i=>typeof i=="string")}replaceFiles(e){if(super.replaceFiles(e),this.motions)for(const[t,i]of Object.entries(this.motions))for(let r=0;r<i.length;r++)i[r].File=e(i[r].File,`motions.${t}[${r}].File`),i[r].Sound!==void 0&&(i[r].Sound=e(i[r].Sound,`motions.${t}[${r}].Sound`));if(this.expressions)for(let t=0;t<this.expressions.length;t++)this.expressions[t].File=e(this.expressions[t].File,`expressions[${t}].File`)}};nL(Cp,[pL]);var Ca=(n=>(n[n.CubismMotionCurveTarget_Model=0]="CubismMotionCurveTarget_Model",n[n.CubismMotionCurveTarget_Parameter=1]="CubismMotionCurveTarget_Parameter",n[n.CubismMotionCurveTarget_PartOpacity=2]="CubismMotionCurveTarget_PartOpacity",n))(Ca||{}),jr=(n=>(n[n.CubismMotionSegmentType_Linear=0]="CubismMotionSegmentType_Linear",n[n.CubismMotionSegmentType_Bezier=1]="CubismMotionSegmentType_Bezier",n[n.CubismMotionSegmentType_Stepped=2]="CubismMotionSegmentType_Stepped",n[n.CubismMotionSegmentType_InverseStepped=3]="CubismMotionSegmentType_InverseStepped",n))(jr||{});let xo=class{constructor(e=0,t=0){this.time=e,this.value=t}},MY=class{constructor(){this.basePointIndex=0,this.segmentType=0}},wY=class{constructor(){this.id="",this.type=0,this.segmentCount=0,this.baseSegmentIndex=0,this.fadeInTime=0,this.fadeOutTime=0}},AY=class{constructor(){this.fireTime=0,this.value=""}},PY=class{constructor(){this.duration=0,this.loop=!1,this.curveCount=0,this.eventCount=0,this.fps=0,this.curves=[],this.segments=[],this.points=[],this.events=[]}},gL=class{constructor(e){this._json=e}release(){this._json=void 0}getMotionDuration(){return this._json.Meta.Duration}isMotionLoop(){return this._json.Meta.Loop||!1}getEvaluationOptionFlag(e){return Hb.EvaluationOptionFlag_AreBeziersRistricted==e?!!this._json.Meta.AreBeziersRestricted:!1}getMotionCurveCount(){return this._json.Meta.CurveCount}getMotionFps(){return this._json.Meta.Fps}getMotionTotalSegmentCount(){return this._json.Meta.TotalSegmentCount}getMotionTotalPointCount(){return this._json.Meta.TotalPointCount}getMotionFadeInTime(){return this._json.Meta.FadeInTime}getMotionFadeOutTime(){return this._json.Meta.FadeOutTime}getMotionCurveTarget(e){return this._json.Curves[e].Target}getMotionCurveId(e){return this._json.Curves[e].Id}getMotionCurveFadeInTime(e){return this._json.Curves[e].FadeInTime}getMotionCurveFadeOutTime(e){return this._json.Curves[e].FadeOutTime}getMotionCurveSegmentCount(e){return this._json.Curves[e].Segments.length}getMotionCurveSegment(e,t){return this._json.Curves[e].Segments[t]}getEventCount(){return this._json.Meta.UserDataCount||0}getTotalEventValueSize(){return this._json.Meta.TotalUserDataSize}getEventTime(e){return this._json.UserData[e].Time}getEventValue(e){return this._json.UserData[e].Value}};var Hb=(n=>(n[n.EvaluationOptionFlag_AreBeziersRistricted=0]="EvaluationOptionFlag_AreBeziersRistricted",n))(Hb||{});const CY="EyeBlink",RY="LipSync",IY="Model",LY="Parameter",OY="PartOpacity",DY=!1;function Xi(n,e,t){const i=new xo;return i.time=n.time+(e.time-n.time)*t,i.value=n.value+(e.value-n.value)*t,i}function FY(n,e){let t=(e-n[0].time)/(n[1].time-n[0].time);return t<0&&(t=0),n[0].value+(n[1].value-n[0].value)*t}function NY(n,e){let t=(e-n[0].time)/(n[3].time-n[0].time);t<0&&(t=0);const i=Xi(n[0],n[1],t),r=Xi(n[1],n[2],t),s=Xi(n[2],n[3],t),o=Xi(i,r,t),a=Xi(r,s,t);return Xi(o,a,t).value}function UY(n,e){const t=e,i=n[0].time,r=n[3].time,s=n[1].time,o=n[2].time,a=r-3*o+3*s-i,l=3*o-6*s+3*i,u=3*s-3*i,c=i-t,h=Wt.cardanoAlgorithmForBezier(a,l,u,c),d=Xi(n[0],n[1],h),f=Xi(n[1],n[2],h),p=Xi(n[2],n[3],h),_=Xi(d,f,h),m=Xi(f,p,h);return Xi(_,m,h).value}function BY(n,e){return n[0].value}function kY(n,e){return n[1].value}function P_(n,e,t){const i=n.curves[e];let r=-1;const s=i.baseSegmentIndex+i.segmentCount;let o=0;for(let l=i.baseSegmentIndex;l<s;++l)if(o=n.segments[l].basePointIndex+(n.segments[l].segmentType==jr.CubismMotionSegmentType_Bezier?3:1),n.points[o].time>t){r=l;break}if(r==-1)return n.points[o].value;const a=n.segments[r];return a.evaluate(n.points.slice(a.basePointIndex),t)}let VY=class _L extends hL{constructor(){super(),this._eyeBlinkParameterIds=[],this._lipSyncParameterIds=[],this._sourceFrameRate=30,this._loopDurationSeconds=-1,this._isLoop=!1,this._isLoopFadeIn=!0,this._lastWeight=0}static create(e,t){const i=new _L;return i.parse(e),i._sourceFrameRate=i._motionData.fps,i._loopDurationSeconds=i._motionData.duration,i._onFinishedMotion=t,i}doUpdateParameters(e,t,i,r){this._modelCurveIdEyeBlink==null&&(this._modelCurveIdEyeBlink=CY),this._modelCurveIdLipSync==null&&(this._modelCurveIdLipSync=RY);let s=t-r.getStartTime();s<0&&(s=0);let o=Number.MAX_VALUE,a=Number.MAX_VALUE;const l=64;let u=0,c=0;this._eyeBlinkParameterIds.length>l&&SM("too many eye blink targets : {0}",this._eyeBlinkParameterIds.length),this._lipSyncParameterIds.length>l&&SM("too many lip sync targets : {0}",this._lipSyncParameterIds.length);const h=this._fadeInSeconds<=0?1:Wt.getEasingSine((t-r.getFadeInStartTime())/this._fadeInSeconds),d=this._fadeOutSeconds<=0||r.getEndTime()<0?1:Wt.getEasingSine((r.getEndTime()-t)/this._fadeOutSeconds);let f,p,_,m=s;if(this._isLoop)for(;m>this._motionData.duration;)m-=this._motionData.duration;const g=this._motionData.curves;for(p=0;p<this._motionData.curveCount&&g[p].type==Ca.CubismMotionCurveTarget_Model;++p)f=P_(this._motionData,p,m),g[p].id==this._modelCurveIdEyeBlink?a=f:g[p].id==this._modelCurveIdLipSync&&(o=f);for(;p<this._motionData.curveCount&&g[p].type==Ca.CubismMotionCurveTarget_Parameter;++p){if(_=e.getParameterIndex(g[p].id),_==-1)continue;const v=e.getParameterValueByIndex(_);if(f=P_(this._motionData,p,m),a!=Number.MAX_VALUE){for(let x=0;x<this._eyeBlinkParameterIds.length&&x<l;++x)if(this._eyeBlinkParameterIds[x]==g[p].id){f*=a,c|=1<<x;break}}if(o!=Number.MAX_VALUE){for(let x=0;x<this._lipSyncParameterIds.length&&x<l;++x)if(this._lipSyncParameterIds[x]==g[p].id){f+=o,u|=1<<x;break}}let y;if(g[p].fadeInTime<0&&g[p].fadeOutTime<0)y=v+(f-v)*i;else{let x,b;g[p].fadeInTime<0?x=h:x=g[p].fadeInTime==0?1:Wt.getEasingSine((t-r.getFadeInStartTime())/g[p].fadeInTime),g[p].fadeOutTime<0?b=d:b=g[p].fadeOutTime==0||r.getEndTime()<0?1:Wt.getEasingSine((r.getEndTime()-t)/g[p].fadeOutTime);const S=this._weight*x*b;y=v+(f-v)*S}e.setParameterValueByIndex(_,y,1)}{if(a!=Number.MAX_VALUE)for(let v=0;v<this._eyeBlinkParameterIds.length&&v<l;++v){const y=e.getParameterValueById(this._eyeBlinkParameterIds[v]);if(c>>v&1)continue;const x=y+(a-y)*i;e.setParameterValueById(this._eyeBlinkParameterIds[v],x)}if(o!=Number.MAX_VALUE)for(let v=0;v<this._lipSyncParameterIds.length&&v<l;++v){const y=e.getParameterValueById(this._lipSyncParameterIds[v]);if(u>>v&1)continue;const x=y+(o-y)*i;e.setParameterValueById(this._lipSyncParameterIds[v],x)}}for(;p<this._motionData.curveCount&&g[p].type==Ca.CubismMotionCurveTarget_PartOpacity;++p)if(f=P_(this._motionData,p,m),fd.setOpacityFromMotion)e.setPartOpacityById(g[p].id,f);else{if(_=e.getParameterIndex(g[p].id),_==-1)continue;e.setParameterValueByIndex(_,f)}s>=this._motionData.duration&&(this._isLoop?(r.setStartTime(t),this._isLoopFadeIn&&r.setFadeInStartTime(t)):(this._onFinishedMotion&&this._onFinishedMotion(this),r.setIsFinished(!0))),this._lastWeight=i}setIsLoop(e){this._isLoop=e}isLoop(){return this._isLoop}setIsLoopFadeIn(e){this._isLoopFadeIn=e}isLoopFadeIn(){return this._isLoopFadeIn}getDuration(){return this._isLoop?-1:this._loopDurationSeconds}getLoopDuration(){return this._loopDurationSeconds}setParameterFadeInTime(e,t){const i=this._motionData.curves;for(let r=0;r<this._motionData.curveCount;++r)if(e==i[r].id){i[r].fadeInTime=t;return}}setParameterFadeOutTime(e,t){const i=this._motionData.curves;for(let r=0;r<this._motionData.curveCount;++r)if(e==i[r].id){i[r].fadeOutTime=t;return}}getParameterFadeInTime(e){const t=this._motionData.curves;for(let i=0;i<this._motionData.curveCount;++i)if(e==t[i].id)return t[i].fadeInTime;return-1}getParameterFadeOutTime(e){const t=this._motionData.curves;for(let i=0;i<this._motionData.curveCount;++i)if(e==t[i].id)return t[i].fadeOutTime;return-1}setEffectIds(e,t){this._eyeBlinkParameterIds=e,this._lipSyncParameterIds=t}release(){this._motionData=void 0}parse(e){this._motionData=new PY;let t=new gL(e);this._motionData.duration=t.getMotionDuration(),this._motionData.loop=t.isMotionLoop(),this._motionData.curveCount=t.getMotionCurveCount(),this._motionData.fps=t.getMotionFps(),this._motionData.eventCount=t.getEventCount();const i=t.getEvaluationOptionFlag(Hb.EvaluationOptionFlag_AreBeziersRistricted),r=t.getMotionFadeInTime(),s=t.getMotionFadeOutTime();r!==void 0?this._fadeInSeconds=r<0?1:r:this._fadeInSeconds=1,s!==void 0?this._fadeOutSeconds=s<0?1:s:this._fadeOutSeconds=1,this._motionData.curves=Array.from({length:this._motionData.curveCount}).map(()=>new wY),this._motionData.segments=Array.from({length:t.getMotionTotalSegmentCount()}).map(()=>new MY),this._motionData.events=Array.from({length:this._motionData.eventCount}).map(()=>new AY),this._motionData.points=[];let o=0,a=0;for(let l=0;l<this._motionData.curveCount;++l){const u=this._motionData.curves[l];switch(t.getMotionCurveTarget(l)){case IY:u.type=Ca.CubismMotionCurveTarget_Model;break;case LY:u.type=Ca.CubismMotionCurveTarget_Parameter;break;case OY:u.type=Ca.CubismMotionCurveTarget_PartOpacity;break;default:gh('Warning : Unable to get segment type from Curve! The number of "CurveCount" may be incorrect!')}u.id=t.getMotionCurveId(l),u.baseSegmentIndex=a;const c=t.getMotionCurveFadeInTime(l),h=t.getMotionCurveFadeOutTime(l);u.fadeInTime=c!==void 0?c:-1,u.fadeOutTime=h!==void 0?h:-1;for(let d=0;d<t.getMotionCurveSegmentCount(l);){switch(d==0?(this._motionData.segments[a].basePointIndex=o,this._motionData.points[o]=new xo(t.getMotionCurveSegment(l,d),t.getMotionCurveSegment(l,d+1)),o+=1,d+=2):this._motionData.segments[a].basePointIndex=o-1,t.getMotionCurveSegment(l,d)){case jr.CubismMotionSegmentType_Linear:{this._motionData.segments[a].segmentType=jr.CubismMotionSegmentType_Linear,this._motionData.segments[a].evaluate=FY,this._motionData.points[o]=new xo(t.getMotionCurveSegment(l,d+1),t.getMotionCurveSegment(l,d+2)),o+=1,d+=3;break}case jr.CubismMotionSegmentType_Bezier:{this._motionData.segments[a].segmentType=jr.CubismMotionSegmentType_Bezier,i||DY?this._motionData.segments[a].evaluate=NY:this._motionData.segments[a].evaluate=UY,this._motionData.points[o]=new xo(t.getMotionCurveSegment(l,d+1),t.getMotionCurveSegment(l,d+2)),this._motionData.points[o+1]=new xo(t.getMotionCurveSegment(l,d+3),t.getMotionCurveSegment(l,d+4)),this._motionData.points[o+2]=new xo(t.getMotionCurveSegment(l,d+5),t.getMotionCurveSegment(l,d+6)),o+=3,d+=7;break}case jr.CubismMotionSegmentType_Stepped:{this._motionData.segments[a].segmentType=jr.CubismMotionSegmentType_Stepped,this._motionData.segments[a].evaluate=BY,this._motionData.points[o]=new xo(t.getMotionCurveSegment(l,d+1),t.getMotionCurveSegment(l,d+2)),o+=1,d+=3;break}case jr.CubismMotionSegmentType_InverseStepped:{this._motionData.segments[a].segmentType=jr.CubismMotionSegmentType_InverseStepped,this._motionData.segments[a].evaluate=kY,this._motionData.points[o]=new xo(t.getMotionCurveSegment(l,d+1),t.getMotionCurveSegment(l,d+2)),o+=1,d+=3;break}}++u.segmentCount,++a}this._motionData.curves.push(u)}for(let l=0;l<t.getEventCount();++l)this._motionData.events[l].fireTime=t.getEventTime(l),this._motionData.events[l].value=t.getEventValue(l);t.release()}getFiredEvent(e,t){this._firedEventValues.length=0;for(let i=0;i<this._motionData.eventCount;++i)this._motionData.events[i].fireTime>e&&this._motionData.events[i].fireTime<=t&&this._firedEventValues.push(this._motionData.events[i].value);return this._firedEventValues}},GY=class extends hg{constructor(e,t){var i;super(e,t),this.groups={idle:"Idle"},this.motionDataType="json",this.queueManager=new fL,this.definitions=(i=e.motions)!=null?i:{},this.eyeBlinkIds=e.getEyeBlinkParameters()||[],this.lipSyncIds=e.getLipSyncParameters()||[],this.init(t)}init(e){super.init(e),this.settings.expressions&&(this.expressionManager=new TY(this.settings,e)),this.queueManager.setEventCallback((t,i,r)=>{this.emit("motion:"+i)})}isFinished(){return this.queueManager.isFinished()}_startMotion(e,t){return e.setFinishedMotionHandler(t),this.queueManager.stopAllMotions(),this.queueManager.startMotion(e,!1,performance.now())}_stopAllMotions(){this.queueManager.stopAllMotions()}createMotion(e,t,i){const r=VY.create(e),s=new gL(e),o=(t===this.groups.idle?En.idleMotionFadingDuration:En.motionFadingDuration)/1e3;return s.getMotionFadeInTime()===void 0&&r.setFadeInTime(i.FadeInTime>0?i.FadeInTime:o),s.getMotionFadeOutTime()===void 0&&r.setFadeOutTime(i.FadeOutTime>0?i.FadeOutTime:o),r.setEffectIds(this.eyeBlinkIds,this.lipSyncIds),r}getMotionFile(e){return e.File}getMotionName(e){return e.File}getSoundFile(e){return e.Sound}updateParameters(e,t){return this.queueManager.doUpdateMotion(e,t)}destroy(){super.destroy(),this.queueManager.release(),this.queueManager=void 0}};const HY="ParamAngleX",zY="ParamAngleY",WY="ParamAngleZ",XY="ParamEyeBallX",jY="ParamEyeBallY",$Y="ParamBodyAngleX",YY="ParamBreath";let qY=class vL{constructor(){this._breathParameters=[],this._currentTime=0}static create(){return new vL}setParameters(e){this._breathParameters=e}getParameters(){return this._breathParameters}updateParameters(e,t){this._currentTime+=t;const i=this._currentTime*2*3.14159;for(let r=0;r<this._breathParameters.length;++r){const s=this._breathParameters[r];e.addParameterValueById(s.parameterId,s.offset+s.peak*Math.sin(i/s.cycle),s.weight)}}},zc=class{constructor(e,t,i,r,s){this.parameterId=e??void 0,this.offset=t??0,this.peak=i??0,this.cycle=r??0,this.weight=s??0}};const k0=class{static create(e){return new k0(e)}setBlinkingInterval(e){this._blinkingIntervalSeconds=e}setBlinkingSetting(e,t,i){this._closingSeconds=e,this._closedSeconds=t,this._openingSeconds=i}setParameterIds(e){this._parameterIds=e}getParameterIds(){return this._parameterIds}updateParameters(e,t){this._userTimeSeconds+=t;let i,r=0;switch(this._blinkingState){case Vi.EyeState_Closing:r=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._closingSeconds,r>=1&&(r=1,this._blinkingState=Vi.EyeState_Closed,this._stateStartTimeSeconds=this._userTimeSeconds),i=1-r;break;case Vi.EyeState_Closed:r=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._closedSeconds,r>=1&&(this._blinkingState=Vi.EyeState_Opening,this._stateStartTimeSeconds=this._userTimeSeconds),i=0;break;case Vi.EyeState_Opening:r=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._openingSeconds,r>=1&&(r=1,this._blinkingState=Vi.EyeState_Interval,this._nextBlinkingTime=this.determinNextBlinkingTiming()),i=r;break;case Vi.EyeState_Interval:this._nextBlinkingTime<this._userTimeSeconds&&(this._blinkingState=Vi.EyeState_Closing,this._stateStartTimeSeconds=this._userTimeSeconds),i=1;break;case Vi.EyeState_First:default:this._blinkingState=Vi.EyeState_Interval,this._nextBlinkingTime=this.determinNextBlinkingTiming(),i=1;break}k0.CloseIfZero||(i=-i);for(let s=0;s<this._parameterIds.length;++s)e.setParameterValueById(this._parameterIds[s],i)}constructor(e){var t,i;this._blinkingState=Vi.EyeState_First,this._nextBlinkingTime=0,this._stateStartTimeSeconds=0,this._blinkingIntervalSeconds=4,this._closingSeconds=.1,this._closedSeconds=.05,this._openingSeconds=.15,this._userTimeSeconds=0,this._parameterIds=[],e!=null&&(this._parameterIds=(i=(t=e.getEyeBlinkParameters())==null?void 0:t.slice())!=null?i:this._parameterIds)}determinNextBlinkingTiming(){const e=Math.random();return this._userTimeSeconds+e*(2*this._blinkingIntervalSeconds-1)}};let yL=k0;yL.CloseIfZero=!0;var Vi=(n=>(n[n.EyeState_First=0]="EyeState_First",n[n.EyeState_Interval=1]="EyeState_Interval",n[n.EyeState_Closing=2]="EyeState_Closing",n[n.EyeState_Closed=3]="EyeState_Closed",n[n.EyeState_Opening=4]="EyeState_Opening",n))(Vi||{});let V0=class{constructor(e=0,t=0,i=0,r=0){this.x=e,this.y=t,this.width=i,this.height=r}getCenterX(){return this.x+.5*this.width}getCenterY(){return this.y+.5*this.height}getRight(){return this.x+this.width}getBottom(){return this.y+this.height}setRect(e){this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height}expand(e,t){this.x-=e,this.y-=t,this.width+=e*2,this.height+=t*2}};const C_=4,KY=10;let ua,_h,G0,R_=class{getChannelFlagAsColor(e){return this._channelColors[e]}getMaskRenderTexture(){let e=0;if(this._maskTexture&&this._maskTexture.texture!=0&&(this._maskTexture.frameNo=this._currentFrameNo,e=this._maskTexture.texture),e==0){const t=this._clippingMaskBufferSize;this._colorBuffer=this.gl.createTexture(),this.gl.bindTexture(this.gl.TEXTURE_2D,this._colorBuffer),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,t,t,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.bindTexture(this.gl.TEXTURE_2D,null),e=this.gl.createFramebuffer(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,e),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,this._colorBuffer,0),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,G0),this._maskTexture=new ZY(this._currentFrameNo,e)}return e}setGL(e){this.gl=e}calcClippedDrawTotalBounds(e,t){let i=Number.MAX_VALUE,r=Number.MAX_VALUE,s=Number.MIN_VALUE,o=Number.MIN_VALUE;const a=t._clippedDrawableIndexList.length;for(let l=0;l<a;l++){const u=t._clippedDrawableIndexList[l],c=e.getDrawableVertexCount(u),h=e.getDrawableVertices(u);let d=Number.MAX_VALUE,f=Number.MAX_VALUE,p=Number.MIN_VALUE,_=Number.MIN_VALUE;const m=c*A_.vertexStep;for(let g=A_.vertexOffset;g<m;g+=A_.vertexStep){const v=h[g],y=h[g+1];v<d&&(d=v),v>p&&(p=v),y<f&&(f=y),y>_&&(_=y)}if(d!=Number.MAX_VALUE)if(d<i&&(i=d),f<r&&(r=f),p>s&&(s=p),_>o&&(o=_),i==Number.MAX_VALUE)t._allClippedDrawRect.x=0,t._allClippedDrawRect.y=0,t._allClippedDrawRect.width=0,t._allClippedDrawRect.height=0,t._isUsing=!1;else{t._isUsing=!0;const g=s-i,v=o-r;t._allClippedDrawRect.x=i,t._allClippedDrawRect.y=r,t._allClippedDrawRect.width=g,t._allClippedDrawRect.height=v}}}constructor(){this._maskRenderTexture=null,this._colorBuffer=null,this._currentFrameNo=0,this._clippingMaskBufferSize=256,this._clippingContextListForMask=[],this._clippingContextListForDraw=[],this._channelColors=[],this._tmpBoundsOnModel=new V0,this._tmpMatrix=new sl,this._tmpMatrixForMask=new sl,this._tmpMatrixForDraw=new sl;let e=new mh;e.R=1,e.G=0,e.B=0,e.A=0,this._channelColors.push(e),e=new mh,e.R=0,e.G=1,e.B=0,e.A=0,this._channelColors.push(e),e=new mh,e.R=0,e.G=0,e.B=1,e.A=0,this._channelColors.push(e),e=new mh,e.R=0,e.G=0,e.B=0,e.A=1,this._channelColors.push(e)}release(){var e,t,i;const r=this;for(let s=0;s<this._clippingContextListForMask.length;s++)this._clippingContextListForMask[s]&&((e=this._clippingContextListForMask[s])==null||e.release());r._clippingContextListForMask=void 0,r._clippingContextListForDraw=void 0,this._maskTexture&&((t=this.gl)==null||t.deleteFramebuffer(this._maskTexture.texture),r._maskTexture=void 0),r._channelColors=void 0,(i=this.gl)==null||i.deleteTexture(this._colorBuffer),this._colorBuffer=null}initialize(e,t,i,r){for(let s=0;s<t;s++){if(r[s]<=0){this._clippingContextListForDraw.push(null);continue}let o=this.findSameClip(i[s],r[s]);o==null&&(o=new JY(this,i[s],r[s]),this._clippingContextListForMask.push(o)),o.addClippedDrawable(s),this._clippingContextListForDraw.push(o)}}setupClippingContext(e,t){this._currentFrameNo++;let i=0;for(let r=0;r<this._clippingContextListForMask.length;r++){const s=this._clippingContextListForMask[r];this.calcClippedDrawTotalBounds(e,s),s._isUsing&&i++}if(i>0){this.gl.viewport(0,0,this._clippingMaskBufferSize,this._clippingMaskBufferSize),this._maskRenderTexture=this.getMaskRenderTexture(),t.getMvpMatrix(),t.preDraw(),this.setupLayoutBounds(i),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this._maskRenderTexture),this.gl.clearColor(1,1,1,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT);for(let r=0;r<this._clippingContextListForMask.length;r++){const s=this._clippingContextListForMask[r],o=s._allClippedDrawRect,a=s._layoutBounds,l=.05;this._tmpBoundsOnModel.setRect(o),this._tmpBoundsOnModel.expand(o.width*l,o.height*l);const u=a.width/this._tmpBoundsOnModel.width,c=a.height/this._tmpBoundsOnModel.height;this._tmpMatrix.loadIdentity(),this._tmpMatrix.translateRelative(-1,-1),this._tmpMatrix.scaleRelative(2,2),this._tmpMatrix.translateRelative(a.x,a.y),this._tmpMatrix.scaleRelative(u,c),this._tmpMatrix.translateRelative(-this._tmpBoundsOnModel.x,-this._tmpBoundsOnModel.y),this._tmpMatrixForMask.setMatrix(this._tmpMatrix.getArray()),this._tmpMatrix.loadIdentity(),this._tmpMatrix.translateRelative(a.x,a.y),this._tmpMatrix.scaleRelative(u,c),this._tmpMatrix.translateRelative(-this._tmpBoundsOnModel.x,-this._tmpBoundsOnModel.y),this._tmpMatrixForDraw.setMatrix(this._tmpMatrix.getArray()),s._matrixForMask.setMatrix(this._tmpMatrixForMask.getArray()),s._matrixForDraw.setMatrix(this._tmpMatrixForDraw.getArray());const h=s._clippingIdCount;for(let d=0;d<h;d++){const f=s._clippingIdList[d];e.getDrawableDynamicFlagVertexPositionsDidChange(f)&&(t.setIsCulling(e.getDrawableCulling(f)!=!1),t.setClippingContextBufferForMask(s),t.drawMesh(e.getDrawableTextureIndices(f),e.getDrawableVertexIndexCount(f),e.getDrawableVertexCount(f),e.getDrawableVertexIndices(f),e.getDrawableVertices(f),e.getDrawableVertexUvs(f),e.getDrawableOpacity(f),Fo.CubismBlendMode_Normal,!1))}}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,G0),t.setClippingContextBufferForMask(null),this.gl.viewport(_h[0],_h[1],_h[2],_h[3])}}findSameClip(e,t){for(let i=0;i<this._clippingContextListForMask.length;i++){const r=this._clippingContextListForMask[i],s=r._clippingIdCount;if(s!=t)continue;let o=0;for(let a=0;a<s;a++){const l=r._clippingIdList[a];for(let u=0;u<s;u++)if(e[u]==l){o++;break}}if(o==s)return r}return null}setupLayoutBounds(e){let t=e/C_,i=e%C_;t=~~t,i=~~i;let r=0;for(let s=0;s<C_;s++){const o=t+(s<i?1:0);if(o!=0)if(o==1){const a=this._clippingContextListForMask[r++];a._layoutChannelNo=s,a._layoutBounds.x=0,a._layoutBounds.y=0,a._layoutBounds.width=1,a._layoutBounds.height=1}else if(o==2)for(let a=0;a<o;a++){let l=a%2;l=~~l;const u=this._clippingContextListForMask[r++];u._layoutChannelNo=s,u._layoutBounds.x=l*.5,u._layoutBounds.y=0,u._layoutBounds.width=.5,u._layoutBounds.height=1}else if(o<=4)for(let a=0;a<o;a++){let l=a%2,u=a/2;l=~~l,u=~~u;const c=this._clippingContextListForMask[r++];c._layoutChannelNo=s,c._layoutBounds.x=l*.5,c._layoutBounds.y=u*.5,c._layoutBounds.width=.5,c._layoutBounds.height=.5}else if(o<=9)for(let a=0;a<o;a++){let l=a%3,u=a/3;l=~~l,u=~~u;const c=this._clippingContextListForMask[r++];c._layoutChannelNo=s,c._layoutBounds.x=l/3,c._layoutBounds.y=u/3,c._layoutBounds.width=1/3,c._layoutBounds.height=1/3}else if(fd.supportMoreMaskDivisions&&o<=16)for(let a=0;a<o;a++){let l=a%4,u=a/4;l=~~l,u=~~u;const c=this._clippingContextListForMask[r++];c._layoutChannelNo=s,c._layoutBounds.x=l/4,c._layoutBounds.y=u/4,c._layoutBounds.width=1/4,c._layoutBounds.height=1/4}else du("not supported mask count : {0}",o)}}getColorBuffer(){return this._colorBuffer}getClippingContextListForDraw(){return this._clippingContextListForDraw}setClippingMaskBufferSize(e){this._clippingMaskBufferSize=e}getClippingMaskBufferSize(){return this._clippingMaskBufferSize}},ZY=class{constructor(e,t){this.frameNo=e,this.texture=t}},JY=class{constructor(e,t,i){this._isUsing=!1,this._owner=e,this._clippingIdList=t,this._clippingIdCount=i,this._allClippedDrawRect=new V0,this._layoutBounds=new V0,this._clippedDrawableIndexList=[],this._matrixForMask=new sl,this._matrixForDraw=new sl}release(){const e=this;e._layoutBounds=void 0,e._allClippedDrawRect=void 0,e._clippedDrawableIndexList=void 0}addClippedDrawable(e){this._clippedDrawableIndexList.push(e)}getClippingManager(){return this._owner}setGl(e){this._owner.setGL(e)}},Rp=class xL{static getInstance(){return ua==null&&(ua=new xL),ua}static deleteInstance(){ua&&(ua.release(),ua=void 0)}constructor(){this._shaderSets=[]}release(){this.releaseShaderProgram()}setupShaderProgram(e,t,i,r,s,o,a,l,u,c,h,d,f){h||du("NoPremultipliedAlpha is not allowed"),this._shaderSets.length==0&&this.generateShaders();let p,_,m,g;const v=e.getClippingContextBufferForMask();if(v!=null){const y=this._shaderSets[vh.ShaderNames_SetupMask];this.gl.useProgram(y.shaderProgram),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.uniform1i(y.samplerTexture0Location,0),a.vertex==null&&(a.vertex=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,a.vertex),this.gl.bufferData(this.gl.ARRAY_BUFFER,r,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(y.attributePositionLocation),this.gl.vertexAttribPointer(y.attributePositionLocation,2,this.gl.FLOAT,!1,0,0),a.uv==null&&(a.uv=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,a.uv),this.gl.bufferData(this.gl.ARRAY_BUFFER,o,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(y.attributeTexCoordLocation),this.gl.vertexAttribPointer(y.attributeTexCoordLocation,2,this.gl.FLOAT,!1,0,0);const x=v._layoutChannelNo,b=v.getClippingManager().getChannelFlagAsColor(x);this.gl.uniform4f(y.uniformChannelFlagLocation,b.R,b.G,b.B,b.A),this.gl.uniformMatrix4fv(y.uniformClipMatrixLocation,!1,v._matrixForMask.getArray());const S=v._layoutBounds;this.gl.uniform4f(y.uniformBaseColorLocation,S.x*2-1,S.y*2-1,S.getRight()*2-1,S.getBottom()*2-1),p=this.gl.ZERO,_=this.gl.ONE_MINUS_SRC_COLOR,m=this.gl.ZERO,g=this.gl.ONE_MINUS_SRC_ALPHA}else{const y=e.getClippingContextBufferForDraw(),b=y!=null?f?2:1:0;let S;switch(u){case Fo.CubismBlendMode_Normal:default:S=this._shaderSets[vh.ShaderNames_NormalPremultipliedAlpha+b],p=this.gl.ONE,_=this.gl.ONE_MINUS_SRC_ALPHA,m=this.gl.ONE,g=this.gl.ONE_MINUS_SRC_ALPHA;break;case Fo.CubismBlendMode_Additive:S=this._shaderSets[vh.ShaderNames_AddPremultipliedAlpha+b],p=this.gl.ONE,_=this.gl.ONE,m=this.gl.ZERO,g=this.gl.ONE;break;case Fo.CubismBlendMode_Multiplicative:S=this._shaderSets[vh.ShaderNames_MultPremultipliedAlpha+b],p=this.gl.DST_COLOR,_=this.gl.ONE_MINUS_SRC_ALPHA,m=this.gl.ZERO,g=this.gl.ONE;break}if(this.gl.useProgram(S.shaderProgram),a.vertex==null&&(a.vertex=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,a.vertex),this.gl.bufferData(this.gl.ARRAY_BUFFER,r,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(S.attributePositionLocation),this.gl.vertexAttribPointer(S.attributePositionLocation,2,this.gl.FLOAT,!1,0,0),a.uv==null&&(a.uv=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,a.uv),this.gl.bufferData(this.gl.ARRAY_BUFFER,o,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(S.attributeTexCoordLocation),this.gl.vertexAttribPointer(S.attributeTexCoordLocation,2,this.gl.FLOAT,!1,0,0),y!=null){this.gl.activeTexture(this.gl.TEXTURE1);const T=y.getClippingManager().getColorBuffer();this.gl.bindTexture(this.gl.TEXTURE_2D,T),this.gl.uniform1i(S.samplerTexture1Location,1),this.gl.uniformMatrix4fv(S.uniformClipMatrixLocation,!1,y._matrixForDraw.getArray());const P=y._layoutChannelNo,E=y.getClippingManager().getChannelFlagAsColor(P);this.gl.uniform4f(S.uniformChannelFlagLocation,E.R,E.G,E.B,E.A)}this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.uniform1i(S.samplerTexture0Location,0),this.gl.uniformMatrix4fv(S.uniformMatrixLocation,!1,d.getArray()),this.gl.uniform4f(S.uniformBaseColorLocation,c.R,c.G,c.B,c.A)}a.index==null&&(a.index=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,a.index),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,s,this.gl.DYNAMIC_DRAW),this.gl.blendFuncSeparate(p,_,m,g)}releaseShaderProgram(){for(let e=0;e<this._shaderSets.length;e++)this.gl.deleteProgram(this._shaderSets[e].shaderProgram),this._shaderSets[e].shaderProgram=0;this._shaderSets=[]}generateShaders(){for(let e=0;e<KY;e++)this._shaderSets.push({});this._shaderSets[0].shaderProgram=this.loadShaderProgram(QY,e7),this._shaderSets[1].shaderProgram=this.loadShaderProgram(t7,n7),this._shaderSets[2].shaderProgram=this.loadShaderProgram(TM,i7),this._shaderSets[3].shaderProgram=this.loadShaderProgram(TM,r7),this._shaderSets[4].shaderProgram=this._shaderSets[1].shaderProgram,this._shaderSets[5].shaderProgram=this._shaderSets[2].shaderProgram,this._shaderSets[6].shaderProgram=this._shaderSets[3].shaderProgram,this._shaderSets[7].shaderProgram=this._shaderSets[1].shaderProgram,this._shaderSets[8].shaderProgram=this._shaderSets[2].shaderProgram,this._shaderSets[9].shaderProgram=this._shaderSets[3].shaderProgram,this._shaderSets[0].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[0].shaderProgram,"a_position"),this._shaderSets[0].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[0].shaderProgram,"a_texCoord"),this._shaderSets[0].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[0].shaderProgram,"s_texture0"),this._shaderSets[0].uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets[0].shaderProgram,"u_clipMatrix"),this._shaderSets[0].uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets[0].shaderProgram,"u_channelFlag"),this._shaderSets[0].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[0].shaderProgram,"u_baseColor"),this._shaderSets[1].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[1].shaderProgram,"a_position"),this._shaderSets[1].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[1].shaderProgram,"a_texCoord"),this._shaderSets[1].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[1].shaderProgram,"s_texture0"),this._shaderSets[1].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[1].shaderProgram,"u_matrix"),this._shaderSets[1].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[1].shaderProgram,"u_baseColor"),this._shaderSets[2].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[2].shaderProgram,"a_position"),this._shaderSets[2].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[2].shaderProgram,"a_texCoord"),this._shaderSets[2].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[2].shaderProgram,"s_texture0"),this._shaderSets[2].samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets[2].shaderProgram,"s_texture1"),this._shaderSets[2].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[2].shaderProgram,"u_matrix"),this._shaderSets[2].uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets[2].shaderProgram,"u_clipMatrix"),this._shaderSets[2].uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets[2].shaderProgram,"u_channelFlag"),this._shaderSets[2].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[2].shaderProgram,"u_baseColor"),this._shaderSets[3].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[3].shaderProgram,"a_position"),this._shaderSets[3].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[3].shaderProgram,"a_texCoord"),this._shaderSets[3].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[3].shaderProgram,"s_texture0"),this._shaderSets[3].samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets[3].shaderProgram,"s_texture1"),this._shaderSets[3].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[3].shaderProgram,"u_matrix"),this._shaderSets[3].uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets[3].shaderProgram,"u_clipMatrix"),this._shaderSets[3].uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets[3].shaderProgram,"u_channelFlag"),this._shaderSets[3].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[3].shaderProgram,"u_baseColor"),this._shaderSets[4].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[4].shaderProgram,"a_position"),this._shaderSets[4].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[4].shaderProgram,"a_texCoord"),this._shaderSets[4].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[4].shaderProgram,"s_texture0"),this._shaderSets[4].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[4].shaderProgram,"u_matrix"),this._shaderSets[4].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[4].shaderProgram,"u_baseColor"),this._shaderSets[5].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[5].shaderProgram,"a_position"),this._shaderSets[5].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[5].shaderProgram,"a_texCoord"),this._shaderSets[5].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[5].shaderProgram,"s_texture0"),this._shaderSets[5].samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets[5].shaderProgram,"s_texture1"),this._shaderSets[5].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[5].shaderProgram,"u_matrix"),this._shaderSets[5].uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets[5].shaderProgram,"u_clipMatrix"),this._shaderSets[5].uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets[5].shaderProgram,"u_channelFlag"),this._shaderSets[5].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[5].shaderProgram,"u_baseColor"),this._shaderSets[6].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[6].shaderProgram,"a_position"),this._shaderSets[6].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[6].shaderProgram,"a_texCoord"),this._shaderSets[6].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[6].shaderProgram,"s_texture0"),this._shaderSets[6].samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets[6].shaderProgram,"s_texture1"),this._shaderSets[6].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[6].shaderProgram,"u_matrix"),this._shaderSets[6].uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets[6].shaderProgram,"u_clipMatrix"),this._shaderSets[6].uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets[6].shaderProgram,"u_channelFlag"),this._shaderSets[6].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[6].shaderProgram,"u_baseColor"),this._shaderSets[7].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[7].shaderProgram,"a_position"),this._shaderSets[7].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[7].shaderProgram,"a_texCoord"),this._shaderSets[7].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[7].shaderProgram,"s_texture0"),this._shaderSets[7].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[7].shaderProgram,"u_matrix"),this._shaderSets[7].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[7].shaderProgram,"u_baseColor"),this._shaderSets[8].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[8].shaderProgram,"a_position"),this._shaderSets[8].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[8].shaderProgram,"a_texCoord"),this._shaderSets[8].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[8].shaderProgram,"s_texture0"),this._shaderSets[8].samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets[8].shaderProgram,"s_texture1"),this._shaderSets[8].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[8].shaderProgram,"u_matrix"),this._shaderSets[8].uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets[8].shaderProgram,"u_clipMatrix"),this._shaderSets[8].uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets[8].shaderProgram,"u_channelFlag"),this._shaderSets[8].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[8].shaderProgram,"u_baseColor"),this._shaderSets[9].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[9].shaderProgram,"a_position"),this._shaderSets[9].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[9].shaderProgram,"a_texCoord"),this._shaderSets[9].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[9].shaderProgram,"s_texture0"),this._shaderSets[9].samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets[9].shaderProgram,"s_texture1"),this._shaderSets[9].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[9].shaderProgram,"u_matrix"),this._shaderSets[9].uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets[9].shaderProgram,"u_clipMatrix"),this._shaderSets[9].uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets[9].shaderProgram,"u_channelFlag"),this._shaderSets[9].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[9].shaderProgram,"u_baseColor")}loadShaderProgram(e,t){let i=this.gl.createProgram(),r=this.compileShaderSource(this.gl.VERTEX_SHADER,e);if(!r)return du("Vertex shader compile error!"),0;let s=this.compileShaderSource(this.gl.FRAGMENT_SHADER,t);return s?(this.gl.attachShader(i,r),this.gl.attachShader(i,s),this.gl.linkProgram(i),this.gl.getProgramParameter(i,this.gl.LINK_STATUS)?(this.gl.deleteShader(r),this.gl.deleteShader(s),i):(du("Failed to link program: {0}",i),this.gl.deleteShader(r),this.gl.deleteShader(s),i&&this.gl.deleteProgram(i),0)):(du("Vertex shader compile error!"),0)}compileShaderSource(e,t){const i=t,r=this.gl.createShader(e);if(this.gl.shaderSource(r,i),this.gl.compileShader(r),!r){const o=this.gl.getShaderInfoLog(r);du("Shader compile log: {0} ",o)}return this.gl.getShaderParameter(r,this.gl.COMPILE_STATUS)?r:(this.gl.deleteShader(r),null)}setGl(e){this.gl=e}};var vh=(n=>(n[n.ShaderNames_SetupMask=0]="ShaderNames_SetupMask",n[n.ShaderNames_NormalPremultipliedAlpha=1]="ShaderNames_NormalPremultipliedAlpha",n[n.ShaderNames_NormalMaskedPremultipliedAlpha=2]="ShaderNames_NormalMaskedPremultipliedAlpha",n[n.ShaderNames_NomralMaskedInvertedPremultipliedAlpha=3]="ShaderNames_NomralMaskedInvertedPremultipliedAlpha",n[n.ShaderNames_AddPremultipliedAlpha=4]="ShaderNames_AddPremultipliedAlpha",n[n.ShaderNames_AddMaskedPremultipliedAlpha=5]="ShaderNames_AddMaskedPremultipliedAlpha",n[n.ShaderNames_AddMaskedPremultipliedAlphaInverted=6]="ShaderNames_AddMaskedPremultipliedAlphaInverted",n[n.ShaderNames_MultPremultipliedAlpha=7]="ShaderNames_MultPremultipliedAlpha",n[n.ShaderNames_MultMaskedPremultipliedAlpha=8]="ShaderNames_MultMaskedPremultipliedAlpha",n[n.ShaderNames_MultMaskedPremultipliedAlphaInverted=9]="ShaderNames_MultMaskedPremultipliedAlphaInverted",n))(vh||{});const QY="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;varying vec4       v_myPos;uniform mat4       u_clipMatrix;void main(){   gl_Position = u_clipMatrix * a_position;   v_myPos = u_clipMatrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",e7="precision mediump float;varying vec2       v_texCoord;varying vec4       v_myPos;uniform vec4       u_baseColor;uniform vec4       u_channelFlag;uniform sampler2D  s_texture0;void main(){   float isInside =        step(u_baseColor.x, v_myPos.x/v_myPos.w)       * step(u_baseColor.y, v_myPos.y/v_myPos.w)       * step(v_myPos.x/v_myPos.w, u_baseColor.z)       * step(v_myPos.y/v_myPos.w, u_baseColor.w);   gl_FragColor = u_channelFlag * texture2D(s_texture0, v_texCoord).a * isInside;}",t7="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;uniform mat4       u_matrix;void main(){   gl_Position = u_matrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",TM="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;varying vec4       v_clipPos;uniform mat4       u_matrix;uniform mat4       u_clipMatrix;void main(){   gl_Position = u_matrix * a_position;   v_clipPos = u_clipMatrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",n7="precision mediump float;varying vec2       v_texCoord;uniform vec4       u_baseColor;uniform sampler2D  s_texture0;void main(){   gl_FragColor = texture2D(s_texture0 , v_texCoord) * u_baseColor;}",i7="precision mediump float;varying vec2       v_texCoord;varying vec4       v_clipPos;uniform vec4       u_baseColor;uniform vec4       u_channelFlag;uniform sampler2D  s_texture0;uniform sampler2D  s_texture1;void main(){   vec4 col_formask = texture2D(s_texture0 , v_texCoord) * u_baseColor;   vec4 clipMask = (1.0 - texture2D(s_texture1, v_clipPos.xy / v_clipPos.w)) * u_channelFlag;   float maskVal = clipMask.r + clipMask.g + clipMask.b + clipMask.a;   col_formask = col_formask * maskVal;   gl_FragColor = col_formask;}",r7="precision mediump float;varying vec2 v_texCoord;varying vec4 v_clipPos;uniform sampler2D s_texture0;uniform sampler2D s_texture1;uniform vec4 u_channelFlag;uniform vec4 u_baseColor;void main(){vec4 col_formask = texture2D(s_texture0, v_texCoord) * u_baseColor;vec4 clipMask = (1.0 - texture2D(s_texture1, v_clipPos.xy / v_clipPos.w)) * u_channelFlag;float maskVal = clipMask.r + clipMask.g + clipMask.b + clipMask.a;col_formask = col_formask * (1.0 - maskVal);gl_FragColor = col_formask;}";let bL=class extends Gb{constructor(){super(),this._clippingContextBufferForMask=null,this._clippingContextBufferForDraw=null,this._clippingManager=new R_,this.firstDraw=!0,this._textures={},this._sortedDrawableIndexList=[],this._bufferData={vertex:null,uv:null,index:null}}initialize(e){e.isUsingMasking()&&(this._clippingManager=new R_,this._clippingManager.initialize(e,e.getDrawableCount(),e.getDrawableMasks(),e.getDrawableMaskCounts()));for(let t=e.getDrawableCount()-1;t>=0;t--)this._sortedDrawableIndexList[t]=0;super.initialize(e)}bindTexture(e,t){this._textures[e]=t}getBindedTextures(){return this._textures}setClippingMaskBufferSize(e){this._clippingManager.release(),this._clippingManager=new R_,this._clippingManager.setClippingMaskBufferSize(e),this._clippingManager.initialize(this.getModel(),this.getModel().getDrawableCount(),this.getModel().getDrawableMasks(),this.getModel().getDrawableMaskCounts())}getClippingMaskBufferSize(){return this._clippingManager.getClippingMaskBufferSize()}release(){var e,t,i;const r=this;this._clippingManager.release(),r._clippingManager=void 0,(e=this.gl)==null||e.deleteBuffer(this._bufferData.vertex),this._bufferData.vertex=null,(t=this.gl)==null||t.deleteBuffer(this._bufferData.uv),this._bufferData.uv=null,(i=this.gl)==null||i.deleteBuffer(this._bufferData.index),this._bufferData.index=null,r._bufferData=void 0,r._textures=void 0}doDrawModel(){this.preDraw(),this._clippingManager!=null&&this._clippingManager.setupClippingContext(this.getModel(),this);const e=this.getModel().getDrawableCount(),t=this.getModel().getDrawableRenderOrders();for(let i=0;i<e;++i){const r=t[i];this._sortedDrawableIndexList[r]=i}for(let i=0;i<e;++i){const r=this._sortedDrawableIndexList[i];this.getModel().getDrawableDynamicFlagIsVisible(r)&&(this.setClippingContextBufferForDraw(this._clippingManager!=null?this._clippingManager.getClippingContextListForDraw()[r]:null),this.setIsCulling(this.getModel().getDrawableCulling(r)),this.drawMesh(this.getModel().getDrawableTextureIndices(r),this.getModel().getDrawableVertexIndexCount(r),this.getModel().getDrawableVertexCount(r),this.getModel().getDrawableVertexIndices(r),this.getModel().getDrawableVertices(r),this.getModel().getDrawableVertexUvs(r),this.getModel().getDrawableOpacity(r),this.getModel().getDrawableBlendMode(r),this.getModel().getDrawableInvertedMaskBit(r)))}}drawMesh(e,t,i,r,s,o,a,l,u){this.isCulling()?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this.gl.frontFace(this.gl.CCW);const c=this.getModelColor();this.getClippingContextBufferForMask()==null&&(c.A*=a,this.isPremultipliedAlpha()&&(c.R*=c.A,c.G*=c.A,c.B*=c.A));let h=null;this._textures[e]!=null&&(h=this._textures[e]),Rp.getInstance().setupShaderProgram(this,h,i,s,r,o,this._bufferData,a,l,c,this.isPremultipliedAlpha(),this.getMvpMatrix(),u),this.gl.drawElements(this.gl.TRIANGLES,t,this.gl.UNSIGNED_SHORT,0),this.gl.useProgram(null),this.setClippingContextBufferForDraw(null),this.setClippingContextBufferForMask(null)}static doStaticRelease(){Rp.deleteInstance()}setRenderState(e,t){G0=e,_h=t}preDraw(){this.firstDraw&&(this.firstDraw=!1,this._anisortopy=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")),this.gl.disable(this.gl.SCISSOR_TEST),this.gl.disable(this.gl.STENCIL_TEST),this.gl.disable(this.gl.DEPTH_TEST),this.gl.frontFace(this.gl.CW),this.gl.enable(this.gl.BLEND),this.gl.colorMask(!0,!0,!0,!0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null)}setClippingContextBufferForMask(e){this._clippingContextBufferForMask=e}getClippingContextBufferForMask(){return this._clippingContextBufferForMask}setClippingContextBufferForDraw(e){this._clippingContextBufferForDraw=e}getClippingContextBufferForDraw(){return this._clippingContextBufferForDraw}startUp(e){this.gl=e,this._clippingManager.setGL(e),Rp.getInstance().setGl(e)}};Gb.staticRelease=()=>{bL.doStaticRelease()};const MM=new sl;let s7=class extends iL{constructor(e,t,i){super(),this.lipSync=!0,this.breath=qY.create(),this.renderer=new bL,this.idParamAngleX=HY,this.idParamAngleY=zY,this.idParamAngleZ=WY,this.idParamEyeBallX=XY,this.idParamEyeBallY=jY,this.idParamBodyAngleX=$Y,this.idParamBreath=YY,this.pixelsPerUnit=1,this.centeringTransform=new kt,this.coreModel=e,this.settings=t,this.motionManager=new GY(t,i),this.init()}init(){var e;super.init(),((e=this.settings.getEyeBlinkParameters())==null?void 0:e.length)>0&&(this.eyeBlink=yL.create(this.settings)),this.breath.setParameters([new zc(this.idParamAngleX,0,15,6.5345,.5),new zc(this.idParamAngleY,0,8,3.5345,.5),new zc(this.idParamAngleZ,0,10,5.5345,.5),new zc(this.idParamBodyAngleX,0,4,15.5345,.5),new zc(this.idParamBreath,0,.5,3.2345,.5)]),this.renderer.initialize(this.coreModel),this.renderer.setIsPremultipliedAlpha(!0)}getSize(){return[this.coreModel.getModel().canvasinfo.CanvasWidth,this.coreModel.getModel().canvasinfo.CanvasHeight]}getLayout(){const e={};if(this.settings.layout)for(const t of Object.keys(this.settings.layout)){const i=t.charAt(0).toLowerCase()+t.slice(1);e[i]=this.settings.layout[t]}return e}setupLayout(){super.setupLayout(),this.pixelsPerUnit=this.coreModel.getModel().canvasinfo.PixelsPerUnit,this.centeringTransform.scale(this.pixelsPerUnit,this.pixelsPerUnit).translate(this.originalWidth/2,this.originalHeight/2)}updateWebGLContext(e,t){this.renderer.firstDraw=!0,this.renderer._bufferData={vertex:null,uv:null,index:null},this.renderer.startUp(e),this.renderer._clippingManager._currentFrameNo=t,this.renderer._clippingManager._maskTexture=void 0,Rp.getInstance()._shaderSets=[]}bindTexture(e,t){this.renderer.bindTexture(e,t)}getHitAreaDefs(){var e,t;return(t=(e=this.settings.hitAreas)==null?void 0:e.map(i=>({id:i.Id,name:i.Name,index:this.coreModel.getDrawableIndex(i.Id)})))!=null?t:[]}getDrawableIDs(){return this.coreModel.getDrawableIds()}getDrawableIndex(e){return this.coreModel.getDrawableIndex(e)}getDrawableVertices(e){if(typeof e=="string"&&(e=this.coreModel.getDrawableIndex(e),e===-1))throw new TypeError("Unable to find drawable ID: "+e);const t=this.coreModel.getDrawableVertices(e).slice();for(let i=0;i<t.length;i+=2)t[i]=t[i]*this.pixelsPerUnit+this.originalWidth/2,t[i+1]=-t[i+1]*this.pixelsPerUnit+this.originalHeight/2;return t}updateTransform(e){this.drawingMatrix.copyFrom(this.centeringTransform).prepend(this.localTransform).prepend(e)}update(e,t){var i,r,s,o;super.update(e,t),e/=1e3,t/=1e3;const a=this.coreModel;this.emit("beforeMotionUpdate");const l=this.motionManager.update(this.coreModel,t);this.emit("afterMotionUpdate"),a.saveParameters(),(i=this.motionManager.expressionManager)==null||i.update(a,t),l||(r=this.eyeBlink)==null||r.updateParameters(a,e),this.updateFocus(),this.updateNaturalMovements(e*1e3,t*1e3),(s=this.physics)==null||s.evaluate(a,e),(o=this.pose)==null||o.updateParameters(a,e),this.emit("beforeModelUpdate"),a.update(),a.loadParameters()}updateFocus(){this.coreModel.addParameterValueById(this.idParamEyeBallX,this.focusController.x),this.coreModel.addParameterValueById(this.idParamEyeBallY,this.focusController.y),this.coreModel.addParameterValueById(this.idParamAngleX,this.focusController.x*30),this.coreModel.addParameterValueById(this.idParamAngleY,this.focusController.y*30),this.coreModel.addParameterValueById(this.idParamAngleZ,this.focusController.x*this.focusController.y*-30),this.coreModel.addParameterValueById(this.idParamBodyAngleX,this.focusController.x*10)}updateNaturalMovements(e,t){var i;(i=this.breath)==null||i.updateParameters(this.coreModel,e/1e3)}draw(e){const t=this.drawingMatrix,i=MM.getArray();i[0]=t.a,i[1]=t.b,i[4]=-t.c,i[5]=-t.d,i[12]=t.tx,i[13]=t.ty,this.renderer.setMvpMatrix(MM),this.renderer.setRenderState(e.getParameter(e.FRAMEBUFFER_BINDING),this.viewport),this.renderer.drawModel()}destroy(){super.destroy(),this.renderer.release(),this.coreModel.release(),this.renderer=void 0,this.coreModel=void 0}},Pf,wM=20;function o7(){return pd.isStarted()?Promise.resolve():(Pf??(Pf=new Promise((n,e)=>{function t(){try{a7(),n()}catch(i){if(wM--,wM<0){const r=new Error("Failed to start up Cubism 4 framework.");r.cause=i,e(r);return}Gt.log("Cubism4","Startup failed, retrying 10ms later..."),setTimeout(t,10)}}t()})),Pf)}function a7(n){n=Object.assign({logFunction:console.log,loggingLevel:El.LogLevel_Verbose},n),pd.startUp(n),pd.initialize()}const l7=.001,AM=.5;let u7=class SL{static create(e){const t=new SL;typeof e.FadeInTime=="number"&&(t._fadeTimeSeconds=e.FadeInTime,t._fadeTimeSeconds<=0&&(t._fadeTimeSeconds=AM));const i=e.Groups,r=i.length;for(let s=0;s<r;++s){const o=i[s],a=o.length;let l=0;for(let u=0;u<a;++u){const c=o[u],h=new PM;h.partId=c.Id;const d=c.Link;if(d){const f=d.length;for(let p=0;p<f;++p){const _=new PM;_.partId=d[p],h.link.push(_)}}t._partGroups.push(h),++l}t._partGroupCounts.push(l)}return t}updateParameters(e,t){e!=this._lastModel&&this.reset(e),this._lastModel=e,t<0&&(t=0);let i=0;for(let r=0;r<this._partGroupCounts.length;r++){const s=this._partGroupCounts[r];this.doFade(e,t,i,s),i+=s}this.copyPartOpacities(e)}reset(e){let t=0;for(let i=0;i<this._partGroupCounts.length;++i){const r=this._partGroupCounts[i];for(let s=t;s<t+r;++s){this._partGroups[s].initialize(e);const o=this._partGroups[s].partIndex,a=this._partGroups[s].parameterIndex;if(!(o<0)){e.setPartOpacityByIndex(o,s==t?1:0),e.setParameterValueByIndex(a,s==t?1:0);for(let l=0;l<this._partGroups[s].link.length;++l)this._partGroups[s].link[l].initialize(e)}}t+=r}}copyPartOpacities(e){for(let t=0;t<this._partGroups.length;++t){const i=this._partGroups[t];if(i.link.length==0)continue;const r=this._partGroups[t].partIndex,s=e.getPartOpacityByIndex(r);for(let o=0;o<i.link.length;++o){const l=i.link[o].partIndex;l<0||e.setPartOpacityByIndex(l,s)}}}doFade(e,t,i,r){let s=-1,o=1;const a=.5,l=.15;for(let u=i;u<i+r;++u){const c=this._partGroups[u].partIndex,h=this._partGroups[u].parameterIndex;if(e.getParameterValueByIndex(h)>l7){if(s>=0)break;s=u,o=e.getPartOpacityByIndex(c),o+=t/this._fadeTimeSeconds,o>1&&(o=1)}}s<0&&(s=0,o=1);for(let u=i;u<i+r;++u){const c=this._partGroups[u].partIndex;if(s==u)e.setPartOpacityByIndex(c,o);else{let h=e.getPartOpacityByIndex(c),d;o<a?d=o*(a-1)/a+1:d=(1-o)*a/(1-a),(1-d)*(1-o)>l&&(d=1-l/(1-o)),h>d&&(h=d),e.setPartOpacityByIndex(c,h)}}}constructor(){this._fadeTimeSeconds=AM,this._lastModel=void 0,this._partGroups=[],this._partGroupCounts=[]}},PM=class EL{constructor(e){this.parameterIndex=0,this.partIndex=0,this.partId="",this.link=[],e!=null&&this.assignment(e)}assignment(e){return this.partId=e.partId,this.link=e.link.map(t=>t.clone()),this}initialize(e){this.parameterIndex=e.getParameterIndex(this.partId),this.partIndex=e.getPartIndex(this.partId),e.setParameterValueByIndex(this.parameterIndex,1)}clone(){const e=new EL;return e.partId=this.partId,e.parameterIndex=this.parameterIndex,e.partIndex=this.partIndex,e.link=this.link.map(t=>t.clone()),e}},c7=class{update(){this._model.update(),this._model.drawables.resetDynamicFlags()}getCanvasWidth(){return this._model==null?0:this._model.canvasinfo.CanvasWidth/this._model.canvasinfo.PixelsPerUnit}getCanvasHeight(){return this._model==null?0:this._model.canvasinfo.CanvasHeight/this._model.canvasinfo.PixelsPerUnit}saveParameters(){const e=this._model.parameters.count,t=this._savedParameters.length;for(let i=0;i<e;++i)i<t?this._savedParameters[i]=this._parameterValues[i]:this._savedParameters.push(this._parameterValues[i])}getModel(){return this._model}getPartIndex(e){let t;const i=this._model.parts.count;for(t=0;t<i;++t)if(e==this._partIds[t])return t;return e in this._notExistPartId?this._notExistPartId[e]:(t=i+this._notExistPartId.length,this._notExistPartId[e]=t,this._notExistPartOpacities[t]=0,t)}getPartCount(){return this._model.parts.count}setPartOpacityByIndex(e,t){if(e in this._notExistPartOpacities){this._notExistPartOpacities[e]=t;return}Af(0<=e&&e<this.getPartCount()),this._partOpacities[e]=t}setPartOpacityById(e,t){const i=this.getPartIndex(e);i<0||this.setPartOpacityByIndex(i,t)}getPartOpacityByIndex(e){return e in this._notExistPartOpacities?this._notExistPartOpacities[e]:(Af(0<=e&&e<this.getPartCount()),this._partOpacities[e])}getPartOpacityById(e){const t=this.getPartIndex(e);return t<0?0:this.getPartOpacityByIndex(t)}getParameterIndex(e){let t;const i=this._model.parameters.count;for(t=0;t<i;++t)if(e==this._parameterIds[t])return t;return e in this._notExistParameterId?this._notExistParameterId[e]:(t=this._model.parameters.count+Object.keys(this._notExistParameterId).length,this._notExistParameterId[e]=t,this._notExistParameterValues[t]=0,t)}getParameterCount(){return this._model.parameters.count}getParameterMaximumValue(e){return this._model.parameters.maximumValues[e]}getParameterMinimumValue(e){return this._model.parameters.minimumValues[e]}getParameterDefaultValue(e){return this._model.parameters.defaultValues[e]}getParameterValueByIndex(e){return e in this._notExistParameterValues?this._notExistParameterValues[e]:(Af(0<=e&&e<this.getParameterCount()),this._parameterValues[e])}getParameterValueById(e){const t=this.getParameterIndex(e);return this.getParameterValueByIndex(t)}setParameterValueByIndex(e,t,i=1){if(e in this._notExistParameterValues){this._notExistParameterValues[e]=i==1?t:this._notExistParameterValues[e]*(1-i)+t*i;return}Af(0<=e&&e<this.getParameterCount()),this._model.parameters.maximumValues[e]<t&&(t=this._model.parameters.maximumValues[e]),this._model.parameters.minimumValues[e]>t&&(t=this._model.parameters.minimumValues[e]),this._parameterValues[e]=i==1?t:this._parameterValues[e]=this._parameterValues[e]*(1-i)+t*i}setParameterValueById(e,t,i=1){const r=this.getParameterIndex(e);this.setParameterValueByIndex(r,t,i)}addParameterValueByIndex(e,t,i=1){this.setParameterValueByIndex(e,this.getParameterValueByIndex(e)+t*i)}addParameterValueById(e,t,i=1){const r=this.getParameterIndex(e);this.addParameterValueByIndex(r,t,i)}multiplyParameterValueById(e,t,i=1){const r=this.getParameterIndex(e);this.multiplyParameterValueByIndex(r,t,i)}multiplyParameterValueByIndex(e,t,i=1){this.setParameterValueByIndex(e,this.getParameterValueByIndex(e)*(1+(t-1)*i))}getDrawableIds(){return this._drawableIds.slice()}getDrawableIndex(e){const t=this._model.drawables.count;for(let i=0;i<t;++i)if(this._drawableIds[i]==e)return i;return-1}getDrawableCount(){return this._model.drawables.count}getDrawableId(e){return this._model.drawables.ids[e]}getDrawableRenderOrders(){return this._model.drawables.renderOrders}getDrawableTextureIndices(e){return this._model.drawables.textureIndices[e]}getDrawableDynamicFlagVertexPositionsDidChange(e){const t=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasVertexPositionsDidChangeBit(t[e])}getDrawableVertexIndexCount(e){return this._model.drawables.indexCounts[e]}getDrawableVertexCount(e){return this._model.drawables.vertexCounts[e]}getDrawableVertices(e){return this.getDrawableVertexPositions(e)}getDrawableVertexIndices(e){return this._model.drawables.indices[e]}getDrawableVertexPositions(e){return this._model.drawables.vertexPositions[e]}getDrawableVertexUvs(e){return this._model.drawables.vertexUvs[e]}getDrawableOpacity(e){return this._model.drawables.opacities[e]}getDrawableCulling(e){const t=this._model.drawables.constantFlags;return!Live2DCubismCore.Utils.hasIsDoubleSidedBit(t[e])}getDrawableBlendMode(e){const t=this._model.drawables.constantFlags;return Live2DCubismCore.Utils.hasBlendAdditiveBit(t[e])?Fo.CubismBlendMode_Additive:Live2DCubismCore.Utils.hasBlendMultiplicativeBit(t[e])?Fo.CubismBlendMode_Multiplicative:Fo.CubismBlendMode_Normal}getDrawableInvertedMaskBit(e){const t=this._model.drawables.constantFlags;return Live2DCubismCore.Utils.hasIsInvertedMaskBit(t[e])}getDrawableMasks(){return this._model.drawables.masks}getDrawableMaskCounts(){return this._model.drawables.maskCounts}isUsingMasking(){for(let e=0;e<this._model.drawables.count;++e)if(!(this._model.drawables.maskCounts[e]<=0))return!0;return!1}getDrawableDynamicFlagIsVisible(e){const t=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasIsVisibleBit(t[e])}getDrawableDynamicFlagVisibilityDidChange(e){const t=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasVisibilityDidChangeBit(t[e])}getDrawableDynamicFlagOpacityDidChange(e){const t=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasOpacityDidChangeBit(t[e])}getDrawableDynamicFlagRenderOrderDidChange(e){const t=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasRenderOrderDidChangeBit(t[e])}loadParameters(){let e=this._model.parameters.count;const t=this._savedParameters.length;e>t&&(e=t);for(let i=0;i<e;++i)this._parameterValues[i]=this._savedParameters[i]}initialize(){this._parameterValues=this._model.parameters.values,this._partOpacities=this._model.parts.opacities,this._parameterMaximumValues=this._model.parameters.maximumValues,this._parameterMinimumValues=this._model.parameters.minimumValues;{const e=this._model.parameters.ids,t=this._model.parameters.count;for(let i=0;i<t;++i)this._parameterIds.push(e[i])}{const e=this._model.parts.ids,t=this._model.parts.count;for(let i=0;i<t;++i)this._partIds.push(e[i])}{const e=this._model.drawables.ids,t=this._model.drawables.count;for(let i=0;i<t;++i)this._drawableIds.push(e[i])}}constructor(e){this._model=e,this._savedParameters=[],this._parameterIds=[],this._drawableIds=[],this._partIds=[],this._notExistPartId={},this._notExistParameterId={},this._notExistParameterValues={},this._notExistPartOpacities={},this.initialize()}release(){this._model.release(),this._model=void 0}},h7=class TL{static create(e){const t=Live2DCubismCore.Moc.fromArrayBuffer(e);if(t)return new TL(t);throw new Error("Unknown error")}createModel(){let e;const t=Live2DCubismCore.Model.fromMoc(this._moc);if(t)return e=new c7(t),++this._modelCount,e;throw new Error("Unknown error")}deleteModel(e){e!=null&&--this._modelCount}constructor(e){this._moc=e,this._modelCount=0}release(){this._moc._release(),this._moc=void 0}};var H0=(n=>(n[n.CubismPhysicsTargetType_Parameter=0]="CubismPhysicsTargetType_Parameter",n))(H0||{}),Ra=(n=>(n[n.CubismPhysicsSource_X=0]="CubismPhysicsSource_X",n[n.CubismPhysicsSource_Y=1]="CubismPhysicsSource_Y",n[n.CubismPhysicsSource_Angle=2]="CubismPhysicsSource_Angle",n))(Ra||{});let d7=class{constructor(){this.initialPosition=new gt(0,0),this.position=new gt(0,0),this.lastPosition=new gt(0,0),this.lastGravity=new gt(0,0),this.force=new gt(0,0),this.velocity=new gt(0,0)}},f7=class{constructor(){this.normalizationPosition={},this.normalizationAngle={}}},p7=class{constructor(){this.source={}}},m7=class{constructor(){this.destination={},this.translationScale=new gt(0,0)}},g7=class{constructor(){this.settings=[],this.inputs=[],this.outputs=[],this.particles=[],this.gravity=new gt(0,0),this.wind=new gt(0,0)}},_7=class{constructor(e){this._json=e}release(){this._json=void 0}getGravity(){const e=new gt(0,0);return e.x=this._json.Meta.EffectiveForces.Gravity.X,e.y=this._json.Meta.EffectiveForces.Gravity.Y,e}getWind(){const e=new gt(0,0);return e.x=this._json.Meta.EffectiveForces.Wind.X,e.y=this._json.Meta.EffectiveForces.Wind.Y,e}getSubRigCount(){return this._json.Meta.PhysicsSettingCount}getTotalInputCount(){return this._json.Meta.TotalInputCount}getTotalOutputCount(){return this._json.Meta.TotalOutputCount}getVertexCount(){return this._json.Meta.VertexCount}getNormalizationPositionMinimumValue(e){return this._json.PhysicsSettings[e].Normalization.Position.Minimum}getNormalizationPositionMaximumValue(e){return this._json.PhysicsSettings[e].Normalization.Position.Maximum}getNormalizationPositionDefaultValue(e){return this._json.PhysicsSettings[e].Normalization.Position.Default}getNormalizationAngleMinimumValue(e){return this._json.PhysicsSettings[e].Normalization.Angle.Minimum}getNormalizationAngleMaximumValue(e){return this._json.PhysicsSettings[e].Normalization.Angle.Maximum}getNormalizationAngleDefaultValue(e){return this._json.PhysicsSettings[e].Normalization.Angle.Default}getInputCount(e){return this._json.PhysicsSettings[e].Input.length}getInputWeight(e,t){return this._json.PhysicsSettings[e].Input[t].Weight}getInputReflect(e,t){return this._json.PhysicsSettings[e].Input[t].Reflect}getInputType(e,t){return this._json.PhysicsSettings[e].Input[t].Type}getInputSourceId(e,t){return this._json.PhysicsSettings[e].Input[t].Source.Id}getOutputCount(e){return this._json.PhysicsSettings[e].Output.length}getOutputVertexIndex(e,t){return this._json.PhysicsSettings[e].Output[t].VertexIndex}getOutputAngleScale(e,t){return this._json.PhysicsSettings[e].Output[t].Scale}getOutputWeight(e,t){return this._json.PhysicsSettings[e].Output[t].Weight}getOutputDestinationId(e,t){return this._json.PhysicsSettings[e].Output[t].Destination.Id}getOutputType(e,t){return this._json.PhysicsSettings[e].Output[t].Type}getOutputReflect(e,t){return this._json.PhysicsSettings[e].Output[t].Reflect}getParticleCount(e){return this._json.PhysicsSettings[e].Vertices.length}getParticleMobility(e,t){return this._json.PhysicsSettings[e].Vertices[t].Mobility}getParticleDelay(e,t){return this._json.PhysicsSettings[e].Vertices[t].Delay}getParticleAcceleration(e,t){return this._json.PhysicsSettings[e].Vertices[t].Acceleration}getParticleRadius(e,t){return this._json.PhysicsSettings[e].Vertices[t].Radius}getParticlePosition(e,t){const i=new gt(0,0);return i.x=this._json.PhysicsSettings[e].Vertices[t].Position.X,i.y=this._json.PhysicsSettings[e].Vertices[t].Position.Y,i}};const CM="X",RM="Y",IM="Angle",v7=5,ML=100,y7=.001;let x7=class wL{static create(e){const t=new wL;return t.parse(e),t._physicsRig.gravity.y=0,t}evaluate(e,t){let i,r,s,o;const a=new gt;let l,u,c,h,d,f,p,_;d=e.getModel().parameters.values,f=e.getModel().parameters.maximumValues,p=e.getModel().parameters.minimumValues,_=e.getModel().parameters.defaultValues;for(let m=0;m<this._physicsRig.subRigCount;++m){i={angle:0},a.x=0,a.y=0,l=this._physicsRig.settings[m],u=this._physicsRig.inputs.slice(l.baseInputIndex),c=this._physicsRig.outputs.slice(l.baseOutputIndex),h=this._physicsRig.particles.slice(l.baseParticleIndex);for(let g=0;g<l.inputCount;++g)r=u[g].weight/ML,u[g].sourceParameterIndex==-1&&(u[g].sourceParameterIndex=e.getParameterIndex(u[g].source.id)),u[g].getNormalizedParameterValue(a,i,d[u[g].sourceParameterIndex],p[u[g].sourceParameterIndex],f[u[g].sourceParameterIndex],_[u[g].sourceParameterIndex],l.normalizationPosition,l.normalizationAngle,u[g].reflect,r);s=Wt.degreesToRadian(-i.angle),a.x=a.x*Wt.cos(s)-a.y*Wt.sin(s),a.y=a.x*Wt.sin(s)+a.y*Wt.cos(s),O7(h,l.particleCount,a,i.angle,this._options.wind,y7*l.normalizationPosition.maximum,t,v7);for(let g=0;g<l.outputCount;++g){const v=c[g].vertexIndex;if(v<1||v>=l.particleCount)break;c[g].destinationParameterIndex==-1&&(c[g].destinationParameterIndex=e.getParameterIndex(c[g].destination.id));const y=new gt;y.x=h[v].position.x-h[v-1].position.x,y.y=h[v].position.y-h[v-1].position.y,o=c[g].getValue(y,h,v,c[g].reflect,this._options.gravity);const x=c[g].destinationParameterIndex,b=!Float32Array.prototype.slice&&"subarray"in Float32Array.prototype?JSON.parse(JSON.stringify(d.subarray(x))):d.slice(x);D7(b,p[x],f[x],o,c[g]);for(let S=x,T=0;S<d.length;S++,T++)d[S]=b[T]}}}setOptions(e){this._options=e}getOption(){return this._options}constructor(){this._options=new b7,this._options.gravity.y=-1,this._options.gravity.x=0,this._options.wind.x=0,this._options.wind.y=0}release(){this._physicsRig=void 0}parse(e){this._physicsRig=new g7;let t=new _7(e);this._physicsRig.gravity=t.getGravity(),this._physicsRig.wind=t.getWind(),this._physicsRig.subRigCount=t.getSubRigCount();let i=0,r=0,s=0;for(let o=0;o<this._physicsRig.subRigCount;++o){const a=new f7;a.normalizationPosition.minimum=t.getNormalizationPositionMinimumValue(o),a.normalizationPosition.maximum=t.getNormalizationPositionMaximumValue(o),a.normalizationPosition.defalut=t.getNormalizationPositionDefaultValue(o),a.normalizationAngle.minimum=t.getNormalizationAngleMinimumValue(o),a.normalizationAngle.maximum=t.getNormalizationAngleMaximumValue(o),a.normalizationAngle.defalut=t.getNormalizationAngleDefaultValue(o),a.inputCount=t.getInputCount(o),a.baseInputIndex=i,i+=a.inputCount;for(let l=0;l<a.inputCount;++l){const u=new p7;switch(u.sourceParameterIndex=-1,u.weight=t.getInputWeight(o,l),u.reflect=t.getInputReflect(o,l),t.getInputType(o,l)){case CM:u.type=Ra.CubismPhysicsSource_X,u.getNormalizedParameterValue=S7;break;case RM:u.type=Ra.CubismPhysicsSource_Y,u.getNormalizedParameterValue=E7;break;case IM:u.type=Ra.CubismPhysicsSource_Angle,u.getNormalizedParameterValue=T7;break}u.source.targetType=H0.CubismPhysicsTargetType_Parameter,u.source.id=t.getInputSourceId(o,l),this._physicsRig.inputs.push(u)}a.outputCount=t.getOutputCount(o),a.baseOutputIndex=r,r+=a.outputCount;for(let l=0;l<a.outputCount;++l){const u=new m7;switch(u.destinationParameterIndex=-1,u.vertexIndex=t.getOutputVertexIndex(o,l),u.angleScale=t.getOutputAngleScale(o,l),u.weight=t.getOutputWeight(o,l),u.destination.targetType=H0.CubismPhysicsTargetType_Parameter,u.destination.id=t.getOutputDestinationId(o,l),t.getOutputType(o,l)){case CM:u.type=Ra.CubismPhysicsSource_X,u.getValue=M7,u.getScale=R7;break;case RM:u.type=Ra.CubismPhysicsSource_Y,u.getValue=w7,u.getScale=I7;break;case IM:u.type=Ra.CubismPhysicsSource_Angle,u.getValue=A7,u.getScale=L7;break}u.reflect=t.getOutputReflect(o,l),this._physicsRig.outputs.push(u)}a.particleCount=t.getParticleCount(o),a.baseParticleIndex=s,s+=a.particleCount;for(let l=0;l<a.particleCount;++l){const u=new d7;u.mobility=t.getParticleMobility(o,l),u.delay=t.getParticleDelay(o,l),u.acceleration=t.getParticleAcceleration(o,l),u.radius=t.getParticleRadius(o,l),u.position=t.getParticlePosition(o,l),this._physicsRig.particles.push(u)}this._physicsRig.settings.push(a)}this.initialize(),t.release()}initialize(){let e,t,i;for(let r=0;r<this._physicsRig.subRigCount;++r){t=this._physicsRig.settings[r],e=this._physicsRig.particles.slice(t.baseParticleIndex),e[0].initialPosition=new gt(0,0),e[0].lastPosition=new gt(e[0].initialPosition.x,e[0].initialPosition.y),e[0].lastGravity=new gt(0,-1),e[0].lastGravity.y*=-1,e[0].velocity=new gt(0,0),e[0].force=new gt(0,0);for(let s=1;s<t.particleCount;++s)i=new gt(0,0),i.y=e[s].radius,e[s].initialPosition=new gt(e[s-1].initialPosition.x+i.x,e[s-1].initialPosition.y+i.y),e[s].position=new gt(e[s].initialPosition.x,e[s].initialPosition.y),e[s].lastPosition=new gt(e[s].initialPosition.x,e[s].initialPosition.y),e[s].lastGravity=new gt(0,-1),e[s].lastGravity.y*=-1,e[s].velocity=new gt(0,0),e[s].force=new gt(0,0)}}},b7=class{constructor(){this.gravity=new gt(0,0),this.wind=new gt(0,0)}};function S7(n,e,t,i,r,s,o,a,l,u){n.x+=zb(t,i,r,s,o.minimum,o.maximum,o.defalut,l)*u}function E7(n,e,t,i,r,s,o,a,l,u){n.y+=zb(t,i,r,s,o.minimum,o.maximum,o.defalut,l)*u}function T7(n,e,t,i,r,s,o,a,l,u){e.angle+=zb(t,i,r,s,a.minimum,a.maximum,a.defalut,l)*u}function M7(n,e,t,i,r){let s=n.x;return i&&(s*=-1),s}function w7(n,e,t,i,r){let s=n.y;return i&&(s*=-1),s}function A7(n,e,t,i,r){let s;return t>=2?r=e[t-1].position.substract(e[t-2].position):r=r.multiplyByScaler(-1),s=Wt.directionToRadian(r,n),i&&(s*=-1),s}function P7(n,e){return Math.abs(Math.max(n,e)-Math.min(n,e))}function C7(n,e){return Math.min(n,e)+P7(n,e)/2}function R7(n,e){return n.x}function I7(n,e){return n.y}function L7(n,e){return e}function O7(n,e,t,i,r,s,o,a){let l,u,c,h,d=new gt(0,0),f=new gt(0,0),p=new gt(0,0),_=new gt(0,0);n[0].position=new gt(t.x,t.y),l=Wt.degreesToRadian(i),h=Wt.radianToDirection(l),h.normalize();for(let m=1;m<e;++m)n[m].force=h.multiplyByScaler(n[m].acceleration).add(r),n[m].lastPosition=new gt(n[m].position.x,n[m].position.y),u=n[m].delay*o*30,d=n[m].position.substract(n[m-1].position),c=Wt.directionToRadian(n[m].lastGravity,h)/a,d.x=Wt.cos(c)*d.x-d.y*Wt.sin(c),d.y=Wt.sin(c)*d.x+d.y*Wt.cos(c),n[m].position=n[m-1].position.add(d),f=n[m].velocity.multiplyByScaler(u),p=n[m].force.multiplyByScaler(u).multiplyByScaler(u),n[m].position=n[m].position.add(f).add(p),_=n[m].position.substract(n[m-1].position),_.normalize(),n[m].position=n[m-1].position.add(_.multiplyByScaler(n[m].radius)),Wt.abs(n[m].position.x)<s&&(n[m].position.x=0),u!=0&&(n[m].velocity=n[m].position.substract(n[m].lastPosition),n[m].velocity=n[m].velocity.divisionByScalar(u),n[m].velocity=n[m].velocity.multiplyByScaler(n[m].mobility)),n[m].force=new gt(0,0),n[m].lastGravity=new gt(h.x,h.y)}function D7(n,e,t,i,r){let s,o,a;s=r.getScale(r.translationScale,r.angleScale),o=i*s,o<e?(o<r.valueBelowMinimum&&(r.valueBelowMinimum=o),o=e):o>t&&(o>r.valueExceededMaximum&&(r.valueExceededMaximum=o),o=t),a=r.weight/ML,a>=1||(o=n[0]*(1-a)+o*a),n[0]=o}function zb(n,e,t,i,r,s,o,a){let l=0;const u=Wt.max(t,e);u<n&&(n=u);const c=Wt.min(t,e);c>n&&(n=c);const h=Wt.min(r,s),d=Wt.max(r,s),f=o,p=C7(c,u),_=n-p;switch(Math.sign(_)){case 1:{const m=d-f,g=u-p;g!=0&&(l=_*(m/g),l+=f);break}case-1:{const m=h-f,g=c-p;g!=0&&(l=_*(m/g),l+=f);break}case 0:{l=f;break}}return a?l:l*-1}tn.registerRuntime({version:4,ready:o7,test(n){return n instanceof Cp||Cp.isValidJSON(n)},isValidMoc(n){if(n.byteLength<4)return!1;const e=new Int8Array(n,0,4);return String.fromCharCode(...e)==="MOC3"},createModelSettings(n){return new Cp(n)},createCoreModel(n){const e=h7.create(n);try{const t=e.createModel();return t.__moc=e,t}catch(t){try{e.release()}catch{}throw t}},createInternalModel(n,e,t){const i=new s7(n,e,t),r=n;return r.__moc&&(i.__moc=r.__moc,delete r.__moc,i.once("destroy",F7)),i},createPhysics(n,e){return x7.create(e)},createPose(n,e){return u7.create(e)}});function F7(){var n;(n=this.__moc)==null||n.release()}function N7(n){var e=this.constructor;return this.then(function(t){return e.resolve(n()).then(function(){return t})},function(t){return e.resolve(n()).then(function(){return e.reject(t)})})}function U7(n){var e=this;return new e(function(t,i){if(!(n&&typeof n.length<"u"))return i(new TypeError(typeof n+" "+n+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var r=Array.prototype.slice.call(n);if(r.length===0)return t([]);var s=r.length;function o(l,u){if(u&&(typeof u=="object"||typeof u=="function")){var c=u.then;if(typeof c=="function"){c.call(u,function(h){o(l,h)},function(h){r[l]={status:"rejected",reason:h},--s===0&&t(r)});return}}r[l]={status:"fulfilled",value:u},--s===0&&t(r)}for(var a=0;a<r.length;a++)o(a,r[a])})}function AL(n,e){this.name="AggregateError",this.errors=n,this.message=e||""}AL.prototype=Error.prototype;function B7(n){var e=this;return new e(function(t,i){if(!(n&&typeof n.length<"u"))return i(new TypeError("Promise.any accepts an array"));var r=Array.prototype.slice.call(n);if(r.length===0)return i();for(var s=[],o=0;o<r.length;o++)try{e.resolve(r[o]).then(t).catch(function(a){s.push(a),s.length===r.length&&i(new AL(s,"All promises were rejected"))})}catch(a){i(a)}})}var k7=setTimeout;function PL(n){return!!(n&&typeof n.length<"u")}function V7(){}function G7(n,e){return function(){n.apply(e,arguments)}}function an(n){if(!(this instanceof an))throw new TypeError("Promises must be constructed via new");if(typeof n!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],RL(n,this)}function CL(n,e){for(;n._state===3;)n=n._value;if(n._state===0){n._deferreds.push(e);return}n._handled=!0,an._immediateFn(function(){var t=n._state===1?e.onFulfilled:e.onRejected;if(t===null){(n._state===1?z0:md)(e.promise,n._value);return}var i;try{i=t(n._value)}catch(r){md(e.promise,r);return}z0(e.promise,i)})}function z0(n,e){try{if(e===n)throw new TypeError("A promise cannot be resolved with itself.");if(e&&(typeof e=="object"||typeof e=="function")){var t=e.then;if(e instanceof an){n._state=3,n._value=e,W0(n);return}else if(typeof t=="function"){RL(G7(t,e),n);return}}n._state=1,n._value=e,W0(n)}catch(i){md(n,i)}}function md(n,e){n._state=2,n._value=e,W0(n)}function W0(n){n._state===2&&n._deferreds.length===0&&an._immediateFn(function(){n._handled||an._unhandledRejectionFn(n._value)});for(var e=0,t=n._deferreds.length;e<t;e++)CL(n,n._deferreds[e]);n._deferreds=null}function H7(n,e,t){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof e=="function"?e:null,this.promise=t}function RL(n,e){var t=!1;try{n(function(i){t||(t=!0,z0(e,i))},function(i){t||(t=!0,md(e,i))})}catch(i){if(t)return;t=!0,md(e,i)}}an.prototype.catch=function(n){return this.then(null,n)};an.prototype.then=function(n,e){var t=new this.constructor(V7);return CL(this,new H7(n,e,t)),t};an.prototype.finally=N7;an.all=function(n){return new an(function(e,t){if(!PL(n))return t(new TypeError("Promise.all accepts an array"));var i=Array.prototype.slice.call(n);if(i.length===0)return e([]);var r=i.length;function s(a,l){try{if(l&&(typeof l=="object"||typeof l=="function")){var u=l.then;if(typeof u=="function"){u.call(l,function(c){s(a,c)},t);return}}i[a]=l,--r===0&&e(i)}catch(c){t(c)}}for(var o=0;o<i.length;o++)s(o,i[o])})};an.any=B7;an.allSettled=U7;an.resolve=function(n){return n&&typeof n=="object"&&n.constructor===an?n:new an(function(e){e(n)})};an.reject=function(n){return new an(function(e,t){t(n)})};an.race=function(n){return new an(function(e,t){if(!PL(n))return t(new TypeError("Promise.race accepts an array"));for(var i=0,r=n.length;i<r;i++)an.resolve(n[i]).then(e,t)})};an._immediateFn=typeof setImmediate=="function"&&function(n){setImmediate(n)}||function(n){k7(n,0)};an._unhandledRejectionFn=function(e){typeof console<"u"&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var LM=Object.getOwnPropertySymbols,z7=Object.prototype.hasOwnProperty,W7=Object.prototype.propertyIsEnumerable;function X7(n){if(n==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(n)}function j7(){try{if(!Object.assign)return!1;var n=new String("abc");if(n[5]="de",Object.getOwnPropertyNames(n)[0]==="5")return!1;for(var e={},t=0;t<10;t++)e["_"+String.fromCharCode(t)]=t;var i=Object.getOwnPropertyNames(e).map(function(s){return e[s]});if(i.join("")!=="0123456789")return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(s){r[s]=s}),Object.keys(Object.assign({},r)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var $7=j7()?Object.assign:function(n,e){for(var t,i=X7(n),r,s=1;s<arguments.length;s++){t=Object(arguments[s]);for(var o in t)z7.call(t,o)&&(i[o]=t[o]);if(LM){r=LM(t);for(var a=0;a<r.length;a++)W7.call(t,r[a])&&(i[r[a]]=t[r[a]])}}return i};const Y7=jx($7);/*!
 * @pixi/polyfill - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/polyfill is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */typeof globalThis>"u"&&(typeof self<"u"?self.globalThis=self:typeof global<"u"&&(global.globalThis=global));globalThis.Promise||(globalThis.Promise=an);Object.assign||(Object.assign=Y7);var q7=16;Date.now&&Date.prototype.getTime||(Date.now=function(){return new Date().getTime()});if(!(globalThis.performance&&globalThis.performance.now)){var K7=Date.now();globalThis.performance||(globalThis.performance={}),globalThis.performance.now=function(){return Date.now()-K7}}var I_=Date.now(),OM=["ms","moz","webkit","o"];for(var L_=0;L_<OM.length&&!globalThis.requestAnimationFrame;++L_){var O_=OM[L_];globalThis.requestAnimationFrame=globalThis[O_+"RequestAnimationFrame"],globalThis.cancelAnimationFrame=globalThis[O_+"CancelAnimationFrame"]||globalThis[O_+"CancelRequestAnimationFrame"]}globalThis.requestAnimationFrame||(globalThis.requestAnimationFrame=function(n){if(typeof n!="function")throw new TypeError(n+"is not a function");var e=Date.now(),t=q7+I_-e;return t<0&&(t=0),I_=e,globalThis.self.setTimeout(function(){I_=Date.now(),n(performance.now())},t)});globalThis.cancelAnimationFrame||(globalThis.cancelAnimationFrame=function(n){return clearTimeout(n)});Math.sign||(Math.sign=function(e){return e=Number(e),e===0||isNaN(e)?e:e>0?1:-1});Number.isInteger||(Number.isInteger=function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e});globalThis.ArrayBuffer||(globalThis.ArrayBuffer=Array);globalThis.Float32Array||(globalThis.Float32Array=Array);globalThis.Uint32Array||(globalThis.Uint32Array=Array);globalThis.Uint16Array||(globalThis.Uint16Array=Array);globalThis.Uint8Array||(globalThis.Uint8Array=Array);globalThis.Int32Array||(globalThis.Int32Array=Array);/*!
 * @pixi/accessibility - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/accessibility is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var IL={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};cn.mixin(IL);var Z7=9,Cf=100,J7=0,Q7=0,DM=2,FM=1,eq=-1e3,tq=-1e3,nq=2,LL=function(){function n(e){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(Qi.tablet||Qi.phone)&&this.createTouchHook();var t=document.createElement("div");t.style.width=Cf+"px",t.style.height=Cf+"px",t.style.position="absolute",t.style.top=J7+"px",t.style.left=Q7+"px",t.style.zIndex=DM.toString(),this.div=t,this.renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}return Object.defineProperty(n.prototype,"isActive",{get:function(){return this._isActive},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isMobileAccessibility",{get:function(){return this._isMobileAccessibility},enumerable:!1,configurable:!0}),n.prototype.createTouchHook=function(){var e=this,t=document.createElement("button");t.style.width=FM+"px",t.style.height=FM+"px",t.style.position="absolute",t.style.top=eq+"px",t.style.left=tq+"px",t.style.zIndex=nq.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",function(){e._isMobileAccessibility=!0,e.activate(),e.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t},n.prototype.destroyTouchHook=function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)},n.prototype.activate=function(){var e;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(e=this.renderer.view.parentNode)===null||e===void 0||e.appendChild(this.div))},n.prototype.deactivate=function(){var e;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(e=this.div.parentNode)===null||e===void 0||e.removeChild(this.div))},n.prototype.updateAccessibleObjects=function(e){if(!(!e.visible||!e.accessibleChildren)){e.accessible&&e.interactive&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);var t=e.children;if(t)for(var i=0;i<t.length;i++)this.updateAccessibleObjects(t[i])}},n.prototype.update=function(){var e=performance.now();if(!(Qi.android.device&&e<this.androidUpdateCount)&&(this.androidUpdateCount=e+this.androidUpdateFrequency,!!this.renderer.renderingToScreen)){this.renderer._lastObjectRendered&&this.updateAccessibleObjects(this.renderer._lastObjectRendered);var t=this.renderer.view.getBoundingClientRect(),i=t.left,r=t.top,s=t.width,o=t.height,a=this.renderer,l=a.width,u=a.height,c=a.resolution,h=s/l*c,d=o/u*c,f=this.div;f.style.left=i+"px",f.style.top=r+"px",f.style.width=l+"px",f.style.height=u+"px";for(var p=0;p<this.children.length;p++){var _=this.children[p];if(_.renderId!==this.renderId)_._accessibleActive=!1,il(this.children,p,1),this.div.removeChild(_._accessibleDiv),this.pool.push(_._accessibleDiv),_._accessibleDiv=null,p--;else{f=_._accessibleDiv;var m=_.hitArea,g=_.worldTransform;_.hitArea?(f.style.left=(g.tx+m.x*g.a)*h+"px",f.style.top=(g.ty+m.y*g.d)*d+"px",f.style.width=m.width*g.a*h+"px",f.style.height=m.height*g.d*d+"px"):(m=_.getBounds(),this.capHitArea(m),f.style.left=m.x*h+"px",f.style.top=m.y*d+"px",f.style.width=m.width*h+"px",f.style.height=m.height*d+"px",f.title!==_.accessibleTitle&&_.accessibleTitle!==null&&(f.title=_.accessibleTitle),f.getAttribute("aria-label")!==_.accessibleHint&&_.accessibleHint!==null&&f.setAttribute("aria-label",_.accessibleHint)),(_.accessibleTitle!==f.title||_.tabIndex!==f.tabIndex)&&(f.title=_.accessibleTitle,f.tabIndex=_.tabIndex,this.debug&&this.updateDebugHTML(f))}}this.renderId++}},n.prototype.updateDebugHTML=function(e){e.innerHTML="type: "+e.type+"</br> title : "+e.title+"</br> tabIndex: "+e.tabIndex},n.prototype.capHitArea=function(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);var t=this.renderer,i=t.width,r=t.height;e.x+e.width>i&&(e.width=i-e.x),e.y+e.height>r&&(e.height=r-e.y)},n.prototype.addChild=function(e){var t=this.pool.pop();t||(t=document.createElement("button"),t.style.width=Cf+"px",t.style.height=Cf+"px",t.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",t.style.position="absolute",t.style.zIndex=DM.toString(),t.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?t.setAttribute("aria-live","off"):t.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?t.setAttribute("aria-relevant","additions"):t.setAttribute("aria-relevant","text"),t.addEventListener("click",this._onClick.bind(this)),t.addEventListener("focus",this._onFocus.bind(this)),t.addEventListener("focusout",this._onFocusOut.bind(this))),t.style.pointerEvents=e.accessiblePointerEvents,t.type=e.accessibleType,e.accessibleTitle&&e.accessibleTitle!==null?t.title=e.accessibleTitle:(!e.accessibleHint||e.accessibleHint===null)&&(t.title="displayObject "+e.tabIndex),e.accessibleHint&&e.accessibleHint!==null&&t.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(t),e._accessibleActive=!0,e._accessibleDiv=t,t.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex},n.prototype._onClick=function(e){var t=this.renderer.plugins.interaction,i=e.target.displayObject,r=t.eventData;t.dispatchEvent(i,"click",r),t.dispatchEvent(i,"pointertap",r),t.dispatchEvent(i,"tap",r)},n.prototype._onFocus=function(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive");var t=this.renderer.plugins.interaction,i=e.target.displayObject,r=t.eventData;t.dispatchEvent(i,"mouseover",r)},n.prototype._onFocusOut=function(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite");var t=this.renderer.plugins.interaction,i=e.target.displayObject,r=t.eventData;t.dispatchEvent(i,"mouseout",r)},n.prototype._onKeyDown=function(e){e.keyCode===Z7&&this.activate()},n.prototype._onMouseMove=function(e){e.movementX===0&&e.movementY===0||this.deactivate()},n.prototype.destroy=function(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},n.extension={name:"accessibility",type:[Ut.RendererPlugin,Ut.CanvasRendererPlugin]},n}();/*!
 * @pixi/interaction - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/interaction is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var X0=function(){function n(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new Bt,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return Object.defineProperty(n.prototype,"pointerId",{get:function(){return this.identifier},enumerable:!1,configurable:!0}),n.prototype.getLocalPosition=function(e,t,i){return e.worldTransform.applyInverse(i||this.global,t)},n.prototype.copyEvent=function(e){"isPrimary"in e&&e.isPrimary&&(this.isPrimary=!0),this.button="button"in e&&e.button;var t="buttons"in e&&e.buttons;this.buttons=Number.isInteger(t)?t:"which"in e&&e.which,this.width="width"in e&&e.width,this.height="height"in e&&e.height,this.tiltX="tiltX"in e&&e.tiltX,this.tiltY="tiltY"in e&&e.tiltY,this.pointerType="pointerType"in e&&e.pointerType,this.pressure="pressure"in e&&e.pressure,this.rotationAngle="rotationAngle"in e&&e.rotationAngle,this.twist="twist"in e&&e.twist||0,this.tangentialPressure="tangentialPressure"in e&&e.tangentialPressure||0},n.prototype.reset=function(){this.isPrimary=!1},n}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var j0=function(n,e){return j0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},j0(n,e)};function iq(n,e){j0(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var OL=function(){function n(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return n.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},n.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},n}(),Ip=function(){function n(e){this._pointerId=e,this._flags=n.FLAGS.NONE}return n.prototype._doSet=function(e,t){t?this._flags=this._flags|e:this._flags=this._flags&~e},Object.defineProperty(n.prototype,"pointerId",{get:function(){return this._pointerId},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"flags",{get:function(){return this._flags},set:function(e){this._flags=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"none",{get:function(){return this._flags===n.FLAGS.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"over",{get:function(){return(this._flags&n.FLAGS.OVER)!==0},set:function(e){this._doSet(n.FLAGS.OVER,e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rightDown",{get:function(){return(this._flags&n.FLAGS.RIGHT_DOWN)!==0},set:function(e){this._doSet(n.FLAGS.RIGHT_DOWN,e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"leftDown",{get:function(){return(this._flags&n.FLAGS.LEFT_DOWN)!==0},set:function(e){this._doSet(n.FLAGS.LEFT_DOWN,e)},enumerable:!1,configurable:!0}),n.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),n}(),rq=function(){function n(){this._tempPoint=new Bt}return n.prototype.recursiveFindHit=function(e,t,i,r,s){var o;if(!t||!t.visible)return!1;var a=e.data.global;s=t.interactive||s;var l=!1,u=s,c=!0;if(t.hitArea)r&&(t.worldTransform.applyInverse(a,this._tempPoint),t.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?l=!0:(r=!1,c=!1)),u=!1;else if(t._mask&&r){var h=t._mask.isMaskData?t._mask.maskObject:t._mask;h&&!(!((o=h.containsPoint)===null||o===void 0)&&o.call(h,a))&&(r=!1)}if(c&&t.interactiveChildren&&t.children)for(var d=t.children,f=d.length-1;f>=0;f--){var p=d[f],_=this.recursiveFindHit(e,p,i,r,u);if(_){if(!p.parent)continue;u=!1,_&&(e.target&&(r=!1),l=!0)}}return s&&(r&&!e.target&&!t.hitArea&&t.containsPoint&&t.containsPoint(a)&&(l=!0),t.interactive&&(l&&!e.target&&(e.target=t),i&&i(e,t,!!l))),l},n.prototype.findHit=function(e,t,i,r){this.recursiveFindHit(e,t,i,r,!1)},n}(),DL={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return this.cursor==="pointer"},set buttonMode(n){n?this.cursor="pointer":this.cursor==="pointer"&&(this.cursor=null)},cursor:null,get trackedPointers(){return this._trackedPointers===void 0&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};cn.mixin(DL);var Rf=1,If={target:null,data:{global:null}},FL=function(n){iq(e,n);function e(t,i){var r=n.call(this)||this;return i=i||{},r.renderer=t,r.autoPreventDefault=i.autoPreventDefault!==void 0?i.autoPreventDefault:!0,r.interactionFrequency=i.interactionFrequency||10,r.mouse=new X0,r.mouse.identifier=Rf,r.mouse.global.set(-999999),r.activeInteractionData={},r.activeInteractionData[Rf]=r.mouse,r.interactionDataPool=[],r.eventData=new OL,r.interactionDOMElement=null,r.moveWhenInside=!1,r.eventsAdded=!1,r.tickerAdded=!1,r.mouseOverRenderer=!("PointerEvent"in globalThis),r.supportsTouchEvents="ontouchstart"in globalThis,r.supportsPointerEvents=!!globalThis.PointerEvent,r.onPointerUp=r.onPointerUp.bind(r),r.processPointerUp=r.processPointerUp.bind(r),r.onPointerCancel=r.onPointerCancel.bind(r),r.processPointerCancel=r.processPointerCancel.bind(r),r.onPointerDown=r.onPointerDown.bind(r),r.processPointerDown=r.processPointerDown.bind(r),r.onPointerMove=r.onPointerMove.bind(r),r.processPointerMove=r.processPointerMove.bind(r),r.onPointerOut=r.onPointerOut.bind(r),r.processPointerOverOut=r.processPointerOverOut.bind(r),r.onPointerOver=r.onPointerOver.bind(r),r.cursorStyles={default:"inherit",pointer:"pointer"},r.currentCursorMode=null,r.cursor=null,r.resolution=1,r.delayedEvents=[],r.search=new rq,r._tempDisplayObject=new Bb,r._eventListenerOptions={capture:!0,passive:!1},r._useSystemTicker=i.useSystemTicker!==void 0?i.useSystemTicker:!0,r.setTargetElement(r.renderer.view,r.renderer.resolution),r}return Object.defineProperty(e.prototype,"useSystemTicker",{get:function(){return this._useSystemTicker},set:function(t){this._useSystemTicker=t,t?this.addTickerListener():this.removeTickerListener()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastObjectRendered",{get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject},enumerable:!1,configurable:!0}),e.prototype.hitTest=function(t,i){return If.target=null,If.data.global=t,i||(i=this.lastObjectRendered),this.processInteractive(If,i,null,!0),If.target},e.prototype.setTargetElement=function(t,i){i===void 0&&(i=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=t,this.resolution=i,this.addEvents(),this.addTickerListener()},e.prototype.addTickerListener=function(){this.tickerAdded||!this.interactionDOMElement||!this._useSystemTicker||(Fn.system.add(this.tickerUpdate,this,ls.INTERACTION),this.tickerAdded=!0)},e.prototype.removeTickerListener=function(){this.tickerAdded&&(Fn.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},e.prototype.addEvents=function(){if(!(this.eventsAdded||!this.interactionDOMElement)){var t=this.interactionDOMElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none"),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),globalThis.addEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),globalThis.addEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),globalThis.addEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.eventsAdded=!0}},e.prototype.removeEvents=function(){if(!(!this.eventsAdded||!this.interactionDOMElement)){var t=this.interactionDOMElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),globalThis.removeEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),globalThis.removeEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),globalThis.removeEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.interactionDOMElement=null,this.eventsAdded=!1}},e.prototype.tickerUpdate=function(t){this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())},e.prototype.update=function(){if(this.interactionDOMElement){if(this._didMove){this._didMove=!1;return}this.cursor=null;for(var t in this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(t)){var i=this.activeInteractionData[t];if(i.originalEvent&&i.pointerType!=="touch"){var r=this.configureInteractionEventForDOMEvent(this.eventData,i.originalEvent,i);this.processInteractive(r,this.lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},e.prototype.setCursorMode=function(t){t=t||"default";var i=!0;if(globalThis.OffscreenCanvas&&this.interactionDOMElement instanceof OffscreenCanvas&&(i=!1),this.currentCursorMode!==t){this.currentCursorMode=t;var r=this.cursorStyles[t];if(r)switch(typeof r){case"string":i&&(this.interactionDOMElement.style.cursor=r);break;case"function":r(t);break;case"object":i&&Object.assign(this.interactionDOMElement.style,r);break}else i&&typeof t=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.interactionDOMElement.style.cursor=t)}},e.prototype.dispatchEvent=function(t,i,r){(!r.stopPropagationHint||t===r.stopsPropagatingAt)&&(r.currentTarget=t,r.type=i,t.emit(i,r),t[i]&&t[i](r))},e.prototype.delayDispatchEvent=function(t,i,r){this.delayedEvents.push({displayObject:t,eventString:i,eventData:r})},e.prototype.mapPositionToPoint=function(t,i,r){var s;this.interactionDOMElement.parentElement?s=this.interactionDOMElement.getBoundingClientRect():s={x:0,y:0,width:this.interactionDOMElement.width,height:this.interactionDOMElement.height,left:0,top:0};var o=1/this.resolution;t.x=(i-s.left)*(this.interactionDOMElement.width/s.width)*o,t.y=(r-s.top)*(this.interactionDOMElement.height/s.height)*o},e.prototype.processInteractive=function(t,i,r,s){var o=this.search.findHit(t,i,r,s),a=this.delayedEvents;if(!a.length)return o;t.stopPropagationHint=!1;var l=a.length;this.delayedEvents=[];for(var u=0;u<l;u++){var c=a[u],h=c.displayObject,d=c.eventString,f=c.eventData;f.stopsPropagatingAt===h&&(f.stopPropagationHint=!0),this.dispatchEvent(h,d,f)}return o},e.prototype.onPointerDown=function(t){if(!(this.supportsTouchEvents&&t.pointerType==="touch")){var i=this.normalizeToPointerData(t);if(this.autoPreventDefault&&i[0].isNormalized){var r=t.cancelable||!("cancelable"in t);r&&t.preventDefault()}for(var s=i.length,o=0;o<s;o++){var a=i[o],l=this.getInteractionDataForPointerId(a),u=this.configureInteractionEventForDOMEvent(this.eventData,a,l);if(u.data.originalEvent=t,this.processInteractive(u,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",u),a.pointerType==="touch")this.emit("touchstart",u);else if(a.pointerType==="mouse"||a.pointerType==="pen"){var c=a.button===2;this.emit(c?"rightdown":"mousedown",this.eventData)}}}},e.prototype.processPointerDown=function(t,i,r){var s=t.data,o=t.data.identifier;if(r){if(i.trackedPointers[o]||(i.trackedPointers[o]=new Ip(o)),this.dispatchEvent(i,"pointerdown",t),s.pointerType==="touch")this.dispatchEvent(i,"touchstart",t);else if(s.pointerType==="mouse"||s.pointerType==="pen"){var a=s.button===2;a?i.trackedPointers[o].rightDown=!0:i.trackedPointers[o].leftDown=!0,this.dispatchEvent(i,a?"rightdown":"mousedown",t)}}},e.prototype.onPointerComplete=function(t,i,r){var s=this.normalizeToPointerData(t),o=s.length,a=t.target;t.composedPath&&t.composedPath().length>0&&(a=t.composedPath()[0]);for(var l=a!==this.interactionDOMElement?"outside":"",u=0;u<o;u++){var c=s[u],h=this.getInteractionDataForPointerId(c),d=this.configureInteractionEventForDOMEvent(this.eventData,c,h);if(d.data.originalEvent=t,this.processInteractive(d,this.lastObjectRendered,r,i||!l),this.emit(i?"pointercancel":"pointerup"+l,d),c.pointerType==="mouse"||c.pointerType==="pen"){var f=c.button===2;this.emit(f?"rightup"+l:"mouseup"+l,d)}else c.pointerType==="touch"&&(this.emit(i?"touchcancel":"touchend"+l,d),this.releaseInteractionDataForPointerId(c.pointerId))}},e.prototype.onPointerCancel=function(t){this.supportsTouchEvents&&t.pointerType==="touch"||this.onPointerComplete(t,!0,this.processPointerCancel)},e.prototype.processPointerCancel=function(t,i){var r=t.data,s=t.data.identifier;i.trackedPointers[s]!==void 0&&(delete i.trackedPointers[s],this.dispatchEvent(i,"pointercancel",t),r.pointerType==="touch"&&this.dispatchEvent(i,"touchcancel",t))},e.prototype.onPointerUp=function(t){this.supportsTouchEvents&&t.pointerType==="touch"||this.onPointerComplete(t,!1,this.processPointerUp)},e.prototype.processPointerUp=function(t,i,r){var s=t.data,o=t.data.identifier,a=i.trackedPointers[o],l=s.pointerType==="touch",u=s.pointerType==="mouse"||s.pointerType==="pen",c=!1;if(u){var h=s.button===2,d=Ip.FLAGS,f=h?d.RIGHT_DOWN:d.LEFT_DOWN,p=a!==void 0&&a.flags&f;r?(this.dispatchEvent(i,h?"rightup":"mouseup",t),p&&(this.dispatchEvent(i,h?"rightclick":"click",t),c=!0)):p&&this.dispatchEvent(i,h?"rightupoutside":"mouseupoutside",t),a&&(h?a.rightDown=!1:a.leftDown=!1)}r?(this.dispatchEvent(i,"pointerup",t),l&&this.dispatchEvent(i,"touchend",t),a&&((!u||c)&&this.dispatchEvent(i,"pointertap",t),l&&(this.dispatchEvent(i,"tap",t),a.over=!1))):a&&(this.dispatchEvent(i,"pointerupoutside",t),l&&this.dispatchEvent(i,"touchendoutside",t)),a&&a.none&&delete i.trackedPointers[o]},e.prototype.onPointerMove=function(t){if(!(this.supportsTouchEvents&&t.pointerType==="touch")){var i=this.normalizeToPointerData(t);(i[0].pointerType==="mouse"||i[0].pointerType==="pen")&&(this._didMove=!0,this.cursor=null);for(var r=i.length,s=0;s<r;s++){var o=i[s],a=this.getInteractionDataForPointerId(o),l=this.configureInteractionEventForDOMEvent(this.eventData,o,a);l.data.originalEvent=t,this.processInteractive(l,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",l),o.pointerType==="touch"&&this.emit("touchmove",l),(o.pointerType==="mouse"||o.pointerType==="pen")&&this.emit("mousemove",l)}i[0].pointerType==="mouse"&&this.setCursorMode(this.cursor)}},e.prototype.processPointerMove=function(t,i,r){var s=t.data,o=s.pointerType==="touch",a=s.pointerType==="mouse"||s.pointerType==="pen";a&&this.processPointerOverOut(t,i,r),(!this.moveWhenInside||r)&&(this.dispatchEvent(i,"pointermove",t),o&&this.dispatchEvent(i,"touchmove",t),a&&this.dispatchEvent(i,"mousemove",t))},e.prototype.onPointerOut=function(t){if(!(this.supportsTouchEvents&&t.pointerType==="touch")){var i=this.normalizeToPointerData(t),r=i[0];r.pointerType==="mouse"&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var s=this.getInteractionDataForPointerId(r),o=this.configureInteractionEventForDOMEvent(this.eventData,r,s);o.data.originalEvent=r,this.processInteractive(o,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",o),r.pointerType==="mouse"||r.pointerType==="pen"?this.emit("mouseout",o):this.releaseInteractionDataForPointerId(s.identifier)}},e.prototype.processPointerOverOut=function(t,i,r){var s=t.data,o=t.data.identifier,a=s.pointerType==="mouse"||s.pointerType==="pen",l=i.trackedPointers[o];r&&!l&&(l=i.trackedPointers[o]=new Ip(o)),l!==void 0&&(r&&this.mouseOverRenderer?(l.over||(l.over=!0,this.delayDispatchEvent(i,"pointerover",t),a&&this.delayDispatchEvent(i,"mouseover",t)),a&&this.cursor===null&&(this.cursor=i.cursor)):l.over&&(l.over=!1,this.dispatchEvent(i,"pointerout",this.eventData),a&&this.dispatchEvent(i,"mouseout",t),l.none&&delete i.trackedPointers[o]))},e.prototype.onPointerOver=function(t){if(!(this.supportsTouchEvents&&t.pointerType==="touch")){var i=this.normalizeToPointerData(t),r=i[0],s=this.getInteractionDataForPointerId(r),o=this.configureInteractionEventForDOMEvent(this.eventData,r,s);o.data.originalEvent=r,r.pointerType==="mouse"&&(this.mouseOverRenderer=!0),this.emit("pointerover",o),(r.pointerType==="mouse"||r.pointerType==="pen")&&this.emit("mouseover",o)}},e.prototype.getInteractionDataForPointerId=function(t){var i=t.pointerId,r;return i===Rf||t.pointerType==="mouse"?r=this.mouse:this.activeInteractionData[i]?r=this.activeInteractionData[i]:(r=this.interactionDataPool.pop()||new X0,r.identifier=i,this.activeInteractionData[i]=r),r.copyEvent(t),r},e.prototype.releaseInteractionDataForPointerId=function(t){var i=this.activeInteractionData[t];i&&(delete this.activeInteractionData[t],i.reset(),this.interactionDataPool.push(i))},e.prototype.configureInteractionEventForDOMEvent=function(t,i,r){return t.data=r,this.mapPositionToPoint(r.global,i.clientX,i.clientY),i.pointerType==="touch"&&(i.globalX=r.global.x,i.globalY=r.global.y),r.originalEvent=i,t.reset(),t},e.prototype.normalizeToPointerData=function(t){var i=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var r=0,s=t.changedTouches.length;r<s;r++){var o=t.changedTouches[r];typeof o.button>"u"&&(o.button=t.touches.length?1:0),typeof o.buttons>"u"&&(o.buttons=t.touches.length?1:0),typeof o.isPrimary>"u"&&(o.isPrimary=t.touches.length===1&&t.type==="touchstart"),typeof o.width>"u"&&(o.width=o.radiusX||1),typeof o.height>"u"&&(o.height=o.radiusY||1),typeof o.tiltX>"u"&&(o.tiltX=0),typeof o.tiltY>"u"&&(o.tiltY=0),typeof o.pointerType>"u"&&(o.pointerType="touch"),typeof o.pointerId>"u"&&(o.pointerId=o.identifier||0),typeof o.pressure>"u"&&(o.pressure=o.force||.5),typeof o.twist>"u"&&(o.twist=0),typeof o.tangentialPressure>"u"&&(o.tangentialPressure=0),typeof o.layerX>"u"&&(o.layerX=o.offsetX=o.clientX),typeof o.layerY>"u"&&(o.layerY=o.offsetY=o.clientY),o.isNormalized=!0,i.push(o)}else if(!globalThis.MouseEvent||t instanceof MouseEvent&&(!this.supportsPointerEvents||!(t instanceof globalThis.PointerEvent))){var a=t;typeof a.isPrimary>"u"&&(a.isPrimary=!0),typeof a.width>"u"&&(a.width=1),typeof a.height>"u"&&(a.height=1),typeof a.tiltX>"u"&&(a.tiltX=0),typeof a.tiltY>"u"&&(a.tiltY=0),typeof a.pointerType>"u"&&(a.pointerType="mouse"),typeof a.pointerId>"u"&&(a.pointerId=Rf),typeof a.pressure>"u"&&(a.pressure=.5),typeof a.twist>"u"&&(a.twist=0),typeof a.tangentialPressure>"u"&&(a.tangentialPressure=0),a.isNormalized=!0,i.push(a)}else i.push(t);return i},e.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},e.extension={name:"interaction",type:[Ut.RendererPlugin,Ut.CanvasRendererPlugin]},e}(lr);/*!
 * @pixi/extract - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/extract is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var sq=new St,oq=4,NL=function(){function n(e){this.renderer=e}return n.prototype.image=function(e,t,i){var r=new Image;return r.src=this.base64(e,t,i),r},n.prototype.base64=function(e,t,i){return this.canvas(e).toDataURL(t,i)},n.prototype.canvas=function(e,t){var i=this._rawPixels(e,t),r=i.pixels,s=i.width,o=i.height,a=i.flipY,l=new L0(s,o,1),u=l.context.getImageData(0,0,s,o);if(n.arrayPostDivide(r,u.data),l.context.putImageData(u,0,0),a){var c=new L0(l.width,l.height,1);c.context.scale(1,-1),c.context.drawImage(l.canvas,0,-o),l.destroy(),l=c}return l.canvas},n.prototype.pixels=function(e,t){var i=this._rawPixels(e,t).pixels;return n.arrayPostDivide(i,i),i},n.prototype._rawPixels=function(e,t){var i=this.renderer,r,s=!1,o,a=!1;if(e)if(e instanceof zo)o=e;else{var l=i.context.webGLVersion>=2?i.multisample:Jt.NONE;if(o=this.renderer.generateTexture(e,{multisample:l}),l!==Jt.NONE){var u=zo.create({width:o.width,height:o.height});i.framebuffer.bind(o.framebuffer),i.framebuffer.blit(u.framebuffer),i.framebuffer.bind(null),o.destroy(!0),o=u}a=!0}o?(r=o.baseTexture.resolution,t=t??o.frame,s=!1,i.renderTexture.bind(o)):(r=i.resolution,t||(t=sq,t.width=i.width,t.height=i.height),s=!0,i.renderTexture.bind(null));var c=Math.round(t.width*r),h=Math.round(t.height*r),d=new Uint8Array(oq*c*h),f=i.gl;return f.readPixels(Math.round(t.x*r),Math.round(t.y*r),c,h,f.RGBA,f.UNSIGNED_BYTE,d),a&&o.destroy(!0),{pixels:d,width:c,height:h,flipY:s}},n.prototype.destroy=function(){this.renderer=null},n.arrayPostDivide=function(e,t){for(var i=0;i<e.length;i+=4){var r=t[i+3]=e[i+3];r!==0?(t[i]=Math.round(Math.min(e[i]*255/r,255)),t[i+1]=Math.round(Math.min(e[i+1]*255/r,255)),t[i+2]=Math.round(Math.min(e[i+2]*255/r,255))):(t[i]=e[i],t[i+1]=e[i+1],t[i+2]=e[i+2])}},n.extension={name:"extract",type:Ut.RendererPlugin},n}();/*!
 * @pixi/loaders - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/loaders is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Lf=function(){function n(e,t,i){t===void 0&&(t=!1),this._fn=e,this._once=t,this._thisArg=i,this._next=this._prev=this._owner=null}return n.prototype.detach=function(){return this._owner===null?!1:(this._owner.detach(this),!0)},n}();function NM(n,e){return n._head?(n._tail._next=e,e._prev=n._tail,n._tail=e):(n._head=e,n._tail=e),e._owner=n,e}var Ds=function(){function n(){this._head=this._tail=void 0}return n.prototype.handlers=function(e){e===void 0&&(e=!1);var t=this._head;if(e)return!!t;for(var i=[];t;)i.push(t),t=t._next;return i},n.prototype.has=function(e){if(!(e instanceof Lf))throw new Error("MiniSignal#has(): First arg must be a SignalBinding object.");return e._owner===this},n.prototype.dispatch=function(){for(var e=arguments,t=[],i=0;i<arguments.length;i++)t[i]=e[i];var r=this._head;if(!r)return!1;for(;r;)r._once&&this.detach(r),r._fn.apply(r._thisArg,t),r=r._next;return!0},n.prototype.add=function(e,t){if(t===void 0&&(t=null),typeof e!="function")throw new Error("MiniSignal#add(): First arg must be a Function.");return NM(this,new Lf(e,!1,t))},n.prototype.once=function(e,t){if(t===void 0&&(t=null),typeof e!="function")throw new Error("MiniSignal#once(): First arg must be a Function.");return NM(this,new Lf(e,!0,t))},n.prototype.detach=function(e){if(!(e instanceof Lf))throw new Error("MiniSignal#detach(): First arg must be a SignalBinding object.");return e._owner!==this?this:(e._prev&&(e._prev._next=e._next),e._next&&(e._next._prev=e._prev),e===this._head?(this._head=e._next,e._next===null&&(this._tail=null)):e===this._tail&&(this._tail=e._prev,this._tail._next=null),e._owner=null,this)},n.prototype.detachAll=function(){var e=this._head;if(!e)return this;for(this._head=this._tail=null;e;)e._owner=null,e=e._next;return this},n}();function UL(n,e){e=e||{};for(var t={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},i=t.parser[e.strictMode?"strict":"loose"].exec(n),r={},s=14;s--;)r[t.key[s]]=i[s]||"";return r[t.q.name]={},r[t.key[12]].replace(t.q.parser,function(o,a,l){a&&(r[t.q.name][a]=l)}),r}var D_,Of=null,aq=0,UM=200,lq=204,uq=1223,cq=2;function BM(){}function kM(n,e,t){e&&e.indexOf(".")===0&&(e=e.substring(1)),e&&(n[e]=t)}function F_(n){return n.toString().replace("object ","")}var on=function(){function n(e,t,i){if(this._dequeue=BM,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=null,this._boundOnError=null,this._boundOnProgress=null,this._boundOnTimeout=null,this._boundXhrOnError=null,this._boundXhrOnTimeout=null,this._boundXhrOnAbort=null,this._boundXhrOnLoad=null,typeof e!="string"||typeof t!="string")throw new Error("Both name and url are required for constructing a resource.");i=i||{},this._flags=0,this._setFlag(n.STATUS_FLAGS.DATA_URL,t.indexOf("data:")===0),this.name=e,this.url=t,this.extension=this._getExtension(),this.data=null,this.crossOrigin=i.crossOrigin===!0?"anonymous":i.crossOrigin,this.timeout=i.timeout||0,this.loadType=i.loadType||this._determineLoadType(),this.xhrType=i.xhrType,this.metadata=i.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=n.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=BM,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new Ds,this.onProgress=new Ds,this.onComplete=new Ds,this.onAfterMiddleware=new Ds}return n.setExtensionLoadType=function(e,t){kM(n._loadTypeMap,e,t)},n.setExtensionXhrType=function(e,t){kM(n._xhrTypeMap,e,t)},Object.defineProperty(n.prototype,"isDataUrl",{get:function(){return this._hasFlag(n.STATUS_FLAGS.DATA_URL)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isComplete",{get:function(){return this._hasFlag(n.STATUS_FLAGS.COMPLETE)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isLoading",{get:function(){return this._hasFlag(n.STATUS_FLAGS.LOADING)},enumerable:!1,configurable:!0}),n.prototype.complete=function(){this._clearEvents(),this._finish()},n.prototype.abort=function(e){if(!this.error){if(this.error=new Error(e),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=n.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},n.prototype.load=function(e){var t=this;if(!this.isLoading){if(this.isComplete){e&&setTimeout(function(){return e(t)},1);return}else e&&this.onComplete.once(e);switch(this._setFlag(n.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),(this.crossOrigin===!1||typeof this.crossOrigin!="string")&&(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case n.LOAD_TYPE.IMAGE:this.type=n.TYPE.IMAGE,this._loadElement("image");break;case n.LOAD_TYPE.AUDIO:this.type=n.TYPE.AUDIO,this._loadSourceElement("audio");break;case n.LOAD_TYPE.VIDEO:this.type=n.TYPE.VIDEO,this._loadSourceElement("video");break;case n.LOAD_TYPE.XHR:default:typeof D_>"u"&&(D_=!!(globalThis.XDomainRequest&&!("withCredentials"in new XMLHttpRequest))),D_&&this.crossOrigin?this._loadXdr():this._loadXhr();break}}},n.prototype._hasFlag=function(e){return(this._flags&e)!==0},n.prototype._setFlag=function(e,t){this._flags=t?this._flags|e:this._flags&~e},n.prototype._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},n.prototype._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(n.STATUS_FLAGS.COMPLETE,!0),this._setFlag(n.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},n.prototype._loadElement=function(e){this.metadata.loadElement?this.data=this.metadata.loadElement:e==="image"&&typeof globalThis.Image<"u"?this.data=new Image:this.data=document.createElement(e),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},n.prototype._loadSourceElement=function(e){if(this.metadata.loadElement?this.data=this.metadata.loadElement:e==="audio"&&typeof globalThis.Audio<"u"?this.data=new Audio:this.data=document.createElement(e),this.data===null){this.abort("Unsupported element: "+e);return}if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var t=this.metadata.mimeType,i=0;i<this.url.length;++i)this.data.appendChild(this._createSource(e,this.url[i],Array.isArray(t)?t[i]:t));else{var t=this.metadata.mimeType;this.data.appendChild(this._createSource(e,this.url,Array.isArray(t)?t[0]:t))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},n.prototype._loadXhr=function(){typeof this.xhrType!="string"&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XMLHttpRequest;this.crossOrigin==="use-credentials"&&(e.withCredentials=!0),e.open("GET",this.url,!0),e.timeout=this.timeout,this.xhrType===n.XHR_RESPONSE_TYPE.JSON||this.xhrType===n.XHR_RESPONSE_TYPE.DOCUMENT?e.responseType=n.XHR_RESPONSE_TYPE.TEXT:e.responseType=this.xhrType,e.addEventListener("error",this._boundXhrOnError,!1),e.addEventListener("timeout",this._boundXhrOnTimeout,!1),e.addEventListener("abort",this._boundXhrOnAbort,!1),e.addEventListener("progress",this._boundOnProgress,!1),e.addEventListener("load",this._boundXhrOnLoad,!1),e.send()},n.prototype._loadXdr=function(){typeof this.xhrType!="string"&&(this.xhrType=this._determineXhrType());var e=this.xhr=new globalThis.XDomainRequest;e.timeout=this.timeout||5e3,e.onerror=this._boundXhrOnError,e.ontimeout=this._boundXhrOnTimeout,e.onprogress=this._boundOnProgress,e.onload=this._boundXhrOnLoad,e.open("GET",this.url,!0),setTimeout(function(){return e.send()},1)},n.prototype._createSource=function(e,t,i){i||(i=e+"/"+this._getExtension(t));var r=document.createElement("source");return r.src=t,r.type=i,r},n.prototype._onError=function(e){this.abort("Failed to load element using: "+e.target.nodeName)},n.prototype._onProgress=function(e){e&&e.lengthComputable&&this.onProgress.dispatch(this,e.loaded/e.total)},n.prototype._onTimeout=function(){this.abort("Load timed out.")},n.prototype._xhrOnError=function(){var e=this.xhr;this.abort(F_(e)+" Request failed. Status: "+e.status+', text: "'+e.statusText+'"')},n.prototype._xhrOnTimeout=function(){var e=this.xhr;this.abort(F_(e)+" Request timed out.")},n.prototype._xhrOnAbort=function(){var e=this.xhr;this.abort(F_(e)+" Request was aborted by the user.")},n.prototype._xhrOnLoad=function(){var e=this.xhr,t="",i=typeof e.status>"u"?UM:e.status;(e.responseType===""||e.responseType==="text"||typeof e.responseType>"u")&&(t=e.responseText),i===aq&&(t.length>0||e.responseType===n.XHR_RESPONSE_TYPE.BUFFER)?i=UM:i===uq&&(i=lq);var r=i/100|0;if(r===cq)if(this.xhrType===n.XHR_RESPONSE_TYPE.TEXT)this.data=t,this.type=n.TYPE.TEXT;else if(this.xhrType===n.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(t),this.type=n.TYPE.JSON}catch(a){this.abort("Error trying to parse loaded json: "+a);return}else if(this.xhrType===n.XHR_RESPONSE_TYPE.DOCUMENT)try{if(globalThis.DOMParser){var s=new DOMParser;this.data=s.parseFromString(t,"text/xml")}else{var o=document.createElement("div");o.innerHTML=t,this.data=o}this.type=n.TYPE.XML}catch(a){this.abort("Error trying to parse loaded xml: "+a);return}else this.data=e.response||t;else{this.abort("["+e.status+"] "+e.statusText+": "+e.responseURL);return}this.complete()},n.prototype._determineCrossOrigin=function(e,t){if(e.indexOf("data:")===0)return"";if(globalThis.origin!==globalThis.location.origin)return"anonymous";t=t||globalThis.location,Of||(Of=document.createElement("a")),Of.href=e;var i=UL(Of.href,{strictMode:!0}),r=!i.port&&t.port===""||i.port===t.port,s=i.protocol?i.protocol+":":"";return i.host!==t.hostname||!r||s!==t.protocol?"anonymous":""},n.prototype._determineXhrType=function(){return n._xhrTypeMap[this.extension]||n.XHR_RESPONSE_TYPE.TEXT},n.prototype._determineLoadType=function(){return n._loadTypeMap[this.extension]||n.LOAD_TYPE.XHR},n.prototype._getExtension=function(e){e===void 0&&(e=this.url);var t="";if(this.isDataUrl){var i=e.indexOf("/");t=e.substring(i+1,e.indexOf(";",i))}else{var r=e.indexOf("?"),s=e.indexOf("#"),o=Math.min(r>-1?r:e.length,s>-1?s:e.length);e=e.substring(0,o),t=e.substring(e.lastIndexOf(".")+1)}return t.toLowerCase()},n.prototype._getMimeFromXhrType=function(e){switch(e){case n.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case n.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case n.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case n.XHR_RESPONSE_TYPE.JSON:return"application/json";case n.XHR_RESPONSE_TYPE.DEFAULT:case n.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},n}();(function(n){(function(e){e[e.NONE=0]="NONE",e[e.DATA_URL=1]="DATA_URL",e[e.COMPLETE=2]="COMPLETE",e[e.LOADING=4]="LOADING"})(n.STATUS_FLAGS||(n.STATUS_FLAGS={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.JSON=1]="JSON",e[e.XML=2]="XML",e[e.IMAGE=3]="IMAGE",e[e.AUDIO=4]="AUDIO",e[e.VIDEO=5]="VIDEO",e[e.TEXT=6]="TEXT"}(n.TYPE||(n.TYPE={})),function(e){e[e.XHR=1]="XHR",e[e.IMAGE=2]="IMAGE",e[e.AUDIO=3]="AUDIO",e[e.VIDEO=4]="VIDEO"}(n.LOAD_TYPE||(n.LOAD_TYPE={})),function(e){e.DEFAULT="text",e.BUFFER="arraybuffer",e.BLOB="blob",e.DOCUMENT="document",e.JSON="json",e.TEXT="text"}(n.XHR_RESPONSE_TYPE||(n.XHR_RESPONSE_TYPE={})),n._loadTypeMap={gif:n.LOAD_TYPE.IMAGE,png:n.LOAD_TYPE.IMAGE,bmp:n.LOAD_TYPE.IMAGE,jpg:n.LOAD_TYPE.IMAGE,jpeg:n.LOAD_TYPE.IMAGE,tif:n.LOAD_TYPE.IMAGE,tiff:n.LOAD_TYPE.IMAGE,webp:n.LOAD_TYPE.IMAGE,tga:n.LOAD_TYPE.IMAGE,avif:n.LOAD_TYPE.IMAGE,svg:n.LOAD_TYPE.IMAGE,"svg+xml":n.LOAD_TYPE.IMAGE,mp3:n.LOAD_TYPE.AUDIO,ogg:n.LOAD_TYPE.AUDIO,wav:n.LOAD_TYPE.AUDIO,mp4:n.LOAD_TYPE.VIDEO,webm:n.LOAD_TYPE.VIDEO},n._xhrTypeMap={xhtml:n.XHR_RESPONSE_TYPE.DOCUMENT,html:n.XHR_RESPONSE_TYPE.DOCUMENT,htm:n.XHR_RESPONSE_TYPE.DOCUMENT,xml:n.XHR_RESPONSE_TYPE.DOCUMENT,tmx:n.XHR_RESPONSE_TYPE.DOCUMENT,svg:n.XHR_RESPONSE_TYPE.DOCUMENT,tsx:n.XHR_RESPONSE_TYPE.DOCUMENT,gif:n.XHR_RESPONSE_TYPE.BLOB,png:n.XHR_RESPONSE_TYPE.BLOB,bmp:n.XHR_RESPONSE_TYPE.BLOB,jpg:n.XHR_RESPONSE_TYPE.BLOB,jpeg:n.XHR_RESPONSE_TYPE.BLOB,tif:n.XHR_RESPONSE_TYPE.BLOB,tiff:n.XHR_RESPONSE_TYPE.BLOB,webp:n.XHR_RESPONSE_TYPE.BLOB,tga:n.XHR_RESPONSE_TYPE.BLOB,avif:n.XHR_RESPONSE_TYPE.BLOB,json:n.XHR_RESPONSE_TYPE.JSON,text:n.XHR_RESPONSE_TYPE.TEXT,txt:n.XHR_RESPONSE_TYPE.TEXT,ttf:n.XHR_RESPONSE_TYPE.BUFFER,otf:n.XHR_RESPONSE_TYPE.BUFFER},n.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="})(on||(on={}));function ca(){}function hq(n){return function(){for(var t=arguments,i=[],r=0;r<arguments.length;r++)i[r]=t[r];if(n===null)throw new Error("Callback was already called.");var s=n;n=null,s.apply(this,i)}}var dq=function(){function n(e,t){this.data=e,this.callback=t}return n}(),N_=function(){function n(e,t){var i=this;if(t===void 0&&(t=1),this.workers=0,this.saturated=ca,this.unsaturated=ca,this.empty=ca,this.drain=ca,this.error=ca,this.started=!1,this.paused=!1,this._tasks=[],this._insert=function(r,s,o){if(o&&typeof o!="function")throw new Error("task callback must be a function");if(i.started=!0,r==null&&i.idle()){setTimeout(function(){return i.drain()},1);return}var a=new dq(r,typeof o=="function"?o:ca);s?i._tasks.unshift(a):i._tasks.push(a),setTimeout(i.process,1)},this.process=function(){for(;!i.paused&&i.workers<i.concurrency&&i._tasks.length;){var r=i._tasks.shift();i._tasks.length===0&&i.empty(),i.workers+=1,i.workers===i.concurrency&&i.saturated(),i._worker(r.data,hq(i._next(r)))}},this._worker=e,t===0)throw new Error("Concurrency must not be zero");this.concurrency=t,this.buffer=t/4}return n.prototype._next=function(e){var t=this;return function(){for(var i=arguments,r=[],s=0;s<arguments.length;s++)r[s]=i[s];t.workers-=1,e.callback.apply(e,r),r[0]!=null&&t.error(r[0],e.data),t.workers<=t.concurrency-t.buffer&&t.unsaturated(),t.idle()&&t.drain(),t.process()}},n.prototype.push=function(e,t){this._insert(e,!1,t)},n.prototype.kill=function(){this.workers=0,this.drain=ca,this.started=!1,this._tasks=[]},n.prototype.unshift=function(e,t){this._insert(e,!0,t)},n.prototype.length=function(){return this._tasks.length},n.prototype.running=function(){return this.workers},n.prototype.idle=function(){return this._tasks.length+this.workers===0},n.prototype.pause=function(){this.paused!==!0&&(this.paused=!0)},n.prototype.resume=function(){if(this.paused!==!1){this.paused=!1;for(var e=1;e<=this.concurrency;e++)this.process()}},n.eachSeries=function(e,t,i,r){var s=0,o=e.length;function a(l){if(l||s===o){i&&i(l);return}r?setTimeout(function(){t(e[s++],a)},1):t(e[s++],a)}a()},n.queue=function(e,t){return new n(e,t)},n}(),U_=100,fq=/(#[\w-]+)?$/,gd=function(){function n(e,t){var i=this;e===void 0&&(e=""),t===void 0&&(t=10),this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(l,u){return i._loadResource(l,u)},this.resources={},this.baseUrl=e,this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(l,u){return i._loadResource(l,u)},this._queue=N_.queue(this._boundLoadResource,t),this._queue.pause(),this.resources={},this.onProgress=new Ds,this.onError=new Ds,this.onLoad=new Ds,this.onStart=new Ds,this.onComplete=new Ds;for(var r=0;r<n._plugins.length;++r){var s=n._plugins[r],o=s.pre,a=s.use;o&&this.pre(o),a&&this.use(a)}this._protected=!1}return n.prototype._add=function(e,t,i,r){if(this.loading&&(!i||!i.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[e])throw new Error('Resource named "'+e+'" already exists.');if(t=this._prepareUrl(t),this.resources[e]=new on(e,t,i),typeof r=="function"&&this.resources[e].onAfterMiddleware.once(r),this.loading){for(var s=i.parentResource,o=[],a=0;a<s.children.length;++a)s.children[a].isComplete||o.push(s.children[a]);var l=s.progressChunk*(o.length+1),u=l/(o.length+2);s.children.push(this.resources[e]),s.progressChunk=u;for(var a=0;a<o.length;++a)o[a].progressChunk=u;this.resources[e].progressChunk=u}return this._queue.push(this.resources[e]),this},n.prototype.pre=function(e){return this._beforeMiddleware.push(e),this},n.prototype.use=function(e){return this._afterMiddleware.push(e),this},n.prototype.reset=function(){this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause();for(var e in this.resources){var t=this.resources[e];t._onLoadBinding&&t._onLoadBinding.detach(),t.isLoading&&t.abort("loader reset")}return this.resources={},this},n.prototype.load=function(e){if(ai("6.5.0","@pixi/loaders is being replaced with @pixi/assets in the next major release."),typeof e=="function"&&this.onComplete.once(e),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var t=this._queue._tasks.length,i=U_/t,r=0;r<this._queue._tasks.length;++r)this._queue._tasks[r].data.progressChunk=i;this._onStart(),this._queue.resume()}return this},Object.defineProperty(n.prototype,"concurrency",{get:function(){return this._queue.concurrency},set:function(e){this._queue.concurrency=e},enumerable:!1,configurable:!0}),n.prototype._prepareUrl=function(e){var t=UL(e,{strictMode:!0}),i;if(t.protocol||!t.path||e.indexOf("//")===0?i=e:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&e.charAt(0)!=="/"?i=this.baseUrl+"/"+e:i=this.baseUrl+e,this.defaultQueryString){var r=fq.exec(i)[0];i=i.slice(0,i.length-r.length),i.indexOf("?")!==-1?i+="&"+this.defaultQueryString:i+="?"+this.defaultQueryString,i+=r}return i},n.prototype._loadResource=function(e,t){var i=this;e._dequeue=t,N_.eachSeries(this._beforeMiddleware,function(r,s){r.call(i,e,function(){s(e.isComplete?{}:null)})},function(){e.isComplete?i._onLoad(e):(e._onLoadBinding=e.onComplete.once(i._onLoad,i),e.load())},!0)},n.prototype._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},n.prototype._onComplete=function(){this.progress=U_,this.loading=!1,this.onComplete.dispatch(this,this.resources)},n.prototype._onLoad=function(e){var t=this;e._onLoadBinding=null,this._resourcesParsing.push(e),e._dequeue(),N_.eachSeries(this._afterMiddleware,function(i,r){i.call(t,e,r)},function(){e.onAfterMiddleware.dispatch(e),t.progress=Math.min(U_,t.progress+e.progressChunk),t.onProgress.dispatch(t,e),e.error?t.onError.dispatch(e.error,t,e):t.onLoad.dispatch(t,e),t._resourcesParsing.splice(t._resourcesParsing.indexOf(e),1),t._queue.idle()&&t._resourcesParsing.length===0&&t._onComplete()},!0)},n.prototype.destroy=function(){this._protected||this.reset()},Object.defineProperty(n,"shared",{get:function(){var e=n._shared;return e||(e=new n,e._protected=!0,n._shared=e),e},enumerable:!1,configurable:!0}),n.registerPlugin=function(e){return ai("6.5.0","Loader.registerPlugin() is deprecated, use extensions.add() instead."),ds.add({type:Ut.Loader,ref:e}),n},n._plugins=[],n}();ds.handleByList(Ut.Loader,gd._plugins);gd.prototype.add=function(e,t,i,r){if(Array.isArray(e)){for(var s=0;s<e.length;++s)this.add(e[s]);return this}if(typeof e=="object"&&(i=e,r=t||i.callback||i.onComplete,t=i.url,e=i.name||i.key||i.url),typeof t!="string"&&(r=i,i=t,t=e),typeof t!="string")throw new Error("No url passed to add resource to loader.");return typeof i=="function"&&(r=i,i=null),this._add(e,t,i,r)};var BL=function(){function n(){}return n.init=function(e){e=Object.assign({sharedLoader:!1},e),this.loader=e.sharedLoader?gd.shared:new gd},n.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},n.extension=Ut.Application,n}(),kL=function(){function n(){}return n.add=function(){on.setExtensionLoadType("svg",on.LOAD_TYPE.XHR),on.setExtensionXhrType("svg",on.XHR_RESPONSE_TYPE.TEXT)},n.use=function(e,t){if(e.data&&(e.type===on.TYPE.IMAGE||e.extension==="svg")){var i=e.data,r=e.url,s=e.name,o=e.metadata;Ke.fromLoader(i,r,s,o).then(function(a){e.texture=a,t()}).catch(t)}else t()},n.extension=Ut.Loader,n}(),pq="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function mq(n){for(var e="",t=0;t<n.length;){for(var i=[0,0,0],r=[0,0,0,0],s=0;s<i.length;++s)t<n.length?i[s]=n.charCodeAt(t++)&255:i[s]=0;r[0]=i[0]>>2,r[1]=(i[0]&3)<<4|i[1]>>4,r[2]=(i[1]&15)<<2|i[2]>>6,r[3]=i[2]&63;var o=t-(n.length-1);switch(o){case 2:r[3]=64,r[2]=64;break;case 1:r[3]=64;break}for(var s=0;s<r.length;++s)e+=pq.charAt(r[s])}return e}function gq(n,e){if(!n.data){e();return}if(n.xhr&&n.xhrType===on.XHR_RESPONSE_TYPE.BLOB){if(!self.Blob||typeof n.data=="string"){var t=n.xhr.getResponseHeader("content-type");if(t&&t.indexOf("image")===0){n.data=new Image,n.data.src="data:"+t+";base64,"+mq(n.xhr.responseText),n.type=on.TYPE.IMAGE,n.data.onload=function(){n.data.onload=null,e()};return}}else if(n.data.type.indexOf("image")===0){var i=globalThis.URL||globalThis.webkitURL,r=i.createObjectURL(n.data);n.blob=n.data,n.data=new Image,n.data.src=r,n.type=on.TYPE.IMAGE,n.data.onload=function(){i.revokeObjectURL(r),n.data.onload=null,e()};return}}e()}var _q=function(){function n(){}return n.extension=Ut.Loader,n.use=gq,n}();ds.add(kL,_q);/*!
 * @pixi/compressed-textures - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/compressed-textures is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Ot,at;(function(n){n[n.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",n[n.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",n[n.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",n[n.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",n[n.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",n[n.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",n[n.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",n[n.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",n[n.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",n[n.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",n[n.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",n[n.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",n[n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",n[n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",n[n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",n[n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",n[n.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",n[n.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",n[n.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",n[n.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",n[n.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR"})(at||(at={}));var _d=(Ot={},Ot[at.COMPRESSED_RGB_S3TC_DXT1_EXT]=.5,Ot[at.COMPRESSED_RGBA_S3TC_DXT1_EXT]=.5,Ot[at.COMPRESSED_RGBA_S3TC_DXT3_EXT]=1,Ot[at.COMPRESSED_RGBA_S3TC_DXT5_EXT]=1,Ot[at.COMPRESSED_SRGB_S3TC_DXT1_EXT]=.5,Ot[at.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT]=.5,Ot[at.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT]=1,Ot[at.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT]=1,Ot[at.COMPRESSED_R11_EAC]=.5,Ot[at.COMPRESSED_SIGNED_R11_EAC]=.5,Ot[at.COMPRESSED_RG11_EAC]=1,Ot[at.COMPRESSED_SIGNED_RG11_EAC]=1,Ot[at.COMPRESSED_RGB8_ETC2]=.5,Ot[at.COMPRESSED_RGBA8_ETC2_EAC]=1,Ot[at.COMPRESSED_SRGB8_ETC2]=.5,Ot[at.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC]=1,Ot[at.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,Ot[at.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,Ot[at.COMPRESSED_RGB_PVRTC_4BPPV1_IMG]=.5,Ot[at.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG]=.5,Ot[at.COMPRESSED_RGB_PVRTC_2BPPV1_IMG]=.25,Ot[at.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG]=.25,Ot[at.COMPRESSED_RGB_ETC1_WEBGL]=.5,Ot[at.COMPRESSED_RGB_ATC_WEBGL]=.5,Ot[at.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL]=1,Ot[at.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL]=1,Ot[at.COMPRESSED_RGBA_ASTC_4x4_KHR]=1,Ot);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var $0=function(n,e){return $0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},$0(n,e)};function VL(n,e){$0(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function vq(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(c){try{u(i.next(c))}catch(h){o(h)}}function l(c){try{u(i.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(a,l)}u((i=i.apply(n,e||[])).next())})}function yq(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,r,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(c){return l([u,c])}}function l(u){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,r&&(s=u[0]&2?r.return:u[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,u[1])).done)return s;switch(r=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,r=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(n,t)}catch(c){u=[6,c],r=0}finally{i=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var GL=function(n){VL(e,n);function e(t,i){i===void 0&&(i={width:1,height:1,autoLoad:!0});var r=this,s,o;return typeof t=="string"?(s=t,o=new Uint8Array):(s=null,o=t),r=n.call(this,o,i)||this,r.origin=s,r.buffer=o?new am(o):null,r.origin&&i.autoLoad!==!1&&r.load(),o&&o.length&&(r.loaded=!0,r.onBlobLoaded(r.buffer.rawBinaryData)),r}return e.prototype.onBlobLoaded=function(t){},e.prototype.load=function(){return vq(this,void 0,Promise,function(){var t,i,r;return yq(this,function(s){switch(s.label){case 0:return[4,fetch(this.origin)];case 1:return t=s.sent(),[4,t.blob()];case 2:return i=s.sent(),[4,i.arrayBuffer()];case 3:return r=s.sent(),this.data=new Uint32Array(r),this.buffer=new am(r),this.loaded=!0,this.onBlobLoaded(r),this.update(),[2,this]}})})},e}(Sl),um=function(n){VL(e,n);function e(t,i){var r=n.call(this,t,i)||this;return r.format=i.format,r.levels=i.levels||1,r._width=i.width,r._height=i.height,r._extension=e._formatToExtension(r.format),(i.levelBuffers||r.buffer)&&(r._levelBuffers=i.levelBuffers||e._createLevelBuffers(t instanceof Uint8Array?t:r.buffer.uint8View,r.format,r.levels,4,4,r.width,r.height)),r}return e.prototype.upload=function(t,i,r){var s=t.gl,o=t.context.extensions[this._extension];if(!o)throw new Error(this._extension+" textures are not supported on the current machine");if(!this._levelBuffers)return!1;for(var a=0,l=this.levels;a<l;a++){var u=this._levelBuffers[a],c=u.levelID,h=u.levelWidth,d=u.levelHeight,f=u.levelBuffer;s.compressedTexImage2D(s.TEXTURE_2D,c,this.format,h,d,0,f)}return!0},e.prototype.onBlobLoaded=function(){this._levelBuffers=e._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)},e._formatToExtension=function(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")},e._createLevelBuffers=function(t,i,r,s,o,a,l){for(var u=new Array(r),c=t.byteOffset,h=a,d=l,f=h+s-1&~(s-1),p=d+o-1&~(o-1),_=f*p*_d[i],m=0;m<r;m++)u[m]={levelID:m,levelWidth:r>1?h:f,levelHeight:r>1?d:p,levelBuffer:new Uint8Array(t.buffer,c,_)},c+=_,h=h>>1||1,d=d>>1||1,f=h+s-1&~(s-1),p=d+o-1&~(o-1),_=f*p*_d[i];return u},e}(GL),HL=function(){function n(){}return n.use=function(e,t){var i=e.data,r=this;if(e.type===on.TYPE.JSON&&i&&i.cacheID&&i.textures){for(var s=i.textures,o=void 0,a=void 0,l=0,u=s.length;l<u;l++){var c=s[l],h=c.src,d=c.format;if(d||(a=h),n.textureFormats[d]){o=h;break}}if(o=o||a,!o){t(new Error("Cannot load compressed-textures in "+e.url+", make sure you provide a fallback"));return}if(o===e.url){t(new Error("URL of compressed texture cannot be the same as the manifest's URL"));return}var f={crossOrigin:e.crossOrigin,metadata:e.metadata.imageMetadata,parentResource:e},p=Ci.resolve(e.url.replace(r.baseUrl,""),o),_=i.cacheID;r.add(_,p,f,function(m){if(m.error){t(m.error);return}var g=m.texture,v=g===void 0?null:g,y=m.textures,x=y===void 0?{}:y;Object.assign(e,{texture:v,textures:x}),t()})}else t()},Object.defineProperty(n,"textureExtensions",{get:function(){if(!n._textureExtensions){var e=Oe.ADAPTER.createCanvas(),t=e.getContext("webgl");if(!t)return console.warn("WebGL not available for compressed textures. Silently failing."),{};var i={s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};n._textureExtensions=i}return n._textureExtensions},enumerable:!1,configurable:!0}),Object.defineProperty(n,"textureFormats",{get:function(){if(!n._textureFormats){var e=n.textureExtensions;n._textureFormats={};for(var t in e){var i=e[t];i&&Object.assign(n._textureFormats,Object.getPrototypeOf(i))}}return n._textureFormats},enumerable:!1,configurable:!0}),n.extension=Ut.Loader,n}();function zL(n,e,t){var i={textures:{},texture:null};if(!e)return i;var r=e.map(function(s){return new Ke(new xt(s,Object.assign({mipmap:or.OFF,alphaMode:ar.NO_PREMULTIPLIED_ALPHA},t)))});return r.forEach(function(s,o){var a=s.baseTexture,l=n+"-"+(o+1);xt.addToCache(a,l),Ke.addToCache(s,l),o===0&&(xt.addToCache(a,n),Ke.addToCache(s,n),i.texture=s),i.textures[l]=s}),i}var Wc,dr,B_=4,Df=124,xq=32,VM=20,bq=542327876,Ff={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},Sq={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},Nf={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},yr;(function(n){n[n.DXGI_FORMAT_UNKNOWN=0]="DXGI_FORMAT_UNKNOWN",n[n.DXGI_FORMAT_R32G32B32A32_TYPELESS=1]="DXGI_FORMAT_R32G32B32A32_TYPELESS",n[n.DXGI_FORMAT_R32G32B32A32_FLOAT=2]="DXGI_FORMAT_R32G32B32A32_FLOAT",n[n.DXGI_FORMAT_R32G32B32A32_UINT=3]="DXGI_FORMAT_R32G32B32A32_UINT",n[n.DXGI_FORMAT_R32G32B32A32_SINT=4]="DXGI_FORMAT_R32G32B32A32_SINT",n[n.DXGI_FORMAT_R32G32B32_TYPELESS=5]="DXGI_FORMAT_R32G32B32_TYPELESS",n[n.DXGI_FORMAT_R32G32B32_FLOAT=6]="DXGI_FORMAT_R32G32B32_FLOAT",n[n.DXGI_FORMAT_R32G32B32_UINT=7]="DXGI_FORMAT_R32G32B32_UINT",n[n.DXGI_FORMAT_R32G32B32_SINT=8]="DXGI_FORMAT_R32G32B32_SINT",n[n.DXGI_FORMAT_R16G16B16A16_TYPELESS=9]="DXGI_FORMAT_R16G16B16A16_TYPELESS",n[n.DXGI_FORMAT_R16G16B16A16_FLOAT=10]="DXGI_FORMAT_R16G16B16A16_FLOAT",n[n.DXGI_FORMAT_R16G16B16A16_UNORM=11]="DXGI_FORMAT_R16G16B16A16_UNORM",n[n.DXGI_FORMAT_R16G16B16A16_UINT=12]="DXGI_FORMAT_R16G16B16A16_UINT",n[n.DXGI_FORMAT_R16G16B16A16_SNORM=13]="DXGI_FORMAT_R16G16B16A16_SNORM",n[n.DXGI_FORMAT_R16G16B16A16_SINT=14]="DXGI_FORMAT_R16G16B16A16_SINT",n[n.DXGI_FORMAT_R32G32_TYPELESS=15]="DXGI_FORMAT_R32G32_TYPELESS",n[n.DXGI_FORMAT_R32G32_FLOAT=16]="DXGI_FORMAT_R32G32_FLOAT",n[n.DXGI_FORMAT_R32G32_UINT=17]="DXGI_FORMAT_R32G32_UINT",n[n.DXGI_FORMAT_R32G32_SINT=18]="DXGI_FORMAT_R32G32_SINT",n[n.DXGI_FORMAT_R32G8X24_TYPELESS=19]="DXGI_FORMAT_R32G8X24_TYPELESS",n[n.DXGI_FORMAT_D32_FLOAT_S8X24_UINT=20]="DXGI_FORMAT_D32_FLOAT_S8X24_UINT",n[n.DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS=21]="DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS",n[n.DXGI_FORMAT_X32_TYPELESS_G8X24_UINT=22]="DXGI_FORMAT_X32_TYPELESS_G8X24_UINT",n[n.DXGI_FORMAT_R10G10B10A2_TYPELESS=23]="DXGI_FORMAT_R10G10B10A2_TYPELESS",n[n.DXGI_FORMAT_R10G10B10A2_UNORM=24]="DXGI_FORMAT_R10G10B10A2_UNORM",n[n.DXGI_FORMAT_R10G10B10A2_UINT=25]="DXGI_FORMAT_R10G10B10A2_UINT",n[n.DXGI_FORMAT_R11G11B10_FLOAT=26]="DXGI_FORMAT_R11G11B10_FLOAT",n[n.DXGI_FORMAT_R8G8B8A8_TYPELESS=27]="DXGI_FORMAT_R8G8B8A8_TYPELESS",n[n.DXGI_FORMAT_R8G8B8A8_UNORM=28]="DXGI_FORMAT_R8G8B8A8_UNORM",n[n.DXGI_FORMAT_R8G8B8A8_UNORM_SRGB=29]="DXGI_FORMAT_R8G8B8A8_UNORM_SRGB",n[n.DXGI_FORMAT_R8G8B8A8_UINT=30]="DXGI_FORMAT_R8G8B8A8_UINT",n[n.DXGI_FORMAT_R8G8B8A8_SNORM=31]="DXGI_FORMAT_R8G8B8A8_SNORM",n[n.DXGI_FORMAT_R8G8B8A8_SINT=32]="DXGI_FORMAT_R8G8B8A8_SINT",n[n.DXGI_FORMAT_R16G16_TYPELESS=33]="DXGI_FORMAT_R16G16_TYPELESS",n[n.DXGI_FORMAT_R16G16_FLOAT=34]="DXGI_FORMAT_R16G16_FLOAT",n[n.DXGI_FORMAT_R16G16_UNORM=35]="DXGI_FORMAT_R16G16_UNORM",n[n.DXGI_FORMAT_R16G16_UINT=36]="DXGI_FORMAT_R16G16_UINT",n[n.DXGI_FORMAT_R16G16_SNORM=37]="DXGI_FORMAT_R16G16_SNORM",n[n.DXGI_FORMAT_R16G16_SINT=38]="DXGI_FORMAT_R16G16_SINT",n[n.DXGI_FORMAT_R32_TYPELESS=39]="DXGI_FORMAT_R32_TYPELESS",n[n.DXGI_FORMAT_D32_FLOAT=40]="DXGI_FORMAT_D32_FLOAT",n[n.DXGI_FORMAT_R32_FLOAT=41]="DXGI_FORMAT_R32_FLOAT",n[n.DXGI_FORMAT_R32_UINT=42]="DXGI_FORMAT_R32_UINT",n[n.DXGI_FORMAT_R32_SINT=43]="DXGI_FORMAT_R32_SINT",n[n.DXGI_FORMAT_R24G8_TYPELESS=44]="DXGI_FORMAT_R24G8_TYPELESS",n[n.DXGI_FORMAT_D24_UNORM_S8_UINT=45]="DXGI_FORMAT_D24_UNORM_S8_UINT",n[n.DXGI_FORMAT_R24_UNORM_X8_TYPELESS=46]="DXGI_FORMAT_R24_UNORM_X8_TYPELESS",n[n.DXGI_FORMAT_X24_TYPELESS_G8_UINT=47]="DXGI_FORMAT_X24_TYPELESS_G8_UINT",n[n.DXGI_FORMAT_R8G8_TYPELESS=48]="DXGI_FORMAT_R8G8_TYPELESS",n[n.DXGI_FORMAT_R8G8_UNORM=49]="DXGI_FORMAT_R8G8_UNORM",n[n.DXGI_FORMAT_R8G8_UINT=50]="DXGI_FORMAT_R8G8_UINT",n[n.DXGI_FORMAT_R8G8_SNORM=51]="DXGI_FORMAT_R8G8_SNORM",n[n.DXGI_FORMAT_R8G8_SINT=52]="DXGI_FORMAT_R8G8_SINT",n[n.DXGI_FORMAT_R16_TYPELESS=53]="DXGI_FORMAT_R16_TYPELESS",n[n.DXGI_FORMAT_R16_FLOAT=54]="DXGI_FORMAT_R16_FLOAT",n[n.DXGI_FORMAT_D16_UNORM=55]="DXGI_FORMAT_D16_UNORM",n[n.DXGI_FORMAT_R16_UNORM=56]="DXGI_FORMAT_R16_UNORM",n[n.DXGI_FORMAT_R16_UINT=57]="DXGI_FORMAT_R16_UINT",n[n.DXGI_FORMAT_R16_SNORM=58]="DXGI_FORMAT_R16_SNORM",n[n.DXGI_FORMAT_R16_SINT=59]="DXGI_FORMAT_R16_SINT",n[n.DXGI_FORMAT_R8_TYPELESS=60]="DXGI_FORMAT_R8_TYPELESS",n[n.DXGI_FORMAT_R8_UNORM=61]="DXGI_FORMAT_R8_UNORM",n[n.DXGI_FORMAT_R8_UINT=62]="DXGI_FORMAT_R8_UINT",n[n.DXGI_FORMAT_R8_SNORM=63]="DXGI_FORMAT_R8_SNORM",n[n.DXGI_FORMAT_R8_SINT=64]="DXGI_FORMAT_R8_SINT",n[n.DXGI_FORMAT_A8_UNORM=65]="DXGI_FORMAT_A8_UNORM",n[n.DXGI_FORMAT_R1_UNORM=66]="DXGI_FORMAT_R1_UNORM",n[n.DXGI_FORMAT_R9G9B9E5_SHAREDEXP=67]="DXGI_FORMAT_R9G9B9E5_SHAREDEXP",n[n.DXGI_FORMAT_R8G8_B8G8_UNORM=68]="DXGI_FORMAT_R8G8_B8G8_UNORM",n[n.DXGI_FORMAT_G8R8_G8B8_UNORM=69]="DXGI_FORMAT_G8R8_G8B8_UNORM",n[n.DXGI_FORMAT_BC1_TYPELESS=70]="DXGI_FORMAT_BC1_TYPELESS",n[n.DXGI_FORMAT_BC1_UNORM=71]="DXGI_FORMAT_BC1_UNORM",n[n.DXGI_FORMAT_BC1_UNORM_SRGB=72]="DXGI_FORMAT_BC1_UNORM_SRGB",n[n.DXGI_FORMAT_BC2_TYPELESS=73]="DXGI_FORMAT_BC2_TYPELESS",n[n.DXGI_FORMAT_BC2_UNORM=74]="DXGI_FORMAT_BC2_UNORM",n[n.DXGI_FORMAT_BC2_UNORM_SRGB=75]="DXGI_FORMAT_BC2_UNORM_SRGB",n[n.DXGI_FORMAT_BC3_TYPELESS=76]="DXGI_FORMAT_BC3_TYPELESS",n[n.DXGI_FORMAT_BC3_UNORM=77]="DXGI_FORMAT_BC3_UNORM",n[n.DXGI_FORMAT_BC3_UNORM_SRGB=78]="DXGI_FORMAT_BC3_UNORM_SRGB",n[n.DXGI_FORMAT_BC4_TYPELESS=79]="DXGI_FORMAT_BC4_TYPELESS",n[n.DXGI_FORMAT_BC4_UNORM=80]="DXGI_FORMAT_BC4_UNORM",n[n.DXGI_FORMAT_BC4_SNORM=81]="DXGI_FORMAT_BC4_SNORM",n[n.DXGI_FORMAT_BC5_TYPELESS=82]="DXGI_FORMAT_BC5_TYPELESS",n[n.DXGI_FORMAT_BC5_UNORM=83]="DXGI_FORMAT_BC5_UNORM",n[n.DXGI_FORMAT_BC5_SNORM=84]="DXGI_FORMAT_BC5_SNORM",n[n.DXGI_FORMAT_B5G6R5_UNORM=85]="DXGI_FORMAT_B5G6R5_UNORM",n[n.DXGI_FORMAT_B5G5R5A1_UNORM=86]="DXGI_FORMAT_B5G5R5A1_UNORM",n[n.DXGI_FORMAT_B8G8R8A8_UNORM=87]="DXGI_FORMAT_B8G8R8A8_UNORM",n[n.DXGI_FORMAT_B8G8R8X8_UNORM=88]="DXGI_FORMAT_B8G8R8X8_UNORM",n[n.DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM=89]="DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM",n[n.DXGI_FORMAT_B8G8R8A8_TYPELESS=90]="DXGI_FORMAT_B8G8R8A8_TYPELESS",n[n.DXGI_FORMAT_B8G8R8A8_UNORM_SRGB=91]="DXGI_FORMAT_B8G8R8A8_UNORM_SRGB",n[n.DXGI_FORMAT_B8G8R8X8_TYPELESS=92]="DXGI_FORMAT_B8G8R8X8_TYPELESS",n[n.DXGI_FORMAT_B8G8R8X8_UNORM_SRGB=93]="DXGI_FORMAT_B8G8R8X8_UNORM_SRGB",n[n.DXGI_FORMAT_BC6H_TYPELESS=94]="DXGI_FORMAT_BC6H_TYPELESS",n[n.DXGI_FORMAT_BC6H_UF16=95]="DXGI_FORMAT_BC6H_UF16",n[n.DXGI_FORMAT_BC6H_SF16=96]="DXGI_FORMAT_BC6H_SF16",n[n.DXGI_FORMAT_BC7_TYPELESS=97]="DXGI_FORMAT_BC7_TYPELESS",n[n.DXGI_FORMAT_BC7_UNORM=98]="DXGI_FORMAT_BC7_UNORM",n[n.DXGI_FORMAT_BC7_UNORM_SRGB=99]="DXGI_FORMAT_BC7_UNORM_SRGB",n[n.DXGI_FORMAT_AYUV=100]="DXGI_FORMAT_AYUV",n[n.DXGI_FORMAT_Y410=101]="DXGI_FORMAT_Y410",n[n.DXGI_FORMAT_Y416=102]="DXGI_FORMAT_Y416",n[n.DXGI_FORMAT_NV12=103]="DXGI_FORMAT_NV12",n[n.DXGI_FORMAT_P010=104]="DXGI_FORMAT_P010",n[n.DXGI_FORMAT_P016=105]="DXGI_FORMAT_P016",n[n.DXGI_FORMAT_420_OPAQUE=106]="DXGI_FORMAT_420_OPAQUE",n[n.DXGI_FORMAT_YUY2=107]="DXGI_FORMAT_YUY2",n[n.DXGI_FORMAT_Y210=108]="DXGI_FORMAT_Y210",n[n.DXGI_FORMAT_Y216=109]="DXGI_FORMAT_Y216",n[n.DXGI_FORMAT_NV11=110]="DXGI_FORMAT_NV11",n[n.DXGI_FORMAT_AI44=111]="DXGI_FORMAT_AI44",n[n.DXGI_FORMAT_IA44=112]="DXGI_FORMAT_IA44",n[n.DXGI_FORMAT_P8=113]="DXGI_FORMAT_P8",n[n.DXGI_FORMAT_A8P8=114]="DXGI_FORMAT_A8P8",n[n.DXGI_FORMAT_B4G4R4A4_UNORM=115]="DXGI_FORMAT_B4G4R4A4_UNORM",n[n.DXGI_FORMAT_P208=116]="DXGI_FORMAT_P208",n[n.DXGI_FORMAT_V208=117]="DXGI_FORMAT_V208",n[n.DXGI_FORMAT_V408=118]="DXGI_FORMAT_V408",n[n.DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE=119]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE",n[n.DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE=120]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE",n[n.DXGI_FORMAT_FORCE_UINT=121]="DXGI_FORMAT_FORCE_UINT"})(yr||(yr={}));var Y0;(function(n){n[n.DDS_DIMENSION_TEXTURE1D=2]="DDS_DIMENSION_TEXTURE1D",n[n.DDS_DIMENSION_TEXTURE2D=3]="DDS_DIMENSION_TEXTURE2D",n[n.DDS_DIMENSION_TEXTURE3D=6]="DDS_DIMENSION_TEXTURE3D"})(Y0||(Y0={}));var Eq=1,Tq=2,Mq=4,wq=64,Aq=512,Pq=131072,Cq=827611204,Rq=861165636,Iq=894720068,Lq=808540228,Oq=4,Dq=(Wc={},Wc[Cq]=at.COMPRESSED_RGBA_S3TC_DXT1_EXT,Wc[Rq]=at.COMPRESSED_RGBA_S3TC_DXT3_EXT,Wc[Iq]=at.COMPRESSED_RGBA_S3TC_DXT5_EXT,Wc),Fq=(dr={},dr[yr.DXGI_FORMAT_BC1_TYPELESS]=at.COMPRESSED_RGBA_S3TC_DXT1_EXT,dr[yr.DXGI_FORMAT_BC1_UNORM]=at.COMPRESSED_RGBA_S3TC_DXT1_EXT,dr[yr.DXGI_FORMAT_BC2_TYPELESS]=at.COMPRESSED_RGBA_S3TC_DXT3_EXT,dr[yr.DXGI_FORMAT_BC2_UNORM]=at.COMPRESSED_RGBA_S3TC_DXT3_EXT,dr[yr.DXGI_FORMAT_BC3_TYPELESS]=at.COMPRESSED_RGBA_S3TC_DXT5_EXT,dr[yr.DXGI_FORMAT_BC3_UNORM]=at.COMPRESSED_RGBA_S3TC_DXT5_EXT,dr[yr.DXGI_FORMAT_BC1_UNORM_SRGB]=at.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,dr[yr.DXGI_FORMAT_BC2_UNORM_SRGB]=at.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,dr[yr.DXGI_FORMAT_BC3_UNORM_SRGB]=at.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,dr);function WL(n){var e=new Uint32Array(n),t=e[0];if(t!==bq)throw new Error("Invalid DDS file magic word");var i=new Uint32Array(n,0,Df/Uint32Array.BYTES_PER_ELEMENT),r=i[Ff.HEIGHT],s=i[Ff.WIDTH],o=i[Ff.MIPMAP_COUNT],a=new Uint32Array(n,Ff.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,xq/Uint32Array.BYTES_PER_ELEMENT),l=a[Eq];if(l&Mq){var u=a[Sq.FOURCC];if(u!==Lq){var c=Dq[u],h=B_+Df,d=new Uint8Array(n,h),f=new um(d,{format:c,width:s,height:r,levels:o});return[f]}var p=B_+Df,_=new Uint32Array(e.buffer,p,VM/Uint32Array.BYTES_PER_ELEMENT),m=_[Nf.DXGI_FORMAT],g=_[Nf.RESOURCE_DIMENSION],v=_[Nf.MISC_FLAG],y=_[Nf.ARRAY_SIZE],x=Fq[m];if(x===void 0)throw new Error("DDSParser cannot parse texture data with DXGI format "+m);if(v===Oq)throw new Error("DDSParser does not support cubemap textures");if(g===Y0.DDS_DIMENSION_TEXTURE3D)throw new Error("DDSParser does not supported 3D texture data");var b=new Array,S=B_+Df+VM;if(y===1)b.push(new Uint8Array(n,S));else{for(var T=_d[x],P=0,E=s,M=r,O=0;O<o;O++){var L=Math.max(1,E+3&-4),C=Math.max(1,M+3&-4),D=L*C*T;P+=D,E=E>>>1,M=M>>>1}for(var B=S,O=0;O<y;O++)b.push(new Uint8Array(n,B,P)),B+=P}return b.map(function(W){return new um(W,{format:x,width:s,height:r,levels:o})})}throw l&wq?new Error("DDSParser does not support uncompressed texture data."):l&Aq?new Error("DDSParser does not supported YUV uncompressed texture data."):l&Pq?new Error("DDSParser does not support single-channel (lumninance) texture data!"):l&Tq?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}var lo,ys,Xc,GM=[171,75,84,88,32,49,49,187,13,10,26,10],Nq=67305985,fr={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},q0=64,K0=(lo={},lo[Ge.UNSIGNED_BYTE]=1,lo[Ge.UNSIGNED_SHORT]=2,lo[Ge.INT]=4,lo[Ge.UNSIGNED_INT]=4,lo[Ge.FLOAT]=4,lo[Ge.HALF_FLOAT]=8,lo),XL=(ys={},ys[Me.RGBA]=4,ys[Me.RGB]=3,ys[Me.RG]=2,ys[Me.RED]=1,ys[Me.LUMINANCE]=1,ys[Me.LUMINANCE_ALPHA]=2,ys[Me.ALPHA]=1,ys),jL=(Xc={},Xc[Ge.UNSIGNED_SHORT_4_4_4_4]=2,Xc[Ge.UNSIGNED_SHORT_5_5_5_1]=2,Xc[Ge.UNSIGNED_SHORT_5_6_5]=2,Xc);function $L(n,e,t){t===void 0&&(t=!1);var i=new DataView(e);if(!Uq(n,i))return null;var r=i.getUint32(fr.ENDIANNESS,!0)===Nq,s=i.getUint32(fr.GL_TYPE,r),o=i.getUint32(fr.GL_FORMAT,r),a=i.getUint32(fr.GL_INTERNAL_FORMAT,r),l=i.getUint32(fr.PIXEL_WIDTH,r),u=i.getUint32(fr.PIXEL_HEIGHT,r)||1,c=i.getUint32(fr.PIXEL_DEPTH,r)||1,h=i.getUint32(fr.NUMBER_OF_ARRAY_ELEMENTS,r)||1,d=i.getUint32(fr.NUMBER_OF_FACES,r),f=i.getUint32(fr.NUMBER_OF_MIPMAP_LEVELS,r),p=i.getUint32(fr.BYTES_OF_KEY_VALUE_DATA,r);if(u===0||c!==1)throw new Error("Only 2D textures are supported");if(d!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(h!==1)throw new Error("WebGL does not support array textures");var _=4,m=4,g=l+3&-4,v=u+3&-4,y=new Array(h),x=l*u;s===0&&(x=g*v);var b;if(s!==0?K0[s]?b=K0[s]*XL[o]:b=jL[s]:b=_d[a],b===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");for(var S=t?kq(i,p,r):null,T=x*b,P=T,E=l,M=u,O=g,L=v,C=q0+p,D=0;D<f;D++){for(var B=i.getUint32(C,r),W=C+4,U=0;U<h;U++){var $=y[U];$||($=y[U]=new Array(f)),$[D]={levelID:D,levelWidth:f>1||s!==0?E:O,levelHeight:f>1||s!==0?M:L,levelBuffer:new Uint8Array(e,W,P)},W+=P}C+=B+4,C=C%4!==0?C+4-C%4:C,E=E>>1||1,M=M>>1||1,O=E+_-1&~(_-1),L=M+m-1&~(m-1),P=O*L*b}return s!==0?{uncompressed:y.map(function(J){var j=J[0].levelBuffer,F=!1;return s===Ge.FLOAT?j=new Float32Array(J[0].levelBuffer.buffer,J[0].levelBuffer.byteOffset,J[0].levelBuffer.byteLength/4):s===Ge.UNSIGNED_INT?(F=!0,j=new Uint32Array(J[0].levelBuffer.buffer,J[0].levelBuffer.byteOffset,J[0].levelBuffer.byteLength/4)):s===Ge.INT&&(F=!0,j=new Int32Array(J[0].levelBuffer.buffer,J[0].levelBuffer.byteOffset,J[0].levelBuffer.byteLength/4)),{resource:new Sl(j,{width:J[0].levelWidth,height:J[0].levelHeight}),type:s,format:F?Bq(o):o}}),kvData:S}:{compressed:y.map(function(J){return new um(null,{format:a,width:l,height:u,levels:f,levelBuffers:J})}),kvData:S}}function Uq(n,e){for(var t=0;t<GM.length;t++)if(e.getUint8(t)!==GM[t])return console.error(n+" is not a valid *.ktx file!"),!1;return!0}function Bq(n){switch(n){case Me.RGBA:return Me.RGBA_INTEGER;case Me.RGB:return Me.RGB_INTEGER;case Me.RG:return Me.RG_INTEGER;case Me.RED:return Me.RED_INTEGER;default:return n}}function kq(n,e,t){for(var i=new Map,r=0;r<e;){var s=n.getUint32(q0+r,t),o=q0+r+4,a=3-(s+3)%4;if(s===0||s>e-r){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}for(var l=0;l<s&&n.getUint8(o+l)!==0;l++);if(l===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}var u=new TextDecoder().decode(new Uint8Array(n.buffer,o,l)),c=new DataView(n.buffer,o+l+1,s-l-1);i.set(u,c),r+=4+s+a}return i}on.setExtensionXhrType("dds",on.XHR_RESPONSE_TYPE.BUFFER);var YL=function(){function n(){}return n.use=function(e,t){if(e.extension==="dds"&&e.data)try{Object.assign(e,zL(e.name||e.url,WL(e.data),e.metadata))}catch(i){t(i);return}t()},n.extension=Ut.Loader,n}();on.setExtensionXhrType("ktx",on.XHR_RESPONSE_TYPE.BUFFER);var qL=function(){function n(){}return n.use=function(e,t){if(e.extension==="ktx"&&e.data)try{var i=e.name||e.url,r=$L(i,e.data,this.loadKeyValueData),s=r.compressed,o=r.uncompressed,a=r.kvData;if(s){var l=zL(i,s,e.metadata);if(a&&l.textures)for(var u in l.textures)l.textures[u].baseTexture.ktxKeyValueData=a;Object.assign(e,l)}else if(o){var c={};o.forEach(function(h,d){var f=new Ke(new xt(h.resource,{mipmap:or.OFF,alphaMode:ar.NO_PREMULTIPLIED_ALPHA,type:h.type,format:h.format})),p=i+"-"+(d+1);a&&(f.baseTexture.ktxKeyValueData=a),xt.addToCache(f.baseTexture,p),Ke.addToCache(f,p),d===0&&(c[i]=f,xt.addToCache(f.baseTexture,i),Ke.addToCache(f,i)),c[p]=f}),Object.assign(e,{textures:c})}}catch(h){t(h);return}t()},n.extension=Ut.Loader,n.loadKeyValueData=!1,n}();/*!
 * @pixi/particle-container - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/particle-container is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Z0=function(n,e){return Z0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},Z0(n,e)};function KL(n,e){Z0(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Vq=function(n){KL(e,n);function e(t,i,r,s){t===void 0&&(t=1500),r===void 0&&(r=16384),s===void 0&&(s=!1);var o=n.call(this)||this,a=16384;return r>a&&(r=a),o._properties=[!1,!0,!1,!1,!1],o._maxSize=t,o._batchSize=r,o._buffers=null,o._bufferUpdateIDs=[],o._updateID=0,o.interactiveChildren=!1,o.blendMode=He.NORMAL,o.autoResize=s,o.roundPixels=!0,o.baseTexture=null,o.setProperties(i),o._tint=0,o.tintRgb=new Float32Array(4),o.tint=16777215,o}return e.prototype.setProperties=function(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])},e.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,hl(t,this.tintRgb)},enumerable:!1,configurable:!0}),e.prototype.render=function(t){var i=this;!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable||(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",function(){return i.onChildrenChange(0)})),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},e.prototype.onChildrenChange=function(t){for(var i=Math.floor(t/this._batchSize);this._bufferUpdateIDs.length<i;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[i]=++this._updateID},e.prototype.dispose=function(){if(this._buffers){for(var t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}},e.prototype.destroy=function(t){n.prototype.destroy.call(this,t),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},e}(Oi),HM=function(){function n(e,t,i){this.geometry=new Sc,this.indexBuffer=null,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(var r=0;r<e.length;++r){var s=e[r];s={attributeName:s.attributeName,size:s.size,uploadFunction:s.uploadFunction,type:s.type||Ge.FLOAT,offset:s.offset},t[r]?this.dynamicProperties.push(s):this.staticProperties.push(s)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return n.prototype.initBuffers=function(){var e=this.geometry,t=0;this.indexBuffer=new vn(gI(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(var i=0;i<this.dynamicProperties.length;++i){var r=this.dynamicProperties[i];r.offset=t,t+=r.size,this.dynamicStride+=r.size}var s=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(s),this.dynamicDataUint32=new Uint32Array(s),this.dynamicBuffer=new vn(this.dynamicData,!1,!1);var o=0;this.staticStride=0;for(var i=0;i<this.staticProperties.length;++i){var r=this.staticProperties[i];r.offset=o,o+=r.size,this.staticStride+=r.size}var a=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(a),this.staticDataUint32=new Uint32Array(a),this.staticBuffer=new vn(this.staticData,!0,!1);for(var i=0;i<this.dynamicProperties.length;++i){var r=this.dynamicProperties[i];e.addAttribute(r.attributeName,this.dynamicBuffer,0,r.type===Ge.UNSIGNED_BYTE,r.type,this.dynamicStride*4,r.offset*4)}for(var i=0;i<this.staticProperties.length;++i){var r=this.staticProperties[i];e.addAttribute(r.attributeName,this.staticBuffer,0,r.type===Ge.UNSIGNED_BYTE,r.type,this.staticStride*4,r.offset*4)}},n.prototype.uploadDynamic=function(e,t,i){for(var r=0;r<this.dynamicProperties.length;r++){var s=this.dynamicProperties[r];s.uploadFunction(e,t,i,s.type===Ge.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,s.offset)}this.dynamicBuffer._updateID++},n.prototype.uploadStatic=function(e,t,i){for(var r=0;r<this.staticProperties.length;r++){var s=this.staticProperties[r];s.uploadFunction(e,t,i,s.type===Ge.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,s.offset)}this.staticBuffer._updateID++},n.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()},n}(),Gq=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,Hq=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`,ZL=function(n){KL(e,n);function e(t){var i=n.call(this,t)||this;return i.shader=null,i.properties=null,i.tempMatrix=new kt,i.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:i.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:i.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:i.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:i.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:Ge.UNSIGNED_BYTE,uploadFunction:i.uploadTint,offset:0}],i.shader=Xs.from(Hq,Gq,{}),i.state=qo.for2d(),i}return e.prototype.render=function(t){var i=t.children,r=t._maxSize,s=t._batchSize,o=this.renderer,a=i.length;if(a!==0){a>r&&!t.autoResize&&(a=r);var l=t._buffers;l||(l=t._buffers=this.generateBuffers(t));var u=i[0]._texture.baseTexture,c=u.alphaMode>0;this.state.blendMode=ab(t.blendMode,c),o.state.set(this.state);var h=o.gl,d=t.worldTransform.copyTo(this.tempMatrix);d.prepend(o.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=d.toArray(!0),this.shader.uniforms.uColor=mI(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,c),this.shader.uniforms.uSampler=u,this.renderer.shader.bind(this.shader);for(var f=!1,p=0,_=0;p<a;p+=s,_+=1){var m=a-p;m>s&&(m=s),_>=l.length&&l.push(this._generateOneMoreBuffer(t));var g=l[_];g.uploadDynamic(i,p,m);var v=t._bufferUpdateIDs[_]||0;f=f||g._updateID<v,f&&(g._updateID=t._updateID,g.uploadStatic(i,p,m)),o.geometry.bind(g.geometry),h.drawElements(h.TRIANGLES,m*6,h.UNSIGNED_SHORT,0)}}},e.prototype.generateBuffers=function(t){for(var i=[],r=t._maxSize,s=t._batchSize,o=t._properties,a=0;a<r;a+=s)i.push(new HM(this.properties,o,s));return i},e.prototype._generateOneMoreBuffer=function(t){var i=t._batchSize,r=t._properties;return new HM(this.properties,r,i)},e.prototype.uploadVertices=function(t,i,r,s,o,a){for(var l=0,u=0,c=0,h=0,d=0;d<r;++d){var f=t[i+d],p=f._texture,_=f.scale.x,m=f.scale.y,g=p.trim,v=p.orig;g?(u=g.x-f.anchor.x*v.width,l=u+g.width,h=g.y-f.anchor.y*v.height,c=h+g.height):(l=v.width*(1-f.anchor.x),u=v.width*-f.anchor.x,c=v.height*(1-f.anchor.y),h=v.height*-f.anchor.y),s[a]=u*_,s[a+1]=h*m,s[a+o]=l*_,s[a+o+1]=h*m,s[a+o*2]=l*_,s[a+o*2+1]=c*m,s[a+o*3]=u*_,s[a+o*3+1]=c*m,a+=o*4}},e.prototype.uploadPosition=function(t,i,r,s,o,a){for(var l=0;l<r;l++){var u=t[i+l].position;s[a]=u.x,s[a+1]=u.y,s[a+o]=u.x,s[a+o+1]=u.y,s[a+o*2]=u.x,s[a+o*2+1]=u.y,s[a+o*3]=u.x,s[a+o*3+1]=u.y,a+=o*4}},e.prototype.uploadRotation=function(t,i,r,s,o,a){for(var l=0;l<r;l++){var u=t[i+l].rotation;s[a]=u,s[a+o]=u,s[a+o*2]=u,s[a+o*3]=u,a+=o*4}},e.prototype.uploadUvs=function(t,i,r,s,o,a){for(var l=0;l<r;++l){var u=t[i+l]._texture._uvs;u?(s[a]=u.x0,s[a+1]=u.y0,s[a+o]=u.x1,s[a+o+1]=u.y1,s[a+o*2]=u.x2,s[a+o*2+1]=u.y2,s[a+o*3]=u.x3,s[a+o*3+1]=u.y3,a+=o*4):(s[a]=0,s[a+1]=0,s[a+o]=0,s[a+o+1]=0,s[a+o*2]=0,s[a+o*2+1]=0,s[a+o*3]=0,s[a+o*3+1]=0,a+=o*4)}},e.prototype.uploadTint=function(t,i,r,s,o,a){for(var l=0;l<r;++l){var u=t[i+l],c=u._texture.baseTexture.alphaMode>0,h=u.alpha,d=h<1&&c?rg(u._tintRGB,h):u._tintRGB+(h*255<<24);s[a]=d,s[a+o]=d,s[a+o*2]=d,s[a+o*3]=d,a+=o*4}},e.prototype.destroy=function(){n.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},e.extension={name:"particle",type:Ut.RendererPlugin},e}(kd);/*!
 * @pixi/graphics - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/graphics is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var es;(function(n){n.MITER="miter",n.BEVEL="bevel",n.ROUND="round"})(es||(es={}));var Bs;(function(n){n.BUTT="butt",n.ROUND="round",n.SQUARE="square"})(Bs||(Bs={}));var Zu={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(n,e){if(e===void 0&&(e=20),!this.adaptive||!n||isNaN(n))return e;var t=Math.ceil(n/this.maxLength);return t<this.minSegments?t=this.minSegments:t>this.maxSegments&&(t=this.maxSegments),t}},Wb=function(){function n(){this.color=16777215,this.alpha=1,this.texture=Ke.WHITE,this.matrix=null,this.visible=!1,this.reset()}return n.prototype.clone=function(){var e=new n;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e},n.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=Ke.WHITE,this.matrix=null,this.visible=!1},n.prototype.destroy=function(){this.texture=null,this.matrix=null},n}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var J0=function(n,e){return J0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},J0(n,e)};function Xb(n,e){J0(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function zM(n,e){var t,i;e===void 0&&(e=!1);var r=n.length;if(!(r<6)){for(var s=0,o=0,a=n[r-2],l=n[r-1];o<r;o+=2){var u=n[o],c=n[o+1];s+=(u-a)*(c+l),a=u,l=c}if(!e&&s>0||e&&s<=0)for(var h=r/2,o=h+h%2;o<r;o+=2){var d=r-o-2,f=r-o-1,p=o,_=o+1;t=[n[p],n[d]],n[d]=t[0],n[p]=t[1],i=[n[_],n[f]],n[f]=i[0],n[_]=i[1]}}}var jb={build:function(n){n.points=n.shape.points.slice()},triangulate:function(n,e){var t=n.points,i=n.holes,r=e.points,s=e.indices;if(t.length>=6){zM(t,!1);for(var o=[],a=0;a<i.length;a++){var l=i[a];zM(l.points,!0),o.push(t.length/2),t=t.concat(l.points)}var u=qx(t,o,2);if(!u)return;for(var c=r.length/2,a=0;a<u.length;a+=3)s.push(u[a]+c),s.push(u[a+1]+c),s.push(u[a+2]+c);for(var a=0;a<t.length;a++)r.push(t[a])}}},vd={build:function(n){var e=n.points,t,i,r,s,o,a;if(n.type===Tn.CIRC){var l=n.shape;t=l.x,i=l.y,o=a=l.radius,r=s=0}else if(n.type===Tn.ELIP){var u=n.shape;t=u.x,i=u.y,o=u.width,a=u.height,r=s=0}else{var c=n.shape,h=c.width/2,d=c.height/2;t=c.x+h,i=c.y+d,o=a=Math.max(0,Math.min(c.radius,Math.min(h,d))),r=h-o,s=d-a}if(!(o>=0&&a>=0&&r>=0&&s>=0)){e.length=0;return}var f=Math.ceil(2.3*Math.sqrt(o+a)),p=f*8+(r?4:0)+(s?4:0);if(e.length=p,p!==0){if(f===0){e.length=8,e[0]=e[6]=t+r,e[1]=e[3]=i+s,e[2]=e[4]=t-r,e[5]=e[7]=i-s;return}var _=0,m=f*4+(r?2:0)+2,g=m,v=p;{var y=r+o,x=s,b=t+y,S=t-y,T=i+x;if(e[_++]=b,e[_++]=T,e[--m]=T,e[--m]=S,s){var P=i-x;e[g++]=S,e[g++]=P,e[--v]=P,e[--v]=b}}for(var E=1;E<f;E++){var M=Math.PI/2*(E/f),y=r+Math.cos(M)*o,x=s+Math.sin(M)*a,b=t+y,S=t-y,T=i+x,P=i-x;e[_++]=b,e[_++]=T,e[--m]=T,e[--m]=S,e[g++]=S,e[g++]=P,e[--v]=P,e[--v]=b}{var y=r,x=s+a,b=t+y,S=t-y,T=i+x,P=i-x;e[_++]=b,e[_++]=T,e[--v]=P,e[--v]=b,r&&(e[_++]=S,e[_++]=T,e[--v]=P,e[--v]=S)}}},triangulate:function(n,e){var t=n.points,i=e.points,r=e.indices;if(t.length!==0){var s=i.length/2,o=s,a,l;if(n.type!==Tn.RREC){var u=n.shape;a=u.x,l=u.y}else{var c=n.shape;a=c.x+c.width/2,l=c.y+c.height/2}var h=n.matrix;i.push(n.matrix?h.a*a+h.c*l+h.tx:a,n.matrix?h.b*a+h.d*l+h.ty:l),s++,i.push(t[0],t[1]);for(var d=2;d<t.length;d+=2)i.push(t[d],t[d+1]),r.push(s++,o,s);r.push(o+1,o,s)}}},JL={build:function(n){var e=n.shape,t=e.x,i=e.y,r=e.width,s=e.height,o=n.points;o.length=0,o.push(t,i,t+r,i,t+r,i+s,t,i+s)},triangulate:function(n,e){var t=n.points,i=e.points,r=i.length/2;i.push(t[0],t[1],t[2],t[3],t[6],t[7],t[4],t[5]),e.indices.push(r,r+1,r+2,r+1,r+2,r+3)}};function Nl(n,e,t){var i=e-n;return n+i*t}function Uf(n,e,t,i,r,s,o){o===void 0&&(o=[]);for(var a=20,l=o,u=0,c=0,h=0,d=0,f=0,p=0,_=0,m=0;_<=a;++_)m=_/a,u=Nl(n,t,m),c=Nl(e,i,m),h=Nl(t,r,m),d=Nl(i,s,m),f=Nl(u,h,m),p=Nl(c,d,m),!(_===0&&l[l.length-2]===f&&l[l.length-1]===p)&&l.push(f,p);return l}var QL={build:function(n){if(yd.nextRoundedRectBehavior){vd.build(n);return}var e=n.shape,t=n.points,i=e.x,r=e.y,s=e.width,o=e.height,a=Math.max(0,Math.min(e.radius,Math.min(s,o)/2));t.length=0,a?(Uf(i,r+a,i,r,i+a,r,t),Uf(i+s-a,r,i+s,r,i+s,r+a,t),Uf(i+s,r+o-a,i+s,r+o,i+s-a,r+o,t),Uf(i+a,r+o,i,r+o,i,r+o-a,t)):t.push(i,r,i+s,r,i+s,r+o,i,r+o)},triangulate:function(n,e){if(yd.nextRoundedRectBehavior){vd.triangulate(n,e);return}for(var t=n.points,i=e.points,r=e.indices,s=i.length/2,o=qx(t,null,2),a=0,l=o.length;a<l;a+=3)r.push(o[a]+s),r.push(o[a+1]+s),r.push(o[a+2]+s);for(var a=0,l=t.length;a<l;a++)i.push(t[a],t[++a])}};function WM(n,e,t,i,r,s,o,a){var l=n-t*r,u=e-i*r,c=n+t*s,h=e+i*s,d,f;o?(d=i,f=-t):(d=-i,f=t);var p=l+d,_=u+f,m=c+d,g=h+f;return a.push(p,_),a.push(m,g),2}function ha(n,e,t,i,r,s,o,a){var l=t-n,u=i-e,c=Math.atan2(l,u),h=Math.atan2(r-n,s-e);a&&c<h?c+=Math.PI*2:!a&&c>h&&(h+=Math.PI*2);var d=c,f=h-c,p=Math.abs(f),_=Math.sqrt(l*l+u*u),m=(15*p*Math.sqrt(_)/Math.PI>>0)+1,g=f/m;if(d+=g,a){o.push(n,e),o.push(t,i);for(var v=1,y=d;v<m;v++,y+=g)o.push(n,e),o.push(n+Math.sin(y)*_,e+Math.cos(y)*_);o.push(n,e),o.push(r,s)}else{o.push(t,i),o.push(n,e);for(var v=1,y=d;v<m;v++,y+=g)o.push(n+Math.sin(y)*_,e+Math.cos(y)*_),o.push(n,e);o.push(r,s),o.push(n,e)}return m*2}function zq(n,e){var t=n.shape,i=n.points||t.points.slice(),r=e.closePointEps;if(i.length!==0){var s=n.lineStyle,o=new Bt(i[0],i[1]),a=new Bt(i[i.length-2],i[i.length-1]),l=t.type!==Tn.POLY||t.closeStroke,u=Math.abs(o.x-a.x)<r&&Math.abs(o.y-a.y)<r;if(l){i=i.slice(),u&&(i.pop(),i.pop(),a.set(i[i.length-2],i[i.length-1]));var c=(o.x+a.x)*.5,h=(a.y+o.y)*.5;i.unshift(c,h),i.push(c,h)}var d=e.points,f=i.length/2,p=i.length,_=d.length/2,m=s.width/2,g=m*m,v=s.miterLimit*s.miterLimit,y=i[0],x=i[1],b=i[2],S=i[3],T=0,P=0,E=-(x-S),M=y-b,O=0,L=0,C=Math.sqrt(E*E+M*M);E/=C,M/=C,E*=m,M*=m;var D=s.alignment,B=(1-D)*2,W=D*2;l||(s.cap===Bs.ROUND?p+=ha(y-E*(B-W)*.5,x-M*(B-W)*.5,y-E*B,x-M*B,y+E*W,x+M*W,d,!0)+2:s.cap===Bs.SQUARE&&(p+=WM(y,x,E,M,B,W,!0,d))),d.push(y-E*B,x-M*B),d.push(y+E*W,x+M*W);for(var U=1;U<f-1;++U){y=i[(U-1)*2],x=i[(U-1)*2+1],b=i[U*2],S=i[U*2+1],T=i[(U+1)*2],P=i[(U+1)*2+1],E=-(x-S),M=y-b,C=Math.sqrt(E*E+M*M),E/=C,M/=C,E*=m,M*=m,O=-(S-P),L=b-T,C=Math.sqrt(O*O+L*L),O/=C,L/=C,O*=m,L*=m;var $=b-y,J=x-S,j=b-T,F=P-S,X=$*j+J*F,re=J*j-F*$,ce=re<0;if(Math.abs(re)<.001*Math.abs(X)){d.push(b-E*B,S-M*B),d.push(b+E*W,S+M*W),X>=0&&(s.join===es.ROUND?p+=ha(b,S,b-E*B,S-M*B,b-O*B,S-L*B,d,!1)+4:p+=2,d.push(b-O*W,S-L*W),d.push(b+O*B,S+L*B));continue}var ve=(-E+y)*(-M+S)-(-E+b)*(-M+x),ae=(-O+T)*(-L+S)-(-O+b)*(-L+P),Y=($*ae-j*ve)/re,ne=(F*ve-J*ae)/re,he=(Y-b)*(Y-b)+(ne-S)*(ne-S),xe=b+(Y-b)*B,be=S+(ne-S)*B,w=b-(Y-b)*W,V=S-(ne-S)*W,H=Math.min($*$+J*J,j*j+F*F),K=ce?B:W,Z=H+K*K*g,ee=he<=Z;ee?s.join===es.BEVEL||he/g>v?(ce?(d.push(xe,be),d.push(b+E*W,S+M*W),d.push(xe,be),d.push(b+O*W,S+L*W)):(d.push(b-E*B,S-M*B),d.push(w,V),d.push(b-O*B,S-L*B),d.push(w,V)),p+=2):s.join===es.ROUND?ce?(d.push(xe,be),d.push(b+E*W,S+M*W),p+=ha(b,S,b+E*W,S+M*W,b+O*W,S+L*W,d,!0)+4,d.push(xe,be),d.push(b+O*W,S+L*W)):(d.push(b-E*B,S-M*B),d.push(w,V),p+=ha(b,S,b-E*B,S-M*B,b-O*B,S-L*B,d,!1)+4,d.push(b-O*B,S-L*B),d.push(w,V)):(d.push(xe,be),d.push(w,V)):(d.push(b-E*B,S-M*B),d.push(b+E*W,S+M*W),s.join===es.ROUND?ce?p+=ha(b,S,b+E*W,S+M*W,b+O*W,S+L*W,d,!0)+2:p+=ha(b,S,b-E*B,S-M*B,b-O*B,S-L*B,d,!1)+2:s.join===es.MITER&&he/g<=v&&(ce?(d.push(w,V),d.push(w,V)):(d.push(xe,be),d.push(xe,be)),p+=2),d.push(b-O*B,S-L*B),d.push(b+O*W,S+L*W),p+=2)}y=i[(f-2)*2],x=i[(f-2)*2+1],b=i[(f-1)*2],S=i[(f-1)*2+1],E=-(x-S),M=y-b,C=Math.sqrt(E*E+M*M),E/=C,M/=C,E*=m,M*=m,d.push(b-E*B,S-M*B),d.push(b+E*W,S+M*W),l||(s.cap===Bs.ROUND?p+=ha(b-E*(B-W)*.5,S-M*(B-W)*.5,b-E*B,S-M*B,b+E*W,S+M*W,d,!1)+2:s.cap===Bs.SQUARE&&(p+=WM(b,S,E,M,B,W,!1,d)));for(var ge=e.indices,le=Zu.epsilon*Zu.epsilon,U=_;U<p+_-2;++U)y=d[U*2],x=d[U*2+1],b=d[(U+1)*2],S=d[(U+1)*2+1],T=d[(U+2)*2],P=d[(U+2)*2+1],!(Math.abs(y*(S-P)+b*(P-x)+T*(x-S))<le)&&ge.push(U,U+1,U+2)}}function Wq(n,e){var t=0,i=n.shape,r=n.points||i.points,s=i.type!==Tn.POLY||i.closeStroke;if(r.length!==0){var o=e.points,a=e.indices,l=r.length/2,u=o.length/2,c=u;for(o.push(r[0],r[1]),t=1;t<l;t++)o.push(r[t*2],r[t*2+1]),a.push(c,c+1),c++;s&&a.push(c,u)}}function Q0(n,e){n.lineStyle.native?Wq(n,e):zq(n,e)}var ey=function(){function n(){}return n.curveTo=function(e,t,i,r,s,o){var a=o[o.length-2],l=o[o.length-1],u=l-t,c=a-e,h=r-t,d=i-e,f=Math.abs(u*d-c*h);if(f<1e-8||s===0)return(o[o.length-2]!==e||o[o.length-1]!==t)&&o.push(e,t),null;var p=u*u+c*c,_=h*h+d*d,m=u*h+c*d,g=s*Math.sqrt(p)/f,v=s*Math.sqrt(_)/f,y=g*m/p,x=v*m/_,b=g*d+v*c,S=g*h+v*u,T=c*(v+y),P=u*(v+y),E=d*(g+x),M=h*(g+x),O=Math.atan2(P-S,T-b),L=Math.atan2(M-S,E-b);return{cx:b+e,cy:S+t,radius:s,startAngle:O,endAngle:L,anticlockwise:c*h>d*u}},n.arc=function(e,t,i,r,s,o,a,l,u){for(var c=a-o,h=Zu._segmentsCount(Math.abs(c)*s,Math.ceil(Math.abs(c)/cd)*40),d=c/(h*2),f=d*2,p=Math.cos(d),_=Math.sin(d),m=h-1,g=m%1/m,v=0;v<=m;++v){var y=v+g*v,x=d+o+f*y,b=Math.cos(x),S=-Math.sin(x);u.push((p*b+_*S)*s+i,(p*-S+_*b)*s+r)}},n}(),eO=function(){function n(){}return n.curveLength=function(e,t,i,r,s,o,a,l){for(var u=10,c=0,h=0,d=0,f=0,p=0,_=0,m=0,g=0,v=0,y=0,x=0,b=e,S=t,T=1;T<=u;++T)h=T/u,d=h*h,f=d*h,p=1-h,_=p*p,m=_*p,g=m*e+3*_*h*i+3*p*d*s+f*a,v=m*t+3*_*h*r+3*p*d*o+f*l,y=b-g,x=S-v,b=g,S=v,c+=Math.sqrt(y*y+x*x);return c},n.curveTo=function(e,t,i,r,s,o,a){var l=a[a.length-2],u=a[a.length-1];a.length-=2;var c=Zu._segmentsCount(n.curveLength(l,u,e,t,i,r,s,o)),h=0,d=0,f=0,p=0,_=0;a.push(l,u);for(var m=1,g=0;m<=c;++m)g=m/c,h=1-g,d=h*h,f=d*h,p=g*g,_=p*g,a.push(f*l+3*d*g*e+3*h*p*i+_*s,f*u+3*d*g*t+3*h*p*r+_*o)},n}(),tO=function(){function n(){}return n.curveLength=function(e,t,i,r,s,o){var a=e-2*i+s,l=t-2*r+o,u=2*i-2*e,c=2*r-2*t,h=4*(a*a+l*l),d=4*(a*u+l*c),f=u*u+c*c,p=2*Math.sqrt(h+d+f),_=Math.sqrt(h),m=2*h*_,g=2*Math.sqrt(f),v=d/_;return(m*p+_*d*(p-g)+(4*f*h-d*d)*Math.log((2*_+v+p)/(v+g)))/(4*m)},n.curveTo=function(e,t,i,r,s){for(var o=s[s.length-2],a=s[s.length-1],l=Zu._segmentsCount(n.curveLength(o,a,e,t,i,r)),u=0,c=0,h=1;h<=l;++h){var d=h/l;u=o+(e-o)*d,c=a+(t-a)*d,s.push(u+(e+(i-e)*d-u)*d,c+(t+(r-t)*d-c)*d)}},n}(),nO=function(){function n(){this.reset()}return n.prototype.begin=function(e,t,i){this.reset(),this.style=e,this.start=t,this.attribStart=i},n.prototype.end=function(e,t){this.attribSize=t-this.attribStart,this.size=e-this.start},n.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},n}(),da,Lp=(da={},da[Tn.POLY]=jb,da[Tn.CIRC]=vd,da[Tn.ELIP]=vd,da[Tn.RECT]=JL,da[Tn.RREC]=QL,da),ty=[],yh=[],ny=function(){function n(e,t,i,r){t===void 0&&(t=null),i===void 0&&(i=null),r===void 0&&(r=null),this.points=[],this.holes=[],this.shape=e,this.lineStyle=i,this.fillStyle=t,this.matrix=r,this.type=e.type}return n.prototype.clone=function(){return new n(this.shape,this.fillStyle,this.lineStyle,this.matrix)},n.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},n}(),Ul=new Bt,iO=function(n){Xb(e,n);function e(){var t=n.call(this)||this;return t.closePointEps=1e-4,t.boundsPadding=0,t.uvsFloat32=null,t.indicesUint16=null,t.batchable=!1,t.points=[],t.colors=[],t.uvs=[],t.indices=[],t.textureIds=[],t.graphicsData=[],t.drawCalls=[],t.batchDirty=-1,t.batches=[],t.dirty=0,t.cacheDirty=-1,t.clearDirty=0,t.shapeIndex=0,t._bounds=new dd,t.boundsDirty=-1,t}return Object.defineProperty(e.prototype,"bounds",{get:function(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),e.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),yh.push(this.drawCalls[t]);this.drawCalls.length=0;for(var t=0;t<this.batches.length;t++){var i=this.batches[t];i.reset(),ty.push(i)}this.batches.length=0},e.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},e.prototype.drawShape=function(t,i,r,s){i===void 0&&(i=null),r===void 0&&(r=null),s===void 0&&(s=null);var o=new ny(t,i,r,s);return this.graphicsData.push(o),this.dirty++,this},e.prototype.drawHole=function(t,i){if(i===void 0&&(i=null),!this.graphicsData.length)return null;var r=new ny(t,null,null,i),s=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=s.lineStyle,s.holes.push(r),this.dirty++,this},e.prototype.destroy=function(){n.prototype.destroy.call(this);for(var t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},e.prototype.containsPoint=function(t){for(var i=this.graphicsData,r=0;r<i.length;++r){var s=i[r];if(s.fillStyle.visible&&s.shape&&(s.matrix?s.matrix.applyInverse(t,Ul):Ul.copyFrom(t),s.shape.contains(Ul.x,Ul.y))){var o=!1;if(s.holes)for(var a=0;a<s.holes.length;a++){var l=s.holes[a];if(l.shape.contains(Ul.x,Ul.y)){o=!0;break}}if(!o)return!0}}return!1},e.prototype.updateBatches=function(){if(!this.graphicsData.length){this.batchable=!0;return}if(this.validateBatching()){this.cacheDirty=this.dirty;var t=this.uvs,i=this.graphicsData,r=null,s=null;this.batches.length>0&&(r=this.batches[this.batches.length-1],s=r.style);for(var o=this.shapeIndex;o<i.length;o++){this.shapeIndex++;var a=i[o],l=a.fillStyle,u=a.lineStyle,c=Lp[a.type];c.build(a),a.matrix&&this.transformPoints(a.points,a.matrix),(l.visible||u.visible)&&this.processHoles(a.holes);for(var h=0;h<2;h++){var d=h===0?l:u;if(d.visible){var f=d.texture.baseTexture,p=this.indices.length,_=this.points.length/2;f.wrapMode=Ar.REPEAT,h===0?this.processFill(a):this.processLine(a);var m=this.points.length/2-_;m!==0&&(r&&!this._compareStyles(s,d)&&(r.end(p,_),r=null),r||(r=ty.pop()||new nO,r.begin(d,p,_),this.batches.push(r),s=d),this.addUvs(this.points,t,d.texture,_,m,d.matrix))}}}var g=this.indices.length,v=this.points.length/2;if(r&&r.end(g,v),this.batches.length===0){this.batchable=!0;return}var y=v>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&y===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=y?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}},e.prototype._compareStyles=function(t,i){return!(!t||!i||t.texture.baseTexture!==i.texture.baseTexture||t.color+t.alpha!==i.color+i.alpha||!!t.native!=!!i.native)},e.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var t=0,i=this.graphicsData.length;t<i;t++){var r=this.graphicsData[t],s=r.fillStyle,o=r.lineStyle;if(s&&!s.texture.baseTexture.valid||o&&!o.texture.baseTexture.valid)return!1}return!0},e.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var t=this.batches,i=0,r=t.length;i<r;i++)for(var s=t[i],o=0;o<s.size;o++){var a=s.start+o;this.indicesUint16[a]=this.indicesUint16[a]-s.attribStart}},e.prototype.isBatchable=function(){if(this.points.length>65535*2)return!1;for(var t=this.batches,i=0;i<t.length;i++)if(t[i].style.native)return!1;return this.points.length<e.BATCHABLE_SIZE*2},e.prototype.buildDrawCalls=function(){for(var t=++xt._globalBatch,i=0;i<this.drawCalls.length;i++)this.drawCalls[i].texArray.clear(),yh.push(this.drawCalls[i]);this.drawCalls.length=0;var r=this.colors,s=this.textureIds,o=yh.pop();o||(o=new sm,o.texArray=new om),o.texArray.count=0,o.start=0,o.size=0,o.type=Ji.TRIANGLES;var a=0,l=null,u=0,c=!1,h=Ji.TRIANGLES,d=0;this.drawCalls.push(o);for(var i=0;i<this.batches.length;i++){var f=this.batches[i],p=8,_=f.style,m=_.texture.baseTexture;c!==!!_.native&&(c=!!_.native,h=c?Ji.LINES:Ji.TRIANGLES,l=null,a=p,t++),l!==m&&(l=m,m._batchEnabled!==t&&(a===p&&(t++,a=0,o.size>0&&(o=yh.pop(),o||(o=new sm,o.texArray=new om),this.drawCalls.push(o)),o.start=d,o.size=0,o.texArray.count=0,o.type=h),m.touched=1,m._batchEnabled=t,m._batchLocation=a,m.wrapMode=Ar.REPEAT,o.texArray.elements[o.texArray.count++]=m,a++)),o.size+=f.size,d+=f.size,u=m._batchLocation,this.addColors(r,_.color,_.alpha,f.attribSize,f.attribStart),this.addTextureIds(s,u,f.attribSize,f.attribStart)}xt._globalBatch=t,this.packAttributes()},e.prototype.packAttributes=function(){for(var t=this.points,i=this.uvs,r=this.colors,s=this.textureIds,o=new ArrayBuffer(t.length*3*4),a=new Float32Array(o),l=new Uint32Array(o),u=0,c=0;c<t.length/2;c++)a[u++]=t[c*2],a[u++]=t[c*2+1],a[u++]=i[c*2],a[u++]=i[c*2+1],l[u++]=r[c],a[u++]=s[c];this._buffer.update(o),this._indexBuffer.update(this.indicesUint16)},e.prototype.processFill=function(t){if(t.holes.length)jb.triangulate(t,this);else{var i=Lp[t.type];i.triangulate(t,this)}},e.prototype.processLine=function(t){Q0(t,this);for(var i=0;i<t.holes.length;i++)Q0(t.holes[i],this)},e.prototype.processHoles=function(t){for(var i=0;i<t.length;i++){var r=t[i],s=Lp[r.type];s.build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}},e.prototype.calculateBounds=function(){var t=this._bounds;t.clear(),t.addVertexData(this.points,0,this.points.length),t.pad(this.boundsPadding,this.boundsPadding)},e.prototype.transformPoints=function(t,i){for(var r=0;r<t.length/2;r++){var s=t[r*2],o=t[r*2+1];t[r*2]=i.a*s+i.c*o+i.tx,t[r*2+1]=i.b*s+i.d*o+i.ty}},e.prototype.addColors=function(t,i,r,s,o){o===void 0&&(o=0);var a=(i>>16)+(i&65280)+((i&255)<<16),l=rg(a,r);t.length=Math.max(t.length,o+s);for(var u=0;u<s;u++)t[o+u]=l},e.prototype.addTextureIds=function(t,i,r,s){s===void 0&&(s=0),t.length=Math.max(t.length,s+r);for(var o=0;o<r;o++)t[s+o]=i},e.prototype.addUvs=function(t,i,r,s,o,a){a===void 0&&(a=null);for(var l=0,u=i.length,c=r.frame;l<o;){var h=t[(s+l)*2],d=t[(s+l)*2+1];if(a){var f=a.a*h+a.c*d+a.tx;d=a.b*h+a.d*d+a.ty,h=f}l++,i.push(h/c.width,d/c.height)}var p=r.baseTexture;(c.width<p.width||c.height<p.height)&&this.adjustUvs(i,r,u,o)},e.prototype.adjustUvs=function(t,i,r,s){for(var o=i.baseTexture,a=1e-6,l=r+s*2,u=i.frame,c=u.width/o.width,h=u.height/o.height,d=u.x/u.width,f=u.y/u.height,p=Math.floor(t[r]+a),_=Math.floor(t[r+1]+a),m=r+2;m<l;m+=2)p=Math.min(p,Math.floor(t[m]+a)),_=Math.min(_,Math.floor(t[m+1]+a));d-=p,f-=_;for(var m=r;m<l;m+=2)t[m]=(t[m]+d)*c,t[m+1]=(t[m+1]+f)*h},e.BATCHABLE_SIZE=100,e}(Db),rO=function(n){Xb(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.width=0,t.alignment=.5,t.native=!1,t.cap=Bs.BUTT,t.join=es.MITER,t.miterLimit=10,t}return e.prototype.clone=function(){var t=new e;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t},e.prototype.reset=function(){n.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},e}(Wb),Xq=new Float32Array(3),k_={},yd=function(n){Xb(e,n);function e(t){t===void 0&&(t=null);var i=n.call(this)||this;return i.shader=null,i.pluginName="batch",i.currentPath=null,i.batches=[],i.batchTint=-1,i.batchDirty=-1,i.vertexData=null,i._fillStyle=new Wb,i._lineStyle=new rO,i._matrix=null,i._holeMode=!1,i.state=qo.for2d(),i._geometry=t||new iO,i._geometry.refCount++,i._transformID=-1,i.tint=16777215,i.blendMode=He.NORMAL,i}return Object.defineProperty(e.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return this.finishPoly(),new e(this._geometry)},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),e.prototype.lineStyle=function(t,i,r,s,o){return t===void 0&&(t=null),i===void 0&&(i=0),r===void 0&&(r=1),s===void 0&&(s=.5),o===void 0&&(o=!1),typeof t=="number"&&(t={width:t,color:i,alpha:r,alignment:s,native:o}),this.lineTextureStyle(t)},e.prototype.lineTextureStyle=function(t){t=Object.assign({width:0,texture:Ke.WHITE,color:t&&t.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:Bs.BUTT,join:es.MITER,miterLimit:10},t),this.currentPath&&this.startPoly();var i=t.width>0&&t.alpha>0;return i?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:i},t)):this._lineStyle.reset(),this},e.prototype.startPoly=function(){if(this.currentPath){var t=this.currentPath.points,i=this.currentPath.points.length;i>2&&(this.drawShape(this.currentPath),this.currentPath=new Dh,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[i-2],t[i-1]))}else this.currentPath=new Dh,this.currentPath.closeStroke=!1},e.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},e.prototype.moveTo=function(t,i){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=i,this},e.prototype.lineTo=function(t,i){this.currentPath||this.moveTo(0,0);var r=this.currentPath.points,s=r[r.length-2],o=r[r.length-1];return(s!==t||o!==i)&&r.push(t,i),this},e.prototype._initCurve=function(t,i){t===void 0&&(t=0),i===void 0&&(i=0),this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[t,i]):this.moveTo(t,i)},e.prototype.quadraticCurveTo=function(t,i,r,s){this._initCurve();var o=this.currentPath.points;return o.length===0&&this.moveTo(0,0),tO.curveTo(t,i,r,s,o),this},e.prototype.bezierCurveTo=function(t,i,r,s,o,a){return this._initCurve(),eO.curveTo(t,i,r,s,o,a,this.currentPath.points),this},e.prototype.arcTo=function(t,i,r,s,o){this._initCurve(t,i);var a=this.currentPath.points,l=ey.curveTo(t,i,r,s,o,a);if(l){var u=l.cx,c=l.cy,h=l.radius,d=l.startAngle,f=l.endAngle,p=l.anticlockwise;this.arc(u,c,h,d,f,p)}return this},e.prototype.arc=function(t,i,r,s,o,a){if(a===void 0&&(a=!1),s===o)return this;!a&&o<=s?o+=cd:a&&s<=o&&(s+=cd);var l=o-s;if(l===0)return this;var u=t+Math.cos(s)*r,c=i+Math.sin(s)*r,h=this._geometry.closePointEps,d=this.currentPath?this.currentPath.points:null;if(d){var f=Math.abs(d[d.length-2]-u),p=Math.abs(d[d.length-1]-c);f<h&&p<h||d.push(u,c)}else this.moveTo(u,c),d=this.currentPath.points;return ey.arc(u,c,t,i,r,s,o,a,d),this},e.prototype.beginFill=function(t,i){return t===void 0&&(t=0),i===void 0&&(i=1),this.beginTextureFill({texture:Ke.WHITE,color:t,alpha:i})},e.prototype.beginTextureFill=function(t){t=Object.assign({texture:Ke.WHITE,color:16777215,alpha:1,matrix:null},t),this.currentPath&&this.startPoly();var i=t.alpha>0;return i?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:i},t)):this._fillStyle.reset(),this},e.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},e.prototype.drawRect=function(t,i,r,s){return this.drawShape(new St(t,i,r,s))},e.prototype.drawRoundedRect=function(t,i,r,s,o){return this.drawShape(new TI(t,i,r,s,o))},e.prototype.drawCircle=function(t,i,r){return this.drawShape(new SI(t,i,r))},e.prototype.drawEllipse=function(t,i,r,s){return this.drawShape(new EI(t,i,r,s))},e.prototype.drawPolygon=function(){for(var t=arguments,i=[],r=0;r<arguments.length;r++)i[r]=t[r];var s,o=!0,a=i[0];a.points?(o=a.closeStroke,s=a.points):Array.isArray(i[0])?s=i[0]:s=i;var l=new Dh(s);return l.closeStroke=o,this.drawShape(l),this},e.prototype.drawShape=function(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},e.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},e.prototype.isFastRect=function(){var t=this._geometry.graphicsData;return t.length===1&&t[0].shape.type===Tn.RECT&&!t[0].matrix&&!t[0].holes.length&&!(t[0].lineStyle.visible&&t[0].lineStyle.width)},e.prototype._render=function(t){this.finishPoly();var i=this._geometry;i.updateBatches(),i.batchable?(this.batchDirty!==i.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))},e.prototype._populateBatches=function(){var t=this._geometry,i=this.blendMode,r=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=r,this.vertexData=new Float32Array(t.points);for(var s=0;s<r;s++){var o=t.batches[s],a=o.style.color,l=new Float32Array(this.vertexData.buffer,o.attribStart*4*2,o.attribSize*2),u=new Float32Array(t.uvsFloat32.buffer,o.attribStart*4*2,o.attribSize*2),c=new Uint16Array(t.indicesUint16.buffer,o.start*2,o.size),h={vertexData:l,blendMode:i,indices:c,uvs:u,_batchRGB:hl(a),_tintRGB:a,_texture:o.style.texture,alpha:o.style.alpha,worldAlpha:1};this.batches[s]=h}},e.prototype._renderBatched=function(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var i=0,r=this.batches.length;i<r;i++){var s=this.batches[i];s.worldAlpha=this.worldAlpha*s.alpha,t.plugins[this.pluginName].render(s)}}},e.prototype._renderDirect=function(t){var i=this._resolveDirectShader(t),r=this._geometry,s=this.tint,o=this.worldAlpha,a=i.uniforms,l=r.drawCalls;a.translationMatrix=this.transform.worldTransform,a.tint[0]=(s>>16&255)/255*o,a.tint[1]=(s>>8&255)/255*o,a.tint[2]=(s&255)/255*o,a.tint[3]=o,t.shader.bind(i),t.geometry.bind(r,i),t.state.set(this.state);for(var u=0,c=l.length;u<c;u++)this._renderDrawCallDirect(t,r.drawCalls[u])},e.prototype._renderDrawCallDirect=function(t,i){for(var r=i.texArray,s=i.type,o=i.size,a=i.start,l=r.count,u=0;u<l;u++)t.texture.bind(r.elements[u],u);t.geometry.draw(s,o,a)},e.prototype._resolveDirectShader=function(t){var i=this.shader,r=this.pluginName;if(!i){if(!k_[r]){for(var s=t.plugins[r].MAX_TEXTURES,o=new Int32Array(s),a=0;a<s;a++)o[a]=a;var l={tint:new Float32Array([1,1,1,1]),translationMatrix:new kt,default:Do.from({uSamplers:o},!0)},u=t.plugins[r]._shader.program;k_[r]=new Xs(u,l)}i=k_[r]}return i},e.prototype._calculateBounds=function(){this.finishPoly();var t=this._geometry;if(t.graphicsData.length){var i=t.bounds,r=i.minX,s=i.minY,o=i.maxX,a=i.maxY;this._bounds.addFrame(this.transform,r,s,o,a)}},e.prototype.containsPoint=function(t){return this.worldTransform.applyInverse(t,e._TEMP_POINT),this._geometry.containsPoint(e._TEMP_POINT)},e.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var t=hl(this.tint,Xq),i=0;i<this.batches.length;i++){var r=this.batches[i],s=r._batchRGB,o=t[0]*s[0]*255,a=t[1]*s[1]*255,l=t[2]*s[2]*255,u=(o<<16)+(a<<8)+(l|0);r._tintRGB=(u>>16)+(u&65280)+((u&255)<<16)}}},e.prototype.calculateVertices=function(){var t=this.transform._worldID;if(this._transformID!==t){this._transformID=t;for(var i=this.transform.worldTransform,r=i.a,s=i.b,o=i.c,a=i.d,l=i.tx,u=i.ty,c=this._geometry.points,h=this.vertexData,d=0,f=0;f<c.length;f+=2){var p=c[f],_=c[f+1];h[d++]=r*p+o*_+l,h[d++]=a*_+s*p+u}}},e.prototype.closePath=function(){var t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this},e.prototype.setMatrix=function(t){return this._matrix=t,this},e.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},e.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},e.prototype.destroy=function(t){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,n.prototype.destroy.call(this,t)},e.nextRoundedRectBehavior=!1,e._TEMP_POINT=new Bt,e}(Oi),jq={buildPoly:jb,buildCircle:vd,buildRectangle:JL,buildRoundedRectangle:QL,buildLine:Q0,ArcUtils:ey,BezierUtils:eO,QuadraticUtils:tO,BatchPart:nO,FILL_COMMANDS:Lp,BATCH_POOL:ty,DRAW_CALL_POOL:yh};/*!
 * @pixi/sprite - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/sprite is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var iy=function(n,e){return iy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},iy(n,e)};function $q(n,e){iy(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var jc=new Bt,Yq=new Uint16Array([0,1,2,0,2,3]),Tc=function(n){$q(e,n);function e(t){var i=n.call(this)||this;return i._anchor=new Us(i._onAnchorUpdate,i,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),i._texture=null,i._width=0,i._height=0,i._tint=null,i._tintRGB=null,i.tint=16777215,i.blendMode=He.NORMAL,i._cachedTint=16777215,i.uvs=null,i.texture=t||Ke.EMPTY,i.vertexData=new Float32Array(8),i.vertexTrimmedData=null,i._transformID=-1,i._textureID=-1,i._transformTrimmedID=-1,i._textureTrimmedID=-1,i.indices=Yq,i.pluginName="batch",i.isSprite=!0,i._roundPixels=Oe.ROUND_PIXELS,i}return e.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=ja(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=ja(this.scale.y)*this._height/this._texture.orig.height)},e.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},e.prototype.calculateVertices=function(){var t=this._texture;if(!(this._transformID===this.transform._worldID&&this._textureID===t._updateID)){this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;var i=this.transform.worldTransform,r=i.a,s=i.b,o=i.c,a=i.d,l=i.tx,u=i.ty,c=this.vertexData,h=t.trim,d=t.orig,f=this._anchor,p=0,_=0,m=0,g=0;if(h?(_=h.x-f._x*d.width,p=_+h.width,g=h.y-f._y*d.height,m=g+h.height):(_=-f._x*d.width,p=_+d.width,g=-f._y*d.height,m=g+d.height),c[0]=r*_+o*g+l,c[1]=a*g+s*_+u,c[2]=r*p+o*g+l,c[3]=a*g+s*p+u,c[4]=r*p+o*m+l,c[5]=a*m+s*p+u,c[6]=r*_+o*m+l,c[7]=a*m+s*_+u,this._roundPixels)for(var v=Oe.RESOLUTION,y=0;y<c.length;++y)c[y]=Math.round((c[y]*v|0)/v)}},e.prototype.calculateTrimmedVertices=function(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,i=this.vertexTrimmedData,r=t.orig,s=this._anchor,o=this.transform.worldTransform,a=o.a,l=o.b,u=o.c,c=o.d,h=o.tx,d=o.ty,f=-s._x*r.width,p=f+r.width,_=-s._y*r.height,m=_+r.height;i[0]=a*f+u*_+h,i[1]=c*_+l*f+d,i[2]=a*p+u*_+h,i[3]=c*_+l*p+d,i[4]=a*p+u*m+h,i[5]=c*m+l*p+d,i[6]=a*f+u*m+h,i[7]=c*m+l*f+d},e.prototype._render=function(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._calculateBounds=function(){var t=this._texture.trim,i=this._texture.orig;!t||t.width===i.width&&t.height===i.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},e.prototype.getLocalBounds=function(t){return this.children.length===0?(this._localBounds||(this._localBounds=new dd),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new St),t=this._localBoundsRect),this._localBounds.getRectangle(t)):n.prototype.getLocalBounds.call(this,t)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,jc);var i=this._texture.orig.width,r=this._texture.orig.height,s=-i*this.anchor.x,o=0;return jc.x>=s&&jc.x<s+i&&(o=-r*this.anchor.y,jc.y>=o&&jc.y<o+r)},e.prototype.destroy=function(t){n.prototype.destroy.call(this,t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null;var i=typeof t=="boolean"?t:t&&t.texture;if(i){var r=typeof t=="boolean"?t:t&&t.baseTexture;this._texture.destroy(!!r)}this._texture=null},e.from=function(t,i){var r=t instanceof Ke?t:Ke.from(t,i);return new e(r)},Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){var i=ja(this.scale.x)||1;this.scale.x=i*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){var i=ja(this.scale.y)||1;this.scale.y=i*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},set:function(t){this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,this._tintRGB=(t>>16)+(t&65280)+((t&255)<<16)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||Ke.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))},enumerable:!1,configurable:!0}),e}(Oi);/*!
 * @pixi/text - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/text is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ry=function(n,e){return ry=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},ry(n,e)};function qq(n,e){ry(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Ju;(function(n){n[n.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",n[n.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL"})(Ju||(Ju={}));var V_={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Ju.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},Kq=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],fl=function(){function n(e){this.styleID=0,this.reset(),H_(this,e,e)}return n.prototype.clone=function(){var e={};return H_(e,this,V_),new n(e)},n.prototype.reset=function(){H_(this,V_,V_)},Object.defineProperty(n.prototype,"align",{get:function(){return this._align},set:function(e){this._align!==e&&(this._align=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"breakWords",{get:function(){return this._breakWords},set:function(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dropShadow",{get:function(){return this._dropShadow},set:function(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dropShadowAlpha",{get:function(){return this._dropShadowAlpha},set:function(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dropShadowAngle",{get:function(){return this._dropShadowAngle},set:function(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dropShadowBlur",{get:function(){return this._dropShadowBlur},set:function(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dropShadowColor",{get:function(){return this._dropShadowColor},set:function(e){var t=G_(e);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dropShadowDistance",{get:function(){return this._dropShadowDistance},set:function(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fill",{get:function(){return this._fill},set:function(e){var t=G_(e);this._fill!==t&&(this._fill=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fillGradientType",{get:function(){return this._fillGradientType},set:function(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fillGradientStops",{get:function(){return this._fillGradientStops},set:function(e){Zq(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fontSize",{get:function(){return this._fontSize},set:function(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fontVariant",{get:function(){return this._fontVariant},set:function(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"leading",{get:function(){return this._leading},set:function(e){this._leading!==e&&(this._leading=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"miterLimit",{get:function(){return this._miterLimit},set:function(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"padding",{get:function(){return this._padding},set:function(e){this._padding!==e&&(this._padding=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"stroke",{get:function(){return this._stroke},set:function(e){var t=G_(e);this._stroke!==t&&(this._stroke=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"strokeThickness",{get:function(){return this._strokeThickness},set:function(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textBaseline",{get:function(){return this._textBaseline},set:function(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"trim",{get:function(){return this._trim},set:function(e){this._trim!==e&&(this._trim=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"whiteSpace",{get:function(){return this._whiteSpace},set:function(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"wordWrapWidth",{get:function(){return this._wordWrapWidth},set:function(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)},enumerable:!1,configurable:!0}),n.prototype.toFontString=function(){var e=typeof this.fontSize=="number"?this.fontSize+"px":this.fontSize,t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(var i=t.length-1;i>=0;i--){var r=t[i].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&Kq.indexOf(r)<0&&(r='"'+r+'"'),t[i]=r}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+e+" "+t.join(",")},n}();function XM(n){return typeof n=="number"?rb(n):(typeof n=="string"&&n.indexOf("0x")===0&&(n=n.replace("0x","#")),n)}function G_(n){if(Array.isArray(n)){for(var e=0;e<n.length;++e)n[e]=XM(n[e]);return n}else return XM(n)}function Zq(n,e){if(!Array.isArray(n)||!Array.isArray(e)||n.length!==e.length)return!1;for(var t=0;t<n.length;++t)if(n[t]!==e[t])return!1;return!0}function H_(n,e,t){for(var i in t)Array.isArray(e[i])?n[i]=e[i].slice():n[i]=e[i]}var Bf={willReadFrequently:!0},Br=function(){function n(e,t,i,r,s,o,a,l,u){this.text=e,this.style=t,this.width=i,this.height=r,this.lines=s,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=u}return n.measureText=function(e,t,i,r){r===void 0&&(r=n._canvas),i=i??t.wordWrap;var s=t.toFontString(),o=n.measureFont(s);o.fontSize===0&&(o.fontSize=t.fontSize,o.ascent=t.fontSize);var a=r.getContext("2d",Bf);a.font=s;for(var l=i?n.wordWrap(e,t,r):e,u=l.split(/(?:\r\n|\r|\n)/),c=new Array(u.length),h=0,d=0;d<u.length;d++){var f=a.measureText(u[d]).width+(u[d].length-1)*t.letterSpacing;c[d]=f,h=Math.max(h,f)}var p=h+t.strokeThickness;t.dropShadow&&(p+=t.dropShadowDistance);var _=t.lineHeight||o.fontSize+t.strokeThickness,m=Math.max(_,o.fontSize+t.strokeThickness)+(u.length-1)*(_+t.leading);return t.dropShadow&&(m+=t.dropShadowDistance),new n(e,t,p,m,u,c,_+t.leading,h,o)},n.wordWrap=function(e,t,i){i===void 0&&(i=n._canvas);for(var r=i.getContext("2d",Bf),s=0,o="",a="",l=Object.create(null),u=t.letterSpacing,c=t.whiteSpace,h=n.collapseSpaces(c),d=n.collapseNewlines(c),f=!h,p=t.wordWrapWidth+u,_=n.tokenize(e),m=0;m<_.length;m++){var g=_[m];if(n.isNewline(g)){if(!d){a+=n.addLine(o),f=!h,o="",s=0;continue}g=" "}if(h){var v=n.isBreakingSpace(g),y=n.isBreakingSpace(o[o.length-1]);if(v&&y)continue}var x=n.getFromCache(g,u,l,r);if(x>p)if(o!==""&&(a+=n.addLine(o),o="",s=0),n.canBreakWords(g,t.breakWords))for(var b=n.wordWrapSplit(g),S=0;S<b.length;S++){for(var T=b[S],P=1;b[S+P];){var E=b[S+P],M=T[T.length-1];if(!n.canBreakChars(M,E,g,S,t.breakWords))T+=E;else break;P++}S+=T.length-1;var O=n.getFromCache(T,u,l,r);O+s>p&&(a+=n.addLine(o),f=!1,o="",s=0),o+=T,s+=O}else{o.length>0&&(a+=n.addLine(o),o="",s=0);var L=m===_.length-1;a+=n.addLine(g,!L),f=!1,o="",s=0}else x+s>p&&(f=!1,a+=n.addLine(o),o="",s=0),(o.length>0||!n.isBreakingSpace(g)||f)&&(o+=g,s+=x)}return a+=n.addLine(o,!1),a},n.addLine=function(e,t){return t===void 0&&(t=!0),e=n.trimRight(e),e=t?e+`
`:e,e},n.getFromCache=function(e,t,i,r){var s=i[e];if(typeof s!="number"){var o=e.length*t;s=r.measureText(e).width+o,i[e]=s}return s},n.collapseSpaces=function(e){return e==="normal"||e==="pre-line"},n.collapseNewlines=function(e){return e==="normal"},n.trimRight=function(e){if(typeof e!="string")return"";for(var t=e.length-1;t>=0;t--){var i=e[t];if(!n.isBreakingSpace(i))break;e=e.slice(0,-1)}return e},n.isNewline=function(e){return typeof e!="string"?!1:n._newlines.indexOf(e.charCodeAt(0))>=0},n.isBreakingSpace=function(e,t){return typeof e!="string"?!1:n._breakingSpaces.indexOf(e.charCodeAt(0))>=0},n.tokenize=function(e){var t=[],i="";if(typeof e!="string")return t;for(var r=0;r<e.length;r++){var s=e[r],o=e[r+1];if(n.isBreakingSpace(s,o)||n.isNewline(s)){i!==""&&(t.push(i),i=""),t.push(s);continue}i+=s}return i!==""&&t.push(i),t},n.canBreakWords=function(e,t){return t},n.canBreakChars=function(e,t,i,r,s){return!0},n.wordWrapSplit=function(e){return e.split("")},n.measureFont=function(e){if(n._fonts[e])return n._fonts[e];var t={ascent:0,descent:0,fontSize:0},i=n._canvas,r=n._context;r.font=e;var s=n.METRICS_STRING+n.BASELINE_SYMBOL,o=Math.ceil(r.measureText(s).width),a=Math.ceil(r.measureText(n.BASELINE_SYMBOL).width),l=Math.ceil(n.HEIGHT_MULTIPLIER*a);a=a*n.BASELINE_MULTIPLIER|0,i.width=o,i.height=l,r.fillStyle="#f00",r.fillRect(0,0,o,l),r.font=e,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(s,0,a);var u=r.getImageData(0,0,o,l).data,c=u.length,h=o*4,d=0,f=0,p=!1;for(d=0;d<a;++d){for(var _=0;_<h;_+=4)if(u[f+_]!==255){p=!0;break}if(!p)f+=h;else break}for(t.ascent=a-d,f=c-h,p=!1,d=l;d>a;--d){for(var _=0;_<h;_+=4)if(u[f+_]!==255){p=!0;break}if(!p)f-=h;else break}return t.descent=d-a,t.fontSize=t.ascent+t.descent,n._fonts[e]=t,t},n.clearMetrics=function(e){e===void 0&&(e=""),e?delete n._fonts[e]:n._fonts={}},Object.defineProperty(n,"_canvas",{get:function(){if(!n.__canvas){var e=void 0;try{var t=new OffscreenCanvas(0,0),i=t.getContext("2d",Bf);if(i&&i.measureText)return n.__canvas=t,t;e=Oe.ADAPTER.createCanvas()}catch{e=Oe.ADAPTER.createCanvas()}e.width=e.height=10,n.__canvas=e}return n.__canvas},enumerable:!1,configurable:!0}),Object.defineProperty(n,"_context",{get:function(){return n.__context||(n.__context=n._canvas.getContext("2d",Bf)),n.__context},enumerable:!1,configurable:!0}),n}();Br._fonts={};Br.METRICS_STRING="|ÉqÅ";Br.BASELINE_SYMBOL="M";Br.BASELINE_MULTIPLIER=1.4;Br.HEIGHT_MULTIPLIER=2;Br._newlines=[10,13];Br._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var Jq={texture:!0,children:!1,baseTexture:!0},$b=function(n){qq(e,n);function e(t,i,r){var s=this,o=!1;r||(r=Oe.ADAPTER.createCanvas(),o=!0),r.width=3,r.height=3;var a=Ke.from(r);return a.orig=new St,a.trim=new St,s=n.call(this,a)||this,s._ownCanvas=o,s.canvas=r,s.context=r.getContext("2d",{willReadFrequently:!0}),s._resolution=Oe.RESOLUTION,s._autoResolution=!0,s._text=null,s._style=null,s._styleListener=null,s._font="",s.text=t,s.style=i,s.localStyleID=-1,s}return e.prototype.updateText=function(t){var i=this._style;if(this.localStyleID!==i.styleID&&(this.dirty=!0,this.localStyleID=i.styleID),!(!this.dirty&&t)){this._font=this._style.toFontString();var r=this.context,s=Br.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),o=s.width,a=s.height,l=s.lines,u=s.lineHeight,c=s.lineWidths,h=s.maxLineWidth,d=s.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,o)+i.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,a)+i.padding*2)*this._resolution),r.scale(this._resolution,this._resolution),r.clearRect(0,0,this.canvas.width,this.canvas.height),r.font=this._font,r.lineWidth=i.strokeThickness,r.textBaseline=i.textBaseline,r.lineJoin=i.lineJoin,r.miterLimit=i.miterLimit;for(var f,p,_=i.dropShadow?2:1,m=0;m<_;++m){var g=i.dropShadow&&m===0,v=g?Math.ceil(Math.max(1,a)+i.padding*2):0,y=v*this._resolution;if(g){r.fillStyle="black",r.strokeStyle="black";var x=i.dropShadowColor,b=hl(typeof x=="number"?x:sb(x)),S=i.dropShadowBlur*this._resolution,T=i.dropShadowDistance*this._resolution;r.shadowColor="rgba("+b[0]*255+","+b[1]*255+","+b[2]*255+","+i.dropShadowAlpha+")",r.shadowBlur=S,r.shadowOffsetX=Math.cos(i.dropShadowAngle)*T,r.shadowOffsetY=Math.sin(i.dropShadowAngle)*T+y}else r.fillStyle=this._generateFillStyle(i,l,s),r.strokeStyle=i.stroke,r.shadowColor="black",r.shadowBlur=0,r.shadowOffsetX=0,r.shadowOffsetY=0;var P=(u-d.fontSize)/2;(!e.nextLineHeightBehavior||u-d.fontSize<0)&&(P=0);for(var E=0;E<l.length;E++)f=i.strokeThickness/2,p=i.strokeThickness/2+E*u+d.ascent+P,i.align==="right"?f+=h-c[E]:i.align==="center"&&(f+=(h-c[E])/2),i.stroke&&i.strokeThickness&&this.drawLetterSpacing(l[E],f+i.padding,p+i.padding-v,!0),i.fill&&this.drawLetterSpacing(l[E],f+i.padding,p+i.padding-v)}this.updateTexture()}},e.prototype.drawLetterSpacing=function(t,i,r,s){s===void 0&&(s=!1);var o=this._style,a=o.letterSpacing,l=e.experimentalLetterSpacing&&("letterSpacing"in CanvasRenderingContext2D.prototype||"textLetterSpacing"in CanvasRenderingContext2D.prototype);if(a===0||l){l&&(this.context.letterSpacing=a,this.context.textLetterSpacing=a),s?this.context.strokeText(t,i,r):this.context.fillText(t,i,r);return}for(var u=i,c=Array.from?Array.from(t):t.split(""),h=this.context.measureText(t).width,d=0,f=0;f<c.length;++f){var p=c[f];s?this.context.strokeText(p,u,r):this.context.fillText(p,u,r);for(var _="",m=f+1;m<c.length;++m)_+=c[m];d=this.context.measureText(_).width,u+=h-d+a,h=d}},e.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var i=_I(t);i.data&&(t.width=i.width,t.height=i.height,this.context.putImageData(i.data,0,0))}var r=this._texture,s=this._style,o=s.trim?0:s.padding,a=r.baseTexture;r.trim.width=r._frame.width=t.width/this._resolution,r.trim.height=r._frame.height=t.height/this._resolution,r.trim.x=-o,r.trim.y=-o,r.orig.width=r._frame.width-o*2,r.orig.height=r._frame.height-o*2,this._onTextureUpdate(),a.setRealSize(t.width,t.height,this._resolution),r.updateUvs(),this.dirty=!1},e.prototype._render=function(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),n.prototype._render.call(this,t)},e.prototype.updateTransform=function(){this.updateText(!0),n.prototype.updateTransform.call(this)},e.prototype.getBounds=function(t,i){return this.updateText(!0),this._textureID===-1&&(t=!1),n.prototype.getBounds.call(this,t,i)},e.prototype.getLocalBounds=function(t){return this.updateText(!0),n.prototype.getLocalBounds.call(this,t)},e.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)},e.prototype._generateFillStyle=function(t,i,r){var s=t.fill;if(Array.isArray(s)){if(s.length===1)return s[0]}else return s;var o,a=t.dropShadow?t.dropShadowDistance:0,l=t.padding||0,u=this.canvas.width/this._resolution-a-l*2,c=this.canvas.height/this._resolution-a-l*2,h=s.slice(),d=t.fillGradientStops.slice();if(!d.length)for(var f=h.length+1,p=1;p<f;++p)d.push(p/f);if(h.unshift(s[0]),d.unshift(0),h.push(s[s.length-1]),d.push(1),t.fillGradientType===Ju.LINEAR_VERTICAL){o=this.context.createLinearGradient(u/2,l,u/2,c+l);for(var _=r.fontProperties.fontSize+t.strokeThickness,p=0;p<i.length;p++){var m=r.lineHeight*(p-1)+_,g=r.lineHeight*p,v=g;p>0&&m>g&&(v=(g+m)/2);var y=g+_,x=r.lineHeight*(p+1),b=y;p+1<i.length&&x<y&&(b=(y+x)/2);for(var S=(b-v)/c,T=0;T<h.length;T++){var P=0;typeof d[T]=="number"?P=d[T]:P=T/h.length;var E=Math.min(1,Math.max(0,v/c+P*S));E=Number(E.toFixed(5)),o.addColorStop(E,h[T])}}}else{o=this.context.createLinearGradient(l,c/2,u+l,c/2);for(var M=h.length+1,O=1,p=0;p<h.length;p++){var L=void 0;typeof d[p]=="number"?L=d[p]:L=O/M,o.addColorStop(L,h[p]),O++}}return o},e.prototype.destroy=function(t){typeof t=="boolean"&&(t={children:t}),t=Object.assign({},Jq,t),n.prototype.destroy.call(this,t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},Object.defineProperty(e.prototype,"width",{get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){this.updateText(!0);var i=ja(this.scale.x)||1;this.scale.x=i*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){this.updateText(!0);var i=ja(this.scale.y)||1;this.scale.y=i*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return this._style},set:function(t){t=t||{},t instanceof fl?this._style=t:this._style=new fl(t),this.localStyleID=-1,this.dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)},enumerable:!1,configurable:!0}),e.nextLineHeightBehavior=!1,e.experimentalLetterSpacing=!1,e}(Tc);/*!
 * @pixi/prepare - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/prepare is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */Oe.UPLOADS_PER_FRAME=4;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var sy=function(n,e){return sy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},sy(n,e)};function Qq(n,e){sy(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var sO=function(){function n(e){this.maxItemsPerFrame=e,this.itemsLeft=0}return n.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},n.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},n}();function eK(n,e){var t=!1;if(n&&n._textures&&n._textures.length){for(var i=0;i<n._textures.length;i++)if(n._textures[i]instanceof Ke){var r=n._textures[i].baseTexture;e.indexOf(r)===-1&&(e.push(r),t=!0)}}return t}function tK(n,e){if(n.baseTexture instanceof xt){var t=n.baseTexture;return e.indexOf(t)===-1&&e.push(t),!0}return!1}function nK(n,e){if(n._texture&&n._texture instanceof Ke){var t=n._texture.baseTexture;return e.indexOf(t)===-1&&e.push(t),!0}return!1}function iK(n,e){return e instanceof $b?(e.updateText(!0),!0):!1}function rK(n,e){if(e instanceof fl){var t=e.toFontString();return Br.measureFont(t),!0}return!1}function sK(n,e){if(n instanceof $b){e.indexOf(n.style)===-1&&e.push(n.style),e.indexOf(n)===-1&&e.push(n);var t=n._texture.baseTexture;return e.indexOf(t)===-1&&e.push(t),!0}return!1}function oK(n,e){return n instanceof fl?(e.indexOf(n)===-1&&e.push(n),!0):!1}var oO=function(){function n(e){var t=this;this.limiter=new sO(Oe.UPLOADS_PER_FRAME),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){t.queue&&t.prepareItems()},this.registerFindHook(sK),this.registerFindHook(oK),this.registerFindHook(eK),this.registerFindHook(tK),this.registerFindHook(nK),this.registerUploadHook(iK),this.registerUploadHook(rK)}return n.prototype.upload=function(e,t){var i=this;return typeof e=="function"&&(t=e,e=null),t&&ai("6.5.0","BasePrepare.upload callback is deprecated, use the return Promise instead."),new Promise(function(r){e&&i.add(e);var s=function(){t==null||t(),r()};i.queue.length?(i.completes.push(s),i.ticking||(i.ticking=!0,Fn.system.addOnce(i.tick,i,ls.UTILITY))):s()})},n.prototype.tick=function(){setTimeout(this.delayedTick,0)},n.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var e=this.queue[0],t=!1;if(e&&!e._destroyed){for(var i=0,r=this.uploadHooks.length;i<r;i++)if(this.uploadHooks[i](this.uploadHookHelper,e)){this.queue.shift(),t=!0;break}}t||this.queue.shift()}if(this.queue.length)Fn.system.addOnce(this.tick,this,ls.UTILITY);else{this.ticking=!1;var s=this.completes.slice(0);this.completes.length=0;for(var i=0,r=s.length;i<r;i++)s[i]()}},n.prototype.registerFindHook=function(e){return e&&this.addHooks.push(e),this},n.prototype.registerUploadHook=function(e){return e&&this.uploadHooks.push(e),this},n.prototype.add=function(e){for(var t=0,i=this.addHooks.length;t<i&&!this.addHooks[t](e,this.queue);t++);if(e instanceof Oi)for(var t=e.children.length-1;t>=0;t--)this.add(e.children[t]);return this},n.prototype.destroy=function(){this.ticking&&Fn.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},n}();function aO(n,e){return e instanceof xt?(e._glTextures[n.CONTEXT_UID]||n.texture.bind(e),!0):!1}function aK(n,e){if(!(e instanceof yd))return!1;var t=e.geometry;e.finishPoly(),t.updateBatches();for(var i=t.batches,r=0;r<i.length;r++){var s=i[r].style.texture;s&&aO(n,s.baseTexture)}return t.batchable||n.geometry.bind(t,e._resolveDirectShader(n)),!0}function lK(n,e){return n instanceof yd?(e.push(n),!0):!1}var lO=function(n){Qq(e,n);function e(t){var i=n.call(this,t)||this;return i.uploadHookHelper=i.renderer,i.registerFindHook(lK),i.registerUploadHook(aO),i.registerUploadHook(aK),i}return e.extension={name:"prepare",type:Ut.RendererPlugin},e}(oO),uK=function(){function n(e){this.maxMilliseconds=e,this.frameStart=0}return n.prototype.beginFrame=function(){this.frameStart=Date.now()},n.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds},n}();/*!
 * @pixi/spritesheet - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/spritesheet is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var uO=function(){function n(e,t,i){i===void 0&&(i=null),this.linkedSheets=[],this._texture=e instanceof Ke?e:null,this.baseTexture=e instanceof xt?e:this._texture.baseTexture,this.textures={},this.animations={},this.data=t;var r=this.baseTexture.resource;this.resolution=this._updateResolution(i||(r?r.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return n.prototype._updateResolution=function(e){e===void 0&&(e=null);var t=this.data.meta.scale,i=ud(e,null);return i===null&&(i=t!==void 0?parseFloat(t):1),i!==1&&this.baseTexture.setResolution(i),i},n.prototype.parse=function(e){var t=this;return e&&ai("6.5.0","Spritesheet.parse callback is deprecated, use the return Promise instead."),new Promise(function(i){t._callback=function(r){e==null||e(r),i(r)},t._batchIndex=0,t._frameKeys.length<=n.BATCH_SIZE?(t._processFrames(0),t._processAnimations(),t._parseComplete()):t._nextBatch()})},n.prototype._processFrames=function(e){for(var t=e,i=n.BATCH_SIZE;t-e<i&&t<this._frameKeys.length;){var r=this._frameKeys[t],s=this._frames[r],o=s.frame;if(o){var a=null,l=null,u=s.trimmed!==!1&&s.sourceSize?s.sourceSize:s.frame,c=new St(0,0,Math.floor(u.w)/this.resolution,Math.floor(u.h)/this.resolution);s.rotated?a=new St(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new St(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),s.trimmed!==!1&&s.spriteSourceSize&&(l=new St(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[r]=new Ke(this.baseTexture,a,c,l,s.rotated?2:0,s.anchor),Ke.addToCache(this.textures[r],r)}t++}},n.prototype._processAnimations=function(){var e=this.data.animations||{};for(var t in e){this.animations[t]=[];for(var i=0;i<e[t].length;i++){var r=e[t][i];this.animations[t].push(this.textures[r])}}},n.prototype._parseComplete=function(){var e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)},n.prototype._nextBatch=function(){var e=this;this._processFrames(this._batchIndex*n.BATCH_SIZE),this._batchIndex++,setTimeout(function(){e._batchIndex*n.BATCH_SIZE<e._frameKeys.length?e._nextBatch():(e._processAnimations(),e._parseComplete())},0)},n.prototype.destroy=function(e){var t;e===void 0&&(e=!1);for(var i in this.textures)this.textures[i].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&((t=this._texture)===null||t===void 0||t.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]},n.BATCH_SIZE=1e3,n}(),cO=function(){function n(){}return n.use=function(e,t){var i,r,s=this,o=e.name+"_image";if(!e.data||e.type!==on.TYPE.JSON||!e.data.frames||s.resources[o]){t();return}var a=(r=(i=e.data)===null||i===void 0?void 0:i.meta)===null||r===void 0?void 0:r.related_multi_packs;if(Array.isArray(a))for(var l=function(p){if(typeof p!="string")return"continue";var _=p.replace(".json",""),m=Ci.resolve(e.url.replace(s.baseUrl,""),p);if(s.resources[_]||Object.values(s.resources).some(function(v){return Ci.format(Ci.parse(v.url))===m}))return"continue";var g={crossOrigin:e.crossOrigin,loadType:on.LOAD_TYPE.XHR,xhrType:on.XHR_RESPONSE_TYPE.JSON,parentResource:e,metadata:e.metadata};s.add(_,m,g)},u=0,c=a;u<c.length;u++){var h=c[u];l(h)}var d={crossOrigin:e.crossOrigin,metadata:e.metadata.imageMetadata,parentResource:e},f=n.getResourcePath(e,s.baseUrl);s.add(o,f,d,function(_){if(_.error){t(_.error);return}var m=new uO(_.texture,e.data,e.url);m.parse().then(function(){e.spritesheet=m,e.textures=m.textures,t()})})},n.getResourcePath=function(e,t){return e.isDataUrl?e.data.meta.image:Ci.resolve(e.url.replace(t,""),e.data.meta.image)},n.extension=Ut.Loader,n}();/*!
 * @pixi/sprite-tiling - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/sprite-tiling is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var oy=function(n,e){return oy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},oy(n,e)};function hO(n,e){oy(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var $c=new Bt,cK=function(n){hO(e,n);function e(t,i,r){i===void 0&&(i=100),r===void 0&&(r=100);var s=n.call(this,t)||this;return s.tileTransform=new Bd,s._width=i,s._height=r,s.uvMatrix=s.texture.uvMatrix||new ug(t),s.pluginName="tilingSprite",s.uvRespectAnchor=!1,s}return Object.defineProperty(e.prototype,"clampMargin",{get:function(){return this.uvMatrix.clampMargin},set:function(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tileScale",{get:function(){return this.tileTransform.scale},set:function(t){this.tileTransform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tilePosition",{get:function(){return this.tileTransform.position},set:function(t){this.tileTransform.position.copyFrom(t)},enumerable:!1,configurable:!0}),e.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},e.prototype._render=function(t){var i=this._texture;!i||!i.valid||(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},e.prototype._calculateBounds=function(){var t=this._width*-this._anchor._x,i=this._height*-this._anchor._y,r=this._width*(1-this._anchor._x),s=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,i,r,s)},e.prototype.getLocalBounds=function(t){return this.children.length===0?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new St),t=this._localBoundsRect),this._bounds.getRectangle(t)):n.prototype.getLocalBounds.call(this,t)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,$c);var i=this._width,r=this._height,s=-i*this.anchor._x;if($c.x>=s&&$c.x<s+i){var o=-r*this.anchor._y;if($c.y>=o&&$c.y<o+r)return!0}return!1},e.prototype.destroy=function(t){n.prototype.destroy.call(this,t),this.tileTransform=null,this.uvMatrix=null},e.from=function(t,i){var r=t instanceof Ke?t:Ke.from(t,i);return new e(r,i.width,i.height)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t},enumerable:!1,configurable:!0}),e}(Tc),hK=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`,jM=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,dK=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,fK=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,pK=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,kf=new kt,dO=function(n){hO(e,n);function e(t){var i=n.call(this,t)||this;return t.runners.contextChange.add(i),i.quad=new _b,i.state=qo.for2d(),i}return e.prototype.contextChange=function(){var t=this.renderer,i={globals:t.globalUniforms};this.simpleShader=Xs.from(jM,hK,i),this.shader=t.context.webGLVersion>1?Xs.from(fK,pK,i):Xs.from(jM,dK,i)},e.prototype.render=function(t){var i=this.renderer,r=this.quad,s=r.vertices;s[0]=s[6]=t._width*-t.anchor.x,s[1]=s[3]=t._height*-t.anchor.y,s[2]=s[4]=t._width*(1-t.anchor.x),s[5]=s[7]=t._height*(1-t.anchor.y);var o=t.uvRespectAnchor?t.anchor.x:0,a=t.uvRespectAnchor?t.anchor.y:0;s=r.uvs,s[0]=s[6]=-o,s[1]=s[3]=-a,s[2]=s[4]=1-o,s[5]=s[7]=1-a,r.invalidate();var l=t._texture,u=l.baseTexture,c=u.alphaMode>0,h=t.tileTransform.localTransform,d=t.uvMatrix,f=u.isPowerOfTwo&&l.frame.width===u.width&&l.frame.height===u.height;f&&(u._glTextures[i.CONTEXT_UID]?f=u.wrapMode!==Ar.CLAMP:u.wrapMode===Ar.CLAMP&&(u.wrapMode=Ar.REPEAT));var p=f?this.simpleShader:this.shader,_=l.width,m=l.height,g=t._width,v=t._height;kf.set(h.a*_/g,h.b*_/v,h.c*m/g,h.d*m/v,h.tx/g,h.ty/v),kf.invert(),f?kf.prepend(d.mapCoord):(p.uniforms.uMapCoord=d.mapCoord.toArray(!0),p.uniforms.uClampFrame=d.uClampFrame,p.uniforms.uClampOffset=d.uClampOffset),p.uniforms.uTransform=kf.toArray(!0),p.uniforms.uColor=lb(t.tint,t.worldAlpha,p.uniforms.uColor,c),p.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),p.uniforms.uSampler=l,i.shader.bind(p),i.geometry.bind(r),this.state.blendMode=ab(t.blendMode,c),i.state.set(this.state),i.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},e.extension={name:"tilingSprite",type:Ut.RendererPlugin},e}(kd);/*!
 * @pixi/mesh - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/mesh is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ay=function(n,e){return ay=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},ay(n,e)};function Yb(n,e){ay(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var fO=function(){function n(e,t){this.uvBuffer=e,this.uvMatrix=t,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}return n.prototype.update=function(e){if(!(!e&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var t=this.uvBuffer.data;(!this.data||this.data.length!==t.length)&&(this.data=new Float32Array(t.length)),this.uvMatrix.multiplyUvs(t,this.data),this._updateID++}},n}(),z_=new Bt,$M=new Dh,Qu=function(n){Yb(e,n);function e(t,i,r,s){s===void 0&&(s=Ji.TRIANGLES);var o=n.call(this)||this;return o.geometry=t,o.shader=i,o.state=r||qo.for2d(),o.drawMode=s,o.start=0,o.size=0,o.uvs=null,o.indices=null,o.vertexData=new Float32Array(1),o.vertexDirty=-1,o._transformID=-1,o._roundPixels=Oe.ROUND_PIXELS,o.batchUvs=null,o}return Object.defineProperty(e.prototype,"geometry",{get:function(){return this._geometry},set:function(t){this._geometry!==t&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=t,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uvBuffer",{get:function(){return this.geometry.buffers[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticesBuffer",{get:function(){return this.geometry.buffers[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"material",{get:function(){return this.shader},set:function(t){this.shader=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return"tint"in this.shader?this.shader.tint:null},set:function(t){this.shader.tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return"texture"in this.shader?this.shader.texture:null},set:function(t){this.shader.texture=t},enumerable:!1,configurable:!0}),e.prototype._render=function(t){var i=this.geometry.buffers[0].data,r=this.shader;r.batchable&&this.drawMode===Ji.TRIANGLES&&i.length<e.BATCHABLE_SIZE*2?this._renderToBatch(t):this._renderDefault(t)},e.prototype._renderDefault=function(t){var i=this.shader;i.alpha=this.worldAlpha,i.update&&i.update(),t.batch.flush(),i.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),t.shader.bind(i),t.state.set(this.state),t.geometry.bind(this.geometry,i),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},e.prototype._renderToBatch=function(t){var i=this.geometry,r=this.shader;r.uvMatrix&&(r.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=i.indexBuffer.data,this._tintRGB=r._tintRGB,this._texture=r.texture;var s=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[s]),t.plugins[s].render(this)},e.prototype.calculateVertices=function(){var t=this.geometry,i=t.buffers[0],r=i.data,s=i._updateID;if(!(s===this.vertexDirty&&this._transformID===this.transform._worldID)){this._transformID=this.transform._worldID,this.vertexData.length!==r.length&&(this.vertexData=new Float32Array(r.length));for(var o=this.transform.worldTransform,a=o.a,l=o.b,u=o.c,c=o.d,h=o.tx,d=o.ty,f=this.vertexData,p=0;p<f.length/2;p++){var _=r[p*2],m=r[p*2+1];f[p*2]=a*_+u*m+h,f[p*2+1]=l*_+c*m+d}if(this._roundPixels)for(var g=Oe.RESOLUTION,p=0;p<f.length;++p)f[p]=Math.round((f[p]*g|0)/g);this.vertexDirty=s}},e.prototype.calculateUvs=function(){var t=this.geometry.buffers[1],i=this.shader;i.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new fO(t,i.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},e.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},e.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,z_);for(var i=this.geometry.getBuffer("aVertexPosition").data,r=$M.points,s=this.geometry.getIndex().data,o=s.length,a=this.drawMode===4?3:1,l=0;l+2<o;l+=a){var u=s[l]*2,c=s[l+1]*2,h=s[l+2]*2;if(r[0]=i[u],r[1]=i[u+1],r[2]=i[c],r[3]=i[c+1],r[4]=i[h],r[5]=i[h+1],$M.contains(z_.x,z_.y))return!0}return!1},e.prototype.destroy=function(t){n.prototype.destroy.call(this,t),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},e.BATCHABLE_SIZE=100,e}(Oi),mK=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,gK=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`,ec=function(n){Yb(e,n);function e(t,i){var r=this,s={uSampler:t,alpha:1,uTextureMatrix:kt.IDENTITY,uColor:new Float32Array([1,1,1,1])};return i=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},i),i.uniforms&&Object.assign(s,i.uniforms),r=n.call(this,i.program||Ec.from(gK,mK),s)||this,r._colorDirty=!1,r.uvMatrix=new ug(t),r.batchable=i.program===void 0,r.pluginName=i.pluginName,r.tint=i.tint,r.alpha=i.alpha,r}return Object.defineProperty(e.prototype,"texture",{get:function(){return this.uniforms.uSampler},set:function(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(t&65280)+((t&255)<<16),this._colorDirty=!0)},enumerable:!1,configurable:!0}),e.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var t=this.texture.baseTexture;lb(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},e}(Xs),Vd=function(n){Yb(e,n);function e(t,i,r){var s=n.call(this)||this,o=new vn(t),a=new vn(i,!0),l=new vn(r,!0,!0);return s.addAttribute("aVertexPosition",o,2,!1,Ge.FLOAT).addAttribute("aTextureCoord",a,2,!1,Ge.FLOAT).addIndex(l),s._updateId=-1,s}return Object.defineProperty(e.prototype,"vertexDirtyId",{get:function(){return this.buffers[0]._updateID},enumerable:!1,configurable:!0}),e}(Sc);/*!
 * @pixi/text-bitmap - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/text-bitmap is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ly=function(n,e){return ly=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},ly(n,e)};function _K(n,e){ly(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var xd=function(){function n(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}return n}(),pO=function(){function n(){}return n.test=function(e){return typeof e=="string"&&e.indexOf("info face=")===0},n.parse=function(e){var t=e.match(/^[a-z]+\s+.+$/gm),i={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(var r in t){var s=t[r].match(/^[a-z]+/gm)[0],o=t[r].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),a={};for(var l in o){var u=o[l].split("="),c=u[0],h=u[1].replace(/"/gm,""),d=parseFloat(h),f=isNaN(d)?h:d;a[c]=f}i[s].push(a)}var p=new xd;return i.info.forEach(function(_){return p.info.push({face:_.face,size:parseInt(_.size,10)})}),i.common.forEach(function(_){return p.common.push({lineHeight:parseInt(_.lineHeight,10)})}),i.page.forEach(function(_){return p.page.push({id:parseInt(_.id,10),file:_.file})}),i.char.forEach(function(_){return p.char.push({id:parseInt(_.id,10),page:parseInt(_.page,10),x:parseInt(_.x,10),y:parseInt(_.y,10),width:parseInt(_.width,10),height:parseInt(_.height,10),xoffset:parseInt(_.xoffset,10),yoffset:parseInt(_.yoffset,10),xadvance:parseInt(_.xadvance,10)})}),i.kerning.forEach(function(_){return p.kerning.push({first:parseInt(_.first,10),second:parseInt(_.second,10),amount:parseInt(_.amount,10)})}),i.distanceField.forEach(function(_){return p.distanceField.push({distanceRange:parseInt(_.distanceRange,10),fieldType:_.fieldType})}),p},n}(),cm=function(){function n(){}return n.test=function(e){return e instanceof XMLDocument&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null},n.parse=function(e){for(var t=new xd,i=e.getElementsByTagName("info"),r=e.getElementsByTagName("common"),s=e.getElementsByTagName("page"),o=e.getElementsByTagName("char"),a=e.getElementsByTagName("kerning"),l=e.getElementsByTagName("distanceField"),u=0;u<i.length;u++)t.info.push({face:i[u].getAttribute("face"),size:parseInt(i[u].getAttribute("size"),10)});for(var u=0;u<r.length;u++)t.common.push({lineHeight:parseInt(r[u].getAttribute("lineHeight"),10)});for(var u=0;u<s.length;u++)t.page.push({id:parseInt(s[u].getAttribute("id"),10)||0,file:s[u].getAttribute("file")});for(var u=0;u<o.length;u++){var c=o[u];t.char.push({id:parseInt(c.getAttribute("id"),10),page:parseInt(c.getAttribute("page"),10)||0,x:parseInt(c.getAttribute("x"),10),y:parseInt(c.getAttribute("y"),10),width:parseInt(c.getAttribute("width"),10),height:parseInt(c.getAttribute("height"),10),xoffset:parseInt(c.getAttribute("xoffset"),10),yoffset:parseInt(c.getAttribute("yoffset"),10),xadvance:parseInt(c.getAttribute("xadvance"),10)})}for(var u=0;u<a.length;u++)t.kerning.push({first:parseInt(a[u].getAttribute("first"),10),second:parseInt(a[u].getAttribute("second"),10),amount:parseInt(a[u].getAttribute("amount"),10)});for(var u=0;u<l.length;u++)t.distanceField.push({fieldType:l[u].getAttribute("fieldType"),distanceRange:parseInt(l[u].getAttribute("distanceRange"),10)});return t},n}(),mO=function(){function n(){}return n.test=function(e){if(typeof e=="string"&&e.indexOf("<font>")>-1){var t=new globalThis.DOMParser().parseFromString(e,"text/xml");return cm.test(t)}return!1},n.parse=function(e){var t=new globalThis.DOMParser().parseFromString(e,"text/xml");return cm.parse(t)},n}(),W_=[pO,cm,mO];function qb(n){for(var e=0;e<W_.length;e++)if(W_[e].test(n))return W_[e];return null}function vK(n,e,t,i,r,s){var o=t.fill;if(Array.isArray(o)){if(o.length===1)return o[0]}else return o;var a,l=t.dropShadow?t.dropShadowDistance:0,u=t.padding||0,c=n.width/i-l-u*2,h=n.height/i-l-u*2,d=o.slice(),f=t.fillGradientStops.slice();if(!f.length)for(var p=d.length+1,_=1;_<p;++_)f.push(_/p);if(d.unshift(o[0]),f.unshift(0),d.push(o[o.length-1]),f.push(1),t.fillGradientType===Ju.LINEAR_VERTICAL){a=e.createLinearGradient(c/2,u,c/2,h+u);for(var m=0,g=s.fontProperties.fontSize+t.strokeThickness,v=g/h,_=0;_<r.length;_++)for(var y=s.lineHeight*_,x=0;x<d.length;x++){var b=0;typeof f[x]=="number"?b=f[x]:b=x/d.length;var S=y/h+b*v,T=Math.max(m,S);T=Math.min(T,1),a.addColorStop(T,d[x]),m=T}}else{a=e.createLinearGradient(u,h/2,c+u,h/2);for(var P=d.length+1,E=1,_=0;_<d.length;_++){var M=void 0;typeof f[_]=="number"?M=f[_]:M=E/P,a.addColorStop(M,d[_]),E++}}return a}function yK(n,e,t,i,r,s,o){var a=t.text,l=t.fontProperties;e.translate(i,r),e.scale(s,s);var u=o.strokeThickness/2,c=-(o.strokeThickness/2);if(e.font=o.toFontString(),e.lineWidth=o.strokeThickness,e.textBaseline=o.textBaseline,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.fillStyle=vK(n,e,o,s,[a],t),e.strokeStyle=o.stroke,o.dropShadow){var h=o.dropShadowColor,d=hl(typeof h=="number"?h:sb(h)),f=o.dropShadowBlur*s,p=o.dropShadowDistance*s;e.shadowColor="rgba("+d[0]*255+","+d[1]*255+","+d[2]*255+","+o.dropShadowAlpha+")",e.shadowBlur=f,e.shadowOffsetX=Math.cos(o.dropShadowAngle)*p,e.shadowOffsetY=Math.sin(o.dropShadowAngle)*p}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;o.stroke&&o.strokeThickness&&e.strokeText(a,u,c+t.lineHeight-l.descent),o.fill&&e.fillText(a,u,c+t.lineHeight-l.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function gO(n){return Array.from?Array.from(n):n.split("")}function xK(n){typeof n=="string"&&(n=[n]);for(var e=[],t=0,i=n.length;t<i;t++){var r=n[t];if(Array.isArray(r)){if(r.length!==2)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got "+r.length+".");var s=r[0].charCodeAt(0),o=r[1].charCodeAt(0);if(o<s)throw new Error("[BitmapFont]: Invalid character range.");for(var a=s,l=o;a<=l;a++)e.push(String.fromCharCode(a))}else e.push.apply(e,gO(r))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}function Op(n){return n.codePointAt?n.codePointAt(0):n.charCodeAt(0)}var Ls=function(){function n(e,t,i){var r,s,o=e.info[0],a=e.common[0],l=e.page[0],u=e.distanceField[0],c=ud(l.file),h={};this._ownsTextures=i,this.font=o.face,this.size=o.size,this.lineHeight=a.lineHeight/c,this.chars={},this.pageTextures=h;for(var d=0;d<e.page.length;d++){var f=e.page[d],p=f.id,_=f.file;h[p]=t instanceof Array?t[d]:t[_],u!=null&&u.fieldType&&u.fieldType!=="none"&&(h[p].baseTexture.alphaMode=ar.NO_PREMULTIPLIED_ALPHA,h[p].baseTexture.mipmap=or.OFF)}for(var d=0;d<e.char.length;d++){var m=e.char[d],p=m.id,g=m.page,v=e.char[d],y=v.x,x=v.y,b=v.width,S=v.height,T=v.xoffset,P=v.yoffset,E=v.xadvance;y/=c,x/=c,b/=c,S/=c,T/=c,P/=c,E/=c;var M=new St(y+h[g].frame.x/c,x+h[g].frame.y/c,b,S);this.chars[p]={xOffset:T,yOffset:P,xAdvance:E,kerning:{},texture:new Ke(h[g].baseTexture,M),page:g}}for(var d=0;d<e.kerning.length;d++){var O=e.kerning[d],L=O.first,C=O.second,D=O.amount;L/=c,C/=c,D/=c,this.chars[C]&&(this.chars[C].kerning[L]=D)}this.distanceFieldRange=u==null?void 0:u.distanceRange,this.distanceFieldType=(s=(r=u==null?void 0:u.fieldType)===null||r===void 0?void 0:r.toLowerCase())!==null&&s!==void 0?s:"none"}return n.prototype.destroy=function(){for(var e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(var e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null},n.install=function(e,t,i){var r;if(e instanceof xd)r=e;else{var s=qb(e);if(!s)throw new Error("Unrecognized data format for font.");r=s.parse(e)}t instanceof Ke&&(t=[t]);var o=new n(r,t,i);return n.available[o.font]=o,o},n.uninstall=function(e){var t=n.available[e];if(!t)throw new Error("No font found named '"+e+"'");t.destroy(),delete n.available[e]},n.from=function(e,t,i){if(!e)throw new Error("[BitmapFont] Property `name` is required.");var r=Object.assign({},n.defaultOptions,i),s=r.chars,o=r.padding,a=r.resolution,l=r.textureWidth,u=r.textureHeight,c=xK(s),h=t instanceof fl?t:new fl(t),d=l,f=new xd;f.info[0]={face:h.fontFamily,size:h.fontSize},f.common[0]={lineHeight:h.fontSize};for(var p=0,_=0,m,g,v,y=0,x=[],b=0;b<c.length;b++){m||(m=Oe.ADAPTER.createCanvas(),m.width=l,m.height=u,g=m.getContext("2d"),v=new xt(m,{resolution:a}),x.push(new Ke(v)),f.page.push({id:x.length-1,file:""}));var S=c[b],T=Br.measureText(S,h,!1,m),P=T.width,E=Math.ceil(T.height),M=Math.ceil((h.fontStyle==="italic"?2:1)*P);if(_>=u-E*a){if(_===0)throw new Error("[BitmapFont] textureHeight "+u+"px is too small "+("(fontFamily: '"+h.fontFamily+"', fontSize: "+h.fontSize+"px, char: '"+S+"')"));--b,m=null,g=null,v=null,_=0,p=0,y=0;continue}if(y=Math.max(E+T.fontProperties.descent,y),M*a+p>=d){if(p===0)throw new Error("[BitmapFont] textureWidth "+l+"px is too small "+("(fontFamily: '"+h.fontFamily+"', fontSize: "+h.fontSize+"px, char: '"+S+"')"));--b,_+=y*a,_=Math.ceil(_),p=0,y=0;continue}yK(m,g,T,p,_,a,h);var O=Op(T.text);f.char.push({id:O,page:x.length-1,x:p/a,y:_/a,width:M,height:E,xoffset:0,yoffset:0,xadvance:Math.ceil(P-(h.dropShadow?h.dropShadowDistance:0)-(h.stroke?h.strokeThickness:0))}),p+=(M+2*o)*a,p=Math.ceil(p)}if(!(i!=null&&i.skipKerning))for(var b=0,L=c.length;b<L;b++)for(var C=c[b],D=0;D<L;D++){var B=c[D],W=g.measureText(C).width,U=g.measureText(B).width,$=g.measureText(C+B).width,J=$-(W+U);J&&f.kerning.push({first:Op(C),second:Op(B),amount:J})}var j=new n(f,x,!0);return n.available[e]!==void 0&&n.uninstall(e),n.available[e]=j,j},n.ALPHA=[["a","z"],["A","Z"]," "],n.NUMERIC=[["0","9"]],n.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],n.ASCII=[[" ","~"]],n.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:n.ALPHANUMERIC},n.available={},n}(),bK=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, uColor.a * alpha);\r
\r
}\r
`,SK=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`,YM=[],qM=[],KM=[],EK=function(n){_K(e,n);function e(t,i){i===void 0&&(i={});var r=n.call(this)||this;r._tint=16777215;var s=Object.assign({},e.styleDefaults,i),o=s.align,a=s.tint,l=s.maxWidth,u=s.letterSpacing,c=s.fontName,h=s.fontSize;if(!Ls.available[c])throw new Error('Missing BitmapFont "'+c+'"');return r._activePagesMeshData=[],r._textWidth=0,r._textHeight=0,r._align=o,r._tint=a,r._font=void 0,r._fontName=c,r._fontSize=h,r.text=t,r._maxWidth=l,r._maxLineHeight=0,r._letterSpacing=u,r._anchor=new Us(function(){r.dirty=!0},r,0,0),r._roundPixels=Oe.ROUND_PIXELS,r.dirty=!0,r._resolution=Oe.RESOLUTION,r._autoResolution=!0,r._textureCache={},r}return e.prototype.updateText=function(){for(var t,i=Ls.available[this._fontName],r=this.fontSize,s=r/i.size,o=new Bt,a=[],l=[],u=[],c=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",h=gO(c),d=this._maxWidth*i.size/r,f=i.distanceFieldType==="none"?YM:qM,p=null,_=0,m=0,g=0,v=-1,y=0,x=0,b=0,S=0,T=0;T<h.length;T++){var P=h[T],E=Op(P);if(/(?:\s)/.test(P)&&(v=T,y=_,S++),P==="\r"||P===`
`){l.push(_),u.push(-1),m=Math.max(m,_),++g,++x,o.x=0,o.y+=i.lineHeight,p=null,S=0;continue}var M=i.chars[E];if(M){p&&M.kerning[p]&&(o.x+=M.kerning[p]);var O=KM.pop()||{texture:Ke.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Bt};O.texture=M.texture,O.line=g,O.charCode=E,O.position.x=o.x+M.xOffset+this._letterSpacing/2,O.position.y=o.y+M.yOffset,O.prevSpaces=S,a.push(O),_=O.position.x+Math.max(M.xAdvance-M.xOffset,M.texture.orig.width),o.x+=M.xAdvance+this._letterSpacing,b=Math.max(b,M.yOffset+M.texture.height),p=E,v!==-1&&d>0&&o.x>d&&(++x,il(a,1+v-x,1+T-v),T=v,v=-1,l.push(y),u.push(a.length>0?a[a.length-1].prevSpaces:0),m=Math.max(m,y),g++,o.x=0,o.y+=i.lineHeight,p=null,S=0)}}var L=h[h.length-1];L!=="\r"&&L!==`
`&&(/(?:\s)/.test(L)&&(_=y),l.push(_),m=Math.max(m,_),u.push(-1));for(var C=[],T=0;T<=g;T++){var D=0;this._align==="right"?D=m-l[T]:this._align==="center"?D=(m-l[T])/2:this._align==="justify"&&(D=u[T]<0?0:(m-l[T])/u[T]),C.push(D)}var B=a.length,W={},U=[],$=this._activePagesMeshData;f.push.apply(f,$);for(var T=0;T<B;T++){var J=a[T].texture,j=J.baseTexture.uid;if(!W[j]){var F=f.pop();if(!F){var X=new Vd,re=void 0,ce=void 0;i.distanceFieldType==="none"?(re=new ec(Ke.EMPTY),ce=He.NORMAL):(re=new ec(Ke.EMPTY,{program:Ec.from(SK,bK),uniforms:{uFWidth:0}}),ce=He.NORMAL_NPM);var ve=new Qu(X,re);ve.blendMode=ce,F={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:ve,vertices:null,uvs:null,indices:null}}F.index=0,F.indexCount=0,F.vertexCount=0,F.uvsCount=0,F.total=0;var ae=this._textureCache;ae[j]=ae[j]||new Ke(J.baseTexture),F.mesh.texture=ae[j],F.mesh.tint=this._tint,U.push(F),W[j]=F}W[j].total++}for(var T=0;T<$.length;T++)U.indexOf($[T])===-1&&this.removeChild($[T].mesh);for(var T=0;T<U.length;T++)U[T].mesh.parent!==this&&this.addChild(U[T].mesh);this._activePagesMeshData=U;for(var T in W){var F=W[T],Y=F.total;if(!(((t=F.indices)===null||t===void 0?void 0:t.length)>6*Y)||F.vertices.length<Qu.BATCHABLE_SIZE*2)F.vertices=new Float32Array(4*2*Y),F.uvs=new Float32Array(4*2*Y),F.indices=new Uint16Array(6*Y);else for(var ne=F.total,he=F.vertices,xe=ne*4*2;xe<he.length;xe++)he[xe]=0;F.mesh.size=6*Y}for(var T=0;T<B;T++){var P=a[T],be=P.position.x+C[P.line]*(this._align==="justify"?P.prevSpaces:1);this._roundPixels&&(be=Math.round(be));var w=be*s,V=P.position.y*s,J=P.texture,H=W[J.baseTexture.uid],K=J.frame,Z=J._uvs,ee=H.index++;H.indices[ee*6+0]=0+ee*4,H.indices[ee*6+1]=1+ee*4,H.indices[ee*6+2]=2+ee*4,H.indices[ee*6+3]=0+ee*4,H.indices[ee*6+4]=2+ee*4,H.indices[ee*6+5]=3+ee*4,H.vertices[ee*8+0]=w,H.vertices[ee*8+1]=V,H.vertices[ee*8+2]=w+K.width*s,H.vertices[ee*8+3]=V,H.vertices[ee*8+4]=w+K.width*s,H.vertices[ee*8+5]=V+K.height*s,H.vertices[ee*8+6]=w,H.vertices[ee*8+7]=V+K.height*s,H.uvs[ee*8+0]=Z.x0,H.uvs[ee*8+1]=Z.y0,H.uvs[ee*8+2]=Z.x1,H.uvs[ee*8+3]=Z.y1,H.uvs[ee*8+4]=Z.x2,H.uvs[ee*8+5]=Z.y2,H.uvs[ee*8+6]=Z.x3,H.uvs[ee*8+7]=Z.y3}this._textWidth=m*s,this._textHeight=(o.y+i.lineHeight)*s;for(var T in W){var F=W[T];if(this.anchor.x!==0||this.anchor.y!==0)for(var ge=0,le=this._textWidth*this.anchor.x,fe=this._textHeight*this.anchor.y,me=0;me<F.total;me++)F.vertices[ge++]-=le,F.vertices[ge++]-=fe,F.vertices[ge++]-=le,F.vertices[ge++]-=fe,F.vertices[ge++]-=le,F.vertices[ge++]-=fe,F.vertices[ge++]-=le,F.vertices[ge++]-=fe;this._maxLineHeight=b*s;var we=F.mesh.geometry.getBuffer("aVertexPosition"),I=F.mesh.geometry.getBuffer("aTextureCoord"),A=F.mesh.geometry.getIndex();we.data=F.vertices,I.data=F.uvs,A.data=F.indices,we.update(),I.update(),A.update()}for(var T=0;T<a.length;T++)KM.push(a[T]);this._font=i,this.dirty=!1},e.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},e.prototype._render=function(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0);var i=Ls.available[this._fontName],r=i.distanceFieldRange,s=i.distanceFieldType,o=i.size;if(s!=="none")for(var a=this.worldTransform,l=a.a,u=a.b,c=a.c,h=a.d,d=Math.sqrt(l*l+u*u),f=Math.sqrt(c*c+h*h),p=(Math.abs(d)+Math.abs(f))/2,_=this.fontSize/o,m=0,g=this._activePagesMeshData;m<g.length;m++){var v=g[m];v.mesh.shader.uniforms.uFWidth=p*r*_*this._resolution}n.prototype._render.call(this,t)},e.prototype.getLocalBounds=function(){return this.validate(),n.prototype.getLocalBounds.call(this)},e.prototype.validate=function(){var t=Ls.available[this._fontName];if(!t)throw new Error('Missing BitmapFont "'+this._fontName+'"');this._font!==t&&(this.dirty=!0),this.dirty&&this.updateText()},Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){if(this._tint!==t){this._tint=t;for(var i=0;i<this._activePagesMeshData.length;i++)this._activePagesMeshData[i].mesh.tint=t}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontName",{get:function(){return this._fontName},set:function(t){if(!Ls.available[t])throw new Error('Missing BitmapFont "'+t+'"');this._fontName!==t&&(this._fontName=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){var t;return(t=this._fontSize)!==null&&t!==void 0?t:Ls.available[this._fontName].size},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},set:function(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxLineHeight",{get:function(){return this.validate(),this._maxLineHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textWidth",{get:function(){return this.validate(),this._textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textHeight",{get:function(){return this.validate(),this._textHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)},enumerable:!1,configurable:!0}),e.prototype.destroy=function(t){var i=this._textureCache,r=Ls.available[this._fontName],s=r.distanceFieldType==="none"?YM:qM;s.push.apply(s,this._activePagesMeshData);for(var o=0,a=this._activePagesMeshData;o<a.length;o++){var l=a[o];this.removeChild(l.mesh)}this._activePagesMeshData=[],s.filter(function(h){return i[h.mesh.texture.baseTexture.uid]}).forEach(function(h){h.mesh.texture=Ke.EMPTY});for(var u in i){var c=i[u];c.destroy(),delete i[u]}this._font=null,this._textureCache=null,n.prototype.destroy.call(this,t)},e.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0},e}(Oi),_O=function(){function n(){}return n.add=function(){on.setExtensionXhrType("fnt",on.XHR_RESPONSE_TYPE.TEXT)},n.use=function(e,t){var i=qb(e.data);if(!i){t();return}for(var r=n.getBaseUrl(this,e),s=i.parse(e.data),o={},a=function(_){o[_.metadata.pageFile]=_.texture,Object.keys(o).length===s.page.length&&(e.bitmapFont=Ls.install(s,o,!0),t())},l=0;l<s.page.length;++l){var u=s.page[l].file,c=r+u,h=!1;for(var d in this.resources){var f=this.resources[d];if(f.url===c){f.metadata.pageFile=u,f.texture?a(f):f.onAfterMiddleware.add(a),h=!0;break}}if(!h){var p={crossOrigin:e.crossOrigin,loadType:on.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:u},e.metadata.imageMetadata),parentResource:e};this.add(c,p,a)}}},n.getBaseUrl=function(e,t){var i=t.isDataUrl?"":n.dirname(t.url);return t.isDataUrl&&(i==="."&&(i=""),e.baseUrl&&i&&e.baseUrl.charAt(e.baseUrl.length-1)==="/"&&(i+="/")),i=i.replace(e.baseUrl,""),i&&i.charAt(i.length-1)!=="/"&&(i+="/"),i},n.dirname=function(e){var t=e.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return t===e?".":t===""?"/":t},n.extension=Ut.Loader,n}();/*!
 * @pixi/filter-alpha - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/filter-alpha is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var uy=function(n,e){return uy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},uy(n,e)};function TK(n,e){uy(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var MK=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`,wK=function(n){TK(e,n);function e(t){t===void 0&&(t=1);var i=n.call(this,KI,MK,{uAlpha:1})||this;return i.alpha=t,i}return Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0}),e}(eo);/*!
 * @pixi/filter-blur - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/filter-blur is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var cy=function(n,e){return cy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},cy(n,e)};function vO(n,e){cy(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var AK=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function PK(n,e){var t=Math.ceil(n/2),i=AK,r="",s;e?s="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":s="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var o=0;o<n;o++){var a=s.replace("%index%",o.toString());a=a.replace("%sampleIndex%",o-(t-1)+".0"),r+=a,r+=`
`}return i=i.replace("%blur%",r),i=i.replace("%size%",n.toString()),i}var CK={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},RK=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function IK(n){for(var e=CK[n],t=e.length,i=RK,r="",s="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;",o,a=0;a<n;a++){var l=s.replace("%index%",a.toString());o=a,a>=t&&(o=n-a-1),l=l.replace("%value%",e[o].toString()),r+=l,r+=`
`}return i=i.replace("%blur%",r),i=i.replace("%size%",n.toString()),i}var hy=function(n){vO(e,n);function e(t,i,r,s,o){i===void 0&&(i=8),r===void 0&&(r=4),s===void 0&&(s=Oe.FILTER_RESOLUTION),o===void 0&&(o=5);var a=this,l=PK(o,t),u=IK(o);return a=n.call(this,l,u)||this,a.horizontal=t,a.resolution=s,a._quality=0,a.quality=r,a.blur=i,a}return e.prototype.apply=function(t,i,r,s){if(r?this.horizontal?this.uniforms.strength=1/r.width*(r.width/i.width):this.uniforms.strength=1/r.height*(r.height/i.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/i.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/i.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)t.applyFilter(this,i,r,s);else{var o=t.getFilterTexture(),a=t.renderer,l=i,u=o;this.state.blend=!1,t.applyFilter(this,l,u,Wi.CLEAR);for(var c=1;c<this.passes-1;c++){t.bindAndClear(l,Wi.BLIT),this.uniforms.uSampler=u;var h=u;u=l,l=h,a.shader.bind(this),a.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,u,r,s),t.returnFilterTexture(o)}},Object.defineProperty(e.prototype,"blur",{get:function(){return this.strength},set:function(t){this.padding=1+Math.abs(t)*2,this.strength=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this._quality},set:function(t){this._quality=t,this.passes=t},enumerable:!1,configurable:!0}),e}(eo),LK=function(n){vO(e,n);function e(t,i,r,s){t===void 0&&(t=8),i===void 0&&(i=4),r===void 0&&(r=Oe.FILTER_RESOLUTION),s===void 0&&(s=5);var o=n.call(this)||this;return o.blurXFilter=new hy(!0,t,i,r,s),o.blurYFilter=new hy(!1,t,i,r,s),o.resolution=r,o.quality=i,o.blur=t,o.repeatEdgePixels=!1,o}return e.prototype.apply=function(t,i,r,s){var o=Math.abs(this.blurXFilter.strength),a=Math.abs(this.blurYFilter.strength);if(o&&a){var l=t.getFilterTexture();this.blurXFilter.apply(t,i,l,Wi.CLEAR),this.blurYFilter.apply(t,l,r,s),t.returnFilterTexture(l)}else a?this.blurYFilter.apply(t,i,r,s):this.blurXFilter.apply(t,i,r,s)},e.prototype.updatePadding=function(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2},Object.defineProperty(e.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this.blurXFilter.quality},set:function(t){this.blurXFilter.quality=this.blurYFilter.quality=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.blurYFilter.blendMode},set:function(t){this.blurYFilter.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"repeatEdgePixels",{get:function(){return this._repeatEdgePixels},set:function(t){this._repeatEdgePixels=t,this.updatePadding()},enumerable:!1,configurable:!0}),e}(eo);/*!
 * @pixi/filter-color-matrix - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/filter-color-matrix is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var dy=function(n,e){return dy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},dy(n,e)};function OK(n,e){dy(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var DK=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`,fy=function(n){OK(e,n);function e(){var t=this,i={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};return t=n.call(this,Ob,DK,i)||this,t.alpha=1,t}return e.prototype._loadMatrix=function(t,i){i===void 0&&(i=!1);var r=t;i&&(this._multiply(r,this.uniforms.m,t),r=this._colorMatrix(r)),this.uniforms.m=r},e.prototype._multiply=function(t,i,r){return t[0]=i[0]*r[0]+i[1]*r[5]+i[2]*r[10]+i[3]*r[15],t[1]=i[0]*r[1]+i[1]*r[6]+i[2]*r[11]+i[3]*r[16],t[2]=i[0]*r[2]+i[1]*r[7]+i[2]*r[12]+i[3]*r[17],t[3]=i[0]*r[3]+i[1]*r[8]+i[2]*r[13]+i[3]*r[18],t[4]=i[0]*r[4]+i[1]*r[9]+i[2]*r[14]+i[3]*r[19]+i[4],t[5]=i[5]*r[0]+i[6]*r[5]+i[7]*r[10]+i[8]*r[15],t[6]=i[5]*r[1]+i[6]*r[6]+i[7]*r[11]+i[8]*r[16],t[7]=i[5]*r[2]+i[6]*r[7]+i[7]*r[12]+i[8]*r[17],t[8]=i[5]*r[3]+i[6]*r[8]+i[7]*r[13]+i[8]*r[18],t[9]=i[5]*r[4]+i[6]*r[9]+i[7]*r[14]+i[8]*r[19]+i[9],t[10]=i[10]*r[0]+i[11]*r[5]+i[12]*r[10]+i[13]*r[15],t[11]=i[10]*r[1]+i[11]*r[6]+i[12]*r[11]+i[13]*r[16],t[12]=i[10]*r[2]+i[11]*r[7]+i[12]*r[12]+i[13]*r[17],t[13]=i[10]*r[3]+i[11]*r[8]+i[12]*r[13]+i[13]*r[18],t[14]=i[10]*r[4]+i[11]*r[9]+i[12]*r[14]+i[13]*r[19]+i[14],t[15]=i[15]*r[0]+i[16]*r[5]+i[17]*r[10]+i[18]*r[15],t[16]=i[15]*r[1]+i[16]*r[6]+i[17]*r[11]+i[18]*r[16],t[17]=i[15]*r[2]+i[16]*r[7]+i[17]*r[12]+i[18]*r[17],t[18]=i[15]*r[3]+i[16]*r[8]+i[17]*r[13]+i[18]*r[18],t[19]=i[15]*r[4]+i[16]*r[9]+i[17]*r[14]+i[18]*r[19]+i[19],t},e.prototype._colorMatrix=function(t){var i=new Float32Array(t);return i[4]/=255,i[9]/=255,i[14]/=255,i[19]/=255,i},e.prototype.brightness=function(t,i){var r=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(r,i)},e.prototype.tint=function(t,i){var r=t>>16&255,s=t>>8&255,o=t&255,a=[r/255,0,0,0,0,0,s/255,0,0,0,0,0,o/255,0,0,0,0,0,1,0];this._loadMatrix(a,i)},e.prototype.greyscale=function(t,i){var r=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(r,i)},e.prototype.blackAndWhite=function(t){var i=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(i,t)},e.prototype.hue=function(t,i){t=(t||0)/180*Math.PI;var r=Math.cos(t),s=Math.sin(t),o=Math.sqrt,a=1/3,l=o(a),u=r+(1-r)*a,c=a*(1-r)-l*s,h=a*(1-r)+l*s,d=a*(1-r)+l*s,f=r+a*(1-r),p=a*(1-r)-l*s,_=a*(1-r)-l*s,m=a*(1-r)+l*s,g=r+a*(1-r),v=[u,c,h,0,0,d,f,p,0,0,_,m,g,0,0,0,0,0,1,0];this._loadMatrix(v,i)},e.prototype.contrast=function(t,i){var r=(t||0)+1,s=-.5*(r-1),o=[r,0,0,0,s,0,r,0,0,s,0,0,r,0,s,0,0,0,1,0];this._loadMatrix(o,i)},e.prototype.saturate=function(t,i){t===void 0&&(t=0);var r=t*2/3+1,s=(r-1)*-.5,o=[r,s,s,0,0,s,r,s,0,0,s,s,r,0,0,0,0,0,1,0];this._loadMatrix(o,i)},e.prototype.desaturate=function(){this.saturate(-1)},e.prototype.negative=function(t){var i=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(i,t)},e.prototype.sepia=function(t){var i=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(i,t)},e.prototype.technicolor=function(t){var i=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(i,t)},e.prototype.polaroid=function(t){var i=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(i,t)},e.prototype.toBGR=function(t){var i=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(i,t)},e.prototype.kodachrome=function(t){var i=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(i,t)},e.prototype.browni=function(t){var i=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(i,t)},e.prototype.vintage=function(t){var i=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(i,t)},e.prototype.colorTone=function(t,i,r,s,o){t=t||.2,i=i||.15,r=r||16770432,s=s||3375104;var a=(r>>16&255)/255,l=(r>>8&255)/255,u=(r&255)/255,c=(s>>16&255)/255,h=(s>>8&255)/255,d=(s&255)/255,f=[.3,.59,.11,0,0,a,l,u,t,0,c,h,d,i,0,a-c,l-h,u-d,0,0];this._loadMatrix(f,o)},e.prototype.night=function(t,i){t=t||.1;var r=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(r,i)},e.prototype.predator=function(t,i){var r=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(r,i)},e.prototype.lsd=function(t){var i=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(i,t)},e.prototype.reset=function(){var t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)},Object.defineProperty(e.prototype,"matrix",{get:function(){return this.uniforms.m},set:function(t){this.uniforms.m=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0}),e}(eo);fy.prototype.grayscale=fy.prototype.greyscale;/*!
 * @pixi/filter-displacement - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/filter-displacement is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var py=function(n,e){return py=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},py(n,e)};function FK(n,e){py(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var NK=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,UK=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`,BK=function(n){FK(e,n);function e(t,i){var r=this,s=new kt;return t.renderable=!1,r=n.call(this,UK,NK,{mapSampler:t._texture,filterMatrix:s,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])})||this,r.maskSprite=t,r.maskMatrix=s,i==null&&(i=20),r.scale=new Bt(i,i),r}return e.prototype.apply=function(t,i,r,s){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var o=this.maskSprite.worldTransform,a=Math.sqrt(o.a*o.a+o.b*o.b),l=Math.sqrt(o.c*o.c+o.d*o.d);a!==0&&l!==0&&(this.uniforms.rotation[0]=o.a/a,this.uniforms.rotation[1]=o.b/a,this.uniforms.rotation[2]=o.c/l,this.uniforms.rotation[3]=o.d/l),t.applyFilter(this,i,r,s)},Object.defineProperty(e.prototype,"map",{get:function(){return this.uniforms.mapSampler},set:function(t){this.uniforms.mapSampler=t},enumerable:!1,configurable:!0}),e}(eo);/*!
 * @pixi/filter-fxaa - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/filter-fxaa is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var my=function(n,e){return my=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},my(n,e)};function kK(n,e){my(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var VK=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`,GK=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,HK=function(n){kK(e,n);function e(){return n.call(this,VK,GK)||this}return e}(eo);/*!
 * @pixi/filter-noise - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/filter-noise is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var gy=function(n,e){return gy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},gy(n,e)};function zK(n,e){gy(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var WK=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`,XK=function(n){zK(e,n);function e(t,i){t===void 0&&(t=.5),i===void 0&&(i=Math.random());var r=n.call(this,Ob,WK,{uNoise:0,uSeed:0})||this;return r.noise=t,r.seed=i,r}return Object.defineProperty(e.prototype,"noise",{get:function(){return this.uniforms.uNoise},set:function(t){this.uniforms.uNoise=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"seed",{get:function(){return this.uniforms.uSeed},set:function(t){this.uniforms.uSeed=t},enumerable:!1,configurable:!0}),e}(eo);/*!
 * @pixi/mixin-cache-as-bitmap - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/mixin-cache-as-bitmap is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var yO=new kt;cn.prototype._cacheAsBitmap=!1;cn.prototype._cacheData=null;cn.prototype._cacheAsBitmapResolution=null;cn.prototype._cacheAsBitmapMultisample=Jt.NONE;var jK=function(){function n(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}return n}();Object.defineProperties(cn.prototype,{cacheAsBitmapResolution:{get:function(){return this._cacheAsBitmapResolution},set:function(n){n!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=n,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get:function(){return this._cacheAsBitmapMultisample},set:function(n){n!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=n,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(n){if(this._cacheAsBitmap!==n){this._cacheAsBitmap=n;var e;n?(this._cacheData||(this._cacheData=new jK),e=this._cacheData,e.originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(e=this._cacheData,e.sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}}});cn.prototype._renderCached=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(e),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(e))};cn.prototype._initCachedDisplayObject=function(e){var t;if(!(this._cacheData&&this._cacheData.sprite)){var i=this.alpha;this.alpha=1,e.batch.flush();var r=this.getLocalBounds(null,!0).clone();if(this.filters&&this.filters.length){var s=this.filters[0].padding;r.pad(s)}r.ceil(Oe.RESOLUTION);var o=e.renderTexture.current,a=e.renderTexture.sourceFrame.clone(),l=e.renderTexture.destinationFrame.clone(),u=e.projection.transform,c=zo.create({width:r.width,height:r.height,resolution:this.cacheAsBitmapResolution||e.resolution,multisample:(t=this.cacheAsBitmapMultisample)!==null&&t!==void 0?t:e.multisample}),h="cacheAsBitmap_"+Ho();this._cacheData.textureCacheId=h,xt.addToCache(c.baseTexture,h),Ke.addToCache(c,h);var d=this.transform.localTransform.copyTo(yO).invert().translate(-r.x,-r.y);this.render=this._cacheData.originalRender,e.render(this,{renderTexture:c,clear:!0,transform:d,skipUpdateTransform:!1}),e.framebuffer.blit(),e.projection.transform=u,e.renderTexture.bind(o,a,l),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=i;var f=new Tc(c);f.transform.worldTransform=this.transform.worldTransform,f.anchor.x=-(r.x/r.width),f.anchor.y=-(r.y/r.height),f.alpha=i,f._bounds=this._bounds,this._cacheData.sprite=f,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=f.containsPoint.bind(f)}};cn.prototype._renderCachedCanvas=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(e),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(e))};cn.prototype._initCachedDisplayObjectCanvas=function(e){if(!(this._cacheData&&this._cacheData.sprite)){var t=this.getLocalBounds(null,!0),i=this.alpha;this.alpha=1;var r=e.context,s=e._projTransform;t.ceil(Oe.RESOLUTION);var o=zo.create({width:t.width,height:t.height}),a="cacheAsBitmap_"+Ho();this._cacheData.textureCacheId=a,xt.addToCache(o.baseTexture,a),Ke.addToCache(o,a);var l=yO;this.transform.localTransform.copyTo(l),l.invert(),l.tx-=t.x,l.ty-=t.y,this.renderCanvas=this._cacheData.originalRenderCanvas,e.render(this,{renderTexture:o,clear:!0,transform:l,skipUpdateTransform:!1}),e.context=r,e._projTransform=s,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=i;var u=new Tc(o);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-(t.x/t.width),u.anchor.y=-(t.y/t.height),u.alpha=i,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=e._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=u.containsPoint.bind(u)}};cn.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};cn.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};cn.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,xt.removeFromCache(this._cacheData.textureCacheId),Ke.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};cn.prototype._cacheAsBitmapDestroy=function(e){this.cacheAsBitmap=!1,this.destroy(e)};/*!
 * @pixi/mixin-get-child-by-name - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/mixin-get-child-by-name is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */cn.prototype.name=null;Oi.prototype.getChildByName=function(e,t){for(var i=0,r=this.children.length;i<r;i++)if(this.children[i].name===e)return this.children[i];if(t)for(var i=0,r=this.children.length;i<r;i++){var s=this.children[i];if(s.getChildByName){var o=s.getChildByName(e,!0);if(o)return o}}return null};/*!
 * @pixi/mixin-get-global-position - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/mixin-get-global-position is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */cn.prototype.getGlobalPosition=function(e,t){return e===void 0&&(e=new Bt),t===void 0&&(t=!1),this.parent?this.parent.toGlobal(this.position,e,t):(e.x=this.position.x,e.y=this.position.y),e};/*!
 * @pixi/app - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/app is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var xO=function(){function n(){}return n.init=function(e){var t=this;Object.defineProperty(this,"resizeTo",{set:function(i){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=i,i&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){t._resizeTo&&(t.cancelResize(),t._resizeId=requestAnimationFrame(function(){return t.resize()}))},this.cancelResize=function(){t._resizeId&&(cancelAnimationFrame(t._resizeId),t._resizeId=null)},this.resize=function(){if(t._resizeTo){t.cancelResize();var i,r;if(t._resizeTo===globalThis.window)i=globalThis.innerWidth,r=globalThis.innerHeight;else{var s=t._resizeTo,o=s.clientWidth,a=s.clientHeight;i=o,r=a}t.renderer.resize(i,r)}},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null},n.destroy=function(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null},n.extension=Ut.Application,n}(),Kb=function(){function n(e){var t=this;this.stage=new Oi,e=Object.assign({forceCanvas:!1},e),this.renderer=qI(e),n._plugins.forEach(function(i){i.init.call(t,e)})}return n.registerPlugin=function(e){ai("6.5.0","Application.registerPlugin() is deprecated, use extensions.add()"),ds.add({type:Ut.Application,ref:e})},n.prototype.render=function(){this.renderer.render(this.stage)},Object.defineProperty(n.prototype,"view",{get:function(){return this.renderer.view},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"screen",{get:function(){return this.renderer.screen},enumerable:!1,configurable:!0}),n.prototype.destroy=function(e,t){var i=this,r=n._plugins.slice(0);r.reverse(),r.forEach(function(s){s.destroy.call(i)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(e),this.renderer=null},n._plugins=[],n}();ds.handleByList(Ut.Application,Kb._plugins);ds.add(xO);/*!
 * @pixi/mesh-extras - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/mesh-extras is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var _y=function(n,e){return _y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},_y(n,e)};function Mc(n,e){_y(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var bO=function(n){Mc(e,n);function e(t,i,r,s){t===void 0&&(t=100),i===void 0&&(i=100),r===void 0&&(r=10),s===void 0&&(s=10);var o=n.call(this)||this;return o.segWidth=r,o.segHeight=s,o.width=t,o.height=i,o.build(),o}return e.prototype.build=function(){for(var t=this.segWidth*this.segHeight,i=[],r=[],s=[],o=this.segWidth-1,a=this.segHeight-1,l=this.width/o,u=this.height/a,c=0;c<t;c++){var h=c%this.segWidth,d=c/this.segWidth|0;i.push(h*l,d*u),r.push(h/o,d/a)}for(var f=o*a,c=0;c<f;c++){var p=c%o,_=c/o|0,m=_*this.segWidth+p,g=_*this.segWidth+p+1,v=(_+1)*this.segWidth+p,y=(_+1)*this.segWidth+p+1;s.push(m,g,v,g,y,v)}this.buffers[0].data=new Float32Array(i),this.buffers[1].data=new Float32Array(r),this.indexBuffer.data=new Uint16Array(s),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()},e}(Vd),SO=function(n){Mc(e,n);function e(t,i,r){t===void 0&&(t=200),r===void 0&&(r=0);var s=n.call(this,new Float32Array(i.length*4),new Float32Array(i.length*4),new Uint16Array((i.length-1)*6))||this;return s.points=i,s._width=t,s.textureScale=r,s.build(),s}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),e.prototype.build=function(){var t=this.points;if(t){var i=this.getBuffer("aVertexPosition"),r=this.getBuffer("aTextureCoord"),s=this.getIndex();if(!(t.length<1)){i.data.length/4!==t.length&&(i.data=new Float32Array(t.length*4),r.data=new Float32Array(t.length*4),s.data=new Uint16Array((t.length-1)*6));var o=r.data,a=s.data;o[0]=0,o[1]=0,o[2]=0,o[3]=1;for(var l=0,u=t[0],c=this._width*this.textureScale,h=t.length,d=0;d<h;d++){var f=d*4;if(this.textureScale>0){var p=u.x-t[d].x,_=u.y-t[d].y,m=Math.sqrt(p*p+_*_);u=t[d],l+=m/c}else l=d/(h-1);o[f]=l,o[f+1]=0,o[f+2]=l,o[f+3]=1}for(var g=0,d=0;d<h-1;d++){var f=d*2;a[g++]=f,a[g++]=f+1,a[g++]=f+2,a[g++]=f+2,a[g++]=f+1,a[g++]=f+3}r.update(),s.update(),this.updateVertices()}}},e.prototype.updateVertices=function(){var t=this.points;if(!(t.length<1)){for(var i=t[0],r,s=0,o=0,a=this.buffers[0].data,l=t.length,u=0;u<l;u++){var c=t[u],h=u*4;u<t.length-1?r=t[u+1]:r=c,o=-(r.x-i.x),s=r.y-i.y;var d=Math.sqrt(s*s+o*o),f=this.textureScale>0?this.textureScale*this._width/2:this._width/2;s/=d,o/=d,s*=f,o*=f,a[h]=c.x+s,a[h+1]=c.y+o,a[h+2]=c.x-s,a[h+3]=c.y-o,i=c}this.buffers[0].update()}},e.prototype.update=function(){this.textureScale>0?this.build():this.updateVertices()},e}(Vd),$K=function(n){Mc(e,n);function e(t,i,r){r===void 0&&(r=0);var s=this,o=new SO(t.height,i,r),a=new ec(t);return r>0&&(t.baseTexture.wrapMode=Ar.REPEAT),s=n.call(this,o,a)||this,s.autoUpdate=!0,s}return e.prototype._render=function(t){var i=this.geometry;(this.autoUpdate||i._width!==this.shader.texture.height)&&(i._width=this.shader.texture.height,i.update()),n.prototype._render.call(this,t)},e}(Qu),EO=function(n){Mc(e,n);function e(t,i,r){var s=this,o=new bO(t.width,t.height,i,r),a=new ec(Ke.WHITE);return s=n.call(this,o,a)||this,s.texture=t,s.autoResize=!0,s}return e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID;var t=this.geometry,i=this.shader.texture,r=i.width,s=i.height;this.autoResize&&(t.width!==r||t.height!==s)&&(t.width=this.shader.texture.width,t.height=this.shader.texture.height,t.build())},Object.defineProperty(e.prototype,"texture",{get:function(){return this.shader.texture},set:function(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))},enumerable:!1,configurable:!0}),e.prototype._render=function(t){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),n.prototype._render.call(this,t)},e.prototype.destroy=function(t){this.shader.texture.off("update",this.textureUpdated,this),n.prototype.destroy.call(this,t)},e}(Qu),YK=function(n){Mc(e,n);function e(t,i,r,s,o){t===void 0&&(t=Ke.EMPTY);var a=this,l=new Vd(i,r,s);l.getBuffer("aVertexPosition").static=!1;var u=new ec(t);return a=n.call(this,l,u,null,o)||this,a.autoUpdate=!0,a}return Object.defineProperty(e.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),e.prototype._render=function(t){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),n.prototype._render.call(this,t)},e}(Qu),Vf=10,qK=function(n){Mc(e,n);function e(t,i,r,s,o){i===void 0&&(i=Vf),r===void 0&&(r=Vf),s===void 0&&(s=Vf),o===void 0&&(o=Vf);var a=n.call(this,Ke.WHITE,4,4)||this;return a._origWidth=t.orig.width,a._origHeight=t.orig.height,a._width=a._origWidth,a._height=a._origHeight,a._leftWidth=i,a._rightWidth=s,a._topHeight=r,a._bottomHeight=o,a.texture=t,a}return e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this._refresh()},Object.defineProperty(e.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),e.prototype.updateHorizontalVertices=function(){var t=this.vertices,i=this._getMinScale();t[9]=t[11]=t[13]=t[15]=this._topHeight*i,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*i,t[25]=t[27]=t[29]=t[31]=this._height},e.prototype.updateVerticalVertices=function(){var t=this.vertices,i=this._getMinScale();t[2]=t[10]=t[18]=t[26]=this._leftWidth*i,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*i,t[6]=t[14]=t[22]=t[30]=this._width},e.prototype._getMinScale=function(){var t=this._leftWidth+this._rightWidth,i=this._width>t?1:this._width/t,r=this._topHeight+this._bottomHeight,s=this._height>r?1:this._height/r,o=Math.min(i,s);return o},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leftWidth",{get:function(){return this._leftWidth},set:function(t){this._leftWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rightWidth",{get:function(){return this._rightWidth},set:function(t){this._rightWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"topHeight",{get:function(){return this._topHeight},set:function(t){this._topHeight=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottomHeight",{get:function(){return this._bottomHeight},set:function(t){this._bottomHeight=t,this._refresh()},enumerable:!1,configurable:!0}),e.prototype._refresh=function(){var t=this.texture,i=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;var r=1/this._origWidth,s=1/this._origHeight;i[0]=i[8]=i[16]=i[24]=0,i[1]=i[3]=i[5]=i[7]=0,i[6]=i[14]=i[22]=i[30]=1,i[25]=i[27]=i[29]=i[31]=1,i[2]=i[10]=i[18]=i[26]=r*this._leftWidth,i[4]=i[12]=i[20]=i[28]=1-r*this._rightWidth,i[9]=i[11]=i[13]=i[15]=s*this._topHeight,i[17]=i[19]=i[21]=i[23]=1-s*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()},e}(EO);/*!
 * @pixi/sprite-animated - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/sprite-animated is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var vy=function(n,e){return vy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},vy(n,e)};function KK(n,e){vy(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var ZK=function(n){KK(e,n);function e(t,i){i===void 0&&(i=!0);var r=n.call(this,t[0]instanceof Ke?t[0]:t[0].texture)||this;return r._textures=null,r._durations=null,r._autoUpdate=i,r._isConnectedToTicker=!1,r.animationSpeed=1,r.loop=!0,r.updateAnchor=!1,r.onComplete=null,r.onFrameChange=null,r.onLoop=null,r._currentTime=0,r._playing=!1,r._previousFrame=null,r.textures=t,r}return e.prototype.stop=function(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(Fn.shared.remove(this.update,this),this._isConnectedToTicker=!1))},e.prototype.play=function(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(Fn.shared.add(this.update,this,ls.HIGH),this._isConnectedToTicker=!0))},e.prototype.gotoAndStop=function(t){this.stop();var i=this.currentFrame;this._currentTime=t,i!==this.currentFrame&&this.updateTexture()},e.prototype.gotoAndPlay=function(t){var i=this.currentFrame;this._currentTime=t,i!==this.currentFrame&&this.updateTexture(),this.play()},e.prototype.update=function(t){if(this._playing){var i=this.animationSpeed*t,r=this.currentFrame;if(this._durations!==null){var s=this._currentTime%1*this._durations[this.currentFrame];for(s+=i/60*1e3;s<0;)this._currentTime--,s+=this._durations[this.currentFrame];var o=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);s>=this._durations[this.currentFrame];)s-=this._durations[this.currentFrame]*o,this._currentTime+=o;this._currentTime+=s/this._durations[this.currentFrame]}else this._currentTime+=i;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):r!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<r?this.onLoop():this.animationSpeed<0&&this.currentFrame>r&&this.onLoop()),this.updateTexture())}},e.prototype.updateTexture=function(){var t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))},e.prototype.destroy=function(t){this.stop(),n.prototype.destroy.call(this,t),this.onComplete=null,this.onFrameChange=null,this.onLoop=null},e.fromFrames=function(t){for(var i=[],r=0;r<t.length;++r)i.push(Ke.from(t[r]));return new e(i)},e.fromImages=function(t){for(var i=[],r=0;r<t.length;++r)i.push(Ke.from(t[r]));return new e(i)},Object.defineProperty(e.prototype,"totalFrames",{get:function(){return this._textures.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textures",{get:function(){return this._textures},set:function(t){if(t[0]instanceof Ke)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(var i=0;i<t.length;i++)this._textures.push(t[i].texture),this._durations.push(t[i].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentFrame",{get:function(){var t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playing",{get:function(){return this._playing},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Fn.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(Fn.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),e}(Tc);/*!
 * pixi.js - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * pixi.js is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */ds.add(LL,NL,FL,ZL,lO,Fb,dO,_O,HL,YL,qL,cO,wI,BL);var JK={AlphaFilter:wK,BlurFilter:LK,BlurFilterPass:hy,ColorMatrixFilter:fy,DisplacementFilter:BK,FXAAFilter:HK,NoiseFilter:XK};const QK=Object.freeze(Object.defineProperty({__proto__:null,get ALPHA_MODES(){return ar},AbstractBatchRenderer:ZI,AbstractMultiResource:ag,AbstractRenderer:YI,AccessibilityManager:LL,AnimatedSprite:ZK,AppLoaderPlugin:BL,Application:Kb,ArrayResource:ub,Attribute:N0,get BLEND_MODES(){return He},get BUFFER_BITS(){return nd},get BUFFER_TYPE(){return Pr},BaseImageResource:us,BasePrepare:oO,BaseRenderTexture:mb,BaseTexture:xt,BatchDrawCall:sm,BatchGeometry:Db,BatchPluginFactory:QI,BatchRenderer:Fb,BatchShaderGenerator:JI,BatchSystem:yb,BatchTextureArray:om,BitmapFont:Ls,BitmapFontData:xd,BitmapFontLoader:_O,BitmapText:EK,BlobResource:GL,Bounds:dd,BrowserAdapter:jR,Buffer:vn,BufferResource:Sl,get CLEAR_MODES(){return Wi},get COLOR_MASK_BITS(){return m0},CanvasResource:cb,Circle:SI,CompressedTextureLoader:HL,CompressedTextureResource:um,Container:Oi,ContextSystem:xb,CountLimiter:sO,CubeResource:hb,DDSLoader:YL,DEG_TO_RAD:bI,get DRAW_MODES(){return Ji},DisplayObject:cn,get ENV(){return as},Ellipse:EI,get ExtensionType(){return Ut},Extract:NL,get FORMATS(){return Me},FORMATS_TO_COMPONENTS:XL,FillStyle:Wb,Filter:eo,FilterState:RI,FilterSystem:vb,Framebuffer:rm,FramebufferSystem:bb,get GC_MODES(){return rd},GLFramebuffer:II,GLProgram:XI,GLTexture:Ap,GRAPHICS_CURVES:Zu,Geometry:Sc,GeometrySystem:Sb,Graphics:yd,GraphicsData:ny,GraphicsGeometry:iO,IGLUniformData:P9,INSTALLED:hd,get INTERNAL_FORMATS(){return at},INTERNAL_FORMAT_TO_BYTES_PER_PIXEL:_d,ImageBitmapResource:pb,ImageResource:lg,InteractionData:X0,InteractionEvent:OL,InteractionManager:FL,InteractionTrackingData:Ip,KTXLoader:qL,get LINE_CAP(){return Bs},get LINE_JOIN(){return es},LineStyle:rO,Loader:gd,get LoaderResource(){return on},get MASK_TYPES(){return fn},get MIPMAP_MODES(){return or},get MSAA_QUALITY(){return Jt},MaskData:LI,MaskSystem:Eb,Matrix:kt,Mesh:Qu,MeshBatchUvs:fO,MeshGeometry:Vd,MeshMaterial:ec,NineSlicePlane:qK,ObjectRenderer:kd,ObservablePoint:Us,PI_2:cd,get PRECISION(){return gi},ParticleContainer:Vq,ParticleRenderer:ZL,PlaneGeometry:bO,Point:Bt,Polygon:Dh,Prepare:lO,Program:Ec,ProjectionSystem:wb,Quad:CI,QuadUv:_b,RAD_TO_DEG:xI,get RENDERER_TYPE(){return $u},Rectangle:St,RenderTexture:zo,RenderTexturePool:PI,RenderTextureSystem:Ab,Renderer:Lb,ResizePlugin:xO,Resource:dl,RopeGeometry:SO,RoundedRectangle:TI,Runner:On,get SAMPLER_TYPES(){return id},get SCALE_MODES(){return wr},get SHAPES(){return Tn},SVGResource:db,ScissorSystem:Tb,Shader:Xs,ShaderSystem:Pb,SimpleMesh:YK,SimplePlane:EO,SimpleRope:$K,Sprite:Tc,SpriteMaskFilter:kI,Spritesheet:uO,SpritesheetLoader:cO,State:qo,StateSystem:Cb,StencilSystem:Mb,System:W9,get TARGETS(){return Oo},get TEXT_GRADIENT(){return Ju},get TYPES(){return Ge},TYPES_TO_BYTES_PER_COMPONENT:K0,TYPES_TO_BYTES_PER_PIXEL:jL,TemporaryDisplayObject:Bb,Text:$b,TextFormat:pO,TextMetrics:Br,TextStyle:fl,Texture:Ke,TextureGCSystem:Rb,TextureLoader:kL,TextureMatrix:ug,TextureSystem:Ib,TextureUvs:gb,Ticker:Fn,TickerPlugin:wI,TilingSprite:cK,TilingSpriteRenderer:dO,TimeLimiter:uK,Transform:Bd,get UPDATE_PRIORITY(){return ls},UniformGroup:Do,VERSION:$9,VideoResource:fb,ViewableBuffer:am,get WRAP_MODES(){return Ar},XMLFormat:cm,XMLStringFormat:mO,accessibleTarget:IL,autoDetectFormat:qb,autoDetectRenderer:qI,autoDetectResource:og,checkMaxIfStatementsInShader:BI,createUBOElements:HI,defaultFilterVertex:Ob,defaultVertex:KI,extensions:ds,filters:JK,generateProgram:jI,generateUniformBufferSync:WI,getTestContext:FI,getUBOData:zI,graphicsUtils:jq,groupD8:en,interactiveTarget:DL,isMobile:Qi,parseDDS:WL,parseKTX:$L,resources:eL,settings:Oe,systems:tL,uniformParsers:rl,utils:J$},Symbol.toStringTag,{value:"Module"}));var fa=Math.pow,rn=(n,e,t)=>new Promise((i,r)=>{var s=l=>{try{a(t.next(l))}catch(u){r(u)}},o=l=>{try{a(t.throw(l))}catch(u){r(u)}},a=l=>l.done?i(l.value):Promise.resolve(l.value).then(s,o);a((t=t.apply(n,e)).next())});class Zb{constructor(){this._breathParameters=[],this._currentTime=0}static create(){return new Zb}setParameters(e){this._breathParameters=e}getParameters(){return this._breathParameters}updateParameters(e,t){this._currentTime+=t;const i=this._currentTime*2*3.14159;for(let r=0;r<this._breathParameters.length;++r){const s=this._breathParameters[r];e.addParameterValueById(s.parameterId,s.offset+s.peak*Math.sin(i/s.cycle),s.weight)}}}class Yc{constructor(e,t,i,r,s){this.parameterId=e??void 0,this.offset=t??0,this.peak=i??0,this.cycle=r??0,this.weight=s??0}}const yy=class{static create(n){return new yy(n)}setBlinkingInterval(n){this._blinkingIntervalSeconds=n}setBlinkingSetting(n,e,t){this._closingSeconds=n,this._closedSeconds=e,this._openingSeconds=t}setParameterIds(n){this._parameterIds=n}getParameterIds(){return this._parameterIds}updateParameters(n,e){this._userTimeSeconds+=e;let t,i=0;switch(this._blinkingState){case Gi.EyeState_Closing:i=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._closingSeconds,i>=1&&(i=1,this._blinkingState=Gi.EyeState_Closed,this._stateStartTimeSeconds=this._userTimeSeconds),t=1-i;break;case Gi.EyeState_Closed:i=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._closedSeconds,i>=1&&(this._blinkingState=Gi.EyeState_Opening,this._stateStartTimeSeconds=this._userTimeSeconds),t=0;break;case Gi.EyeState_Opening:i=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._openingSeconds,i>=1&&(i=1,this._blinkingState=Gi.EyeState_Interval,this._nextBlinkingTime=this.determinNextBlinkingTiming()),t=i;break;case Gi.EyeState_Interval:this._nextBlinkingTime<this._userTimeSeconds&&(this._blinkingState=Gi.EyeState_Closing,this._stateStartTimeSeconds=this._userTimeSeconds),t=1;break;case Gi.EyeState_First:default:this._blinkingState=Gi.EyeState_Interval,this._nextBlinkingTime=this.determinNextBlinkingTiming(),t=1;break}yy.CloseIfZero||(t=-t);for(let r=0;r<this._parameterIds.length;++r)n.setParameterValueById(this._parameterIds[r],t)}constructor(n){var e,t;this._blinkingState=Gi.EyeState_First,this._nextBlinkingTime=0,this._stateStartTimeSeconds=0,this._blinkingIntervalSeconds=4,this._closingSeconds=.1,this._closedSeconds=.05,this._openingSeconds=.15,this._userTimeSeconds=0,this._parameterIds=[],n!=null&&(this._parameterIds=(t=(e=n.getEyeBlinkParameters())==null?void 0:e.slice())!=null?t:this._parameterIds)}determinNextBlinkingTiming(){const n=Math.random();return this._userTimeSeconds+n*(2*this._blinkingIntervalSeconds-1)}};let TO=yy;TO.CloseIfZero=!0;var Gi=(n=>(n[n.EyeState_First=0]="EyeState_First",n[n.EyeState_Interval=1]="EyeState_Interval",n[n.EyeState_Closing=2]="EyeState_Closing",n[n.EyeState_Closed=3]="EyeState_Closed",n[n.EyeState_Opening=4]="EyeState_Opening",n))(Gi||{});const eZ=.001,ZM=.5;class Jb{static create(e){const t=new Jb;typeof e.FadeInTime=="number"&&(t._fadeTimeSeconds=e.FadeInTime,t._fadeTimeSeconds<=0&&(t._fadeTimeSeconds=ZM));const i=e.Groups,r=i.length;for(let s=0;s<r;++s){const o=i[s],a=o.length;let l=0;for(let u=0;u<a;++u){const c=o[u],h=new hm;h.partId=c.Id;const d=c.Link;if(d){const f=d.length;for(let p=0;p<f;++p){const _=new hm;_.partId=d[p],h.link.push(_)}}t._partGroups.push(h),++l}t._partGroupCounts.push(l)}return t}updateParameters(e,t){e!=this._lastModel&&this.reset(e),this._lastModel=e,t<0&&(t=0);let i=0;for(let r=0;r<this._partGroupCounts.length;r++){const s=this._partGroupCounts[r];this.doFade(e,t,i,s),i+=s}this.copyPartOpacities(e)}reset(e){let t=0;for(let i=0;i<this._partGroupCounts.length;++i){const r=this._partGroupCounts[i];for(let s=t;s<t+r;++s){this._partGroups[s].initialize(e);const o=this._partGroups[s].partIndex,a=this._partGroups[s].parameterIndex;if(!(o<0)){e.setPartOpacityByIndex(o,s==t?1:0),e.setParameterValueByIndex(a,s==t?1:0);for(let l=0;l<this._partGroups[s].link.length;++l)this._partGroups[s].link[l].initialize(e)}}t+=r}}copyPartOpacities(e){for(let t=0;t<this._partGroups.length;++t){const i=this._partGroups[t];if(i.link.length==0)continue;const r=this._partGroups[t].partIndex,s=e.getPartOpacityByIndex(r);for(let o=0;o<i.link.length;++o){const l=i.link[o].partIndex;l<0||e.setPartOpacityByIndex(l,s)}}}doFade(e,t,i,r){let s=-1,o=1;const a=.5,l=.15;for(let u=i;u<i+r;++u){const c=this._partGroups[u].partIndex,h=this._partGroups[u].parameterIndex;if(e.getParameterValueByIndex(h)>eZ){if(s>=0)break;s=u,o=e.getPartOpacityByIndex(c),o+=t/this._fadeTimeSeconds,o>1&&(o=1)}}s<0&&(s=0,o=1);for(let u=i;u<i+r;++u){const c=this._partGroups[u].partIndex;if(s==u)e.setPartOpacityByIndex(c,o);else{let h=e.getPartOpacityByIndex(c),d;o<a?d=o*(a-1)/a+1:d=(1-o)*a/(1-a),(1-d)*(1-o)>l&&(d=1-l/(1-o)),h>d&&(h=d),e.setPartOpacityByIndex(c,h)}}}constructor(){this._fadeTimeSeconds=ZM,this._lastModel=void 0,this._partGroups=[],this._partGroupCounts=[]}}class hm{constructor(e){this.parameterIndex=0,this.partIndex=0,this.partId="",this.link=[],e!=null&&this.assignment(e)}assignment(e){return this.partId=e.partId,this.link=e.link.map(t=>t.clone()),this}initialize(e){this.parameterIndex=e.getParameterIndex(this.partId),this.partIndex=e.getPartIndex(this.partId),e.setParameterValueByIndex(this.parameterIndex,1)}clone(){const e=new hm;return e.partId=this.partId,e.parameterIndex=this.parameterIndex,e.partIndex=this.partIndex,e.link=this.link.map(t=>t.clone()),e}}class st{constructor(e,t){this.x=e||0,this.y=t||0}add(e){const t=new st(0,0);return t.x=this.x+e.x,t.y=this.y+e.y,t}substract(e){const t=new st(0,0);return t.x=this.x-e.x,t.y=this.y-e.y,t}multiply(e){const t=new st(0,0);return t.x=this.x*e.x,t.y=this.y*e.y,t}multiplyByScaler(e){return this.multiply(new st(e,e))}division(e){const t=new st(0,0);return t.x=this.x/e.x,t.y=this.y/e.y,t}divisionByScalar(e){return this.division(new st(e,e))}getLength(){return Math.sqrt(this.x*this.x+this.y*this.y)}getDistanceWith(e){return Math.sqrt((this.x-e.x)*(this.x-e.x)+(this.y-e.y)*(this.y-e.y))}dot(e){return this.x*e.x+this.y*e.y}normalize(){const e=Math.pow(this.x*this.x+this.y*this.y,.5);this.x=this.x/e,this.y=this.y/e}isEqual(e){return this.x==e.x&&this.y==e.y}isNotEqual(e){return!this.isEqual(e)}}const Dp=class{static range(n,e,t){return n<e?n=e:n>t&&(n=t),n}static sin(n){return Math.sin(n)}static cos(n){return Math.cos(n)}static abs(n){return Math.abs(n)}static sqrt(n){return Math.sqrt(n)}static cbrt(n){if(n===0)return n;let e=n;const t=e<0;t&&(e=-e);let i;return e===1/0?i=1/0:(i=Math.exp(Math.log(e)/3),i=(e/(i*i)+2*i)/3),t?-i:i}static getEasingSine(n){return n<0?0:n>1?1:.5-.5*this.cos(n*Math.PI)}static max(n,e){return n>e?n:e}static min(n,e){return n>e?e:n}static degreesToRadian(n){return n/180*Math.PI}static radianToDegrees(n){return n*180/Math.PI}static directionToRadian(n,e){const t=Math.atan2(e.y,e.x),i=Math.atan2(n.y,n.x);let r=t-i;for(;r<-Math.PI;)r+=Math.PI*2;for(;r>Math.PI;)r-=Math.PI*2;return r}static directionToDegrees(n,e){const t=this.directionToRadian(n,e);let i=this.radianToDegrees(t);return e.x-n.x>0&&(i=-i),i}static radianToDirection(n){const e=new st;return e.x=this.sin(n),e.y=this.cos(n),e}static quadraticEquation(n,e,t){return this.abs(n)<Dp.Epsilon?this.abs(e)<Dp.Epsilon?-t:-t/e:-(e+this.sqrt(e*e-4*n*t))/(2*n)}static cardanoAlgorithmForBezier(n,e,t,i){if(this.sqrt(n)<Dp.Epsilon)return this.range(this.quadraticEquation(e,t,i),0,1);const r=e/n,s=t/n,o=i/n,a=(3*s-r*r)/3,l=a/3,u=(2*r*r*r-9*r*s+27*o)/27,c=u/2,h=c*c+l*l*l,d=.5,f=d+.01;if(h<0){const v=-a/3,y=v*v*v,x=this.sqrt(y),b=-u/(2*x),S=this.range(b,-1,1),T=Math.acos(S),E=2*this.cbrt(x),M=E*this.cos(T/3)-r/3;if(this.abs(M-d)<f)return this.range(M,0,1);const O=E*this.cos((T+2*Math.PI)/3)-r/3;if(this.abs(O-d)<f)return this.range(O,0,1);const L=E*this.cos((T+4*Math.PI)/3)-r/3;return this.range(L,0,1)}if(h==0){let v;c<0?v=this.cbrt(-c):v=-this.cbrt(c);const y=2*v-r/3;if(this.abs(y-d)<f)return this.range(y,0,1);const x=-v-r/3;return this.range(x,0,1)}const p=this.sqrt(h),_=this.cbrt(p-c),m=this.cbrt(p+c),g=_-m-r/3;return this.range(g,0,1)}constructor(){}};let Xt=Dp;Xt.Epsilon=1e-5;class er{constructor(){this._tr=new Float32Array(16),this.loadIdentity()}static multiply(e,t,i){const r=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),s=4;for(let o=0;o<s;++o)for(let a=0;a<s;++a)for(let l=0;l<s;++l)r[a+o*4]+=e[l+o*4]*t[a+l*4];for(let o=0;o<16;++o)i[o]=r[o]}loadIdentity(){const e=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);this.setMatrix(e)}setMatrix(e){for(let t=0;t<16;++t)this._tr[t]=e[t]}getArray(){return this._tr}getScaleX(){return this._tr[0]}getScaleY(){return this._tr[5]}getTranslateX(){return this._tr[12]}getTranslateY(){return this._tr[13]}transformX(e){return this._tr[0]*e+this._tr[12]}transformY(e){return this._tr[5]*e+this._tr[13]}invertTransformX(e){return(e-this._tr[12])/this._tr[0]}invertTransformY(e){return(e-this._tr[13])/this._tr[5]}translateRelative(e,t){const i=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,e,t,0,1]);er.multiply(i,this._tr,this._tr)}translate(e,t){this._tr[12]=e,this._tr[13]=t}translateX(e){this._tr[12]=e}translateY(e){this._tr[13]=e}scaleRelative(e,t){const i=new Float32Array([e,0,0,0,0,t,0,0,0,0,1,0,0,0,0,1]);er.multiply(i,this._tr,this._tr)}scale(e,t){this._tr[0]=e,this._tr[5]=t}multiplyByMatrix(e){er.multiply(e.getArray(),this._tr,this._tr)}clone(){const e=new er;for(let t=0;t<this._tr.length;t++)e._tr[t]=this._tr[t];return e}}class Qb{initialize(e){this._model=e}drawModel(){this.getModel()!=null&&this.doDrawModel()}setMvpMatrix(e){this._mvpMatrix4x4.setMatrix(e.getArray())}getMvpMatrix(){return this._mvpMatrix4x4}setModelColor(e,t,i,r){e<0?e=0:e>1&&(e=1),t<0?t=0:t>1&&(t=1),i<0?i=0:i>1&&(i=1),r<0?r=0:r>1&&(r=1),this._modelColor.R=e,this._modelColor.G=t,this._modelColor.B=i,this._modelColor.A=r}getModelColor(){return Object.assign({},this._modelColor)}setIsPremultipliedAlpha(e){this._isPremultipliedAlpha=e}isPremultipliedAlpha(){return this._isPremultipliedAlpha}setIsCulling(e){this._isCulling=e}isCulling(){return this._isCulling}setAnisotropy(e){this._anisortopy=e}getAnisotropy(){return this._anisortopy}getModel(){return this._model}constructor(){this._isCulling=!1,this._isPremultipliedAlpha=!1,this._anisortopy=0,this._modelColor=new xh,this._mvpMatrix4x4=new er,this._mvpMatrix4x4.loadIdentity()}}var No=(n=>(n[n.CubismBlendMode_Normal=0]="CubismBlendMode_Normal",n[n.CubismBlendMode_Additive=1]="CubismBlendMode_Additive",n[n.CubismBlendMode_Multiplicative=2]="CubismBlendMode_Multiplicative",n))(No||{});class xh{constructor(){this.R=1,this.G=1,this.B=1,this.A=1}}let Hr=!1,Bl=!1,kl;const X_={vertexOffset:0,vertexStep:2};class bd{static startUp(e){if(Hr)return qc("CubismFramework.startUp() is already done."),Hr;if(Live2DCubismCore._isStarted)return Hr=!0,!0;if(Live2DCubismCore._isStarted=!0,kl=e,kl&&Live2DCubismCore.Logging.csmSetLogFunction(kl.logFunction),Hr=!0,Hr){const t=Live2DCubismCore.Version.csmGetVersion(),i=(t&4278190080)>>24,r=(t&16711680)>>16,s=t&65535,o=t;qc("Live2D Cubism Core version: {0}.{1}.{2} ({3})",("00"+i).slice(-2),("00"+r).slice(-2),("0000"+s).slice(-4),o)}return qc("CubismFramework.startUp() is complete."),Hr}static cleanUp(){Hr=!1,Bl=!1,kl=void 0}static initialize(){if(!Hr){bh("CubismFramework is not started.");return}if(Bl){bh("CubismFramework.initialize() skipped, already initialized.");return}Bl=!0,qc("CubismFramework.initialize() is complete.")}static dispose(){if(!Hr){bh("CubismFramework is not started.");return}if(!Bl){bh("CubismFramework.dispose() skipped, not initialized.");return}Qb.staticRelease(),Bl=!1,qc("CubismFramework.dispose() is complete.")}static isStarted(){return Hr}static isInitialized(){return Bl}static coreLogFunction(e){Live2DCubismCore.Logging.csmGetLogFunction()&&Live2DCubismCore.Logging.csmGetLogFunction()(e)}static getLoggingLevel(){return kl!=null?kl.loggingLevel:Tl.LogLevel_Off}constructor(){}}var Tl=(n=>(n[n.LogLevel_Verbose=0]="LogLevel_Verbose",n[n.LogLevel_Debug=1]="LogLevel_Debug",n[n.LogLevel_Info=2]="LogLevel_Info",n[n.LogLevel_Warning=3]="LogLevel_Warning",n[n.LogLevel_Error=4]="LogLevel_Error",n[n.LogLevel_Off=5]="LogLevel_Off",n))(Tl||{});const Gf=()=>{};function JM(n,...e){mg.print(Tl.LogLevel_Debug,"[CSM][D]"+n+`
`,e)}function qc(n,...e){mg.print(Tl.LogLevel_Info,"[CSM][I]"+n+`
`,e)}function bh(n,...e){mg.print(Tl.LogLevel_Warning,"[CSM][W]"+n+`
`,e)}function fu(n,...e){mg.print(Tl.LogLevel_Error,"[CSM][E]"+n+`
`,e)}class mg{static print(e,t,i){if(e<bd.getLoggingLevel())return;const r=bd.coreLogFunction;if(!r)return;const s=t.replace(/{(\d+)}/g,(o,a)=>i[a]);r(s)}static dumpBytes(e,t,i){for(let r=0;r<i;r++)r%16==0&&r>0?this.print(e,`
`):r%8==0&&r>0&&this.print(e,"  "),this.print(e,"{0} ",[t[r]&255]);this.print(e,`
`)}constructor(){}}class tZ{update(){this._model.update(),this._model.drawables.resetDynamicFlags()}getCanvasWidth(){return this._model==null?0:this._model.canvasinfo.CanvasWidth/this._model.canvasinfo.PixelsPerUnit}getCanvasHeight(){return this._model==null?0:this._model.canvasinfo.CanvasHeight/this._model.canvasinfo.PixelsPerUnit}saveParameters(){const e=this._model.parameters.count,t=this._savedParameters.length;for(let i=0;i<e;++i)i<t?this._savedParameters[i]=this._parameterValues[i]:this._savedParameters.push(this._parameterValues[i])}getModel(){return this._model}getPartIndex(e){let t;const i=this._model.parts.count;for(t=0;t<i;++t)if(e==this._partIds[t])return t;return e in this._notExistPartId?this._notExistPartId[e]:(t=i+this._notExistPartId.length,this._notExistPartId[e]=t,this._notExistPartOpacities[t]=0,t)}getPartCount(){return this._model.parts.count}setPartOpacityByIndex(e,t){if(e in this._notExistPartOpacities){this._notExistPartOpacities[e]=t;return}Gf(0<=e&&e<this.getPartCount()),this._partOpacities[e]=t}setPartOpacityById(e,t){const i=this.getPartIndex(e);i<0||this.setPartOpacityByIndex(i,t)}getPartOpacityByIndex(e){return e in this._notExistPartOpacities?this._notExistPartOpacities[e]:(Gf(0<=e&&e<this.getPartCount()),this._partOpacities[e])}getPartOpacityById(e){const t=this.getPartIndex(e);return t<0?0:this.getPartOpacityByIndex(t)}getParameterIndex(e){let t;const i=this._model.parameters.count;for(t=0;t<i;++t)if(e==this._parameterIds[t])return t;return e in this._notExistParameterId?this._notExistParameterId[e]:(t=this._model.parameters.count+Object.keys(this._notExistParameterId).length,this._notExistParameterId[e]=t,this._notExistParameterValues[t]=0,t)}getParameterCount(){return this._model.parameters.count}getParameterMaximumValue(e){return this._model.parameters.maximumValues[e]}getParameterMinimumValue(e){return this._model.parameters.minimumValues[e]}getParameterDefaultValue(e){return this._model.parameters.defaultValues[e]}getParameterValueByIndex(e){return e in this._notExistParameterValues?this._notExistParameterValues[e]:(Gf(0<=e&&e<this.getParameterCount()),this._parameterValues[e])}getParameterValueById(e){const t=this.getParameterIndex(e);return this.getParameterValueByIndex(t)}setParameterValueByIndex(e,t,i=1,r=!1){let s;if(this._model.parameters.ids.includes("ParamMouthOpenY")&&(s=this.getParameterIndex("ParamMouthOpenY")),this._model.parameters.ids.includes("PARAM_MOUTH_OPEN_Y")&&(s=this.getParameterIndex("PARAM_MOUTH_OPEN_Y")),this._model.parameters.ids.includes("ParamMouthA")&&(s=this.getParameterIndex("ParamMouthA")),e in this._notExistParameterValues){this._notExistParameterValues[e]=i==1?t:this._notExistParameterValues[e]*(1-i)+t*i;return}Gf(0<=e&&e<this.getParameterCount()),this._model.parameters.maximumValues[e]<t&&(t=this._model.parameters.maximumValues[e]),this._model.parameters.minimumValues[e]>t&&(t=this._model.parameters.minimumValues[e]),(e!=s||r)&&(this._parameterValues[e]=i==1?t:this._parameterValues[e]=this._parameterValues[e]*(1-i)+t*i)}setParameterValueById(e,t,i=1,r=!1){const s=this.getParameterIndex(e);this.setParameterValueByIndex(s,t,i,r)}addParameterValueByIndex(e,t,i=1){this.setParameterValueByIndex(e,this.getParameterValueByIndex(e)+t*i)}addParameterValueById(e,t,i=1){const r=this.getParameterIndex(e);this.addParameterValueByIndex(r,t,i)}multiplyParameterValueById(e,t,i=1){const r=this.getParameterIndex(e);this.multiplyParameterValueByIndex(r,t,i)}multiplyParameterValueByIndex(e,t,i=1){this.setParameterValueByIndex(e,this.getParameterValueByIndex(e)*(1+(t-1)*i))}getDrawableIds(){return this._drawableIds.slice()}getDrawableIndex(e){const t=this._model.drawables.count;for(let i=0;i<t;++i)if(this._drawableIds[i]==e)return i;return-1}getDrawableCount(){return this._model.drawables.count}getDrawableId(e){return this._model.drawables.ids[e]}getDrawableRenderOrders(){return this._model.drawables.renderOrders}getDrawableTextureIndices(e){return this._model.drawables.textureIndices[e]}getDrawableDynamicFlagVertexPositionsDidChange(e){const t=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasVertexPositionsDidChangeBit(t[e])}getDrawableVertexIndexCount(e){return this._model.drawables.indexCounts[e]}getDrawableVertexCount(e){return this._model.drawables.vertexCounts[e]}getDrawableVertices(e){return this.getDrawableVertexPositions(e)}getDrawableVertexIndices(e){return this._model.drawables.indices[e]}getDrawableVertexPositions(e){return this._model.drawables.vertexPositions[e]}getDrawableVertexUvs(e){return this._model.drawables.vertexUvs[e]}getDrawableOpacity(e){return this._model.drawables.opacities[e]}getDrawableCulling(e){const t=this._model.drawables.constantFlags;return!Live2DCubismCore.Utils.hasIsDoubleSidedBit(t[e])}getDrawableBlendMode(e){const t=this._model.drawables.constantFlags;return Live2DCubismCore.Utils.hasBlendAdditiveBit(t[e])?No.CubismBlendMode_Additive:Live2DCubismCore.Utils.hasBlendMultiplicativeBit(t[e])?No.CubismBlendMode_Multiplicative:No.CubismBlendMode_Normal}getDrawableInvertedMaskBit(e){const t=this._model.drawables.constantFlags;return Live2DCubismCore.Utils.hasIsInvertedMaskBit(t[e])}getDrawableMasks(){return this._model.drawables.masks}getDrawableMaskCounts(){return this._model.drawables.maskCounts}isUsingMasking(){for(let e=0;e<this._model.drawables.count;++e)if(!(this._model.drawables.maskCounts[e]<=0))return!0;return!1}getDrawableDynamicFlagIsVisible(e){const t=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasIsVisibleBit(t[e])}getDrawableDynamicFlagVisibilityDidChange(e){const t=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasVisibilityDidChangeBit(t[e])}getDrawableDynamicFlagOpacityDidChange(e){const t=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasOpacityDidChangeBit(t[e])}getDrawableDynamicFlagRenderOrderDidChange(e){const t=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasRenderOrderDidChangeBit(t[e])}loadParameters(){let e=this._model.parameters.count;const t=this._savedParameters.length;e>t&&(e=t);for(let i=0;i<e;++i)this._parameterValues[i]=this._savedParameters[i]}initialize(){this._parameterValues=this._model.parameters.values,this._partOpacities=this._model.parts.opacities,this._parameterMaximumValues=this._model.parameters.maximumValues,this._parameterMinimumValues=this._model.parameters.minimumValues;{const e=this._model.parameters.ids,t=this._model.parameters.count;for(let i=0;i<t;++i)this._parameterIds.push(e[i])}{const e=this._model.parts.ids,t=this._model.parts.count;for(let i=0;i<t;++i)this._partIds.push(e[i])}{const e=this._model.drawables.ids,t=this._model.drawables.count;for(let i=0;i<t;++i)this._drawableIds.push(e[i])}}constructor(e){this._model=e,this._savedParameters=[],this._parameterIds=[],this._drawableIds=[],this._partIds=[],this._notExistPartId={},this._notExistParameterId={},this._notExistParameterValues={},this._notExistPartOpacities={},this.initialize()}release(){this._model.release(),this._model=void 0}}class eS{static create(e){const t=Live2DCubismCore.Moc.fromArrayBuffer(e);if(t)return new eS(t);throw new Error("Unknown error")}createModel(){let e;const t=Live2DCubismCore.Model.fromMoc(this._moc);if(t)return e=new tZ(t),++this._modelCount,e;throw new Error("Unknown error")}deleteModel(e){e!=null&&--this._modelCount}constructor(e){this._moc=e,this._modelCount=0}release(){this._moc._release(),this._moc=void 0}}class MO{constructor(){this._fadeInSeconds=-1,this._fadeOutSeconds=-1,this._weight=1,this._offsetSeconds=0,this._firedEventValues=[]}release(){this._weight=0}updateParameters(e,t,i){if(!t.isAvailable()||t.isFinished())return;if(!t.isStarted()){t.setIsStarted(!0),t.setStartTime(i-this._offsetSeconds),t.setFadeInStartTime(i);const a=this.getDuration();t.getEndTime()<0&&t.setEndTime(a<=0?-1:t.getStartTime()+a)}let r=this._weight;const s=this._fadeInSeconds==0?1:Xt.getEasingSine((i-t.getFadeInStartTime())/this._fadeInSeconds),o=this._fadeOutSeconds==0||t.getEndTime()<0?1:Xt.getEasingSine((t.getEndTime()-i)/this._fadeOutSeconds);r=r*s*o,t.setState(i,r),this.doUpdateParameters(e,i,r,t),t.getEndTime()>0&&t.getEndTime()<i&&t.setIsFinished(!0)}setFadeInTime(e){this._fadeInSeconds=e}setFadeOutTime(e){this._fadeOutSeconds=e}getFadeOutTime(){return this._fadeOutSeconds}getFadeInTime(){return this._fadeInSeconds}setWeight(e){this._weight=e}getWeight(){return this._weight}getDuration(){return-1}getLoopDuration(){return-1}setOffsetTime(e){this._offsetSeconds=e}getFiredEvent(e,t){return this._firedEventValues}setFinishedMotionHandler(e){this._onFinishedMotion=e}getFinishedMotionHandler(){return this._onFinishedMotion}}const QM=1;class tS extends MO{constructor(){super(),this._parameters=[]}static create(e){const t=new tS,i=e.FadeInTime,r=e.FadeOutTime;t.setFadeInTime(i!==void 0?i:QM),t.setFadeOutTime(r!==void 0?r:QM);const s=e.Parameters||[];for(let o=0;o<s.length;++o){const a=s[o],l=a.Id,u=a.Value;let c;switch(a.Blend){case"Multiply":c=Ia.ExpressionBlendType_Multiply;break;case"Overwrite":c=Ia.ExpressionBlendType_Overwrite;break;case"Add":default:c=Ia.ExpressionBlendType_Add;break}const h={parameterId:l,blendType:c,value:u};t._parameters.push(h)}return t}doUpdateParameters(e,t,i,r){for(let s=0;s<this._parameters.length;++s){const o=this._parameters[s];switch(o.blendType){case Ia.ExpressionBlendType_Add:{e.addParameterValueById(o.parameterId,o.value,i);break}case Ia.ExpressionBlendType_Multiply:{e.multiplyParameterValueById(o.parameterId,o.value,i);break}case Ia.ExpressionBlendType_Overwrite:{e.setParameterValueById(o.parameterId,o.value,i);break}}}}}var Ia=(n=>(n[n.ExpressionBlendType_Add=0]="ExpressionBlendType_Add",n[n.ExpressionBlendType_Multiply=1]="ExpressionBlendType_Multiply",n[n.ExpressionBlendType_Overwrite=2]="ExpressionBlendType_Overwrite",n))(Ia||{}),Sd;(n=>{n.supportMoreMaskDivisions=!0,n.setOpacityFromMotion=!1})(Sd||(Sd={}));var La=(n=>(n[n.CubismMotionCurveTarget_Model=0]="CubismMotionCurveTarget_Model",n[n.CubismMotionCurveTarget_Parameter=1]="CubismMotionCurveTarget_Parameter",n[n.CubismMotionCurveTarget_PartOpacity=2]="CubismMotionCurveTarget_PartOpacity",n))(La||{}),$r=(n=>(n[n.CubismMotionSegmentType_Linear=0]="CubismMotionSegmentType_Linear",n[n.CubismMotionSegmentType_Bezier=1]="CubismMotionSegmentType_Bezier",n[n.CubismMotionSegmentType_Stepped=2]="CubismMotionSegmentType_Stepped",n[n.CubismMotionSegmentType_InverseStepped=3]="CubismMotionSegmentType_InverseStepped",n))($r||{});class bo{constructor(e=0,t=0){this.time=e,this.value=t}}class nZ{constructor(){this.basePointIndex=0,this.segmentType=0}}class iZ{constructor(){this.id="",this.type=0,this.segmentCount=0,this.baseSegmentIndex=0,this.fadeInTime=0,this.fadeOutTime=0}}class rZ{constructor(){this.fireTime=0,this.value=""}}class sZ{constructor(){this.duration=0,this.loop=!1,this.curveCount=0,this.eventCount=0,this.fps=0,this.curves=[],this.segments=[],this.points=[],this.events=[]}}class wO{constructor(e){this._json=e}release(){this._json=void 0}getMotionDuration(){return this._json.Meta.Duration}isMotionLoop(){return this._json.Meta.Loop||!1}getEvaluationOptionFlag(e){return nS.EvaluationOptionFlag_AreBeziersRistricted==e?!!this._json.Meta.AreBeziersRestricted:!1}getMotionCurveCount(){return this._json.Meta.CurveCount}getMotionFps(){return this._json.Meta.Fps}getMotionTotalSegmentCount(){return this._json.Meta.TotalSegmentCount}getMotionTotalPointCount(){return this._json.Meta.TotalPointCount}getMotionFadeInTime(){return this._json.Meta.FadeInTime}getMotionFadeOutTime(){return this._json.Meta.FadeOutTime}getMotionCurveTarget(e){return this._json.Curves[e].Target}getMotionCurveId(e){return this._json.Curves[e].Id}getMotionCurveFadeInTime(e){return this._json.Curves[e].FadeInTime}getMotionCurveFadeOutTime(e){return this._json.Curves[e].FadeOutTime}getMotionCurveSegmentCount(e){return this._json.Curves[e].Segments.length}getMotionCurveSegment(e,t){return this._json.Curves[e].Segments[t]}getEventCount(){return this._json.Meta.UserDataCount||0}getTotalEventValueSize(){return this._json.Meta.TotalUserDataSize}getEventTime(e){return this._json.UserData[e].Time}getEventValue(e){return this._json.UserData[e].Value}}var nS=(n=>(n[n.EvaluationOptionFlag_AreBeziersRistricted=0]="EvaluationOptionFlag_AreBeziersRistricted",n))(nS||{});const oZ="EyeBlink",aZ="LipSync",lZ="Model",uZ="Parameter",cZ="PartOpacity",hZ=!1;function ji(n,e,t){const i=new bo;return i.time=n.time+(e.time-n.time)*t,i.value=n.value+(e.value-n.value)*t,i}function dZ(n,e){let t=(e-n[0].time)/(n[1].time-n[0].time);return t<0&&(t=0),n[0].value+(n[1].value-n[0].value)*t}function fZ(n,e){let t=(e-n[0].time)/(n[3].time-n[0].time);t<0&&(t=0);const i=ji(n[0],n[1],t),r=ji(n[1],n[2],t),s=ji(n[2],n[3],t),o=ji(i,r,t),a=ji(r,s,t);return ji(o,a,t).value}function pZ(n,e){const t=e,i=n[0].time,r=n[3].time,s=n[1].time,o=n[2].time,a=r-3*o+3*s-i,l=3*o-6*s+3*i,u=3*s-3*i,c=i-t,h=Xt.cardanoAlgorithmForBezier(a,l,u,c),d=ji(n[0],n[1],h),f=ji(n[1],n[2],h),p=ji(n[2],n[3],h),_=ji(d,f,h),m=ji(f,p,h);return ji(_,m,h).value}function mZ(n,e){return n[0].value}function gZ(n,e){return n[1].value}function j_(n,e,t){const i=n.curves[e];let r=-1;const s=i.baseSegmentIndex+i.segmentCount;let o=0;for(let l=i.baseSegmentIndex;l<s;++l)if(o=n.segments[l].basePointIndex+(n.segments[l].segmentType==$r.CubismMotionSegmentType_Bezier?3:1),n.points[o].time>t){r=l;break}if(r==-1)return n.points[o].value;const a=n.segments[r];return a.evaluate(n.points.slice(a.basePointIndex),t)}class iS extends MO{constructor(){super(),this._eyeBlinkParameterIds=[],this._lipSyncParameterIds=[],this._sourceFrameRate=30,this._loopDurationSeconds=-1,this._isLoop=!1,this._isLoopFadeIn=!0,this._lastWeight=0}static create(e,t){const i=new iS;return i.parse(e),i._sourceFrameRate=i._motionData.fps,i._loopDurationSeconds=i._motionData.duration,i._onFinishedMotion=t,i}doUpdateParameters(e,t,i,r){this._modelCurveIdEyeBlink==null&&(this._modelCurveIdEyeBlink=oZ),this._modelCurveIdLipSync==null&&(this._modelCurveIdLipSync=aZ);let s=t-r.getStartTime();s<0&&(s=0);let o=Number.MAX_VALUE,a=Number.MAX_VALUE;const l=64;let u=0,c=0;this._eyeBlinkParameterIds.length>l&&JM("too many eye blink targets : {0}",this._eyeBlinkParameterIds.length),this._lipSyncParameterIds.length>l&&JM("too many lip sync targets : {0}",this._lipSyncParameterIds.length);const h=this._fadeInSeconds<=0?1:Xt.getEasingSine((t-r.getFadeInStartTime())/this._fadeInSeconds),d=this._fadeOutSeconds<=0||r.getEndTime()<0?1:Xt.getEasingSine((r.getEndTime()-t)/this._fadeOutSeconds);let f,p,_,m=s;if(this._isLoop)for(;m>this._motionData.duration;)m-=this._motionData.duration;const g=this._motionData.curves;for(p=0;p<this._motionData.curveCount&&g[p].type==La.CubismMotionCurveTarget_Model;++p)f=j_(this._motionData,p,m),g[p].id==this._modelCurveIdEyeBlink?a=f:g[p].id==this._modelCurveIdLipSync&&(o=f);for(;p<this._motionData.curveCount&&g[p].type==La.CubismMotionCurveTarget_Parameter;++p){if(_=e.getParameterIndex(g[p].id),_==-1)continue;const v=e.getParameterValueByIndex(_);if(f=j_(this._motionData,p,m),a!=Number.MAX_VALUE){for(let x=0;x<this._eyeBlinkParameterIds.length&&x<l;++x)if(this._eyeBlinkParameterIds[x]==g[p].id){f*=a,c|=1<<x;break}}if(o!=Number.MAX_VALUE){for(let x=0;x<this._lipSyncParameterIds.length&&x<l;++x)if(this._lipSyncParameterIds[x]==g[p].id){f+=o,u|=1<<x;break}}let y;if(g[p].fadeInTime<0&&g[p].fadeOutTime<0)y=v+(f-v)*i;else{let x,b;g[p].fadeInTime<0?x=h:x=g[p].fadeInTime==0?1:Xt.getEasingSine((t-r.getFadeInStartTime())/g[p].fadeInTime),g[p].fadeOutTime<0?b=d:b=g[p].fadeOutTime==0||r.getEndTime()<0?1:Xt.getEasingSine((r.getEndTime()-t)/g[p].fadeOutTime);const S=this._weight*x*b;y=v+(f-v)*S}e.setParameterValueByIndex(_,y,1)}{if(a!=Number.MAX_VALUE)for(let v=0;v<this._eyeBlinkParameterIds.length&&v<l;++v){const y=e.getParameterValueById(this._eyeBlinkParameterIds[v]);if(c>>v&1)continue;const x=y+(a-y)*i;e.setParameterValueById(this._eyeBlinkParameterIds[v],x)}if(o!=Number.MAX_VALUE)for(let v=0;v<this._lipSyncParameterIds.length&&v<l;++v){const y=e.getParameterValueById(this._lipSyncParameterIds[v]);if(u>>v&1)continue;const x=y+(o-y)*i;e.setParameterValueById(this._lipSyncParameterIds[v],x)}}for(;p<this._motionData.curveCount&&g[p].type==La.CubismMotionCurveTarget_PartOpacity;++p)if(f=j_(this._motionData,p,m),Sd.setOpacityFromMotion)e.setPartOpacityById(g[p].id,f);else{if(_=e.getParameterIndex(g[p].id),_==-1)continue;e.setParameterValueByIndex(_,f)}s>=this._motionData.duration&&(this._isLoop?(r.setStartTime(t),this._isLoopFadeIn&&r.setFadeInStartTime(t)):(this._onFinishedMotion&&this._onFinishedMotion(this),r.setIsFinished(!0))),this._lastWeight=i}setIsLoop(e){this._isLoop=e}isLoop(){return this._isLoop}setIsLoopFadeIn(e){this._isLoopFadeIn=e}isLoopFadeIn(){return this._isLoopFadeIn}getDuration(){return this._isLoop?-1:this._loopDurationSeconds}getLoopDuration(){return this._loopDurationSeconds}setParameterFadeInTime(e,t){const i=this._motionData.curves;for(let r=0;r<this._motionData.curveCount;++r)if(e==i[r].id){i[r].fadeInTime=t;return}}setParameterFadeOutTime(e,t){const i=this._motionData.curves;for(let r=0;r<this._motionData.curveCount;++r)if(e==i[r].id){i[r].fadeOutTime=t;return}}getParameterFadeInTime(e){const t=this._motionData.curves;for(let i=0;i<this._motionData.curveCount;++i)if(e==t[i].id)return t[i].fadeInTime;return-1}getParameterFadeOutTime(e){const t=this._motionData.curves;for(let i=0;i<this._motionData.curveCount;++i)if(e==t[i].id)return t[i].fadeOutTime;return-1}setEffectIds(e,t){this._eyeBlinkParameterIds=e,this._lipSyncParameterIds=t}release(){this._motionData=void 0}parse(e){this._motionData=new sZ;let t=new wO(e);this._motionData.duration=t.getMotionDuration(),this._motionData.loop=t.isMotionLoop(),this._motionData.curveCount=t.getMotionCurveCount(),this._motionData.fps=t.getMotionFps(),this._motionData.eventCount=t.getEventCount();const i=t.getEvaluationOptionFlag(nS.EvaluationOptionFlag_AreBeziersRistricted),r=t.getMotionFadeInTime(),s=t.getMotionFadeOutTime();r!==void 0?this._fadeInSeconds=r<0?1:r:this._fadeInSeconds=1,s!==void 0?this._fadeOutSeconds=s<0?1:s:this._fadeOutSeconds=1,this._motionData.curves=Array.from({length:this._motionData.curveCount}).map(()=>new iZ),this._motionData.segments=Array.from({length:t.getMotionTotalSegmentCount()}).map(()=>new nZ),this._motionData.events=Array.from({length:this._motionData.eventCount}).map(()=>new rZ),this._motionData.points=[];let o=0,a=0;for(let l=0;l<this._motionData.curveCount;++l){const u=this._motionData.curves[l];switch(t.getMotionCurveTarget(l)){case lZ:u.type=La.CubismMotionCurveTarget_Model;break;case uZ:u.type=La.CubismMotionCurveTarget_Parameter;break;case cZ:u.type=La.CubismMotionCurveTarget_PartOpacity;break;default:bh('Warning : Unable to get segment type from Curve! The number of "CurveCount" may be incorrect!')}u.id=t.getMotionCurveId(l),u.baseSegmentIndex=a;const c=t.getMotionCurveFadeInTime(l),h=t.getMotionCurveFadeOutTime(l);u.fadeInTime=c!==void 0?c:-1,u.fadeOutTime=h!==void 0?h:-1;for(let d=0;d<t.getMotionCurveSegmentCount(l);){switch(d==0?(this._motionData.segments[a].basePointIndex=o,this._motionData.points[o]=new bo(t.getMotionCurveSegment(l,d),t.getMotionCurveSegment(l,d+1)),o+=1,d+=2):this._motionData.segments[a].basePointIndex=o-1,t.getMotionCurveSegment(l,d)){case $r.CubismMotionSegmentType_Linear:{this._motionData.segments[a].segmentType=$r.CubismMotionSegmentType_Linear,this._motionData.segments[a].evaluate=dZ,this._motionData.points[o]=new bo(t.getMotionCurveSegment(l,d+1),t.getMotionCurveSegment(l,d+2)),o+=1,d+=3;break}case $r.CubismMotionSegmentType_Bezier:{this._motionData.segments[a].segmentType=$r.CubismMotionSegmentType_Bezier,i||hZ?this._motionData.segments[a].evaluate=fZ:this._motionData.segments[a].evaluate=pZ,this._motionData.points[o]=new bo(t.getMotionCurveSegment(l,d+1),t.getMotionCurveSegment(l,d+2)),this._motionData.points[o+1]=new bo(t.getMotionCurveSegment(l,d+3),t.getMotionCurveSegment(l,d+4)),this._motionData.points[o+2]=new bo(t.getMotionCurveSegment(l,d+5),t.getMotionCurveSegment(l,d+6)),o+=3,d+=7;break}case $r.CubismMotionSegmentType_Stepped:{this._motionData.segments[a].segmentType=$r.CubismMotionSegmentType_Stepped,this._motionData.segments[a].evaluate=mZ,this._motionData.points[o]=new bo(t.getMotionCurveSegment(l,d+1),t.getMotionCurveSegment(l,d+2)),o+=1,d+=3;break}case $r.CubismMotionSegmentType_InverseStepped:{this._motionData.segments[a].segmentType=$r.CubismMotionSegmentType_InverseStepped,this._motionData.segments[a].evaluate=gZ,this._motionData.points[o]=new bo(t.getMotionCurveSegment(l,d+1),t.getMotionCurveSegment(l,d+2)),o+=1,d+=3;break}}++u.segmentCount,++a}this._motionData.curves.push(u)}for(let l=0;l<t.getEventCount();++l)this._motionData.events[l].fireTime=t.getEventTime(l),this._motionData.events[l].value=t.getEventValue(l);t.release()}getFiredEvent(e,t){this._firedEventValues.length=0;for(let i=0;i<this._motionData.eventCount;++i)this._motionData.events[i].fireTime>e&&this._motionData.events[i].fireTime<=t&&this._firedEventValues.push(this._motionData.events[i].value);return this._firedEventValues}}class _Z{constructor(){this._autoDelete=!1,this._available=!0,this._finished=!1,this._started=!1,this._startTimeSeconds=-1,this._fadeInStartTimeSeconds=0,this._endTimeSeconds=-1,this._stateTimeSeconds=0,this._stateWeight=0,this._lastEventCheckSeconds=0,this._motionQueueEntryHandle=this,this._fadeOutSeconds=0,this._isTriggeredFadeOut=!1}release(){this._autoDelete&&this._motion&&this._motion.release()}setFadeOut(e){this._fadeOutSeconds=e,this._isTriggeredFadeOut=!0}startFadeOut(e,t){const i=t+e;this._isTriggeredFadeOut=!0,(this._endTimeSeconds<0||i<this._endTimeSeconds)&&(this._endTimeSeconds=i)}isFinished(){return this._finished}isStarted(){return this._started}getStartTime(){return this._startTimeSeconds}getFadeInStartTime(){return this._fadeInStartTimeSeconds}getEndTime(){return this._endTimeSeconds}setStartTime(e){this._startTimeSeconds=e}setFadeInStartTime(e){this._fadeInStartTimeSeconds=e}setEndTime(e){this._endTimeSeconds=e}setIsFinished(e){this._finished=e}setIsStarted(e){this._started=e}isAvailable(){return this._available}setIsAvailable(e){this._available=e}setState(e,t){this._stateTimeSeconds=e,this._stateWeight=t}getStateTime(){return this._stateTimeSeconds}getStateWeight(){return this._stateWeight}getLastCheckEventSeconds(){return this._lastEventCheckSeconds}setLastCheckEventSeconds(e){this._lastEventCheckSeconds=e}isTriggeredFadeOut(){return this._isTriggeredFadeOut}getFadeOutSeconds(){return this._fadeOutSeconds}}class AO{constructor(){this._userTimeSeconds=0,this._eventCustomData=null,this._motions=[]}release(){for(let e=0;e<this._motions.length;++e)this._motions[e]&&this._motions[e].release();this._motions=void 0}startMotion(e,t,i){if(e==null)return vZ;let r;for(let s=0;s<this._motions.length;++s)r=this._motions[s],r!=null&&r.setFadeOut(r._motion.getFadeOutTime());return r=new _Z,r._autoDelete=t,r._motion=e,this._motions.push(r),r._motionQueueEntryHandle}isFinished(){let e=0;for(;e<this._motions.length;){const t=this._motions[e];if(t==null){this._motions.splice(e,1);continue}if(t._motion==null){t.release(),this._motions.splice(e,1);continue}if(!t.isFinished())return!1;e++}return!0}isFinishedByHandle(e){for(let t=0;t<this._motions.length;t++){const i=this._motions[t];if(i!=null&&i._motionQueueEntryHandle==e&&!i.isFinished())return!1}return!0}stopAllMotions(){for(let e=0;e<this._motions.length;e++){const t=this._motions[e];t!=null&&t.release()}this._motions=[]}getCubismMotionQueueEntry(e){return this._motions.find(t=>t!=null&&t._motionQueueEntryHandle==e)}setEventCallback(e,t=null){this._eventCallBack=e,this._eventCustomData=t}doUpdateMotion(e,t){let i=!1,r=0;for(;r<this._motions.length;){const s=this._motions[r];if(s==null){this._motions.splice(r,1);continue}const o=s._motion;if(o==null){s.release(),this._motions.splice(r,1);continue}o.updateParameters(e,s,t),i=!0;const a=o.getFiredEvent(s.getLastCheckEventSeconds()-s.getStartTime(),t-s.getStartTime());for(let l=0;l<a.length;++l)this._eventCallBack(this,a[l],this._eventCustomData);s.setLastCheckEventSeconds(t),s.isFinished()?(s.release(),this._motions.splice(r,1)):(s.isTriggeredFadeOut()&&s.startFadeOut(s.getFadeOutSeconds(),t),r++)}return i}}const vZ=-1;var xy=(n=>(n[n.CubismPhysicsTargetType_Parameter=0]="CubismPhysicsTargetType_Parameter",n))(xy||{}),Oa=(n=>(n[n.CubismPhysicsSource_X=0]="CubismPhysicsSource_X",n[n.CubismPhysicsSource_Y=1]="CubismPhysicsSource_Y",n[n.CubismPhysicsSource_Angle=2]="CubismPhysicsSource_Angle",n))(Oa||{});class yZ{constructor(){this.initialPosition=new st(0,0),this.position=new st(0,0),this.lastPosition=new st(0,0),this.lastGravity=new st(0,0),this.force=new st(0,0),this.velocity=new st(0,0)}}class xZ{constructor(){this.normalizationPosition={},this.normalizationAngle={}}}class bZ{constructor(){this.source={}}}class SZ{constructor(){this.destination={},this.translationScale=new st(0,0)}}class EZ{constructor(){this.settings=[],this.inputs=[],this.outputs=[],this.particles=[],this.gravity=new st(0,0),this.wind=new st(0,0)}}class TZ{constructor(e){this._json=e}release(){this._json=void 0}getGravity(){const e=new st(0,0);return e.x=this._json.Meta.EffectiveForces.Gravity.X,e.y=this._json.Meta.EffectiveForces.Gravity.Y,e}getWind(){const e=new st(0,0);return e.x=this._json.Meta.EffectiveForces.Wind.X,e.y=this._json.Meta.EffectiveForces.Wind.Y,e}getSubRigCount(){return this._json.Meta.PhysicsSettingCount}getTotalInputCount(){return this._json.Meta.TotalInputCount}getTotalOutputCount(){return this._json.Meta.TotalOutputCount}getVertexCount(){return this._json.Meta.VertexCount}getNormalizationPositionMinimumValue(e){return this._json.PhysicsSettings[e].Normalization.Position.Minimum}getNormalizationPositionMaximumValue(e){return this._json.PhysicsSettings[e].Normalization.Position.Maximum}getNormalizationPositionDefaultValue(e){return this._json.PhysicsSettings[e].Normalization.Position.Default}getNormalizationAngleMinimumValue(e){return this._json.PhysicsSettings[e].Normalization.Angle.Minimum}getNormalizationAngleMaximumValue(e){return this._json.PhysicsSettings[e].Normalization.Angle.Maximum}getNormalizationAngleDefaultValue(e){return this._json.PhysicsSettings[e].Normalization.Angle.Default}getInputCount(e){return this._json.PhysicsSettings[e].Input.length}getInputWeight(e,t){return this._json.PhysicsSettings[e].Input[t].Weight}getInputReflect(e,t){return this._json.PhysicsSettings[e].Input[t].Reflect}getInputType(e,t){return this._json.PhysicsSettings[e].Input[t].Type}getInputSourceId(e,t){return this._json.PhysicsSettings[e].Input[t].Source.Id}getOutputCount(e){return this._json.PhysicsSettings[e].Output.length}getOutputVertexIndex(e,t){return this._json.PhysicsSettings[e].Output[t].VertexIndex}getOutputAngleScale(e,t){return this._json.PhysicsSettings[e].Output[t].Scale}getOutputWeight(e,t){return this._json.PhysicsSettings[e].Output[t].Weight}getOutputDestinationId(e,t){return this._json.PhysicsSettings[e].Output[t].Destination.Id}getOutputType(e,t){return this._json.PhysicsSettings[e].Output[t].Type}getOutputReflect(e,t){return this._json.PhysicsSettings[e].Output[t].Reflect}getParticleCount(e){return this._json.PhysicsSettings[e].Vertices.length}getParticleMobility(e,t){return this._json.PhysicsSettings[e].Vertices[t].Mobility}getParticleDelay(e,t){return this._json.PhysicsSettings[e].Vertices[t].Delay}getParticleAcceleration(e,t){return this._json.PhysicsSettings[e].Vertices[t].Acceleration}getParticleRadius(e,t){return this._json.PhysicsSettings[e].Vertices[t].Radius}getParticlePosition(e,t){const i=new st(0,0);return i.x=this._json.PhysicsSettings[e].Vertices[t].Position.X,i.y=this._json.PhysicsSettings[e].Vertices[t].Position.Y,i}}const ew="X",tw="Y",nw="Angle",MZ=5,PO=100,wZ=.001;class rS{static create(e){const t=new rS;return t.parse(e),t._physicsRig.gravity.y=0,t}evaluate(e,t){let i,r,s,o;const a=new st;let l,u,c,h,d,f,p,_;d=e.getModel().parameters.values,f=e.getModel().parameters.maximumValues,p=e.getModel().parameters.minimumValues,_=e.getModel().parameters.defaultValues;for(let m=0;m<this._physicsRig.subRigCount;++m){i={angle:0},a.x=0,a.y=0,l=this._physicsRig.settings[m],u=this._physicsRig.inputs.slice(l.baseInputIndex),c=this._physicsRig.outputs.slice(l.baseOutputIndex),h=this._physicsRig.particles.slice(l.baseParticleIndex);for(let g=0;g<l.inputCount;++g)r=u[g].weight/PO,u[g].sourceParameterIndex==-1&&(u[g].sourceParameterIndex=e.getParameterIndex(u[g].source.id)),u[g].getNormalizedParameterValue(a,i,d[u[g].sourceParameterIndex],p[u[g].sourceParameterIndex],f[u[g].sourceParameterIndex],_[u[g].sourceParameterIndex],l.normalizationPosition,l.normalizationAngle,u[g].reflect,r);s=Xt.degreesToRadian(-i.angle),a.x=a.x*Xt.cos(s)-a.y*Xt.sin(s),a.y=a.x*Xt.sin(s)+a.y*Xt.cos(s),kZ(h,l.particleCount,a,i.angle,this._options.wind,wZ*l.normalizationPosition.maximum,t,MZ);for(let g=0;g<l.outputCount;++g){const v=c[g].vertexIndex;if(v<1||v>=l.particleCount)break;c[g].destinationParameterIndex==-1&&(c[g].destinationParameterIndex=e.getParameterIndex(c[g].destination.id));const y=new st;y.x=h[v].position.x-h[v-1].position.x,y.y=h[v].position.y-h[v-1].position.y,o=c[g].getValue(y,h,v,c[g].reflect,this._options.gravity);const x=c[g].destinationParameterIndex,b=!Float32Array.prototype.slice&&"subarray"in Float32Array.prototype?JSON.parse(JSON.stringify(d.subarray(x))):d.slice(x);VZ(b,p[x],f[x],o,c[g]);for(let S=x,T=0;S<d.length;S++,T++)d[S]=b[T]}}}setOptions(e){this._options=e}getOption(){return this._options}constructor(){this._options=new AZ,this._options.gravity.y=-1,this._options.gravity.x=0,this._options.wind.x=0,this._options.wind.y=0}release(){this._physicsRig=void 0}parse(e){this._physicsRig=new EZ;let t=new TZ(e);this._physicsRig.gravity=t.getGravity(),this._physicsRig.wind=t.getWind(),this._physicsRig.subRigCount=t.getSubRigCount();let i=0,r=0,s=0;for(let o=0;o<this._physicsRig.subRigCount;++o){const a=new xZ;a.normalizationPosition.minimum=t.getNormalizationPositionMinimumValue(o),a.normalizationPosition.maximum=t.getNormalizationPositionMaximumValue(o),a.normalizationPosition.defalut=t.getNormalizationPositionDefaultValue(o),a.normalizationAngle.minimum=t.getNormalizationAngleMinimumValue(o),a.normalizationAngle.maximum=t.getNormalizationAngleMaximumValue(o),a.normalizationAngle.defalut=t.getNormalizationAngleDefaultValue(o),a.inputCount=t.getInputCount(o),a.baseInputIndex=i,i+=a.inputCount;for(let l=0;l<a.inputCount;++l){const u=new bZ;switch(u.sourceParameterIndex=-1,u.weight=t.getInputWeight(o,l),u.reflect=t.getInputReflect(o,l),t.getInputType(o,l)){case ew:u.type=Oa.CubismPhysicsSource_X,u.getNormalizedParameterValue=PZ;break;case tw:u.type=Oa.CubismPhysicsSource_Y,u.getNormalizedParameterValue=CZ;break;case nw:u.type=Oa.CubismPhysicsSource_Angle,u.getNormalizedParameterValue=RZ;break}u.source.targetType=xy.CubismPhysicsTargetType_Parameter,u.source.id=t.getInputSourceId(o,l),this._physicsRig.inputs.push(u)}a.outputCount=t.getOutputCount(o),a.baseOutputIndex=r,r+=a.outputCount;for(let l=0;l<a.outputCount;++l){const u=new SZ;switch(u.destinationParameterIndex=-1,u.vertexIndex=t.getOutputVertexIndex(o,l),u.angleScale=t.getOutputAngleScale(o,l),u.weight=t.getOutputWeight(o,l),u.destination.targetType=xy.CubismPhysicsTargetType_Parameter,u.destination.id=t.getOutputDestinationId(o,l),t.getOutputType(o,l)){case ew:u.type=Oa.CubismPhysicsSource_X,u.getValue=IZ,u.getScale=NZ;break;case tw:u.type=Oa.CubismPhysicsSource_Y,u.getValue=LZ,u.getScale=UZ;break;case nw:u.type=Oa.CubismPhysicsSource_Angle,u.getValue=OZ,u.getScale=BZ;break}u.reflect=t.getOutputReflect(o,l),this._physicsRig.outputs.push(u)}a.particleCount=t.getParticleCount(o),a.baseParticleIndex=s,s+=a.particleCount;for(let l=0;l<a.particleCount;++l){const u=new yZ;u.mobility=t.getParticleMobility(o,l),u.delay=t.getParticleDelay(o,l),u.acceleration=t.getParticleAcceleration(o,l),u.radius=t.getParticleRadius(o,l),u.position=t.getParticlePosition(o,l),this._physicsRig.particles.push(u)}this._physicsRig.settings.push(a)}this.initialize(),t.release()}initialize(){let e,t,i;for(let r=0;r<this._physicsRig.subRigCount;++r){t=this._physicsRig.settings[r],e=this._physicsRig.particles.slice(t.baseParticleIndex),e[0].initialPosition=new st(0,0),e[0].lastPosition=new st(e[0].initialPosition.x,e[0].initialPosition.y),e[0].lastGravity=new st(0,-1),e[0].lastGravity.y*=-1,e[0].velocity=new st(0,0),e[0].force=new st(0,0);for(let s=1;s<t.particleCount;++s)i=new st(0,0),i.y=e[s].radius,e[s].initialPosition=new st(e[s-1].initialPosition.x+i.x,e[s-1].initialPosition.y+i.y),e[s].position=new st(e[s].initialPosition.x,e[s].initialPosition.y),e[s].lastPosition=new st(e[s].initialPosition.x,e[s].initialPosition.y),e[s].lastGravity=new st(0,-1),e[s].lastGravity.y*=-1,e[s].velocity=new st(0,0),e[s].force=new st(0,0)}}}class AZ{constructor(){this.gravity=new st(0,0),this.wind=new st(0,0)}}function PZ(n,e,t,i,r,s,o,a,l,u){n.x+=sS(t,i,r,s,o.minimum,o.maximum,o.defalut,l)*u}function CZ(n,e,t,i,r,s,o,a,l,u){n.y+=sS(t,i,r,s,o.minimum,o.maximum,o.defalut,l)*u}function RZ(n,e,t,i,r,s,o,a,l,u){e.angle+=sS(t,i,r,s,a.minimum,a.maximum,a.defalut,l)*u}function IZ(n,e,t,i,r){let s=n.x;return i&&(s*=-1),s}function LZ(n,e,t,i,r){let s=n.y;return i&&(s*=-1),s}function OZ(n,e,t,i,r){let s;return t>=2?r=e[t-1].position.substract(e[t-2].position):r=r.multiplyByScaler(-1),s=Xt.directionToRadian(r,n),i&&(s*=-1),s}function DZ(n,e){return Math.abs(Math.max(n,e)-Math.min(n,e))}function FZ(n,e){return Math.min(n,e)+DZ(n,e)/2}function NZ(n,e){return n.x}function UZ(n,e){return n.y}function BZ(n,e){return e}function kZ(n,e,t,i,r,s,o,a){let l,u,c,h,d=new st(0,0),f=new st(0,0),p=new st(0,0),_=new st(0,0);n[0].position=new st(t.x,t.y),l=Xt.degreesToRadian(i),h=Xt.radianToDirection(l),h.normalize();for(let m=1;m<e;++m)n[m].force=h.multiplyByScaler(n[m].acceleration).add(r),n[m].lastPosition=new st(n[m].position.x,n[m].position.y),u=n[m].delay*o*30,d=n[m].position.substract(n[m-1].position),c=Xt.directionToRadian(n[m].lastGravity,h)/a,d.x=Xt.cos(c)*d.x-d.y*Xt.sin(c),d.y=Xt.sin(c)*d.x+d.y*Xt.cos(c),n[m].position=n[m-1].position.add(d),f=n[m].velocity.multiplyByScaler(u),p=n[m].force.multiplyByScaler(u).multiplyByScaler(u),n[m].position=n[m].position.add(f).add(p),_=n[m].position.substract(n[m-1].position),_.normalize(),n[m].position=n[m-1].position.add(_.multiplyByScaler(n[m].radius)),Xt.abs(n[m].position.x)<s&&(n[m].position.x=0),u!=0&&(n[m].velocity=n[m].position.substract(n[m].lastPosition),n[m].velocity=n[m].velocity.divisionByScalar(u),n[m].velocity=n[m].velocity.multiplyByScaler(n[m].mobility)),n[m].force=new st(0,0),n[m].lastGravity=new st(h.x,h.y)}function VZ(n,e,t,i,r){let s,o,a;s=r.getScale(r.translationScale,r.angleScale),o=i*s,o<e?(o<r.valueBelowMinimum&&(r.valueBelowMinimum=o),o=e):o>t&&(o>r.valueExceededMaximum&&(r.valueExceededMaximum=o),o=t),a=r.weight/PO,a>=1||(o=n[0]*(1-a)+o*a),n[0]=o}function sS(n,e,t,i,r,s,o,a){let l=0;const u=Xt.max(t,e);u<n&&(n=u);const c=Xt.min(t,e);c>n&&(n=c);const h=Xt.min(r,s),d=Xt.max(r,s),f=o,p=FZ(c,u),_=n-p;switch(Math.sign(_)){case 1:{const m=d-f,g=u-p;g!=0&&(l=_*(m/g),l+=f);break}case-1:{const m=h-f,g=c-p;g!=0&&(l=_*(m/g),l+=f);break}case 0:{l=f;break}}return a?l:l*-1}class by{constructor(e=0,t=0,i=0,r=0){this.x=e,this.y=t,this.width=i,this.height=r}getCenterX(){return this.x+.5*this.width}getCenterY(){return this.y+.5*this.height}getRight(){return this.x+this.width}getBottom(){return this.y+this.height}setRect(e){this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height}expand(e,t){this.x-=e,this.y-=t,this.width+=e*2,this.height+=t*2}}const $_=4,GZ=10;let pa,Sh,Sy;class Y_{getChannelFlagAsColor(e){return this._channelColors[e]}getMaskRenderTexture(){let e=0;if(this._maskTexture&&this._maskTexture.texture!=0&&(this._maskTexture.frameNo=this._currentFrameNo,e=this._maskTexture.texture),e==0){const t=this._clippingMaskBufferSize;this._colorBuffer=this.gl.createTexture(),this.gl.bindTexture(this.gl.TEXTURE_2D,this._colorBuffer),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,t,t,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.bindTexture(this.gl.TEXTURE_2D,null),e=this.gl.createFramebuffer(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,e),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,this._colorBuffer,0),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,Sy),this._maskTexture=new HZ(this._currentFrameNo,e)}return e}setGL(e){this.gl=e}calcClippedDrawTotalBounds(e,t){let i=Number.MAX_VALUE,r=Number.MAX_VALUE,s=Number.MIN_VALUE,o=Number.MIN_VALUE;const a=t._clippedDrawableIndexList.length;for(let l=0;l<a;l++){const u=t._clippedDrawableIndexList[l],c=e.getDrawableVertexCount(u),h=e.getDrawableVertices(u);let d=Number.MAX_VALUE,f=Number.MAX_VALUE,p=Number.MIN_VALUE,_=Number.MIN_VALUE;const m=c*X_.vertexStep;for(let g=X_.vertexOffset;g<m;g+=X_.vertexStep){const v=h[g],y=h[g+1];v<d&&(d=v),v>p&&(p=v),y<f&&(f=y),y>_&&(_=y)}if(d!=Number.MAX_VALUE)if(d<i&&(i=d),f<r&&(r=f),p>s&&(s=p),_>o&&(o=_),i==Number.MAX_VALUE)t._allClippedDrawRect.x=0,t._allClippedDrawRect.y=0,t._allClippedDrawRect.width=0,t._allClippedDrawRect.height=0,t._isUsing=!1;else{t._isUsing=!0;const g=s-i,v=o-r;t._allClippedDrawRect.x=i,t._allClippedDrawRect.y=r,t._allClippedDrawRect.width=g,t._allClippedDrawRect.height=v}}}constructor(){this._maskRenderTexture=null,this._colorBuffer=null,this._currentFrameNo=0,this._clippingMaskBufferSize=256,this._clippingContextListForMask=[],this._clippingContextListForDraw=[],this._channelColors=[],this._tmpBoundsOnModel=new by,this._tmpMatrix=new er,this._tmpMatrixForMask=new er,this._tmpMatrixForDraw=new er;let e=new xh;e.R=1,e.G=0,e.B=0,e.A=0,this._channelColors.push(e),e=new xh,e.R=0,e.G=1,e.B=0,e.A=0,this._channelColors.push(e),e=new xh,e.R=0,e.G=0,e.B=1,e.A=0,this._channelColors.push(e),e=new xh,e.R=0,e.G=0,e.B=0,e.A=1,this._channelColors.push(e)}release(){var e,t,i;const r=this;for(let s=0;s<this._clippingContextListForMask.length;s++)this._clippingContextListForMask[s]&&((e=this._clippingContextListForMask[s])==null||e.release());r._clippingContextListForMask=void 0,r._clippingContextListForDraw=void 0,this._maskTexture&&((t=this.gl)==null||t.deleteFramebuffer(this._maskTexture.texture),r._maskTexture=void 0),r._channelColors=void 0,(i=this.gl)==null||i.deleteTexture(this._colorBuffer),this._colorBuffer=null}initialize(e,t,i,r){for(let s=0;s<t;s++){if(r[s]<=0){this._clippingContextListForDraw.push(null);continue}let o=this.findSameClip(i[s],r[s]);o==null&&(o=new zZ(this,i[s],r[s]),this._clippingContextListForMask.push(o)),o.addClippedDrawable(s),this._clippingContextListForDraw.push(o)}}setupClippingContext(e,t){this._currentFrameNo++;let i=0;for(let r=0;r<this._clippingContextListForMask.length;r++){const s=this._clippingContextListForMask[r];this.calcClippedDrawTotalBounds(e,s),s._isUsing&&i++}if(i>0){this.gl.viewport(0,0,this._clippingMaskBufferSize,this._clippingMaskBufferSize),this._maskRenderTexture=this.getMaskRenderTexture(),t.getMvpMatrix(),t.preDraw(),this.setupLayoutBounds(i),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this._maskRenderTexture),this.gl.clearColor(1,1,1,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT);for(let r=0;r<this._clippingContextListForMask.length;r++){const s=this._clippingContextListForMask[r],o=s._allClippedDrawRect,a=s._layoutBounds,l=.05;this._tmpBoundsOnModel.setRect(o),this._tmpBoundsOnModel.expand(o.width*l,o.height*l);const u=a.width/this._tmpBoundsOnModel.width,c=a.height/this._tmpBoundsOnModel.height;this._tmpMatrix.loadIdentity(),this._tmpMatrix.translateRelative(-1,-1),this._tmpMatrix.scaleRelative(2,2),this._tmpMatrix.translateRelative(a.x,a.y),this._tmpMatrix.scaleRelative(u,c),this._tmpMatrix.translateRelative(-this._tmpBoundsOnModel.x,-this._tmpBoundsOnModel.y),this._tmpMatrixForMask.setMatrix(this._tmpMatrix.getArray()),this._tmpMatrix.loadIdentity(),this._tmpMatrix.translateRelative(a.x,a.y),this._tmpMatrix.scaleRelative(u,c),this._tmpMatrix.translateRelative(-this._tmpBoundsOnModel.x,-this._tmpBoundsOnModel.y),this._tmpMatrixForDraw.setMatrix(this._tmpMatrix.getArray()),s._matrixForMask.setMatrix(this._tmpMatrixForMask.getArray()),s._matrixForDraw.setMatrix(this._tmpMatrixForDraw.getArray());const h=s._clippingIdCount;for(let d=0;d<h;d++){const f=s._clippingIdList[d];e.getDrawableDynamicFlagVertexPositionsDidChange(f)&&(t.setIsCulling(e.getDrawableCulling(f)!=!1),t.setClippingContextBufferForMask(s),t.drawMesh(e.getDrawableTextureIndices(f),e.getDrawableVertexIndexCount(f),e.getDrawableVertexCount(f),e.getDrawableVertexIndices(f),e.getDrawableVertices(f),e.getDrawableVertexUvs(f),e.getDrawableOpacity(f),No.CubismBlendMode_Normal,!1))}}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,Sy),t.setClippingContextBufferForMask(null),this.gl.viewport(Sh[0],Sh[1],Sh[2],Sh[3])}}findSameClip(e,t){for(let i=0;i<this._clippingContextListForMask.length;i++){const r=this._clippingContextListForMask[i],s=r._clippingIdCount;if(s!=t)continue;let o=0;for(let a=0;a<s;a++){const l=r._clippingIdList[a];for(let u=0;u<s;u++)if(e[u]==l){o++;break}}if(o==s)return r}return null}setupLayoutBounds(e){let t=e/$_,i=e%$_;t=~~t,i=~~i;let r=0;for(let s=0;s<$_;s++){const o=t+(s<i?1:0);if(o!=0)if(o==1){const a=this._clippingContextListForMask[r++];a._layoutChannelNo=s,a._layoutBounds.x=0,a._layoutBounds.y=0,a._layoutBounds.width=1,a._layoutBounds.height=1}else if(o==2)for(let a=0;a<o;a++){let l=a%2;l=~~l;const u=this._clippingContextListForMask[r++];u._layoutChannelNo=s,u._layoutBounds.x=l*.5,u._layoutBounds.y=0,u._layoutBounds.width=.5,u._layoutBounds.height=1}else if(o<=4)for(let a=0;a<o;a++){let l=a%2,u=a/2;l=~~l,u=~~u;const c=this._clippingContextListForMask[r++];c._layoutChannelNo=s,c._layoutBounds.x=l*.5,c._layoutBounds.y=u*.5,c._layoutBounds.width=.5,c._layoutBounds.height=.5}else if(o<=9)for(let a=0;a<o;a++){let l=a%3,u=a/3;l=~~l,u=~~u;const c=this._clippingContextListForMask[r++];c._layoutChannelNo=s,c._layoutBounds.x=l/3,c._layoutBounds.y=u/3,c._layoutBounds.width=1/3,c._layoutBounds.height=1/3}else if(Sd.supportMoreMaskDivisions&&o<=16)for(let a=0;a<o;a++){let l=a%4,u=a/4;l=~~l,u=~~u;const c=this._clippingContextListForMask[r++];c._layoutChannelNo=s,c._layoutBounds.x=l/4,c._layoutBounds.y=u/4,c._layoutBounds.width=1/4,c._layoutBounds.height=1/4}else fu("not supported mask count : {0}",o)}}getColorBuffer(){return this._colorBuffer}getClippingContextListForDraw(){return this._clippingContextListForDraw}setClippingMaskBufferSize(e){this._clippingMaskBufferSize=e}getClippingMaskBufferSize(){return this._clippingMaskBufferSize}}class HZ{constructor(e,t){this.frameNo=e,this.texture=t}}class zZ{constructor(e,t,i){this._isUsing=!1,this._owner=e,this._clippingIdList=t,this._clippingIdCount=i,this._allClippedDrawRect=new by,this._layoutBounds=new by,this._clippedDrawableIndexList=[],this._matrixForMask=new er,this._matrixForDraw=new er}release(){const e=this;e._layoutBounds=void 0,e._allClippedDrawRect=void 0,e._clippedDrawableIndexList=void 0}addClippedDrawable(e){this._clippedDrawableIndexList.push(e)}getClippingManager(){return this._owner}setGl(e){this._owner.setGL(e)}}class Pu{static getInstance(){return pa==null&&(pa=new Pu),pa}static deleteInstance(){pa&&(pa.release(),pa=void 0)}constructor(){this._shaderSets=[]}release(){this.releaseShaderProgram()}setupShaderProgram(e,t,i,r,s,o,a,l,u,c,h,d,f){h||fu("NoPremultipliedAlpha is not allowed"),this._shaderSets.length==0&&this.generateShaders();let p,_,m,g;const v=e.getClippingContextBufferForMask();if(v!=null){const y=this._shaderSets[Eh.ShaderNames_SetupMask];this.gl.useProgram(y.shaderProgram),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.uniform1i(y.samplerTexture0Location,0),a.vertex==null&&(a.vertex=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,a.vertex),this.gl.bufferData(this.gl.ARRAY_BUFFER,r,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(y.attributePositionLocation),this.gl.vertexAttribPointer(y.attributePositionLocation,2,this.gl.FLOAT,!1,0,0),a.uv==null&&(a.uv=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,a.uv),this.gl.bufferData(this.gl.ARRAY_BUFFER,o,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(y.attributeTexCoordLocation),this.gl.vertexAttribPointer(y.attributeTexCoordLocation,2,this.gl.FLOAT,!1,0,0);const x=v._layoutChannelNo,b=v.getClippingManager().getChannelFlagAsColor(x);this.gl.uniform4f(y.uniformChannelFlagLocation,b.R,b.G,b.B,b.A),this.gl.uniformMatrix4fv(y.uniformClipMatrixLocation,!1,v._matrixForMask.getArray());const S=v._layoutBounds;this.gl.uniform4f(y.uniformBaseColorLocation,S.x*2-1,S.y*2-1,S.getRight()*2-1,S.getBottom()*2-1),p=this.gl.ZERO,_=this.gl.ONE_MINUS_SRC_COLOR,m=this.gl.ZERO,g=this.gl.ONE_MINUS_SRC_ALPHA}else{const y=e.getClippingContextBufferForDraw(),b=y!=null?f?2:1:0;let S;switch(u){case No.CubismBlendMode_Normal:default:S=this._shaderSets[Eh.ShaderNames_NormalPremultipliedAlpha+b],p=this.gl.ONE,_=this.gl.ONE_MINUS_SRC_ALPHA,m=this.gl.ONE,g=this.gl.ONE_MINUS_SRC_ALPHA;break;case No.CubismBlendMode_Additive:S=this._shaderSets[Eh.ShaderNames_AddPremultipliedAlpha+b],p=this.gl.ONE,_=this.gl.ONE,m=this.gl.ZERO,g=this.gl.ONE;break;case No.CubismBlendMode_Multiplicative:S=this._shaderSets[Eh.ShaderNames_MultPremultipliedAlpha+b],p=this.gl.DST_COLOR,_=this.gl.ONE_MINUS_SRC_ALPHA,m=this.gl.ZERO,g=this.gl.ONE;break}if(this.gl.useProgram(S.shaderProgram),a.vertex==null&&(a.vertex=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,a.vertex),this.gl.bufferData(this.gl.ARRAY_BUFFER,r,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(S.attributePositionLocation),this.gl.vertexAttribPointer(S.attributePositionLocation,2,this.gl.FLOAT,!1,0,0),a.uv==null&&(a.uv=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,a.uv),this.gl.bufferData(this.gl.ARRAY_BUFFER,o,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(S.attributeTexCoordLocation),this.gl.vertexAttribPointer(S.attributeTexCoordLocation,2,this.gl.FLOAT,!1,0,0),y!=null){this.gl.activeTexture(this.gl.TEXTURE1);const T=y.getClippingManager().getColorBuffer();this.gl.bindTexture(this.gl.TEXTURE_2D,T),this.gl.uniform1i(S.samplerTexture1Location,1),this.gl.uniformMatrix4fv(S.uniformClipMatrixLocation,!1,y._matrixForDraw.getArray());const P=y._layoutChannelNo,E=y.getClippingManager().getChannelFlagAsColor(P);this.gl.uniform4f(S.uniformChannelFlagLocation,E.R,E.G,E.B,E.A)}this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.uniform1i(S.samplerTexture0Location,0),this.gl.uniformMatrix4fv(S.uniformMatrixLocation,!1,d.getArray()),this.gl.uniform4f(S.uniformBaseColorLocation,c.R,c.G,c.B,c.A)}a.index==null&&(a.index=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,a.index),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,s,this.gl.DYNAMIC_DRAW),this.gl.blendFuncSeparate(p,_,m,g)}releaseShaderProgram(){for(let e=0;e<this._shaderSets.length;e++)this.gl.deleteProgram(this._shaderSets[e].shaderProgram),this._shaderSets[e].shaderProgram=0;this._shaderSets=[]}generateShaders(){for(let e=0;e<GZ;e++)this._shaderSets.push({});this._shaderSets[0].shaderProgram=this.loadShaderProgram(WZ,XZ),this._shaderSets[1].shaderProgram=this.loadShaderProgram(jZ,$Z),this._shaderSets[2].shaderProgram=this.loadShaderProgram(iw,YZ),this._shaderSets[3].shaderProgram=this.loadShaderProgram(iw,qZ),this._shaderSets[4].shaderProgram=this._shaderSets[1].shaderProgram,this._shaderSets[5].shaderProgram=this._shaderSets[2].shaderProgram,this._shaderSets[6].shaderProgram=this._shaderSets[3].shaderProgram,this._shaderSets[7].shaderProgram=this._shaderSets[1].shaderProgram,this._shaderSets[8].shaderProgram=this._shaderSets[2].shaderProgram,this._shaderSets[9].shaderProgram=this._shaderSets[3].shaderProgram,this._shaderSets[0].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[0].shaderProgram,"a_position"),this._shaderSets[0].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[0].shaderProgram,"a_texCoord"),this._shaderSets[0].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[0].shaderProgram,"s_texture0"),this._shaderSets[0].uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets[0].shaderProgram,"u_clipMatrix"),this._shaderSets[0].uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets[0].shaderProgram,"u_channelFlag"),this._shaderSets[0].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[0].shaderProgram,"u_baseColor"),this._shaderSets[1].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[1].shaderProgram,"a_position"),this._shaderSets[1].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[1].shaderProgram,"a_texCoord"),this._shaderSets[1].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[1].shaderProgram,"s_texture0"),this._shaderSets[1].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[1].shaderProgram,"u_matrix"),this._shaderSets[1].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[1].shaderProgram,"u_baseColor"),this._shaderSets[2].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[2].shaderProgram,"a_position"),this._shaderSets[2].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[2].shaderProgram,"a_texCoord"),this._shaderSets[2].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[2].shaderProgram,"s_texture0"),this._shaderSets[2].samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets[2].shaderProgram,"s_texture1"),this._shaderSets[2].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[2].shaderProgram,"u_matrix"),this._shaderSets[2].uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets[2].shaderProgram,"u_clipMatrix"),this._shaderSets[2].uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets[2].shaderProgram,"u_channelFlag"),this._shaderSets[2].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[2].shaderProgram,"u_baseColor"),this._shaderSets[3].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[3].shaderProgram,"a_position"),this._shaderSets[3].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[3].shaderProgram,"a_texCoord"),this._shaderSets[3].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[3].shaderProgram,"s_texture0"),this._shaderSets[3].samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets[3].shaderProgram,"s_texture1"),this._shaderSets[3].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[3].shaderProgram,"u_matrix"),this._shaderSets[3].uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets[3].shaderProgram,"u_clipMatrix"),this._shaderSets[3].uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets[3].shaderProgram,"u_channelFlag"),this._shaderSets[3].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[3].shaderProgram,"u_baseColor"),this._shaderSets[4].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[4].shaderProgram,"a_position"),this._shaderSets[4].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[4].shaderProgram,"a_texCoord"),this._shaderSets[4].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[4].shaderProgram,"s_texture0"),this._shaderSets[4].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[4].shaderProgram,"u_matrix"),this._shaderSets[4].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[4].shaderProgram,"u_baseColor"),this._shaderSets[5].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[5].shaderProgram,"a_position"),this._shaderSets[5].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[5].shaderProgram,"a_texCoord"),this._shaderSets[5].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[5].shaderProgram,"s_texture0"),this._shaderSets[5].samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets[5].shaderProgram,"s_texture1"),this._shaderSets[5].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[5].shaderProgram,"u_matrix"),this._shaderSets[5].uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets[5].shaderProgram,"u_clipMatrix"),this._shaderSets[5].uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets[5].shaderProgram,"u_channelFlag"),this._shaderSets[5].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[5].shaderProgram,"u_baseColor"),this._shaderSets[6].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[6].shaderProgram,"a_position"),this._shaderSets[6].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[6].shaderProgram,"a_texCoord"),this._shaderSets[6].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[6].shaderProgram,"s_texture0"),this._shaderSets[6].samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets[6].shaderProgram,"s_texture1"),this._shaderSets[6].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[6].shaderProgram,"u_matrix"),this._shaderSets[6].uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets[6].shaderProgram,"u_clipMatrix"),this._shaderSets[6].uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets[6].shaderProgram,"u_channelFlag"),this._shaderSets[6].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[6].shaderProgram,"u_baseColor"),this._shaderSets[7].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[7].shaderProgram,"a_position"),this._shaderSets[7].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[7].shaderProgram,"a_texCoord"),this._shaderSets[7].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[7].shaderProgram,"s_texture0"),this._shaderSets[7].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[7].shaderProgram,"u_matrix"),this._shaderSets[7].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[7].shaderProgram,"u_baseColor"),this._shaderSets[8].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[8].shaderProgram,"a_position"),this._shaderSets[8].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[8].shaderProgram,"a_texCoord"),this._shaderSets[8].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[8].shaderProgram,"s_texture0"),this._shaderSets[8].samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets[8].shaderProgram,"s_texture1"),this._shaderSets[8].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[8].shaderProgram,"u_matrix"),this._shaderSets[8].uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets[8].shaderProgram,"u_clipMatrix"),this._shaderSets[8].uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets[8].shaderProgram,"u_channelFlag"),this._shaderSets[8].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[8].shaderProgram,"u_baseColor"),this._shaderSets[9].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[9].shaderProgram,"a_position"),this._shaderSets[9].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[9].shaderProgram,"a_texCoord"),this._shaderSets[9].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[9].shaderProgram,"s_texture0"),this._shaderSets[9].samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets[9].shaderProgram,"s_texture1"),this._shaderSets[9].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[9].shaderProgram,"u_matrix"),this._shaderSets[9].uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets[9].shaderProgram,"u_clipMatrix"),this._shaderSets[9].uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets[9].shaderProgram,"u_channelFlag"),this._shaderSets[9].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[9].shaderProgram,"u_baseColor")}loadShaderProgram(e,t){let i=this.gl.createProgram(),r=this.compileShaderSource(this.gl.VERTEX_SHADER,e);if(!r)return fu("Vertex shader compile error!"),0;let s=this.compileShaderSource(this.gl.FRAGMENT_SHADER,t);return s?(this.gl.attachShader(i,r),this.gl.attachShader(i,s),this.gl.linkProgram(i),this.gl.getProgramParameter(i,this.gl.LINK_STATUS)?(this.gl.deleteShader(r),this.gl.deleteShader(s),i):(fu("Failed to link program: {0}",i),this.gl.deleteShader(r),this.gl.deleteShader(s),i&&this.gl.deleteProgram(i),0)):(fu("Vertex shader compile error!"),0)}compileShaderSource(e,t){const i=t,r=this.gl.createShader(e);if(this.gl.shaderSource(r,i),this.gl.compileShader(r),!r){const o=this.gl.getShaderInfoLog(r);fu("Shader compile log: {0} ",o)}return this.gl.getShaderParameter(r,this.gl.COMPILE_STATUS)?r:(this.gl.deleteShader(r),null)}setGl(e){this.gl=e}}var Eh=(n=>(n[n.ShaderNames_SetupMask=0]="ShaderNames_SetupMask",n[n.ShaderNames_NormalPremultipliedAlpha=1]="ShaderNames_NormalPremultipliedAlpha",n[n.ShaderNames_NormalMaskedPremultipliedAlpha=2]="ShaderNames_NormalMaskedPremultipliedAlpha",n[n.ShaderNames_NomralMaskedInvertedPremultipliedAlpha=3]="ShaderNames_NomralMaskedInvertedPremultipliedAlpha",n[n.ShaderNames_AddPremultipliedAlpha=4]="ShaderNames_AddPremultipliedAlpha",n[n.ShaderNames_AddMaskedPremultipliedAlpha=5]="ShaderNames_AddMaskedPremultipliedAlpha",n[n.ShaderNames_AddMaskedPremultipliedAlphaInverted=6]="ShaderNames_AddMaskedPremultipliedAlphaInverted",n[n.ShaderNames_MultPremultipliedAlpha=7]="ShaderNames_MultPremultipliedAlpha",n[n.ShaderNames_MultMaskedPremultipliedAlpha=8]="ShaderNames_MultMaskedPremultipliedAlpha",n[n.ShaderNames_MultMaskedPremultipliedAlphaInverted=9]="ShaderNames_MultMaskedPremultipliedAlphaInverted",n))(Eh||{});const WZ="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;varying vec4       v_myPos;uniform mat4       u_clipMatrix;void main(){   gl_Position = u_clipMatrix * a_position;   v_myPos = u_clipMatrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",XZ="precision mediump float;varying vec2       v_texCoord;varying vec4       v_myPos;uniform vec4       u_baseColor;uniform vec4       u_channelFlag;uniform sampler2D  s_texture0;void main(){   float isInside =        step(u_baseColor.x, v_myPos.x/v_myPos.w)       * step(u_baseColor.y, v_myPos.y/v_myPos.w)       * step(v_myPos.x/v_myPos.w, u_baseColor.z)       * step(v_myPos.y/v_myPos.w, u_baseColor.w);   gl_FragColor = u_channelFlag * texture2D(s_texture0, v_texCoord).a * isInside;}",jZ="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;uniform mat4       u_matrix;void main(){   gl_Position = u_matrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",iw="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;varying vec4       v_clipPos;uniform mat4       u_matrix;uniform mat4       u_clipMatrix;void main(){   gl_Position = u_matrix * a_position;   v_clipPos = u_clipMatrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",$Z="precision mediump float;varying vec2       v_texCoord;uniform vec4       u_baseColor;uniform sampler2D  s_texture0;void main(){   gl_FragColor = texture2D(s_texture0 , v_texCoord) * u_baseColor;}",YZ="precision mediump float;varying vec2       v_texCoord;varying vec4       v_clipPos;uniform vec4       u_baseColor;uniform vec4       u_channelFlag;uniform sampler2D  s_texture0;uniform sampler2D  s_texture1;void main(){   vec4 col_formask = texture2D(s_texture0 , v_texCoord) * u_baseColor;   vec4 clipMask = (1.0 - texture2D(s_texture1, v_clipPos.xy / v_clipPos.w)) * u_channelFlag;   float maskVal = clipMask.r + clipMask.g + clipMask.b + clipMask.a;   col_formask = col_formask * maskVal;   gl_FragColor = col_formask;}",qZ="precision mediump float;varying vec2 v_texCoord;varying vec4 v_clipPos;uniform sampler2D s_texture0;uniform sampler2D s_texture1;uniform vec4 u_channelFlag;uniform vec4 u_baseColor;void main(){vec4 col_formask = texture2D(s_texture0, v_texCoord) * u_baseColor;vec4 clipMask = (1.0 - texture2D(s_texture1, v_clipPos.xy / v_clipPos.w)) * u_channelFlag;float maskVal = clipMask.r + clipMask.g + clipMask.b + clipMask.a;col_formask = col_formask * (1.0 - maskVal);gl_FragColor = col_formask;}";class CO extends Qb{constructor(){super(),this._clippingContextBufferForMask=null,this._clippingContextBufferForDraw=null,this._clippingManager=new Y_,this.firstDraw=!0,this._textures={},this._sortedDrawableIndexList=[],this._bufferData={vertex:null,uv:null,index:null}}initialize(e){e.isUsingMasking()&&(this._clippingManager=new Y_,this._clippingManager.initialize(e,e.getDrawableCount(),e.getDrawableMasks(),e.getDrawableMaskCounts()));for(let t=e.getDrawableCount()-1;t>=0;t--)this._sortedDrawableIndexList[t]=0;super.initialize(e)}bindTexture(e,t){this._textures[e]=t}getBindedTextures(){return this._textures}setClippingMaskBufferSize(e){this._clippingManager.release(),this._clippingManager=new Y_,this._clippingManager.setClippingMaskBufferSize(e),this._clippingManager.initialize(this.getModel(),this.getModel().getDrawableCount(),this.getModel().getDrawableMasks(),this.getModel().getDrawableMaskCounts())}getClippingMaskBufferSize(){return this._clippingManager.getClippingMaskBufferSize()}release(){var e,t,i;const r=this;this._clippingManager.release(),r._clippingManager=void 0,(e=this.gl)==null||e.deleteBuffer(this._bufferData.vertex),this._bufferData.vertex=null,(t=this.gl)==null||t.deleteBuffer(this._bufferData.uv),this._bufferData.uv=null,(i=this.gl)==null||i.deleteBuffer(this._bufferData.index),this._bufferData.index=null,r._bufferData=void 0,r._textures=void 0}doDrawModel(){this.preDraw(),this._clippingManager!=null&&this._clippingManager.setupClippingContext(this.getModel(),this);const e=this.getModel().getDrawableCount(),t=this.getModel().getDrawableRenderOrders();for(let i=0;i<e;++i){const r=t[i];this._sortedDrawableIndexList[r]=i}for(let i=0;i<e;++i){const r=this._sortedDrawableIndexList[i];this.getModel().getDrawableDynamicFlagIsVisible(r)&&(this.setClippingContextBufferForDraw(this._clippingManager!=null?this._clippingManager.getClippingContextListForDraw()[r]:null),this.setIsCulling(this.getModel().getDrawableCulling(r)),this.drawMesh(this.getModel().getDrawableTextureIndices(r),this.getModel().getDrawableVertexIndexCount(r),this.getModel().getDrawableVertexCount(r),this.getModel().getDrawableVertexIndices(r),this.getModel().getDrawableVertices(r),this.getModel().getDrawableVertexUvs(r),this.getModel().getDrawableOpacity(r),this.getModel().getDrawableBlendMode(r),this.getModel().getDrawableInvertedMaskBit(r)))}}drawMesh(e,t,i,r,s,o,a,l,u){this.isCulling()?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this.gl.frontFace(this.gl.CCW);const c=this.getModelColor();this.getClippingContextBufferForMask()==null&&(c.A*=a,this.isPremultipliedAlpha()&&(c.R*=c.A,c.G*=c.A,c.B*=c.A));let h=null;this._textures[e]!=null&&(h=this._textures[e]),Pu.getInstance().setupShaderProgram(this,h,i,s,r,o,this._bufferData,a,l,c,this.isPremultipliedAlpha(),this.getMvpMatrix(),u),this.gl.drawElements(this.gl.TRIANGLES,t,this.gl.UNSIGNED_SHORT,0),this.gl.useProgram(null),this.setClippingContextBufferForDraw(null),this.setClippingContextBufferForMask(null)}static doStaticRelease(){Pu.deleteInstance()}setRenderState(e,t){Sy=e,Sh=t}preDraw(){this.firstDraw&&(this.firstDraw=!1,this._anisortopy=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")),this.gl.disable(this.gl.SCISSOR_TEST),this.gl.disable(this.gl.STENCIL_TEST),this.gl.disable(this.gl.DEPTH_TEST),this.gl.frontFace(this.gl.CW),this.gl.enable(this.gl.BLEND),this.gl.colorMask(!0,!0,!0,!0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null)}setClippingContextBufferForMask(e){this._clippingContextBufferForMask=e}getClippingContextBufferForMask(){return this._clippingContextBufferForMask}setClippingContextBufferForDraw(e){this._clippingContextBufferForDraw=e}getClippingContextBufferForDraw(){return this._clippingContextBufferForDraw}startUp(e){this.gl=e,this._clippingManager.setGL(e),Pu.getInstance().setGl(e)}}Qb.staticRelease=()=>{CO.doStaticRelease()};class RO{constructor(e){this.groups=e.Groups,this.hitAreas=e.HitAreas,this.layout=e.Layout,this.moc=e.FileReferences.Moc,this.expressions=e.FileReferences.Expressions,this.motions=e.FileReferences.Motions,this.textures=e.FileReferences.Textures,this.physics=e.FileReferences.Physics,this.pose=e.FileReferences.Pose}getEyeBlinkParameters(){var e,t;return(t=(e=this.groups)==null?void 0:e.find(i=>i.Name==="EyeBlink"))==null?void 0:t.Ids}getLipSyncParameters(){var e,t;return(t=(e=this.groups)==null?void 0:e.find(i=>i.Name==="LipSync"))==null?void 0:t.Ids}}const KZ="ParamAngleX",ZZ="ParamAngleY",JZ="ParamAngleZ",QZ="ParamEyeBallX",eJ="ParamEyeBallY",tJ="ParamBodyAngleX",nJ="ParamBreath",rw=2,sw=2;var Pi;(n=>{n.LOG_LEVEL_VERBOSE=0,n.LOG_LEVEL_WARNING=1,n.LOG_LEVEL_ERROR=2,n.LOG_LEVEL_NONE=999,n.logLevel=n.LOG_LEVEL_WARNING,n.sound=!0,n.motionSync=!0,n.motionFadingDuration=500,n.idleMotionFadingDuration=2e3,n.expressionFadingDuration=500,n.preserveExpressionOnMotion=!0,n.cubism4=Sd})(Pi||(Pi={}));const Ht={log(n,...e){Pi.logLevel<=Pi.LOG_LEVEL_VERBOSE&&console.log(`[${n}]`,...e)},warn(n,...e){Pi.logLevel<=Pi.LOG_LEVEL_WARNING&&console.warn(`[${n}]`,...e)},error(n,...e){Pi.logLevel<=Pi.LOG_LEVEL_ERROR&&console.error(`[${n}]`,...e)}};function ow(n,e,t){return n<e?e:n>t?t:n}function IO(n,e){e.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(i=>{i!=="constructor"&&Object.defineProperty(n.prototype,i,Object.getOwnPropertyDescriptor(t.prototype,i))})})}function iJ(n){let e=n.lastIndexOf("/");return e!=-1&&(n=n.slice(0,e)),e=n.lastIndexOf("/"),e!==-1&&(n=n.slice(e+1)),n}function rJ(n,e){const t=n.indexOf(e);t!==-1&&n.splice(t,1)}class LO extends lr{constructor(e,t){super(),this.expressions=[],this.reserveExpressionIndex=-1,this.destroyed=!1,this.settings=e,this.tag=`ExpressionManager(${e.name})`}init(){this.defaultExpression=this.createExpression({},void 0),this.currentExpression=this.defaultExpression,this.stopAllExpressions()}loadExpression(e){return rn(this,null,function*(){if(!this.definitions[e]){Ht.warn(this.tag,`Undefined expression at [${e}]`);return}if(this.expressions[e]===null){Ht.warn(this.tag,`Cannot set expression at [${e}] because it's already failed in loading.`);return}if(this.expressions[e])return this.expressions[e];const t=yield this._loadExpression(e);return this.expressions[e]=t,t})}_loadExpression(e){throw new Error("Not implemented.")}setRandomExpression(){return rn(this,null,function*(){if(this.definitions.length){const e=[];for(let t=0;t<this.definitions.length;t++)this.expressions[t]!==null&&this.expressions[t]!==this.currentExpression&&t!==this.reserveExpressionIndex&&e.push(t);if(e.length){const t=Math.floor(Math.random()*e.length);return this.setExpression(t)}}return!1})}resetExpression(){this._setExpression(this.defaultExpression)}restoreExpression(){this._setExpression(this.currentExpression)}setExpression(e){return rn(this,null,function*(){if(typeof e!="number"&&(e=this.getExpressionIndex(e)),!(e>-1&&e<this.definitions.length)||e===this.expressions.indexOf(this.currentExpression))return!1;this.reserveExpressionIndex=e;const t=yield this.loadExpression(e);return!t||this.reserveExpressionIndex!==e?!1:(this.reserveExpressionIndex=-1,this.currentExpression=t,this._setExpression(t),!0)})}update(e,t){return this.isFinished()?!1:this.updateParameters(e,t)}destroy(){this.destroyed=!0,this.emit("destroy");const e=this;e.definitions=void 0,e.expressions=void 0}}const aw=.01,sJ=40/7.5,oJ=1/(.15*1e3);class aJ{constructor(){this.targetX=0,this.targetY=0,this.x=0,this.y=0,this.vx=0,this.vy=0}focus(e,t,i=!1){this.targetX=ow(e,-1,1),this.targetY=ow(t,-1,1),i&&(this.x=this.targetX,this.y=this.targetY)}update(e){const t=this.targetX-this.x,i=this.targetY-this.y;if(Math.abs(t)<aw&&Math.abs(i)<aw)return;const r=Math.sqrt(fa(t,2)+fa(i,2)),s=sJ/(1e3/e);let o=s*(t/r)-this.vx,a=s*(i/r)-this.vy;const l=Math.sqrt(fa(o,2)+fa(a,2)),u=s*oJ*e;l>u&&(o*=u/l,a*=u/l),this.vx+=o,this.vy+=a;const c=Math.sqrt(fa(this.vx,2)+fa(this.vy,2)),h=.5*(Math.sqrt(fa(u,2)+8*u*r)-u);c>h&&(this.vx*=h/c,this.vy*=h/c),this.x+=this.vx,this.y+=this.vy}}class oS{constructor(e){this.json=e;let t=e.url;if(typeof t!="string")throw new TypeError("The `url` field in settings JSON must be defined as a string.");this.url=t,this.name=iJ(this.url)}resolveURL(e){return Ci.resolve(this.url,e)}replaceFiles(e){this.moc=e(this.moc,"moc"),this.pose!==void 0&&(this.pose=e(this.pose,"pose")),this.physics!==void 0&&(this.physics=e(this.physics,"physics"));for(let t=0;t<this.textures.length;t++)this.textures[t]=e(this.textures[t],`textures[${t}]`)}getDefinedFiles(){const e=[];return this.replaceFiles(t=>(e.push(t),t)),e}validateFiles(e){const t=(s,o)=>{const a=this.resolveURL(s);if(!e.includes(a)){if(o)throw new Error(`File "${s}" is defined in settings, but doesn't exist in given files`);return!1}return!0};return[this.moc,...this.textures].forEach(s=>t(s,!0)),this.getDefinedFiles().filter(s=>t(s,!1))}}var Ey=(n=>(n[n.NONE=0]="NONE",n[n.IDLE=1]="IDLE",n[n.NORMAL=2]="NORMAL",n[n.FORCE=3]="FORCE",n))(Ey||{});class lJ{constructor(){this.debug=!1,this.currentPriority=0,this.reservePriority=0}reserve(e,t,i){if(i<=0)return Ht.log(this.tag,"Cannot start a motion with MotionPriority.NONE."),!1;if(e===this.currentGroup&&t===this.currentIndex)return Ht.log(this.tag,"Motion is already playing.",this.dump(e,t)),!1;if(e===this.reservedGroup&&t===this.reservedIndex||e===this.reservedIdleGroup&&t===this.reservedIdleIndex)return Ht.log(this.tag,"Motion is already reserved.",this.dump(e,t)),!1;if(i===1){if(this.currentPriority!==0)return Ht.log(this.tag,"Cannot start idle motion because another motion is playing.",this.dump(e,t)),!1;if(this.reservedIdleGroup!==void 0)return Ht.log(this.tag,"Cannot start idle motion because another idle motion has reserved.",this.dump(e,t)),!1;this.setReservedIdle(e,t)}else{if(i<3){if(i<=this.currentPriority)return Ht.log(this.tag,"Cannot start motion because another motion is playing as an equivalent or higher priority.",this.dump(e,t)),!1;if(i<=this.reservePriority)return Ht.log(this.tag,"Cannot start motion because another motion has reserved as an equivalent or higher priority.",this.dump(e,t)),!1}this.setReserved(e,t,i)}return!0}start(e,t,i,r){if(r===1){if(this.setReservedIdle(void 0,void 0),this.currentPriority!==0)return Ht.log(this.tag,"Cannot start idle motion because another motion is playing.",this.dump(t,i)),!1}else{if(t!==this.reservedGroup||i!==this.reservedIndex)return Ht.log(this.tag,"Cannot start motion because another motion has taken the place.",this.dump(t,i)),!1;this.setReserved(void 0,void 0,0)}return e?(this.setCurrent(t,i,r),!0):!1}complete(){this.setCurrent(void 0,void 0,0)}setCurrent(e,t,i){this.currentPriority=i,this.currentGroup=e,this.currentIndex=t}setReserved(e,t,i){this.reservePriority=i,this.reservedGroup=e,this.reservedIndex=t}setReservedIdle(e,t){this.reservedIdleGroup=e,this.reservedIdleIndex=t}isActive(e,t){return e===this.currentGroup&&t===this.currentIndex||e===this.reservedGroup&&t===this.reservedIndex||e===this.reservedIdleGroup&&t===this.reservedIdleIndex}reset(){this.setCurrent(void 0,void 0,0),this.setReserved(void 0,void 0,0),this.setReservedIdle(void 0,void 0)}shouldRequestIdleMotion(){return this.currentGroup===void 0&&this.reservedIdleGroup===void 0}shouldOverrideExpression(){return!Pi.preserveExpressionOnMotion&&this.currentPriority>1}dump(e,t){if(this.debug){const i=["currentPriority","reservePriority","currentGroup","currentIndex","reservedGroup","reservedIndex","reservedIdleGroup","reservedIdleIndex"];return`
<Requested> group = "${e}", index = ${t}
`+i.map(r=>"["+r+"] "+this[r]).join(`
`)}return""}}const uJ="SoundManager",cJ=.5;class Ga{static get volume(){return this._volume}static set volume(e){this._volume=(e>1?1:e<0?0:e)||0,this.audios.forEach(t=>t.volume=this._volume)}static add(e,t,i){const r=new Audio(e);return r.volume=this._volume,r.preload="auto",r.addEventListener("ended",()=>{this.dispose(r),t==null||t()}),r.addEventListener("error",s=>{this.dispose(r),Ht.warn(uJ,`Error occurred on "${e}"`,s.error),i==null||i(s.error)}),this.audios.push(r),r}static play(e){return new Promise((t,i)=>{var r;(r=e.play())==null||r.catch(s=>{e.dispatchEvent(new ErrorEvent("error",{error:s})),i(s)}),e.readyState===e.HAVE_ENOUGH_DATA?t():e.addEventListener("canplaythrough",t)})}static dispose(e){e.pause(),e.removeAttribute("src"),rJ(this.audios,e)}static destroy(){for(let e=this.audios.length-1;e>=0;e--)this.dispose(this.audios[e])}}Ga.audios=[];Ga._volume=cJ;class aS extends lr{constructor(e,t){super(),this.motionGroups={},this.state=new lJ,this.playing=!1,this.destroyed=!1,this.settings=e,this.tag=`MotionManager(${e.name})`,this.state.tag=this.tag}init(e){e!=null&&e.idleMotionGroup&&(this.groups.idle=e.idleMotionGroup),this.setupMotions(e),this.stopAllMotions()}setupMotions(e){for(const i of Object.keys(this.definitions))this.motionGroups[i]=[];let t;switch(e==null?void 0:e.motionPreload){case"NONE":return;case"ALL":t=Object.keys(this.definitions);break;case"IDLE":default:t=[this.groups.idle];break}for(const i of t)if(this.definitions[i])for(let r=0;r<this.definitions[i].length;r++)this.loadMotion(i,r).then()}loadMotion(e,t){return rn(this,null,function*(){var i;if(!((i=this.definitions[e])!=null&&i[t])){Ht.warn(this.tag,`Undefined motion at "${e}"[${t}]`);return}if(this.motionGroups[e][t]===null){Ht.warn(this.tag,`Cannot start motion at "${e}"[${t}] because it's already failed in loading.`);return}if(this.motionGroups[e][t])return this.motionGroups[e][t];const r=yield this._loadMotion(e,t);if(!this.destroyed)return this.motionGroups[e][t]=r??null,r})}_loadMotion(e,t){throw new Error("Not implemented.")}startMotion(e,t){return rn(this,arguments,function*(i,r,s=Ey.NORMAL){var o;if(!this.state.reserve(i,r,s))return!1;const a=(o=this.definitions[i])==null?void 0:o[r];if(!a)return!1;this.currentAudio&&Ga.dispose(this.currentAudio);let l;if(Pi.sound){const c=this.getSoundFile(a);if(c)try{l=Ga.add(this.settings.resolveURL(c),()=>this.currentAudio=void 0,()=>this.currentAudio=void 0),this.currentAudio=l}catch(h){Ht.warn(this.tag,"Failed to create audio",c,h)}}const u=yield this.loadMotion(i,r);if(l){const c=Ga.play(l).catch(h=>Ht.warn(this.tag,"Failed to play audio",l.src,h));Pi.motionSync&&(yield c)}return this.state.start(u,i,r,s)?(Ht.log(this.tag,"Start motion:",this.getMotionName(a)),this.emit("motionStart",i,r,l),this.state.shouldOverrideExpression()&&this.expressionManager&&this.expressionManager.resetExpression(),this.playing=!0,this._startMotion(u),!0):(l&&(Ga.dispose(l),this.currentAudio=void 0),!1)})}startRandomMotion(e,t){return rn(this,null,function*(){const i=this.definitions[e];if(i!=null&&i.length){const r=[];for(let s=0;s<i.length;s++)this.motionGroups[e][s]!==null&&!this.state.isActive(e,s)&&r.push(s);if(r.length){const s=Math.floor(Math.random()*r.length);return this.startMotion(e,r[s],t)}}return!1})}stopAllMotions(){this._stopAllMotions(),this.state.reset(),this.currentAudio&&(Ga.dispose(this.currentAudio),this.currentAudio=void 0)}update(e,t){var i;return this.isFinished()&&(this.playing&&(this.playing=!1,this.emit("motionFinish")),this.state.shouldOverrideExpression()&&((i=this.expressionManager)==null||i.restoreExpression()),this.state.complete(),this.state.shouldRequestIdleMotion()&&this.startRandomMotion(this.groups.idle,Ey.IDLE)),this.updateParameters(e,t)}destroy(){var e;this.destroyed=!0,this.emit("destroy"),this.stopAllMotions(),(e=this.expressionManager)==null||e.destroy();const t=this;t.definitions=void 0,t.motionGroups=void 0}}const hJ={x:0,y:0,width:0,height:0};class dJ extends lr{constructor(){super(...arguments),this.focusController=new aJ,this.originalWidth=0,this.originalHeight=0,this.width=0,this.height=0,this.localTransform=new kt,this.drawingMatrix=new kt,this.hitAreas={},this.textureFlipY=!1,this.viewport=[0,0,0,0],this.destroyed=!1}init(){this.setupLayout(),this.setupHitAreas()}setupLayout(){const e=this,t=this.getSize();e.originalWidth=t[0],e.originalHeight=t[1];const i=Object.assign({width:rw,height:sw},this.getLayout());this.localTransform.scale(i.width/rw,i.height/sw),e.width=this.originalWidth*this.localTransform.a,e.height=this.originalHeight*this.localTransform.d;const r=i.x!==void 0&&i.x-i.width/2||i.centerX!==void 0&&i.centerX||i.left!==void 0&&i.left-i.width/2||i.right!==void 0&&i.right+i.width/2||0,s=i.y!==void 0&&i.y-i.height/2||i.centerY!==void 0&&i.centerY||i.top!==void 0&&i.top-i.height/2||i.bottom!==void 0&&i.bottom+i.height/2||0;this.localTransform.translate(this.width*r,-this.height*s)}setupHitAreas(){const e=this.getHitAreaDefs().filter(t=>t.index>=0);for(const t of e)this.hitAreas[t.name]=t}hitTest(e,t){return Object.keys(this.hitAreas).filter(i=>this.isHit(i,e,t))}isHit(e,t,i){if(!this.hitAreas[e])return!1;const r=this.hitAreas[e].index,s=this.getDrawableBounds(r,hJ);return s.x<=t&&t<=s.x+s.width&&s.y<=i&&i<=s.y+s.height}getDrawableBounds(e,t){const i=this.getDrawableVertices(e);let r=i[0],s=i[0],o=i[1],a=i[1];for(let l=0;l<i.length;l+=2){const u=i[l],c=i[l+1];r=Math.min(u,r),s=Math.max(u,s),o=Math.min(c,o),a=Math.max(c,a)}return t??(t={}),t.x=r,t.y=o,t.width=s-r,t.height=a-o,t}updateTransform(e){this.drawingMatrix.copyFrom(e).append(this.localTransform)}update(e,t){this.focusController.update(e)}destroy(){this.destroyed=!0,this.emit("destroy"),this.motionManager.destroy(),this.motionManager=void 0}}const fJ="XHRLoader";class lw extends Error{constructor(e,t,i,r=!1){super(e),this.url=t,this.status=i,this.aborted=r}}const ii=class{static createXHR(n,e,t,i,r){const s=new XMLHttpRequest;if(ii.allXhrSet.add(s),n){let o=ii.xhrMap.get(n);o?o.add(s):(o=new Set([s]),ii.xhrMap.set(n,o)),n.listeners("destroy").includes(ii.cancelXHRs)||n.once("destroy",ii.cancelXHRs)}return s.open("GET",e),s.responseType=t,s.onload=()=>{(s.status===200||s.status===0)&&s.response?i(s.response):s.onerror()},s.onerror=()=>{Ht.warn(fJ,`Failed to load resource as ${s.responseType} (Status ${s.status}): ${e}`),r(new lw("Network error.",e,s.status))},s.onabort=()=>r(new lw("Aborted.",e,s.status,!0)),s.onloadend=()=>{var o;ii.allXhrSet.delete(s),n&&((o=ii.xhrMap.get(n))==null||o.delete(s))},s}static cancelXHRs(){var n;(n=ii.xhrMap.get(this))==null||n.forEach(e=>{e.abort(),ii.allXhrSet.delete(e)}),ii.xhrMap.delete(this)}static release(){ii.allXhrSet.forEach(n=>n.abort()),ii.allXhrSet.clear(),ii.xhrMap=new WeakMap}};let gg=ii;gg.xhrMap=new WeakMap;gg.allXhrSet=new Set;gg.loader=(n,e)=>new Promise((t,i)=>{ii.createXHR(n.target,n.settings?n.settings.resolveURL(n.url):n.url,n.type,s=>{n.result=s,t()},i).send()});function OO(n,e){let t=-1;return i(0);function i(r,s){if(s)return Promise.reject(s);if(r<=t)return Promise.reject(new Error("next() called multiple times"));t=r;const o=n[r];if(!o)return Promise.resolve();try{return Promise.resolve(o(e,i.bind(null,r+1)))}catch(a){return Promise.reject(a)}}}class Xo{static load(e){return OO(this.middlewares,e).then(()=>e.result)}}Xo.middlewares=[gg.loader];function pJ(n,e={}){var t;const i={resourceOptions:{crossorigin:e.crossOrigin}};if(Ke.fromURL)return Ke.fromURL(n,i).catch(o=>{if(o instanceof Error)throw o;const a=new Error("Texture loading error");throw a.event=o,a});i.resourceOptions.autoLoad=!1;const r=Ke.from(n,i);if(r.baseTexture.valid)return Promise.resolve(r);const s=r.baseTexture.resource;return(t=s._live2d_load)!=null||(s._live2d_load=new Promise((o,a)=>{const l=u=>{s.source.removeEventListener("error",l);const c=new Error("Texture loading error");c.event=u,a(c)};s.source.addEventListener("error",l),s.load().then(()=>o(r)).catch(l)})),s._live2d_load}const uw="Live2DFactory",DO=(n,e)=>rn(void 0,null,function*(){if(typeof n.source=="string"){const t=yield Xo.load({url:n.source,type:"json",target:n.live2dModel});t.url=n.source,n.source=t,n.live2dModel.emit("settingsJSONLoaded",t)}return e()}),FO=(n,e)=>rn(void 0,null,function*(){if(n.source instanceof oS)return n.settings=n.source,e();if(typeof n.source=="object"){const t=ln.findRuntime(n.source);if(t){const i=t.createModelSettings(n.source);return n.settings=i,n.live2dModel.emit("settingsLoaded",i),e()}}throw new TypeError("Unknown settings format.")}),NO=(n,e)=>{if(n.settings){const t=ln.findRuntime(n.settings);if(t)return t.ready().then(e)}return e()},UO=(n,e)=>rn(void 0,null,function*(){yield e();const t=n.internalModel;if(t){const i=n.settings,r=ln.findRuntime(i);if(r){const s=[];i.pose&&s.push(Xo.load({settings:i,url:i.pose,type:"json",target:t}).then(o=>{t.pose=r.createPose(t.coreModel,o),n.live2dModel.emit("poseLoaded",t.pose)}).catch(o=>{n.live2dModel.emit("poseLoadError",o),Ht.warn(uw,"Failed to load pose.",o)})),i.physics&&s.push(Xo.load({settings:i,url:i.physics,type:"json",target:t}).then(o=>{t.physics=r.createPhysics(t.coreModel,o),n.live2dModel.emit("physicsLoaded",t.physics)}).catch(o=>{n.live2dModel.emit("physicsLoadError",o),Ht.warn(uw,"Failed to load physics.",o)})),s.length&&(yield Promise.all(s))}}}),BO=(n,e)=>rn(void 0,null,function*(){if(n.settings){const t=n.live2dModel,i=n.settings.textures.map(r=>{const s=n.settings.resolveURL(r);return pJ(s,{crossOrigin:n.options.crossOrigin})});if(yield e(),n.internalModel)t.internalModel=n.internalModel,t.emit("modelLoaded",n.internalModel);else throw new TypeError("Missing internal model.");t.textures=yield Promise.all(i),t.emit("textureLoaded",t.textures)}else throw new TypeError("Missing settings.")}),kO=(n,e)=>rn(void 0,null,function*(){const t=n.settings;if(t instanceof oS){const i=ln.findRuntime(t);if(!i)throw new TypeError("Unknown model settings.");const r=yield Xo.load({settings:t,url:t.moc,type:"arraybuffer",target:n.live2dModel});if(!i.isValidMoc(r))throw new Error("Invalid moc data");const s=i.createCoreModel(r);return n.internalModel=i.createInternalModel(s,t,n.options),e()}throw new TypeError("Missing settings.")}),Hn=class{static registerRuntime(n){Hn.runtimes.push(n),Hn.runtimes.sort((e,t)=>t.version-e.version)}static findRuntime(n){for(const e of Hn.runtimes)if(e.test(n))return e}static setupLive2DModel(n,e,t){return rn(this,null,function*(){const i=new Promise(o=>n.once("textureLoaded",o)),r=new Promise(o=>n.once("modelLoaded",o)),s=Promise.all([i,r]).then(()=>n.emit("ready"));yield OO(Hn.live2DModelMiddlewares,{live2dModel:n,source:e,options:t||{}}),yield s,n.emit("load")})}static loadMotion(n,e,t){var i,r;const s=o=>n.emit("motionLoadError",e,t,o);try{const o=(i=n.definitions[e])==null?void 0:i[t];if(!o)return Promise.resolve(void 0);n.listeners("destroy").includes(Hn.releaseTasks)||n.once("destroy",Hn.releaseTasks);let a=Hn.motionTasksMap.get(n);a||(a={},Hn.motionTasksMap.set(n,a));let l=a[e];l||(l=[],a[e]=l);const u=n.getMotionFile(o);return(r=l[t])!=null||(l[t]=Xo.load({url:u,settings:n.settings,type:n.motionDataType,target:n}).then(c=>{var h;const d=(h=Hn.motionTasksMap.get(n))==null?void 0:h[e];d&&delete d[t];const f=n.createMotion(c,e,o);return n.emit("motionLoaded",e,t,f),f}).catch(c=>{Ht.warn(n.tag,`Failed to load motion: ${u}
`,c),s(c)})),l[t]}catch(o){Ht.warn(n.tag,`Failed to load motion at "${e}"[${t}]
`,o),s(o)}return Promise.resolve(void 0)}static loadExpression(n,e){var t;const i=r=>n.emit("expressionLoadError",e,r);try{const r=n.definitions[e];if(!r)return Promise.resolve(void 0);n.listeners("destroy").includes(Hn.releaseTasks)||n.once("destroy",Hn.releaseTasks);let s=Hn.expressionTasksMap.get(n);s||(s=[],Hn.expressionTasksMap.set(n,s));const o=n.getExpressionFile(r);return(t=s[e])!=null||(s[e]=Xo.load({url:o,settings:n.settings,type:"json",target:n}).then(a=>{const l=Hn.expressionTasksMap.get(n);l&&delete l[e];const u=n.createExpression(a,r);return n.emit("expressionLoaded",e,u),u}).catch(a=>{Ht.warn(n.tag,`Failed to load expression: ${o}
`,a),i(a)})),s[e]}catch(r){Ht.warn(n.tag,`Failed to load expression at [${e}]
`,r),i(r)}return Promise.resolve(void 0)}static releaseTasks(){this instanceof aS?Hn.motionTasksMap.delete(this):Hn.expressionTasksMap.delete(this)}};let ln=Hn;ln.runtimes=[];ln.urlToJSON=DO;ln.jsonToSettings=FO;ln.waitUntilReady=NO;ln.setupOptionals=UO;ln.setupEssentials=BO;ln.createInternalModel=kO;ln.live2DModelMiddlewares=[DO,FO,NO,UO,BO,kO];ln.motionTasksMap=new WeakMap;ln.expressionTasksMap=new WeakMap;aS.prototype._loadMotion=function(n,e){return ln.loadMotion(this,n,e)};LO.prototype._loadExpression=function(n){return ln.loadExpression(this,n)};class mJ{constructor(){this._autoInteract=!1}get autoInteract(){return this._autoInteract}set autoInteract(e){e!==this._autoInteract&&(e?this.on("pointertap",cw,this):this.off("pointertap",cw,this),this._autoInteract=e)}registerInteraction(e){e!==this.interactionManager&&(this.unregisterInteraction(),this._autoInteract&&e&&(this.interactionManager=e,e.on("pointermove",hw,this)))}unregisterInteraction(){var e;this.interactionManager&&((e=this.interactionManager)==null||e.off("pointermove",hw,this),this.interactionManager=void 0)}}function cw(n){this.tap(n.data.global.x,n.data.global.y)}function hw(n){this.focus(n.data.global.x,n.data.global.y)}class gJ extends Bd{}const Ui=new Bt,_J=new kt;let uo;class VO extends Oi{constructor(e){super(),this.tag="Live2DModel(uninitialized)",this.textures=[],this.transform=new gJ,this.anchor=new Us(this.onAnchorChange,this,0,0),this.glContextID=-1,this.elapsedTime=performance.now(),this.deltaTime=0,this._autoUpdate=!1,this.once("modelLoaded",()=>this.init(e))}static from(e,t){const i=new this(t);return ln.setupLive2DModel(i,e,t).then(()=>i)}static fromSync(e,t){const i=new this(t);return ln.setupLive2DModel(i,e,t).then(t==null?void 0:t.onLoad).catch(t==null?void 0:t.onError),i}static registerTicker(e){uo=e}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){var t;uo||(uo=(t=window.PIXI)==null?void 0:t.Ticker),e?this._destroyed||(uo?(uo.shared.add(this.onTickerUpdate,this),this._autoUpdate=!0):Ht.warn(this.tag,"No Ticker registered, please call Live2DModel.registerTicker(Ticker).")):(uo==null||uo.shared.remove(this.onTickerUpdate,this),this._autoUpdate=!1)}init(e){this.tag=`Live2DModel(${this.internalModel.settings.name})`;const t=Object.assign({autoUpdate:!0,autoInteract:!0},e);t.autoInteract&&(this.interactive=!0),this.autoInteract=t.autoInteract,this.autoUpdate=t.autoUpdate}onAnchorChange(){this.pivot.set(this.anchor.x*this.internalModel.width,this.anchor.y*this.internalModel.height)}motion(e,t,i){return t===void 0?this.internalModel.motionManager.startRandomMotion(e,i):this.internalModel.motionManager.startMotion(e,t,i)}expression(e){return this.internalModel.motionManager.expressionManager?e===void 0?this.internalModel.motionManager.expressionManager.setRandomExpression():this.internalModel.motionManager.expressionManager.setExpression(e):Promise.resolve(!1)}focus(e,t,i=!1){Ui.x=e,Ui.y=t,this.toModelPosition(Ui,Ui,!0);let r=Ui.x/this.internalModel.originalWidth*2-1,s=Ui.y/this.internalModel.originalHeight*2-1,o=Math.atan2(s,r);this.internalModel.focusController.focus(Math.cos(o),-Math.sin(o),i)}tap(e,t){const i=this.hitTest(e,t);i.length&&(Ht.log(this.tag,"Hit",i),this.emit("hit",i))}hitTest(e,t){return Ui.x=e,Ui.y=t,this.toModelPosition(Ui,Ui),this.internalModel.hitTest(Ui.x,Ui.y)}toModelPosition(e,t=e.clone(),i){return i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.transform.worldTransform.applyInverse(e,t),this.internalModel.localTransform.applyInverse(t,t),t}containsPoint(e){return this.getBounds(!0).contains(e.x,e.y)}_calculateBounds(){this._bounds.addFrame(this.transform,0,0,this.internalModel.width,this.internalModel.height)}onTickerUpdate(){this.update(uo.shared.deltaMS)}update(e){this.deltaTime+=e,this.elapsedTime+=e}_render(e){this.registerInteraction(e.plugins.interaction),e.batch.reset(),e.geometry.reset(),e.shader.reset(),e.state.reset();let t=!1;this.glContextID!==e.CONTEXT_UID&&(this.glContextID=e.CONTEXT_UID,this.internalModel.updateWebGLContext(e.gl,this.glContextID),t=!0);for(let s=0;s<this.textures.length;s++){const o=this.textures[s];o.valid&&((t||!o.baseTexture._glTextures[this.glContextID])&&(e.gl.pixelStorei(WebGLRenderingContext.UNPACK_FLIP_Y_WEBGL,this.internalModel.textureFlipY),e.texture.bind(o.baseTexture,0)),this.internalModel.bindTexture(s,o.baseTexture._glTextures[this.glContextID].texture),o.baseTexture.touched=e.textureGC.count)}const i=e.framebuffer.viewport;this.internalModel.viewport=[i.x,i.y,i.width,i.height],this.deltaTime&&(this.internalModel.update(this.deltaTime,this.elapsedTime),this.deltaTime=0);const r=_J.copyFrom(e.globalUniforms.uniforms.projectionMatrix).append(this.worldTransform);this.internalModel.updateTransform(r),this.internalModel.draw(e.gl),e.state.reset(),e.texture.reset()}destroy(e){this.emit("destroy"),this.autoUpdate=!1,this.unregisterInteraction(),e!=null&&e.texture&&this.textures.forEach(t=>t.destroy(e.baseTexture)),this.internalModel.destroy(),super.destroy(e)}}IO(VO,[mJ]);const Zr=class{static resolveURL(n,e){var t;const i=(t=Zr.filesMap[n])==null?void 0:t[e];if(i===void 0)throw new Error("Cannot find this file from uploaded files: "+e);return i}static upload(n,e){return rn(this,null,function*(){const t={};for(const i of e.getDefinedFiles()){const r=decodeURI(Ci.resolve(e.url,i)),s=n.find(o=>o.webkitRelativePath===r);s&&(t[i]=URL.createObjectURL(s))}Zr.filesMap[e._objectURL]=t})}static createSettings(n){return rn(this,null,function*(){const e=n.find(o=>o.name.endsWith("model.json")||o.name.endsWith("model3.json"));if(!e)throw new TypeError("Settings file not found");const t=yield Zr.readText(e),i=JSON.parse(t);i.url=e.webkitRelativePath;const r=ln.findRuntime(i);if(!r)throw new Error("Unknown settings JSON");const s=r.createModelSettings(i);return s._objectURL=URL.createObjectURL(e),s})}static readText(n){return rn(this,null,function*(){return new Promise((e,t)=>{const i=new FileReader;i.onload=()=>e(i.result),i.onerror=t,i.readAsText(n,"utf8")})})}};let lS=Zr;lS.filesMap={};lS.factory=(n,e)=>rn(void 0,null,function*(){if(Array.isArray(n.source)&&n.source[0]instanceof File){const t=n.source;let i=t.settings;if(!i)i=yield Zr.createSettings(t);else if(!i._objectURL)throw new Error('"_objectURL" must be specified in ModelSettings');i.validateFiles(t.map(r=>encodeURI(r.webkitRelativePath))),yield Zr.upload(t,i),i.resolveURL=function(r){return Zr.resolveURL(this._objectURL,r)},n.source=i,n.live2dModel.once("modelLoaded",r=>{r.once("destroy",function(){const s=this.settings._objectURL;if(URL.revokeObjectURL(s),Zr.filesMap[s])for(const o of Object.values(Zr.filesMap[s]))URL.revokeObjectURL(o);delete Zr.filesMap[s]})})}return e()});ln.live2DModelMiddlewares.unshift(lS.factory);const fi=class{static unzip(n,e){return rn(this,null,function*(){const t=yield fi.getFilePaths(n),i=[];for(const s of e.getDefinedFiles()){const o=decodeURI(Ci.resolve(e.url,s));t.includes(o)&&i.push(o)}const r=yield fi.getFiles(n,i);for(let s=0;s<r.length;s++){const o=i[s],a=r[s];Object.defineProperty(a,"webkitRelativePath",{value:o})}return r})}static createSettings(n){return rn(this,null,function*(){const t=(yield fi.getFilePaths(n)).find(o=>o.endsWith("model.json")||o.endsWith("model3.json"));if(!t)throw new Error("Settings file not found");const i=yield fi.readText(n,t);if(!i)throw new Error("Empty settings file: "+t);const r=JSON.parse(i);r.url=t;const s=ln.findRuntime(r);if(!s)throw new Error("Unknown settings JSON");return s.createModelSettings(r)})}static zipReader(n,e){return rn(this,null,function*(){throw new Error("Not implemented")})}static getFilePaths(n){return rn(this,null,function*(){throw new Error("Not implemented")})}static getFiles(n,e){return rn(this,null,function*(){throw new Error("Not implemented")})}static readText(n,e){return rn(this,null,function*(){throw new Error("Not implemented")})}static releaseReader(n){}};let _g=fi;_g.ZIP_PROTOCOL="zip://";_g.uid=0;_g.factory=(n,e)=>rn(void 0,null,function*(){const t=n.source;let i,r,s;if(typeof t=="string"&&(t.endsWith(".zip")||t.startsWith(fi.ZIP_PROTOCOL))?(t.startsWith(fi.ZIP_PROTOCOL)?i=t.slice(fi.ZIP_PROTOCOL.length):i=t,r=yield Xo.load({url:i,type:"blob",target:n.live2dModel})):Array.isArray(t)&&t.length===1&&t[0]instanceof File&&t[0].name.endsWith(".zip")&&(r=t[0],i=URL.createObjectURL(r),s=t.settings),r){if(!r.size)throw new Error("Empty zip file");const o=yield fi.zipReader(r,i);s||(s=yield fi.createSettings(o)),s._objectURL=fi.ZIP_PROTOCOL+fi.uid+"/"+s.url;const a=yield fi.unzip(o,s);a.settings=s,n.source=a,i.startsWith("blob:")&&n.live2dModel.once("modelLoaded",l=>{l.once("destroy",function(){URL.revokeObjectURL(i)})}),fi.releaseReader(o)}return e()});ln.live2DModelMiddlewares.unshift(_g.factory);if(!window.Live2DCubismCore)throw new Error("Could not find Cubism 4 runtime. This plugin requires live2dcubismcore.js to be loaded.");class vJ extends LO{constructor(e,t){var i;super(e,t),this.queueManager=new AO,this.definitions=(i=e.expressions)!=null?i:[],this.init()}isFinished(){return this.queueManager.isFinished()}getExpressionIndex(e){return this.definitions.findIndex(t=>t.Name===e)}getExpressionFile(e){return e.File}createExpression(e,t){return tS.create(e)}_setExpression(e){return this.queueManager.startMotion(e,!1,performance.now())}stopAllExpressions(){this.queueManager.stopAllMotions()}updateParameters(e,t){return this.queueManager.doUpdateMotion(e,t)}}class Cu extends oS{constructor(e){if(super(e),!Cu.isValidJSON(e))throw new TypeError("Invalid JSON.");Object.assign(this,new RO(e))}static isValidJSON(e){var t;return!!(e!=null&&e.FileReferences)&&typeof e.FileReferences.Moc=="string"&&((t=e.FileReferences.Textures)==null?void 0:t.length)>0&&e.FileReferences.Textures.every(i=>typeof i=="string")}replaceFiles(e){if(super.replaceFiles(e),this.motions)for(const[t,i]of Object.entries(this.motions))for(let r=0;r<i.length;r++)i[r].File=e(i[r].File,`motions.${t}[${r}].File`),i[r].Sound!==void 0&&(i[r].Sound=e(i[r].Sound,`motions.${t}[${r}].Sound`));if(this.expressions)for(let t=0;t<this.expressions.length;t++)this.expressions[t].File=e(this.expressions[t].File,`expressions[${t}].File`)}}IO(Cu,[RO]);class yJ extends aS{constructor(e,t){var i;super(e,t),this.groups={idle:"Idle"},this.motionDataType="json",this.queueManager=new AO,this.definitions=(i=e.motions)!=null?i:{},this.eyeBlinkIds=e.getEyeBlinkParameters()||[],this.lipSyncIds=e.getLipSyncParameters()||[],this.init(t)}init(e){super.init(e),this.settings.expressions&&(this.expressionManager=new vJ(this.settings,e)),this.queueManager.setEventCallback((t,i,r)=>{this.emit("motion:"+i)})}isFinished(){return this.queueManager.isFinished()}_startMotion(e,t){return e.setFinishedMotionHandler(t),this.queueManager.stopAllMotions(),this.queueManager.startMotion(e,!1,performance.now())}_stopAllMotions(){this.queueManager.stopAllMotions()}createMotion(e,t,i){const r=iS.create(e),s=new wO(e),o=(t===this.groups.idle?Pi.idleMotionFadingDuration:Pi.motionFadingDuration)/1e3;return s.getMotionFadeInTime()===void 0&&r.setFadeInTime(i.FadeInTime>0?i.FadeInTime:o),s.getMotionFadeOutTime()===void 0&&r.setFadeOutTime(i.FadeOutTime>0?i.FadeOutTime:o),r.setEffectIds(this.eyeBlinkIds,this.lipSyncIds),r}getMotionFile(e){return e.File}getMotionName(e){return e.File}getSoundFile(e){return e.Sound}updateParameters(e,t){return this.queueManager.doUpdateMotion(e,t)}destroy(){super.destroy(),this.queueManager.release(),this.queueManager=void 0}}const dw=new er;class xJ extends dJ{constructor(e,t,i){super(),this.lipSync=!0,this.breath=Zb.create(),this.renderer=new CO,this.idParamAngleX=KZ,this.idParamAngleY=ZZ,this.idParamAngleZ=JZ,this.idParamEyeBallX=QZ,this.idParamEyeBallY=eJ,this.idParamBodyAngleX=tJ,this.idParamBreath=nJ,this.pixelsPerUnit=1,this.centeringTransform=new kt,this.coreModel=e,this.settings=t,this.motionManager=new yJ(t,i),this.init()}init(){var e;super.init(),((e=this.settings.getEyeBlinkParameters())==null?void 0:e.length)>0&&(this.eyeBlink=TO.create(this.settings)),this.breath.setParameters([new Yc(this.idParamAngleX,0,15,6.5345,.5),new Yc(this.idParamAngleY,0,8,3.5345,.5),new Yc(this.idParamAngleZ,0,10,5.5345,.5),new Yc(this.idParamBodyAngleX,0,4,15.5345,.5),new Yc(this.idParamBreath,0,.5,3.2345,.5)]),this.renderer.initialize(this.coreModel),this.renderer.setIsPremultipliedAlpha(!0)}getSize(){return[this.coreModel.getModel().canvasinfo.CanvasWidth,this.coreModel.getModel().canvasinfo.CanvasHeight]}getLayout(){const e={};if(this.settings.layout)for(const t of Object.keys(this.settings.layout)){const i=t.charAt(0).toLowerCase()+t.slice(1);e[i]=this.settings.layout[t]}return e}setupLayout(){super.setupLayout(),this.pixelsPerUnit=this.coreModel.getModel().canvasinfo.PixelsPerUnit,this.centeringTransform.scale(this.pixelsPerUnit,this.pixelsPerUnit).translate(this.originalWidth/2,this.originalHeight/2)}updateWebGLContext(e,t){this.renderer.firstDraw=!0,this.renderer._bufferData={vertex:null,uv:null,index:null},this.renderer.startUp(e),this.renderer._clippingManager._currentFrameNo=t,this.renderer._clippingManager._maskTexture=void 0,Pu.getInstance()._shaderSets=[]}bindTexture(e,t){this.renderer.bindTexture(e,t)}getHitAreaDefs(){var e,t;return(t=(e=this.settings.hitAreas)==null?void 0:e.map(i=>({id:i.Id,name:i.Name,index:this.coreModel.getDrawableIndex(i.Id)})))!=null?t:[]}getDrawableIDs(){return this.coreModel.getDrawableIds()}getDrawableIndex(e){return this.coreModel.getDrawableIndex(e)}getDrawableVertices(e){if(typeof e=="string"&&(e=this.coreModel.getDrawableIndex(e),e===-1))throw new TypeError("Unable to find drawable ID: "+e);const t=this.coreModel.getDrawableVertices(e).slice();for(let i=0;i<t.length;i+=2)t[i]=t[i]*this.pixelsPerUnit+this.originalWidth/2,t[i+1]=-t[i+1]*this.pixelsPerUnit+this.originalHeight/2;return t}updateTransform(e){this.drawingMatrix.copyFrom(this.centeringTransform).prepend(this.localTransform).prepend(e)}update(e,t){var i,r,s,o;super.update(e,t),e/=1e3,t/=1e3;const a=this.coreModel;this.emit("beforeMotionUpdate");const l=this.motionManager.update(this.coreModel,t);this.emit("afterMotionUpdate"),a.saveParameters(),(i=this.motionManager.expressionManager)==null||i.update(a,t),l||(r=this.eyeBlink)==null||r.updateParameters(a,e),this.updateFocus(),this.updateNaturalMovements(e*1e3,t*1e3),(s=this.physics)==null||s.evaluate(a,e),(o=this.pose)==null||o.updateParameters(a,e),this.emit("beforeModelUpdate"),a.update(),a.loadParameters()}updateFocus(){this.coreModel.addParameterValueById(this.idParamEyeBallX,this.focusController.x),this.coreModel.addParameterValueById(this.idParamEyeBallY,this.focusController.y),this.coreModel.addParameterValueById(this.idParamAngleX,this.focusController.x*30),this.coreModel.addParameterValueById(this.idParamAngleY,this.focusController.y*30),this.coreModel.addParameterValueById(this.idParamAngleZ,this.focusController.x*this.focusController.y*-30),this.coreModel.addParameterValueById(this.idParamBodyAngleX,this.focusController.x*10)}updateNaturalMovements(e,t){var i;(i=this.breath)==null||i.updateParameters(this.coreModel,e/1e3)}draw(e){const t=this.drawingMatrix,i=dw.getArray();i[0]=t.a,i[1]=t.b,i[4]=-t.c,i[5]=-t.d,i[12]=t.tx,i[13]=t.ty,this.renderer.setMvpMatrix(dw),this.renderer.setRenderState(e.getParameter(e.FRAMEBUFFER_BINDING),this.viewport),this.renderer.drawModel()}destroy(){super.destroy(),this.renderer.release(),this.coreModel.release(),this.renderer=void 0,this.coreModel=void 0}}let Hf,fw=20;function bJ(){return bd.isStarted()?Promise.resolve():(Hf??(Hf=new Promise((n,e)=>{function t(){try{SJ(),n()}catch(i){if(fw--,fw<0){const r=new Error("Failed to start up Cubism 4 framework.");r.cause=i,e(r);return}Ht.log("Cubism4","Startup failed, retrying 10ms later..."),setTimeout(t,10)}}t()})),Hf)}function SJ(n){n=Object.assign({logFunction:console.log,loggingLevel:Tl.LogLevel_Verbose},n),bd.startUp(n),bd.initialize()}ln.registerRuntime({version:4,ready:bJ,test(n){return n instanceof Cu||Cu.isValidJSON(n)},isValidMoc(n){if(n.byteLength<4)return!1;const e=new Int8Array(n,0,4);return String.fromCharCode(...e)==="MOC3"},createModelSettings(n){return new Cu(n)},createCoreModel(n){const e=eS.create(n);try{const t=e.createModel();return t.__moc=e,t}catch(t){try{e.release()}catch{}throw t}},createInternalModel(n,e,t){const i=new xJ(n,e,t),r=n;return r.__moc&&(i.__moc=r.__moc,delete r.__moc,i.once("destroy",EJ)),i},createPhysics(n,e){return rS.create(e)},createPose(n,e){return Jb.create(e)}});function EJ(){var n;(n=this.__moc)==null||n.release()}window.PIXI=QK;async function TJ(n){const e=yl();let t=await RC({url:"/get",method:"get"}).catch(s=>{console.log(s)})||{};const i=await VO.from("/live2d/"+(t.data||"mao_pro_t03.model3.json"),{autoUpdate:!0});e.state.model4=i,e.state.model4.scale.set(e.state.scale);let r=new Kb({view:n,autoStart:!0,width:e.state.model4.width,height:e.state.model4.height,backgroundAlpha:0});return r.stage.addChild(i),e.state.model4.internalModel.coreModel._parameterIds.includes("ParamMouthOpenY")&&(e.state.parameterIndex=e.state.model4.internalModel.coreModel.getParameterIndex("ParamMouthOpenY")),e.state.model4.internalModel.coreModel._parameterIds.includes("PARAM_MOUTH_OPEN_Y")&&(e.state.parameterIndex=e.state.model4.internalModel.coreModel.getParameterIndex("PARAM_MOUTH_OPEN_Y")),e.state.model4.internalModel.coreModel._parameterIds.includes("ParamMouthA")&&(e.state.parameterIndex=e.state.model4.internalModel.coreModel.getParameterIndex("ParamMouthA")),r}const Uh=Fe(!1),Ty=Fe(0),My=Fe(0);function pw(n){Uh.value=!0,Ty.value=n.clientX,My.value=n.clientY}function mw(n){if(Uh.value){const e=n.clientX-Ty.value,t=n.clientY-My.value;live2d.value.style.left=parseInt(live2d.value.style.left||0)+e+"px",live2d.value.style.top=parseInt(live2d.value.style.top||0)+t+"px",Ty.value=n.clientX,My.value=n.clientY}}function gw(){Uh.value=!1,Uh.value=!1,Uh.value=!1}const MJ={__name:"Live2d",setup(n){En.logLevel=En.LOG_LEVEL_WARNING;const e=Fe(null),t=yl();return Sn(async()=>{t.state.app=await TJ(e.value),qU(),window.onresize=()=>{t.state.model4.x=e.value.clientWidth/2-t.state.model4.width/2},t.state.live2d=e.value}),(i,r)=>(Te(),ke(jt,null,[lt(b8,{modelType:"live2d"}),ze("canvas",{ref_key:"live2d",ref:e,onMousedown:r[0]||(r[0]=(...s)=>R(pw)&&R(pw)(...s)),onMousemove:r[1]||(r[1]=(...s)=>R(mw)&&R(mw)(...s)),onMouseup:r[2]||(r[2]=(...s)=>R(gw)&&R(gw)(...s)),style:{position:"relative"}},null,544)],64))}};const wJ=ze("svg",{viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","data-v-ea893728":""},[ze("path",{fill:"currentColor",d:"M338.752 104.704a64 64 0 0 0 0 90.496l316.8 316.8-316.8 316.8a64 64 0 0 0 90.496 90.496l362.048-362.048a64 64 0 0 0 0-90.496L429.248 104.704a64 64 0 0 0-90.496 0z"})],-1),AJ=[wJ],PJ={__name:"VRMDrawer",setup(n){const e=Fe(!1);Fe(null);const t=yl();function i(){e.value=!0}oe(()=>t.state.live2d);const r=oe(()=>t.state.percentage),s=oe(()=>t.state.scale);return et(r,(o,a)=>{window.localStorage.setItem("percentage",parseFloat(o)),console.log(o)}),et(s,(o,a)=>{window.localStorage.setItem("scale",parseFloat(o)),console.log(o)}),Sn(()=>{document.addEventListener("keydown",o=>{o.code==="ArrowLeft"&&(e.value=!1),o.code==="ArrowRight"&&(e.value=!0),o.code==="ArrowUp"&&t.dispatch("amplify"),o.code==="ArrowDown"&&t.dispatch("reduce")})}),(o,a)=>{const l=HR;return Te(),ke(jt,null,[ze("div",{class:"show_setting",onClick:i},AJ),lt(l,{modelValue:e.value,"onUpdate:modelValue":a[0]||(a[0]=u=>e.value=u),direction:"ltr","show-close":"","with-header":!1,model:!1},null,8,["modelValue"])],64)}}};/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Er="154",Vl={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Gl={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},CJ=0,_w=1,RJ=2,GO=1,IJ=2,Cs=3,Ks=0,li=1,qi=2,Uo=0,Ru=1,vw=2,yw=3,xw=4,LJ=5,pu=100,OJ=101,DJ=102,bw=103,Sw=104,FJ=200,NJ=201,UJ=202,BJ=203,HO=204,zO=205,kJ=206,VJ=207,GJ=208,HJ=209,zJ=210,WJ=0,XJ=1,jJ=2,wy=3,$J=4,YJ=5,qJ=6,KJ=7,WO=0,ZJ=1,JJ=2,js=0,QJ=1,eQ=2,tQ=3,nQ=4,iQ=5,XO=300,tc=301,nc=302,Ay=303,Py=304,vg=306,ic=1e3,Ki=1001,dm=1002,Dn=1003,Cy=1004,Fp=1005,mi=1006,jO=1007,pl=1008,Bo=1009,rQ=1010,sQ=1011,uS=1012,$O=1013,Ro=1014,ks=1015,Ed=1016,YO=1017,qO=1018,ol=1020,oQ=1021,Zi=1023,aQ=1024,lQ=1025,al=1026,rc=1027,uQ=1028,KO=1029,cQ=1030,ZO=1031,JO=1033,q_=33776,K_=33777,Z_=33778,J_=33779,Ew=35840,Tw=35841,Mw=35842,ww=35843,hQ=36196,Aw=37492,Pw=37496,Cw=37808,Rw=37809,Iw=37810,Lw=37811,Ow=37812,Dw=37813,Fw=37814,Nw=37815,Uw=37816,Bw=37817,kw=37818,Vw=37819,Gw=37820,Hw=37821,Q_=36492,dQ=36283,zw=36284,Ww=36285,Xw=36286,fQ=2200,pQ=2201,mQ=2202,Td=2300,sc=2301,ev=2302,vu=2400,yu=2401,fm=2402,cS=2500,gQ=2501,_Q=0,QO=1,Ry=2,e2=3e3,ko=3001,vQ=3200,yQ=3201,hS=0,xQ=1,ll="",nt="srgb",cs="srgb-linear",t2="display-p3",tv=7680,bQ=519,SQ=512,EQ=513,TQ=514,MQ=515,wQ=516,AQ=517,PQ=518,CQ=519,Iy=35044,RQ=35048,jw="300 es",Ly=1035,Vs=2e3,pm=2001;class Ko{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const $n=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let $w=1234567;const Bh=Math.PI/180,oc=180/Math.PI;function Rr(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return($n[n&255]+$n[n>>8&255]+$n[n>>16&255]+$n[n>>24&255]+"-"+$n[e&255]+$n[e>>8&255]+"-"+$n[e>>16&15|64]+$n[e>>24&255]+"-"+$n[t&63|128]+$n[t>>8&255]+"-"+$n[t>>16&255]+$n[t>>24&255]+$n[i&255]+$n[i>>8&255]+$n[i>>16&255]+$n[i>>24&255]).toLowerCase()}function zn(n,e,t){return Math.max(e,Math.min(t,n))}function dS(n,e){return(n%e+e)%e}function IQ(n,e,t,i,r){return i+(n-e)*(r-i)/(t-e)}function LQ(n,e,t){return n!==e?(t-n)/(e-n):0}function kh(n,e,t){return(1-t)*n+t*e}function OQ(n,e,t,i){return kh(n,e,1-Math.exp(-t*i))}function DQ(n,e=1){return e-Math.abs(dS(n,e*2)-e)}function FQ(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function NQ(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function UQ(n,e){return n+Math.floor(Math.random()*(e-n+1))}function BQ(n,e){return n+Math.random()*(e-n)}function kQ(n){return n*(.5-Math.random())}function VQ(n){n!==void 0&&($w=n);let e=$w+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function GQ(n){return n*Bh}function HQ(n){return n*oc}function Oy(n){return(n&n-1)===0&&n!==0}function n2(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function mm(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function zQ(n,e,t,i,r){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),u=s((e+i)/2),c=o((e+i)/2),h=s((e-i)/2),d=o((e-i)/2),f=s((i-e)/2),p=o((i-e)/2);switch(r){case"XYX":n.set(a*c,l*h,l*d,a*u);break;case"YZY":n.set(l*d,a*c,l*h,a*u);break;case"ZXZ":n.set(l*h,l*d,a*c,a*u);break;case"XZX":n.set(a*c,l*p,l*f,a*u);break;case"YXY":n.set(l*f,a*c,l*p,a*u);break;case"ZYZ":n.set(l*p,l*f,a*c,a*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Gs(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Vt(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const Kt={DEG2RAD:Bh,RAD2DEG:oc,generateUUID:Rr,clamp:zn,euclideanModulo:dS,mapLinear:IQ,inverseLerp:LQ,lerp:kh,damp:OQ,pingpong:DQ,smoothstep:FQ,smootherstep:NQ,randInt:UQ,randFloat:BQ,randFloatSpread:kQ,seededRandom:VQ,degToRad:GQ,radToDeg:HQ,isPowerOfTwo:Oy,ceilPowerOfTwo:n2,floorPowerOfTwo:mm,setQuaternionFromProperEuler:zQ,normalize:Vt,denormalize:Gs};class Ze{constructor(e=0,t=0){Ze.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(zn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Je{constructor(e,t,i,r,s,o,a,l,u){Je.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,l,u)}set(e,t,i,r,s,o,a,l,u){const c=this.elements;return c[0]=e,c[1]=r,c[2]=a,c[3]=t,c[4]=s,c[5]=l,c[6]=i,c[7]=o,c[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],l=i[6],u=i[1],c=i[4],h=i[7],d=i[2],f=i[5],p=i[8],_=r[0],m=r[3],g=r[6],v=r[1],y=r[4],x=r[7],b=r[2],S=r[5],T=r[8];return s[0]=o*_+a*v+l*b,s[3]=o*m+a*y+l*S,s[6]=o*g+a*x+l*T,s[1]=u*_+c*v+h*b,s[4]=u*m+c*y+h*S,s[7]=u*g+c*x+h*T,s[2]=d*_+f*v+p*b,s[5]=d*m+f*y+p*S,s[8]=d*g+f*x+p*T,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8];return t*o*c-t*a*u-i*s*c+i*a*l+r*s*u-r*o*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=c*o-a*u,d=a*l-c*s,f=u*s-o*l,p=t*h+i*d+r*f;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);const _=1/p;return e[0]=h*_,e[1]=(r*u-c*i)*_,e[2]=(a*i-r*o)*_,e[3]=d*_,e[4]=(c*t-r*l)*_,e[5]=(r*s-a*t)*_,e[6]=f*_,e[7]=(i*l-u*t)*_,e[8]=(o*t-i*s)*_,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const l=Math.cos(s),u=Math.sin(s);return this.set(i*l,i*u,-i*(l*o+u*a)+o+e,-r*u,r*l,-r*(-u*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(nv.makeScale(e,t)),this}rotate(e){return this.premultiply(nv.makeRotation(-e)),this}translate(e,t){return this.premultiply(nv.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const nv=new Je;function i2(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function Md(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}const Yw={};function Vh(n){n in Yw||(Yw[n]=!0,console.warn(n))}function Iu(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function iv(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}const WQ=new Je().fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),XQ=new Je().fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]);function jQ(n){return n.convertSRGBToLinear().applyMatrix3(XQ)}function $Q(n){return n.applyMatrix3(WQ).convertLinearToSRGB()}const YQ={[cs]:n=>n,[nt]:n=>n.convertSRGBToLinear(),[t2]:jQ},qQ={[cs]:n=>n,[nt]:n=>n.convertLinearToSRGB(),[t2]:$Q},pr={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(n){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!n},get workingColorSpace(){return cs},set workingColorSpace(n){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(n,e,t){if(this.enabled===!1||e===t||!e||!t)return n;const i=YQ[e],r=qQ[t];if(i===void 0||r===void 0)throw new Error(`Unsupported color space conversion, "${e}" to "${t}".`);return r(i(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this.workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this.workingColorSpace)}};let Hl;class r2{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Hl===void 0&&(Hl=Md("canvas")),Hl.width=e.width,Hl.height=e.height;const i=Hl.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=Hl}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Md("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=Iu(s[o]/255)*255;return i.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(Iu(t[i]/255)*255):t[i]=Iu(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let KQ=0;class s2{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:KQ++}),this.uuid=Rr(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(rv(r[o].image)):s.push(rv(r[o]))}else s=rv(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function rv(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?r2.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let ZQ=0;class jn extends Ko{constructor(e=jn.DEFAULT_IMAGE,t=jn.DEFAULT_MAPPING,i=Ki,r=Ki,s=mi,o=pl,a=Zi,l=Bo,u=jn.DEFAULT_ANISOTROPY,c=ll){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:ZQ++}),this.uuid=Rr(),this.name="",this.source=new s2(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=i,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=u,this.format=a,this.internalFormat=null,this.type=l,this.offset=new Ze(0,0),this.repeat=new Ze(1,1),this.center=new Ze(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Je,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof c=="string"?this.colorSpace=c:(Vh("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=c===ko?nt:ll),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==XO)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case ic:e.x=e.x-Math.floor(e.x);break;case Ki:e.x=e.x<0?0:1;break;case dm:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case ic:e.y=e.y-Math.floor(e.y);break;case Ki:e.y=e.y<0?0:1;break;case dm:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Vh("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===nt?ko:e2}set encoding(e){Vh("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===ko?nt:ll}}jn.DEFAULT_IMAGE=null;jn.DEFAULT_MAPPING=XO;jn.DEFAULT_ANISOTROPY=1;class zt{constructor(e=0,t=0,i=0,r=1){zt.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const l=e.elements,u=l[0],c=l[4],h=l[8],d=l[1],f=l[5],p=l[9],_=l[2],m=l[6],g=l[10];if(Math.abs(c-d)<.01&&Math.abs(h-_)<.01&&Math.abs(p-m)<.01){if(Math.abs(c+d)<.1&&Math.abs(h+_)<.1&&Math.abs(p+m)<.1&&Math.abs(u+f+g-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const y=(u+1)/2,x=(f+1)/2,b=(g+1)/2,S=(c+d)/4,T=(h+_)/4,P=(p+m)/4;return y>x&&y>b?y<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(y),r=S/i,s=T/i):x>b?x<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(x),i=S/r,s=P/r):b<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(b),i=T/s,r=P/s),this.set(i,r,s,t),this}let v=Math.sqrt((m-p)*(m-p)+(h-_)*(h-_)+(d-c)*(d-c));return Math.abs(v)<.001&&(v=1),this.x=(m-p)/v,this.y=(h-_)/v,this.z=(d-c)/v,this.w=Math.acos((u+f+g-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class ml extends Ko{constructor(e=1,t=1,i={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new zt(0,0,e,t),this.scissorTest=!1,this.viewport=new zt(0,0,e,t);const r={width:e,height:t,depth:1};i.encoding!==void 0&&(Vh("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===ko?nt:ll),this.texture=new jn(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.internalFormat=i.internalFormat!==void 0?i.internalFormat:null,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:mi,this.depthBuffer=i.depthBuffer!==void 0?i.depthBuffer:!0,this.stencilBuffer=i.stencilBuffer!==void 0?i.stencilBuffer:!1,this.depthTexture=i.depthTexture!==void 0?i.depthTexture:null,this.samples=i.samples!==void 0?i.samples:0}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new s2(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class o2 extends jn{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Dn,this.minFilter=Dn,this.wrapR=Ki,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class JQ extends jn{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Dn,this.minFilter=Dn,this.wrapR=Ki,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Xe{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let l=i[r+0],u=i[r+1],c=i[r+2],h=i[r+3];const d=s[o+0],f=s[o+1],p=s[o+2],_=s[o+3];if(a===0){e[t+0]=l,e[t+1]=u,e[t+2]=c,e[t+3]=h;return}if(a===1){e[t+0]=d,e[t+1]=f,e[t+2]=p,e[t+3]=_;return}if(h!==_||l!==d||u!==f||c!==p){let m=1-a;const g=l*d+u*f+c*p+h*_,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){const b=Math.sqrt(y),S=Math.atan2(b,g*v);m=Math.sin(m*S)/b,a=Math.sin(a*S)/b}const x=a*v;if(l=l*m+d*x,u=u*m+f*x,c=c*m+p*x,h=h*m+_*x,m===1-a){const b=1/Math.sqrt(l*l+u*u+c*c+h*h);l*=b,u*=b,c*=b,h*=b}}e[t]=l,e[t+1]=u,e[t+2]=c,e[t+3]=h}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],l=i[r+1],u=i[r+2],c=i[r+3],h=s[o],d=s[o+1],f=s[o+2],p=s[o+3];return e[t]=a*p+c*h+l*f-u*d,e[t+1]=l*p+c*d+u*h-a*f,e[t+2]=u*p+c*f+a*d-l*h,e[t+3]=c*p-a*h-l*d-u*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,u=a(i/2),c=a(r/2),h=a(s/2),d=l(i/2),f=l(r/2),p=l(s/2);switch(o){case"XYZ":this._x=d*c*h+u*f*p,this._y=u*f*h-d*c*p,this._z=u*c*p+d*f*h,this._w=u*c*h-d*f*p;break;case"YXZ":this._x=d*c*h+u*f*p,this._y=u*f*h-d*c*p,this._z=u*c*p-d*f*h,this._w=u*c*h+d*f*p;break;case"ZXY":this._x=d*c*h-u*f*p,this._y=u*f*h+d*c*p,this._z=u*c*p+d*f*h,this._w=u*c*h-d*f*p;break;case"ZYX":this._x=d*c*h-u*f*p,this._y=u*f*h+d*c*p,this._z=u*c*p-d*f*h,this._w=u*c*h+d*f*p;break;case"YZX":this._x=d*c*h+u*f*p,this._y=u*f*h+d*c*p,this._z=u*c*p-d*f*h,this._w=u*c*h-d*f*p;break;case"XZY":this._x=d*c*h-u*f*p,this._y=u*f*h-d*c*p,this._z=u*c*p+d*f*h,this._w=u*c*h+d*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],u=t[2],c=t[6],h=t[10],d=i+a+h;if(d>0){const f=.5/Math.sqrt(d+1);this._w=.25/f,this._x=(c-l)*f,this._y=(s-u)*f,this._z=(o-r)*f}else if(i>a&&i>h){const f=2*Math.sqrt(1+i-a-h);this._w=(c-l)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+u)/f}else if(a>h){const f=2*Math.sqrt(1+a-i-h);this._w=(s-u)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(l+c)/f}else{const f=2*Math.sqrt(1+h-i-a);this._w=(o-r)/f,this._x=(s+u)/f,this._y=(l+c)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(zn(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,u=t._z,c=t._w;return this._x=i*c+o*a+r*u-s*l,this._y=r*c+o*l+s*a-i*u,this._z=s*c+o*u+i*l-r*a,this._w=o*c-i*a-r*l-s*u,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const f=1-t;return this._w=f*o+t*this._w,this._x=f*i+t*this._x,this._y=f*r+t*this._y,this._z=f*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const u=Math.sqrt(l),c=Math.atan2(u,a),h=Math.sin((1-t)*c)/u,d=Math.sin(t*c)/u;return this._w=o*h+this._w*d,this._x=i*h+this._x*d,this._y=r*h+this._y*d,this._z=s*h+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(s),i*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class z{constructor(e=0,t=0,i=0){z.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(qw.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(qw.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,u=l*t+o*r-a*i,c=l*i+a*t-s*r,h=l*r+s*i-o*t,d=-s*t-o*i-a*r;return this.x=u*l+d*-s+c*-a-h*-o,this.y=c*l+d*-o+h*-s-u*-a,this.z=h*l+d*-a+u*-o-c*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return sv.copy(this).projectOnVector(e),this.sub(sv)}reflect(e){return this.sub(sv.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(zn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const sv=new z,qw=new Xe;class to{constructor(e=new z(1/0,1/0,1/0),t=new z(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(bs.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(bs.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=bs.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){if(e.updateWorldMatrix(!1,!1),e.boundingBox!==void 0)e.boundingBox===null&&e.computeBoundingBox(),zl.copy(e.boundingBox),zl.applyMatrix4(e.matrixWorld),this.union(zl);else{const r=e.geometry;if(r!==void 0)if(t&&r.attributes!==void 0&&r.attributes.position!==void 0){const s=r.attributes.position;for(let o=0,a=s.count;o<a;o++)bs.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(bs)}else r.boundingBox===null&&r.computeBoundingBox(),zl.copy(r.boundingBox),zl.applyMatrix4(e.matrixWorld),this.union(zl)}const i=e.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,bs),bs.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Kc),zf.subVectors(this.max,Kc),Wl.subVectors(e.a,Kc),Xl.subVectors(e.b,Kc),jl.subVectors(e.c,Kc),co.subVectors(Xl,Wl),ho.subVectors(jl,Xl),ma.subVectors(Wl,jl);let t=[0,-co.z,co.y,0,-ho.z,ho.y,0,-ma.z,ma.y,co.z,0,-co.x,ho.z,0,-ho.x,ma.z,0,-ma.x,-co.y,co.x,0,-ho.y,ho.x,0,-ma.y,ma.x,0];return!ov(t,Wl,Xl,jl,zf)||(t=[1,0,0,0,1,0,0,0,1],!ov(t,Wl,Xl,jl,zf))?!1:(Wf.crossVectors(co,ho),t=[Wf.x,Wf.y,Wf.z],ov(t,Wl,Xl,jl,zf))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,bs).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(bs).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(xs[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),xs[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),xs[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),xs[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),xs[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),xs[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),xs[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),xs[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(xs),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const xs=[new z,new z,new z,new z,new z,new z,new z,new z],bs=new z,zl=new to,Wl=new z,Xl=new z,jl=new z,co=new z,ho=new z,ma=new z,Kc=new z,zf=new z,Wf=new z,ga=new z;function ov(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){ga.fromArray(n,s);const a=r.x*Math.abs(ga.x)+r.y*Math.abs(ga.y)+r.z*Math.abs(ga.z),l=e.dot(ga),u=t.dot(ga),c=i.dot(ga);if(Math.max(-Math.max(l,u,c),Math.min(l,u,c))>a)return!1}return!0}const QQ=new to,Zc=new z,av=new z;class fs{constructor(e=new z,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;t!==void 0?i.copy(t):QQ.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Zc.subVectors(e,this.center);const t=Zc.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=(i-this.radius)*.5;this.center.addScaledVector(Zc,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(av.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Zc.copy(e.center).add(av)),this.expandByPoint(Zc.copy(e.center).sub(av))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Ss=new z,lv=new z,Xf=new z,fo=new z,uv=new z,jf=new z,cv=new z;class yg{constructor(e=new z,t=new z(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Ss)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Ss.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Ss.copy(this.origin).addScaledVector(this.direction,t),Ss.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){lv.copy(e).add(t).multiplyScalar(.5),Xf.copy(t).sub(e).normalize(),fo.copy(this.origin).sub(lv);const s=e.distanceTo(t)*.5,o=-this.direction.dot(Xf),a=fo.dot(this.direction),l=-fo.dot(Xf),u=fo.lengthSq(),c=Math.abs(1-o*o);let h,d,f,p;if(c>0)if(h=o*l-a,d=o*a-l,p=s*c,h>=0)if(d>=-p)if(d<=p){const _=1/c;h*=_,d*=_,f=h*(h+o*d+2*a)+d*(o*h+d+2*l)+u}else d=s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*l)+u;else d=-s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*l)+u;else d<=-p?(h=Math.max(0,-(-o*s+a)),d=h>0?-s:Math.min(Math.max(-s,-l),s),f=-h*h+d*(d+2*l)+u):d<=p?(h=0,d=Math.min(Math.max(-s,-l),s),f=d*(d+2*l)+u):(h=Math.max(0,-(o*s+a)),d=h>0?s:Math.min(Math.max(-s,-l),s),f=-h*h+d*(d+2*l)+u);else d=o>0?-s:s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*l)+u;return i&&i.copy(this.origin).addScaledVector(this.direction,h),r&&r.copy(lv).addScaledVector(Xf,d),f}intersectSphere(e,t){Ss.subVectors(e.center,this.origin);const i=Ss.dot(this.direction),r=Ss.dot(Ss)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return l<0?null:a<0?this.at(l,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,l;const u=1/this.direction.x,c=1/this.direction.y,h=1/this.direction.z,d=this.origin;return u>=0?(i=(e.min.x-d.x)*u,r=(e.max.x-d.x)*u):(i=(e.max.x-d.x)*u,r=(e.min.x-d.x)*u),c>=0?(s=(e.min.y-d.y)*c,o=(e.max.y-d.y)*c):(s=(e.max.y-d.y)*c,o=(e.min.y-d.y)*c),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),h>=0?(a=(e.min.z-d.z)*h,l=(e.max.z-d.z)*h):(a=(e.max.z-d.z)*h,l=(e.min.z-d.z)*h),i>l||a>r)||((a>i||i!==i)&&(i=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return this.intersectBox(e,Ss)!==null}intersectTriangle(e,t,i,r,s){uv.subVectors(t,e),jf.subVectors(i,e),cv.crossVectors(uv,jf);let o=this.direction.dot(cv),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;fo.subVectors(this.origin,e);const l=a*this.direction.dot(jf.crossVectors(fo,jf));if(l<0)return null;const u=a*this.direction.dot(uv.cross(fo));if(u<0||l+u>o)return null;const c=-a*fo.dot(cv);return c<0?null:this.at(c/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Qe{constructor(e,t,i,r,s,o,a,l,u,c,h,d,f,p,_,m){Qe.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,l,u,c,h,d,f,p,_,m)}set(e,t,i,r,s,o,a,l,u,c,h,d,f,p,_,m){const g=this.elements;return g[0]=e,g[4]=t,g[8]=i,g[12]=r,g[1]=s,g[5]=o,g[9]=a,g[13]=l,g[2]=u,g[6]=c,g[10]=h,g[14]=d,g[3]=f,g[7]=p,g[11]=_,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Qe().fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/$l.setFromMatrixColumn(e,0).length(),s=1/$l.setFromMatrixColumn(e,1).length(),o=1/$l.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),u=Math.sin(r),c=Math.cos(s),h=Math.sin(s);if(e.order==="XYZ"){const d=o*c,f=o*h,p=a*c,_=a*h;t[0]=l*c,t[4]=-l*h,t[8]=u,t[1]=f+p*u,t[5]=d-_*u,t[9]=-a*l,t[2]=_-d*u,t[6]=p+f*u,t[10]=o*l}else if(e.order==="YXZ"){const d=l*c,f=l*h,p=u*c,_=u*h;t[0]=d+_*a,t[4]=p*a-f,t[8]=o*u,t[1]=o*h,t[5]=o*c,t[9]=-a,t[2]=f*a-p,t[6]=_+d*a,t[10]=o*l}else if(e.order==="ZXY"){const d=l*c,f=l*h,p=u*c,_=u*h;t[0]=d-_*a,t[4]=-o*h,t[8]=p+f*a,t[1]=f+p*a,t[5]=o*c,t[9]=_-d*a,t[2]=-o*u,t[6]=a,t[10]=o*l}else if(e.order==="ZYX"){const d=o*c,f=o*h,p=a*c,_=a*h;t[0]=l*c,t[4]=p*u-f,t[8]=d*u+_,t[1]=l*h,t[5]=_*u+d,t[9]=f*u-p,t[2]=-u,t[6]=a*l,t[10]=o*l}else if(e.order==="YZX"){const d=o*l,f=o*u,p=a*l,_=a*u;t[0]=l*c,t[4]=_-d*h,t[8]=p*h+f,t[1]=h,t[5]=o*c,t[9]=-a*c,t[2]=-u*c,t[6]=f*h+p,t[10]=d-_*h}else if(e.order==="XZY"){const d=o*l,f=o*u,p=a*l,_=a*u;t[0]=l*c,t[4]=-h,t[8]=u*c,t[1]=d*h+_,t[5]=o*c,t[9]=f*h-p,t[2]=p*h-f,t[6]=a*c,t[10]=_*h+d}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(eee,e,tee)}lookAt(e,t,i){const r=this.elements;return Ti.subVectors(e,t),Ti.lengthSq()===0&&(Ti.z=1),Ti.normalize(),po.crossVectors(i,Ti),po.lengthSq()===0&&(Math.abs(i.z)===1?Ti.x+=1e-4:Ti.z+=1e-4,Ti.normalize(),po.crossVectors(i,Ti)),po.normalize(),$f.crossVectors(Ti,po),r[0]=po.x,r[4]=$f.x,r[8]=Ti.x,r[1]=po.y,r[5]=$f.y,r[9]=Ti.y,r[2]=po.z,r[6]=$f.z,r[10]=Ti.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],l=i[8],u=i[12],c=i[1],h=i[5],d=i[9],f=i[13],p=i[2],_=i[6],m=i[10],g=i[14],v=i[3],y=i[7],x=i[11],b=i[15],S=r[0],T=r[4],P=r[8],E=r[12],M=r[1],O=r[5],L=r[9],C=r[13],D=r[2],B=r[6],W=r[10],U=r[14],$=r[3],J=r[7],j=r[11],F=r[15];return s[0]=o*S+a*M+l*D+u*$,s[4]=o*T+a*O+l*B+u*J,s[8]=o*P+a*L+l*W+u*j,s[12]=o*E+a*C+l*U+u*F,s[1]=c*S+h*M+d*D+f*$,s[5]=c*T+h*O+d*B+f*J,s[9]=c*P+h*L+d*W+f*j,s[13]=c*E+h*C+d*U+f*F,s[2]=p*S+_*M+m*D+g*$,s[6]=p*T+_*O+m*B+g*J,s[10]=p*P+_*L+m*W+g*j,s[14]=p*E+_*C+m*U+g*F,s[3]=v*S+y*M+x*D+b*$,s[7]=v*T+y*O+x*B+b*J,s[11]=v*P+y*L+x*W+b*j,s[15]=v*E+y*C+x*U+b*F,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],u=e[13],c=e[2],h=e[6],d=e[10],f=e[14],p=e[3],_=e[7],m=e[11],g=e[15];return p*(+s*l*h-r*u*h-s*a*d+i*u*d+r*a*f-i*l*f)+_*(+t*l*f-t*u*d+s*o*d-r*o*f+r*u*c-s*l*c)+m*(+t*u*h-t*a*f-s*o*h+i*o*f+s*a*c-i*u*c)+g*(-r*a*c-t*l*h+t*a*d+r*o*h-i*o*d+i*l*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],_=e[13],m=e[14],g=e[15],v=h*m*u-_*d*u+_*l*f-a*m*f-h*l*g+a*d*g,y=p*d*u-c*m*u-p*l*f+o*m*f+c*l*g-o*d*g,x=c*_*u-p*h*u+p*a*f-o*_*f-c*a*g+o*h*g,b=p*h*l-c*_*l-p*a*d+o*_*d+c*a*m-o*h*m,S=t*v+i*y+r*x+s*b;if(S===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const T=1/S;return e[0]=v*T,e[1]=(_*d*s-h*m*s-_*r*f+i*m*f+h*r*g-i*d*g)*T,e[2]=(a*m*s-_*l*s+_*r*u-i*m*u-a*r*g+i*l*g)*T,e[3]=(h*l*s-a*d*s-h*r*u+i*d*u+a*r*f-i*l*f)*T,e[4]=y*T,e[5]=(c*m*s-p*d*s+p*r*f-t*m*f-c*r*g+t*d*g)*T,e[6]=(p*l*s-o*m*s-p*r*u+t*m*u+o*r*g-t*l*g)*T,e[7]=(o*d*s-c*l*s+c*r*u-t*d*u-o*r*f+t*l*f)*T,e[8]=x*T,e[9]=(p*h*s-c*_*s-p*i*f+t*_*f+c*i*g-t*h*g)*T,e[10]=(o*_*s-p*a*s+p*i*u-t*_*u-o*i*g+t*a*g)*T,e[11]=(c*a*s-o*h*s-c*i*u+t*h*u+o*i*f-t*a*f)*T,e[12]=b*T,e[13]=(c*_*r-p*h*r+p*i*d-t*_*d-c*i*m+t*h*m)*T,e[14]=(p*a*r-o*_*r-p*i*l+t*_*l+o*i*m-t*a*m)*T,e[15]=(o*h*r-c*a*r+c*i*l-t*h*l-o*i*d+t*a*d)*T,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,r))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,l=e.z,u=s*o,c=s*a;return this.set(u*o+i,u*a-r*l,u*l+r*a,0,u*a+r*l,c*a+i,c*l-r*o,0,u*l-r*a,c*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,u=s+s,c=o+o,h=a+a,d=s*u,f=s*c,p=s*h,_=o*c,m=o*h,g=a*h,v=l*u,y=l*c,x=l*h,b=i.x,S=i.y,T=i.z;return r[0]=(1-(_+g))*b,r[1]=(f+x)*b,r[2]=(p-y)*b,r[3]=0,r[4]=(f-x)*S,r[5]=(1-(d+g))*S,r[6]=(m+v)*S,r[7]=0,r[8]=(p+y)*T,r[9]=(m-v)*T,r[10]=(1-(d+_))*T,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=$l.set(r[0],r[1],r[2]).length();const o=$l.set(r[4],r[5],r[6]).length(),a=$l.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],mr.copy(this);const u=1/s,c=1/o,h=1/a;return mr.elements[0]*=u,mr.elements[1]*=u,mr.elements[2]*=u,mr.elements[4]*=c,mr.elements[5]*=c,mr.elements[6]*=c,mr.elements[8]*=h,mr.elements[9]*=h,mr.elements[10]*=h,t.setFromRotationMatrix(mr),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o,a=Vs){const l=this.elements,u=2*s/(t-e),c=2*s/(i-r),h=(t+e)/(t-e),d=(i+r)/(i-r);let f,p;if(a===Vs)f=-(o+s)/(o-s),p=-2*o*s/(o-s);else if(a===pm)f=-o/(o-s),p=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=u,l[4]=0,l[8]=h,l[12]=0,l[1]=0,l[5]=c,l[9]=d,l[13]=0,l[2]=0,l[6]=0,l[10]=f,l[14]=p,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,i,r,s,o,a=Vs){const l=this.elements,u=1/(t-e),c=1/(i-r),h=1/(o-s),d=(t+e)*u,f=(i+r)*c;let p,_;if(a===Vs)p=(o+s)*h,_=-2*h;else if(a===pm)p=s*h,_=-1*h;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*u,l[4]=0,l[8]=0,l[12]=-d,l[1]=0,l[5]=2*c,l[9]=0,l[13]=-f,l[2]=0,l[6]=0,l[10]=_,l[14]=-p,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const $l=new z,mr=new Qe,eee=new z(0,0,0),tee=new z(1,1,1),po=new z,$f=new z,Ti=new z,Kw=new Qe,Zw=new Xe;class Zo{constructor(e=0,t=0,i=0,r=Zo.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,r=this._order){return this._x=e,this._y=t,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const r=e.elements,s=r[0],o=r[4],a=r[8],l=r[1],u=r[5],c=r[9],h=r[2],d=r[6],f=r[10];switch(t){case"XYZ":this._y=Math.asin(zn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,f),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(d,u),this._z=0);break;case"YXZ":this._x=Math.asin(-zn(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,f),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-h,s),this._z=0);break;case"ZXY":this._x=Math.asin(zn(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-h,f),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-zn(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(d,f),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(zn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-h,s)):(this._x=0,this._y=Math.atan2(a,f));break;case"XZY":this._z=Math.asin(-zn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,u),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-c,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return Kw.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Kw,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return Zw.setFromEuler(this),this.setFromQuaternion(Zw,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Zo.DEFAULT_ORDER="XYZ";class a2{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let nee=0;const Jw=new z,Yl=new Xe,Es=new Qe,Yf=new z,Jc=new z,iee=new z,ree=new Xe,Qw=new z(1,0,0),eA=new z(0,1,0),tA=new z(0,0,1),see={type:"added"},nA={type:"removed"};class Ft extends Ko{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:nee++}),this.uuid=Rr(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ft.DEFAULT_UP.clone();const e=new z,t=new Zo,i=new Xe,r=new z(1,1,1);function s(){i.setFromEuler(t,!1)}function o(){t.setFromQuaternion(i,void 0,!1)}t._onChange(s),i._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Qe},normalMatrix:{value:new Je}}),this.matrix=new Qe,this.matrixWorld=new Qe,this.matrixAutoUpdate=Ft.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Ft.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new a2,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Yl.setFromAxisAngle(e,t),this.quaternion.multiply(Yl),this}rotateOnWorldAxis(e,t){return Yl.setFromAxisAngle(e,t),this.quaternion.premultiply(Yl),this}rotateX(e){return this.rotateOnAxis(Qw,e)}rotateY(e){return this.rotateOnAxis(eA,e)}rotateZ(e){return this.rotateOnAxis(tA,e)}translateOnAxis(e,t){return Jw.copy(e).applyQuaternion(this.quaternion),this.position.add(Jw.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Qw,e)}translateY(e){return this.translateOnAxis(eA,e)}translateZ(e){return this.translateOnAxis(tA,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Es.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?Yf.copy(e):Yf.set(e,t,i);const r=this.parent;this.updateWorldMatrix(!0,!1),Jc.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Es.lookAt(Jc,Yf,this.up):Es.lookAt(Yf,Jc,this.up),this.quaternion.setFromRotationMatrix(Es),r&&(Es.extractRotation(r.matrixWorld),Yl.setFromRotationMatrix(Es),this.quaternion.premultiply(Yl.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(see)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(nA)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(nA)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),Es.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Es.multiply(e.parent.matrixWorld)),e.applyMatrix4(Es),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,r=this.children.length;i<r;i++){const o=this.children[i].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t){let i=[];this[e]===t&&i.push(this);for(let r=0,s=this.children.length;r<s;r++){const o=this.children[r].getObjectsByProperty(e,t);o.length>0&&(i=i.concat(o))}return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Jc,e,iee),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Jc,ree,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,r=t.length;i<r;i++){const s=t[i];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const i=this.parent;if(e===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++){const a=r[s];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON()));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let u=0,c=l.length;u<c;u++){const h=l[u];s(e.shapes,h)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,u=this.material.length;l<u;l++)a.push(s(e.materials,this.material[l]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];r.animations.push(s(e.animations,l))}}if(t){const a=o(e.geometries),l=o(e.materials),u=o(e.textures),c=o(e.images),h=o(e.shapes),d=o(e.skeletons),f=o(e.animations),p=o(e.nodes);a.length>0&&(i.geometries=a),l.length>0&&(i.materials=l),u.length>0&&(i.textures=u),c.length>0&&(i.images=c),h.length>0&&(i.shapes=h),d.length>0&&(i.skeletons=d),f.length>0&&(i.animations=f),p.length>0&&(i.nodes=p)}return i.object=r,i;function o(a){const l=[];for(const u in a){const c=a[u];delete c.metadata,l.push(c)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}}Ft.DEFAULT_UP=new z(0,1,0);Ft.DEFAULT_MATRIX_AUTO_UPDATE=!0;Ft.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const gr=new z,Ts=new z,hv=new z,Ms=new z,ql=new z,Kl=new z,iA=new z,dv=new z,fv=new z,pv=new z;let qf=!1;class br{constructor(e=new z,t=new z,i=new z){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),gr.subVectors(e,t),r.cross(gr);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){gr.subVectors(r,t),Ts.subVectors(i,t),hv.subVectors(e,t);const o=gr.dot(gr),a=gr.dot(Ts),l=gr.dot(hv),u=Ts.dot(Ts),c=Ts.dot(hv),h=o*u-a*a;if(h===0)return s.set(-2,-1,-1);const d=1/h,f=(u*l-a*c)*d,p=(o*c-a*l)*d;return s.set(1-f-p,p,f)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,Ms),Ms.x>=0&&Ms.y>=0&&Ms.x+Ms.y<=1}static getUV(e,t,i,r,s,o,a,l){return qf===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),qf=!0),this.getInterpolation(e,t,i,r,s,o,a,l)}static getInterpolation(e,t,i,r,s,o,a,l){return this.getBarycoord(e,t,i,r,Ms),l.setScalar(0),l.addScaledVector(s,Ms.x),l.addScaledVector(o,Ms.y),l.addScaledVector(a,Ms.z),l}static isFrontFacing(e,t,i,r){return gr.subVectors(i,t),Ts.subVectors(e,t),gr.cross(Ts).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return gr.subVectors(this.c,this.b),Ts.subVectors(this.a,this.b),gr.cross(Ts).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return br.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return br.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,s){return qf===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),qf=!0),br.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}getInterpolation(e,t,i,r,s){return br.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return br.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return br.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;ql.subVectors(r,i),Kl.subVectors(s,i),dv.subVectors(e,i);const l=ql.dot(dv),u=Kl.dot(dv);if(l<=0&&u<=0)return t.copy(i);fv.subVectors(e,r);const c=ql.dot(fv),h=Kl.dot(fv);if(c>=0&&h<=c)return t.copy(r);const d=l*h-c*u;if(d<=0&&l>=0&&c<=0)return o=l/(l-c),t.copy(i).addScaledVector(ql,o);pv.subVectors(e,s);const f=ql.dot(pv),p=Kl.dot(pv);if(p>=0&&f<=p)return t.copy(s);const _=f*u-l*p;if(_<=0&&u>=0&&p<=0)return a=u/(u-p),t.copy(i).addScaledVector(Kl,a);const m=c*p-f*h;if(m<=0&&h-c>=0&&f-p>=0)return iA.subVectors(s,r),a=(h-c)/(h-c+(f-p)),t.copy(r).addScaledVector(iA,a);const g=1/(m+_+d);return o=_*g,a=d*g,t.copy(i).addScaledVector(ql,o).addScaledVector(Kl,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let oee=0;class ss extends Ko{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:oee++}),this.uuid=Rr(),this.name="",this.type="Material",this.blending=Ru,this.side=Ks,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=HO,this.blendDst=zO,this.blendEquation=pu,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=wy,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=bQ,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=tv,this.stencilZFail=tv,this.stencilZPass=tv,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const i=e[t];if(i===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Ru&&(i.blending=this.blending),this.side!==Ks&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=this.alphaHash),this.alphaToCoverage===!0&&(i.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(i.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=this.flatShading),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(t!==null){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}const l2={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_r={h:0,s:0,l:0},Kf={h:0,s:0,l:0};function mv(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}class We{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(t===void 0&&i===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=nt){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,pr.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=pr.workingColorSpace){return this.r=e,this.g=t,this.b=i,pr.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=pr.workingColorSpace){if(e=dS(e,1),t=zn(t,0,1),i=zn(i,0,1),t===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=mv(o,s,e+1/3),this.g=mv(o,s,e),this.b=mv(o,s,e-1/3)}return pr.toWorkingColorSpace(this,r),this}setStyle(e,t=nt){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=nt){const i=l2[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Iu(e.r),this.g=Iu(e.g),this.b=Iu(e.b),this}copyLinearToSRGB(e){return this.r=iv(e.r),this.g=iv(e.g),this.b=iv(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=nt){return pr.fromWorkingColorSpace(Yn.copy(this),e),Math.round(zn(Yn.r*255,0,255))*65536+Math.round(zn(Yn.g*255,0,255))*256+Math.round(zn(Yn.b*255,0,255))}getHexString(e=nt){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=pr.workingColorSpace){pr.fromWorkingColorSpace(Yn.copy(this),t);const i=Yn.r,r=Yn.g,s=Yn.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let l,u;const c=(a+o)/2;if(a===o)l=0,u=0;else{const h=o-a;switch(u=c<=.5?h/(o+a):h/(2-o-a),o){case i:l=(r-s)/h+(r<s?6:0);break;case r:l=(s-i)/h+2;break;case s:l=(i-r)/h+4;break}l/=6}return e.h=l,e.s=u,e.l=c,e}getRGB(e,t=pr.workingColorSpace){return pr.fromWorkingColorSpace(Yn.copy(this),t),e.r=Yn.r,e.g=Yn.g,e.b=Yn.b,e}getStyle(e=nt){pr.fromWorkingColorSpace(Yn.copy(this),e);const t=Yn.r,i=Yn.g,r=Yn.b;return e!==nt?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(i*255)},${Math.round(r*255)})`}offsetHSL(e,t,i){return this.getHSL(_r),_r.h+=e,_r.s+=t,_r.l+=i,this.setHSL(_r.h,_r.s,_r.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(_r),e.getHSL(Kf);const i=kh(_r.h,Kf.h,t),r=kh(_r.s,Kf.s,t),s=kh(_r.l,Kf.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Yn=new We;We.NAMES=l2;class Hs extends ss{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new We(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=WO,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const _n=new z,Zf=new Ze;class Nt{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=Iy,this.updateRange={offset:0,count:-1},this.gpuType=ks,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)Zf.fromBufferAttribute(this,t),Zf.applyMatrix3(e),this.setXY(t,Zf.x,Zf.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)_n.fromBufferAttribute(this,t),_n.applyMatrix3(e),this.setXYZ(t,_n.x,_n.y,_n.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)_n.fromBufferAttribute(this,t),_n.applyMatrix4(e),this.setXYZ(t,_n.x,_n.y,_n.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)_n.fromBufferAttribute(this,t),_n.applyNormalMatrix(e),this.setXYZ(t,_n.x,_n.y,_n.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)_n.fromBufferAttribute(this,t),_n.transformDirection(e),this.setXYZ(t,_n.x,_n.y,_n.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Gs(t,this.array)),t}setX(e,t){return this.normalized&&(t=Vt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Gs(t,this.array)),t}setY(e,t){return this.normalized&&(t=Vt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Gs(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Vt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Gs(t,this.array)),t}setW(e,t){return this.normalized&&(t=Vt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Vt(t,this.array),i=Vt(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=Vt(t,this.array),i=Vt(i,this.array),r=Vt(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=Vt(t,this.array),i=Vt(i,this.array),r=Vt(r,this.array),s=Vt(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Iy&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}}class u2 extends Nt{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class c2 extends Nt{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class Ir extends Nt{constructor(e,t,i){super(new Float32Array(e),t,i)}}let aee=0;const Bi=new Qe,gv=new Ft,Zl=new z,Mi=new to,Qc=new to,Rn=new z;class kn extends Ko{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:aee++}),this.uuid=Rr(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(i2(e)?c2:u2)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const s=new Je().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Bi.makeRotationFromQuaternion(e),this.applyMatrix4(Bi),this}rotateX(e){return Bi.makeRotationX(e),this.applyMatrix4(Bi),this}rotateY(e){return Bi.makeRotationY(e),this.applyMatrix4(Bi),this}rotateZ(e){return Bi.makeRotationZ(e),this.applyMatrix4(Bi),this}translate(e,t,i){return Bi.makeTranslation(e,t,i),this.applyMatrix4(Bi),this}scale(e,t,i){return Bi.makeScale(e,t,i),this.applyMatrix4(Bi),this}lookAt(e){return gv.lookAt(e),gv.updateMatrix(),this.applyMatrix4(gv.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Zl).negate(),this.translate(Zl.x,Zl.y,Zl.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Ir(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new to);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new z(-1/0,-1/0,-1/0),new z(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++){const s=t[i];Mi.setFromBufferAttribute(s),this.morphTargetsRelative?(Rn.addVectors(this.boundingBox.min,Mi.min),this.boundingBox.expandByPoint(Rn),Rn.addVectors(this.boundingBox.max,Mi.max),this.boundingBox.expandByPoint(Rn)):(this.boundingBox.expandByPoint(Mi.min),this.boundingBox.expandByPoint(Mi.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new fs);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new z,1/0);return}if(e){const i=this.boundingSphere.center;if(Mi.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const a=t[s];Qc.setFromBufferAttribute(a),this.morphTargetsRelative?(Rn.addVectors(Mi.min,Qc.min),Mi.expandByPoint(Rn),Rn.addVectors(Mi.max,Qc.max),Mi.expandByPoint(Rn)):(Mi.expandByPoint(Qc.min),Mi.expandByPoint(Qc.max))}Mi.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)Rn.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(Rn));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let u=0,c=a.count;u<c;u++)Rn.fromBufferAttribute(a,u),l&&(Zl.fromBufferAttribute(e,u),Rn.add(Zl)),r=Math.max(r,i.distanceToSquared(Rn))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Nt(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,u=[],c=[];for(let M=0;M<a;M++)u[M]=new z,c[M]=new z;const h=new z,d=new z,f=new z,p=new Ze,_=new Ze,m=new Ze,g=new z,v=new z;function y(M,O,L){h.fromArray(r,M*3),d.fromArray(r,O*3),f.fromArray(r,L*3),p.fromArray(o,M*2),_.fromArray(o,O*2),m.fromArray(o,L*2),d.sub(h),f.sub(h),_.sub(p),m.sub(p);const C=1/(_.x*m.y-m.x*_.y);isFinite(C)&&(g.copy(d).multiplyScalar(m.y).addScaledVector(f,-_.y).multiplyScalar(C),v.copy(f).multiplyScalar(_.x).addScaledVector(d,-m.x).multiplyScalar(C),u[M].add(g),u[O].add(g),u[L].add(g),c[M].add(v),c[O].add(v),c[L].add(v))}let x=this.groups;x.length===0&&(x=[{start:0,count:i.length}]);for(let M=0,O=x.length;M<O;++M){const L=x[M],C=L.start,D=L.count;for(let B=C,W=C+D;B<W;B+=3)y(i[B+0],i[B+1],i[B+2])}const b=new z,S=new z,T=new z,P=new z;function E(M){T.fromArray(s,M*3),P.copy(T);const O=u[M];b.copy(O),b.sub(T.multiplyScalar(T.dot(O))).normalize(),S.crossVectors(P,O);const C=S.dot(c[M])<0?-1:1;l[M*4]=b.x,l[M*4+1]=b.y,l[M*4+2]=b.z,l[M*4+3]=C}for(let M=0,O=x.length;M<O;++M){const L=x[M],C=L.start,D=L.count;for(let B=C,W=C+D;B<W;B+=3)E(i[B+0]),E(i[B+1]),E(i[B+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Nt(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let d=0,f=i.count;d<f;d++)i.setXYZ(d,0,0,0);const r=new z,s=new z,o=new z,a=new z,l=new z,u=new z,c=new z,h=new z;if(e)for(let d=0,f=e.count;d<f;d+=3){const p=e.getX(d+0),_=e.getX(d+1),m=e.getX(d+2);r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,_),o.fromBufferAttribute(t,m),c.subVectors(o,s),h.subVectors(r,s),c.cross(h),a.fromBufferAttribute(i,p),l.fromBufferAttribute(i,_),u.fromBufferAttribute(i,m),a.add(c),l.add(c),u.add(c),i.setXYZ(p,a.x,a.y,a.z),i.setXYZ(_,l.x,l.y,l.z),i.setXYZ(m,u.x,u.y,u.z)}else for(let d=0,f=t.count;d<f;d+=3)r.fromBufferAttribute(t,d+0),s.fromBufferAttribute(t,d+1),o.fromBufferAttribute(t,d+2),c.subVectors(o,s),h.subVectors(r,s),c.cross(h),i.setXYZ(d+0,c.x,c.y,c.z),i.setXYZ(d+1,c.x,c.y,c.z),i.setXYZ(d+2,c.x,c.y,c.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)Rn.fromBufferAttribute(e,t),Rn.normalize(),e.setXYZ(t,Rn.x,Rn.y,Rn.z)}toNonIndexed(){function e(a,l){const u=a.array,c=a.itemSize,h=a.normalized,d=new u.constructor(l.length*c);let f=0,p=0;for(let _=0,m=l.length;_<m;_++){a.isInterleavedBufferAttribute?f=l[_]*a.data.stride+a.offset:f=l[_]*c;for(let g=0;g<c;g++)d[p++]=u[f++]}return new Nt(d,c,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new kn,i=this.index.array,r=this.attributes;for(const a in r){const l=r[a],u=e(l,i);t.setAttribute(a,u)}const s=this.morphAttributes;for(const a in s){const l=[],u=s[a];for(let c=0,h=u.length;c<h;c++){const d=u[c],f=e(d,i);l.push(f)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const u=o[a];t.addGroup(u.start,u.count,u.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const u in l)l[u]!==void 0&&(e[u]=l[u]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i){const u=i[l];e.data.attributes[l]=u.toJSON(e.data)}const r={};let s=!1;for(const l in this.morphAttributes){const u=this.morphAttributes[l],c=[];for(let h=0,d=u.length;h<d;h++){const f=u[h];c.push(f.toJSON(e.data))}c.length>0&&(r[l]=c,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(t));const r=e.attributes;for(const u in r){const c=r[u];this.setAttribute(u,c.clone(t))}const s=e.morphAttributes;for(const u in s){const c=[],h=s[u];for(let d=0,f=h.length;d<f;d++)c.push(h[d].clone(t));this.morphAttributes[u]=c}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let u=0,c=o.length;u<c;u++){const h=o[u];this.addGroup(h.start,h.count,h.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const rA=new Qe,_a=new yg,Jf=new fs,sA=new z,Jl=new z,Ql=new z,eu=new z,_v=new z,Qf=new z,ep=new Ze,tp=new Ze,np=new Ze,oA=new z,aA=new z,lA=new z,ip=new z,rp=new z;class _i extends Ft{constructor(e=new kn,t=new Hs){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const i=this.geometry,r=i.attributes.position,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(r,e);const a=this.morphTargetInfluences;if(s&&a){Qf.set(0,0,0);for(let l=0,u=s.length;l<u;l++){const c=a[l],h=s[l];c!==0&&(_v.fromBufferAttribute(h,e),o?Qf.addScaledVector(_v,c):Qf.addScaledVector(_v.sub(t),c))}t.add(Qf)}return t}raycast(e,t){const i=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),Jf.copy(i.boundingSphere),Jf.applyMatrix4(s),_a.copy(e.ray).recast(e.near),!(Jf.containsPoint(_a.origin)===!1&&(_a.intersectSphere(Jf,sA)===null||_a.origin.distanceToSquared(sA)>(e.far-e.near)**2))&&(rA.copy(s).invert(),_a.copy(e.ray).applyMatrix4(rA),!(i.boundingBox!==null&&_a.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,t,_a)))}_computeIntersections(e,t,i){let r;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,u=s.attributes.uv,c=s.attributes.uv1,h=s.attributes.normal,d=s.groups,f=s.drawRange;if(a!==null)if(Array.isArray(o))for(let p=0,_=d.length;p<_;p++){const m=d[p],g=o[m.materialIndex],v=Math.max(m.start,f.start),y=Math.min(a.count,Math.min(m.start+m.count,f.start+f.count));for(let x=v,b=y;x<b;x+=3){const S=a.getX(x),T=a.getX(x+1),P=a.getX(x+2);r=sp(this,g,e,i,u,c,h,S,T,P),r&&(r.faceIndex=Math.floor(x/3),r.face.materialIndex=m.materialIndex,t.push(r))}}else{const p=Math.max(0,f.start),_=Math.min(a.count,f.start+f.count);for(let m=p,g=_;m<g;m+=3){const v=a.getX(m),y=a.getX(m+1),x=a.getX(m+2);r=sp(this,o,e,i,u,c,h,v,y,x),r&&(r.faceIndex=Math.floor(m/3),t.push(r))}}else if(l!==void 0)if(Array.isArray(o))for(let p=0,_=d.length;p<_;p++){const m=d[p],g=o[m.materialIndex],v=Math.max(m.start,f.start),y=Math.min(l.count,Math.min(m.start+m.count,f.start+f.count));for(let x=v,b=y;x<b;x+=3){const S=x,T=x+1,P=x+2;r=sp(this,g,e,i,u,c,h,S,T,P),r&&(r.faceIndex=Math.floor(x/3),r.face.materialIndex=m.materialIndex,t.push(r))}}else{const p=Math.max(0,f.start),_=Math.min(l.count,f.start+f.count);for(let m=p,g=_;m<g;m+=3){const v=m,y=m+1,x=m+2;r=sp(this,o,e,i,u,c,h,v,y,x),r&&(r.faceIndex=Math.floor(m/3),t.push(r))}}}}function lee(n,e,t,i,r,s,o,a){let l;if(e.side===li?l=i.intersectTriangle(o,s,r,!0,a):l=i.intersectTriangle(r,s,o,e.side===Ks,a),l===null)return null;rp.copy(a),rp.applyMatrix4(n.matrixWorld);const u=t.ray.origin.distanceTo(rp);return u<t.near||u>t.far?null:{distance:u,point:rp.clone(),object:n}}function sp(n,e,t,i,r,s,o,a,l,u){n.getVertexPosition(a,Jl),n.getVertexPosition(l,Ql),n.getVertexPosition(u,eu);const c=lee(n,e,t,i,Jl,Ql,eu,ip);if(c){r&&(ep.fromBufferAttribute(r,a),tp.fromBufferAttribute(r,l),np.fromBufferAttribute(r,u),c.uv=br.getInterpolation(ip,Jl,Ql,eu,ep,tp,np,new Ze)),s&&(ep.fromBufferAttribute(s,a),tp.fromBufferAttribute(s,l),np.fromBufferAttribute(s,u),c.uv1=br.getInterpolation(ip,Jl,Ql,eu,ep,tp,np,new Ze),c.uv2=c.uv1),o&&(oA.fromBufferAttribute(o,a),aA.fromBufferAttribute(o,l),lA.fromBufferAttribute(o,u),c.normal=br.getInterpolation(ip,Jl,Ql,eu,oA,aA,lA,new z),c.normal.dot(i.direction)>0&&c.normal.multiplyScalar(-1));const h={a,b:l,c:u,normal:new z,materialIndex:0};br.getNormal(Jl,Ql,eu,h.normal),c.face=h}return c}class Gd extends kn{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],u=[],c=[],h=[];let d=0,f=0;p("z","y","x",-1,-1,i,t,e,o,s,0),p("z","y","x",1,-1,i,t,-e,o,s,1),p("x","z","y",1,1,e,i,t,r,o,2),p("x","z","y",1,-1,e,i,-t,r,o,3),p("x","y","z",1,-1,e,t,i,r,s,4),p("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new Ir(u,3)),this.setAttribute("normal",new Ir(c,3)),this.setAttribute("uv",new Ir(h,2));function p(_,m,g,v,y,x,b,S,T,P,E){const M=x/T,O=b/P,L=x/2,C=b/2,D=S/2,B=T+1,W=P+1;let U=0,$=0;const J=new z;for(let j=0;j<W;j++){const F=j*O-C;for(let X=0;X<B;X++){const re=X*M-L;J[_]=re*v,J[m]=F*y,J[g]=D,u.push(J.x,J.y,J.z),J[_]=0,J[m]=0,J[g]=S>0?1:-1,c.push(J.x,J.y,J.z),h.push(X/T),h.push(1-j/P),U+=1}}for(let j=0;j<P;j++)for(let F=0;F<T;F++){const X=d+F+B*j,re=d+F+B*(j+1),ce=d+(F+1)+B*(j+1),ve=d+(F+1)+B*j;l.push(X,re,ve),l.push(re,ce,ve),$+=6}a.addGroup(f,$,E),f+=$,d+=U}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Gd(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function ac(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():Array.isArray(r)?e[t][i]=r.slice():e[t][i]=r}}return e}function ri(n){const e={};for(let t=0;t<n.length;t++){const i=ac(n[t]);for(const r in i)e[r]=i[r]}return e}function uee(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function h2(n){return n.getRenderTarget()===null?n.outputColorSpace:cs}const d2={clone:ac,merge:ri};var cee=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,hee=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class jo extends ss{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=cee,this.fragmentShader=hee,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=ac(e.uniforms),this.uniformsGroups=uee(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?t.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[r]={type:"m4",value:o.toArray()}:t.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class f2 extends Ft{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Qe,this.projectionMatrix=new Qe,this.projectionMatrixInverse=new Qe,this.coordinateSystem=Vs}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class si extends f2{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=oc*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Bh*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return oc*2*Math.atan(Math.tan(Bh*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Bh*.5*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,u=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*i/u,r*=o.width/l,i*=o.height/u}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const tu=-90,nu=1;class dee extends Ft{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null;const r=new si(tu,nu,e,t);r.layers=this.layers,this.add(r);const s=new si(tu,nu,e,t);s.layers=this.layers,this.add(s);const o=new si(tu,nu,e,t);o.layers=this.layers,this.add(o);const a=new si(tu,nu,e,t);a.layers=this.layers,this.add(a);const l=new si(tu,nu,e,t);l.layers=this.layers,this.add(l);const u=new si(tu,nu,e,t);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,s,o,a,l]=t;for(const u of t)this.remove(u);if(e===Vs)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===pm)i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const u of t)this.add(u),u.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const i=this.renderTarget;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[r,s,o,a,l,u]=this.children,c=e.getRenderTarget(),h=e.toneMapping,d=e.xr.enabled;e.toneMapping=js,e.xr.enabled=!1;const f=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,r),e.setRenderTarget(i,1),e.render(t,s),e.setRenderTarget(i,2),e.render(t,o),e.setRenderTarget(i,3),e.render(t,a),e.setRenderTarget(i,4),e.render(t,l),i.texture.generateMipmaps=f,e.setRenderTarget(i,5),e.render(t,u),e.setRenderTarget(c),e.toneMapping=h,e.xr.enabled=d,i.texture.needsPMREMUpdate=!0}}class p2 extends jn{constructor(e,t,i,r,s,o,a,l,u,c){e=e!==void 0?e:[],t=t!==void 0?t:tc,super(e,t,i,r,s,o,a,l,u,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class fee extends ml{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];t.encoding!==void 0&&(Vh("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===ko?nt:ll),this.texture=new p2(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:mi}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new Gd(5,5,5),s=new jo({name:"CubemapFromEquirect",uniforms:ac(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:li,blending:Uo});s.uniforms.tEquirect.value=t;const o=new _i(r,s),a=t.minFilter;return t.minFilter===pl&&(t.minFilter=mi),new dee(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}const vv=new z,pee=new z,mee=new Je;class Da{constructor(e=new z(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=vv.subVectors(i,t).cross(pee.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(vv),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||mee.getNormalMatrix(e),r=this.coplanarPoint(vv).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const va=new fs,op=new z;class fS{constructor(e=new Da,t=new Da,i=new Da,r=new Da,s=new Da,o=new Da){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=Vs){const i=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],l=r[3],u=r[4],c=r[5],h=r[6],d=r[7],f=r[8],p=r[9],_=r[10],m=r[11],g=r[12],v=r[13],y=r[14],x=r[15];if(i[0].setComponents(l-s,d-u,m-f,x-g).normalize(),i[1].setComponents(l+s,d+u,m+f,x+g).normalize(),i[2].setComponents(l+o,d+c,m+p,x+v).normalize(),i[3].setComponents(l-o,d-c,m-p,x-v).normalize(),i[4].setComponents(l-a,d-h,m-_,x-y).normalize(),t===Vs)i[5].setComponents(l+a,d+h,m+_,x+y).normalize();else if(t===pm)i[5].setComponents(a,h,_,y).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),va.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),va.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(va)}intersectsSprite(e){return va.center.set(0,0,0),va.radius=.7071067811865476,va.applyMatrix4(e.matrixWorld),this.intersectsSphere(va)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(op.x=r.normal.x>0?e.max.x:e.min.x,op.y=r.normal.y>0?e.max.y:e.min.y,op.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(op)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function m2(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function gee(n,e){const t=e.isWebGL2,i=new WeakMap;function r(u,c){const h=u.array,d=u.usage,f=n.createBuffer();n.bindBuffer(c,f),n.bufferData(c,h,d),u.onUploadCallback();let p;if(h instanceof Float32Array)p=n.FLOAT;else if(h instanceof Uint16Array)if(u.isFloat16BufferAttribute)if(t)p=n.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else p=n.UNSIGNED_SHORT;else if(h instanceof Int16Array)p=n.SHORT;else if(h instanceof Uint32Array)p=n.UNSIGNED_INT;else if(h instanceof Int32Array)p=n.INT;else if(h instanceof Int8Array)p=n.BYTE;else if(h instanceof Uint8Array)p=n.UNSIGNED_BYTE;else if(h instanceof Uint8ClampedArray)p=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);return{buffer:f,type:p,bytesPerElement:h.BYTES_PER_ELEMENT,version:u.version}}function s(u,c,h){const d=c.array,f=c.updateRange;n.bindBuffer(h,u),f.count===-1?n.bufferSubData(h,0,d):(t?n.bufferSubData(h,f.offset*d.BYTES_PER_ELEMENT,d,f.offset,f.count):n.bufferSubData(h,f.offset*d.BYTES_PER_ELEMENT,d.subarray(f.offset,f.offset+f.count)),f.count=-1),c.onUploadCallback()}function o(u){return u.isInterleavedBufferAttribute&&(u=u.data),i.get(u)}function a(u){u.isInterleavedBufferAttribute&&(u=u.data);const c=i.get(u);c&&(n.deleteBuffer(c.buffer),i.delete(u))}function l(u,c){if(u.isGLBufferAttribute){const d=i.get(u);(!d||d.version<u.version)&&i.set(u,{buffer:u.buffer,type:u.type,bytesPerElement:u.elementSize,version:u.version});return}u.isInterleavedBufferAttribute&&(u=u.data);const h=i.get(u);h===void 0?i.set(u,r(u,c)):h.version<u.version&&(s(h.buffer,u,c),h.version=u.version)}return{get:o,remove:a,update:l}}class pS extends kn{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),l=Math.floor(r),u=a+1,c=l+1,h=e/a,d=t/l,f=[],p=[],_=[],m=[];for(let g=0;g<c;g++){const v=g*d-o;for(let y=0;y<u;y++){const x=y*h-s;p.push(x,-v,0),_.push(0,0,1),m.push(y/a),m.push(1-g/l)}}for(let g=0;g<l;g++)for(let v=0;v<a;v++){const y=v+u*g,x=v+u*(g+1),b=v+1+u*(g+1),S=v+1+u*g;f.push(y,x,S),f.push(x,b,S)}this.setIndex(f),this.setAttribute("position",new Ir(p,3)),this.setAttribute("normal",new Ir(_,3)),this.setAttribute("uv",new Ir(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new pS(e.width,e.height,e.widthSegments,e.heightSegments)}}var _ee=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,vee=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,yee=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,xee=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,bee=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,See=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Eee=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,Tee=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Mee=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,wee=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Aee=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,Pee=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,Cee=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Ree=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,Iee=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Lee=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Oee=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Dee=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Fee=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,Nee=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,Uee=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,Bee=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,kee=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Vee=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Gee=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Hee=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,zee=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Wee=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Xee="gl_FragColor = linearToOutputTexel( gl_FragColor );",jee=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,$ee=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Yee=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,qee=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Kee=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Zee=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Jee=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Qee=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,ete=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,tte=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,nte=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,ite=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,rte=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,ste=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,ote=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,ate=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,lte=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,ute=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,cte=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,hte=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,dte=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,fte=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	anisotropyV /= material.anisotropy;
	material.anisotropy = saturate( material.anisotropy );
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;
#endif`,pte=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,mte=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,gte=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometry.viewDir, geometry.normal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,_te=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,vte=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,yte=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,xte=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,bte=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,Ste=`#ifdef USE_MAP
	diffuseColor *= texture2D( map, vMapUv );
#endif`,Ete=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,Tte=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Mte=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,wte=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Ate=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Pte=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Cte=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,Rte=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,Ite=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,Lte=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 geometryNormal = normal;`,Ote=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Dte=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Fte=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Nte=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Ute=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,Bte=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,kte=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,Vte=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,Gte=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Hte=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,zte=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,Wte=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Xte=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,jte=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,$te=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Yte=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,qte=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Kte=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,Zte=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Jte=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,Qte=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,ene=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,tne=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,nne=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,ine=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,rne=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,sne=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,one=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,ane=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,lne=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,une=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,cne=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,hne=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,dne=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,fne=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const pne=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,mne=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,gne=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,_ne=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vne=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,yne=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,xne=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,bne=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,Sne=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Ene=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Tne=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Mne=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,wne=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Ane=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Pne=`#include <common>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Cne=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Rne=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Ine=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Lne=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,One=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Dne=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Fne=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,Nne=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Une=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Bne=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,kne=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Vne=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Gne=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Hne=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,zne=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Wne=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Xne=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,jne=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,$ne=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,ht={alphahash_fragment:_ee,alphahash_pars_fragment:vee,alphamap_fragment:yee,alphamap_pars_fragment:xee,alphatest_fragment:bee,alphatest_pars_fragment:See,aomap_fragment:Eee,aomap_pars_fragment:Tee,begin_vertex:Mee,beginnormal_vertex:wee,bsdfs:Aee,iridescence_fragment:Pee,bumpmap_pars_fragment:Cee,clipping_planes_fragment:Ree,clipping_planes_pars_fragment:Iee,clipping_planes_pars_vertex:Lee,clipping_planes_vertex:Oee,color_fragment:Dee,color_pars_fragment:Fee,color_pars_vertex:Nee,color_vertex:Uee,common:Bee,cube_uv_reflection_fragment:kee,defaultnormal_vertex:Vee,displacementmap_pars_vertex:Gee,displacementmap_vertex:Hee,emissivemap_fragment:zee,emissivemap_pars_fragment:Wee,colorspace_fragment:Xee,colorspace_pars_fragment:jee,envmap_fragment:$ee,envmap_common_pars_fragment:Yee,envmap_pars_fragment:qee,envmap_pars_vertex:Kee,envmap_physical_pars_fragment:lte,envmap_vertex:Zee,fog_vertex:Jee,fog_pars_vertex:Qee,fog_fragment:ete,fog_pars_fragment:tte,gradientmap_pars_fragment:nte,lightmap_fragment:ite,lightmap_pars_fragment:rte,lights_lambert_fragment:ste,lights_lambert_pars_fragment:ote,lights_pars_begin:ate,lights_toon_fragment:ute,lights_toon_pars_fragment:cte,lights_phong_fragment:hte,lights_phong_pars_fragment:dte,lights_physical_fragment:fte,lights_physical_pars_fragment:pte,lights_fragment_begin:mte,lights_fragment_maps:gte,lights_fragment_end:_te,logdepthbuf_fragment:vte,logdepthbuf_pars_fragment:yte,logdepthbuf_pars_vertex:xte,logdepthbuf_vertex:bte,map_fragment:Ste,map_pars_fragment:Ete,map_particle_fragment:Tte,map_particle_pars_fragment:Mte,metalnessmap_fragment:wte,metalnessmap_pars_fragment:Ate,morphcolor_vertex:Pte,morphnormal_vertex:Cte,morphtarget_pars_vertex:Rte,morphtarget_vertex:Ite,normal_fragment_begin:Lte,normal_fragment_maps:Ote,normal_pars_fragment:Dte,normal_pars_vertex:Fte,normal_vertex:Nte,normalmap_pars_fragment:Ute,clearcoat_normal_fragment_begin:Bte,clearcoat_normal_fragment_maps:kte,clearcoat_pars_fragment:Vte,iridescence_pars_fragment:Gte,opaque_fragment:Hte,packing:zte,premultiplied_alpha_fragment:Wte,project_vertex:Xte,dithering_fragment:jte,dithering_pars_fragment:$te,roughnessmap_fragment:Yte,roughnessmap_pars_fragment:qte,shadowmap_pars_fragment:Kte,shadowmap_pars_vertex:Zte,shadowmap_vertex:Jte,shadowmask_pars_fragment:Qte,skinbase_vertex:ene,skinning_pars_vertex:tne,skinning_vertex:nne,skinnormal_vertex:ine,specularmap_fragment:rne,specularmap_pars_fragment:sne,tonemapping_fragment:one,tonemapping_pars_fragment:ane,transmission_fragment:lne,transmission_pars_fragment:une,uv_pars_fragment:cne,uv_pars_vertex:hne,uv_vertex:dne,worldpos_vertex:fne,background_vert:pne,background_frag:mne,backgroundCube_vert:gne,backgroundCube_frag:_ne,cube_vert:vne,cube_frag:yne,depth_vert:xne,depth_frag:bne,distanceRGBA_vert:Sne,distanceRGBA_frag:Ene,equirect_vert:Tne,equirect_frag:Mne,linedashed_vert:wne,linedashed_frag:Ane,meshbasic_vert:Pne,meshbasic_frag:Cne,meshlambert_vert:Rne,meshlambert_frag:Ine,meshmatcap_vert:Lne,meshmatcap_frag:One,meshnormal_vert:Dne,meshnormal_frag:Fne,meshphong_vert:Nne,meshphong_frag:Une,meshphysical_vert:Bne,meshphysical_frag:kne,meshtoon_vert:Vne,meshtoon_frag:Gne,points_vert:Hne,points_frag:zne,shadow_vert:Wne,shadow_frag:Xne,sprite_vert:jne,sprite_frag:$ne},Pe={common:{diffuse:{value:new We(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Je},alphaMap:{value:null},alphaMapTransform:{value:new Je},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Je}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Je}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Je}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Je},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Je},normalScale:{value:new Ze(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Je},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Je}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Je}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Je}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new We(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new We(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Je},alphaTest:{value:0},uvTransform:{value:new Je}},sprite:{diffuse:{value:new We(16777215)},opacity:{value:1},center:{value:new Ze(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Je},alphaMap:{value:null},alphaMapTransform:{value:new Je},alphaTest:{value:0}}},Jr={basic:{uniforms:ri([Pe.common,Pe.specularmap,Pe.envmap,Pe.aomap,Pe.lightmap,Pe.fog]),vertexShader:ht.meshbasic_vert,fragmentShader:ht.meshbasic_frag},lambert:{uniforms:ri([Pe.common,Pe.specularmap,Pe.envmap,Pe.aomap,Pe.lightmap,Pe.emissivemap,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,Pe.fog,Pe.lights,{emissive:{value:new We(0)}}]),vertexShader:ht.meshlambert_vert,fragmentShader:ht.meshlambert_frag},phong:{uniforms:ri([Pe.common,Pe.specularmap,Pe.envmap,Pe.aomap,Pe.lightmap,Pe.emissivemap,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,Pe.fog,Pe.lights,{emissive:{value:new We(0)},specular:{value:new We(1118481)},shininess:{value:30}}]),vertexShader:ht.meshphong_vert,fragmentShader:ht.meshphong_frag},standard:{uniforms:ri([Pe.common,Pe.envmap,Pe.aomap,Pe.lightmap,Pe.emissivemap,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,Pe.roughnessmap,Pe.metalnessmap,Pe.fog,Pe.lights,{emissive:{value:new We(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ht.meshphysical_vert,fragmentShader:ht.meshphysical_frag},toon:{uniforms:ri([Pe.common,Pe.aomap,Pe.lightmap,Pe.emissivemap,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,Pe.gradientmap,Pe.fog,Pe.lights,{emissive:{value:new We(0)}}]),vertexShader:ht.meshtoon_vert,fragmentShader:ht.meshtoon_frag},matcap:{uniforms:ri([Pe.common,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,Pe.fog,{matcap:{value:null}}]),vertexShader:ht.meshmatcap_vert,fragmentShader:ht.meshmatcap_frag},points:{uniforms:ri([Pe.points,Pe.fog]),vertexShader:ht.points_vert,fragmentShader:ht.points_frag},dashed:{uniforms:ri([Pe.common,Pe.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ht.linedashed_vert,fragmentShader:ht.linedashed_frag},depth:{uniforms:ri([Pe.common,Pe.displacementmap]),vertexShader:ht.depth_vert,fragmentShader:ht.depth_frag},normal:{uniforms:ri([Pe.common,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,{opacity:{value:1}}]),vertexShader:ht.meshnormal_vert,fragmentShader:ht.meshnormal_frag},sprite:{uniforms:ri([Pe.sprite,Pe.fog]),vertexShader:ht.sprite_vert,fragmentShader:ht.sprite_frag},background:{uniforms:{uvTransform:{value:new Je},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ht.background_vert,fragmentShader:ht.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:ht.backgroundCube_vert,fragmentShader:ht.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ht.cube_vert,fragmentShader:ht.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ht.equirect_vert,fragmentShader:ht.equirect_frag},distanceRGBA:{uniforms:ri([Pe.common,Pe.displacementmap,{referencePosition:{value:new z},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ht.distanceRGBA_vert,fragmentShader:ht.distanceRGBA_frag},shadow:{uniforms:ri([Pe.lights,Pe.fog,{color:{value:new We(0)},opacity:{value:1}}]),vertexShader:ht.shadow_vert,fragmentShader:ht.shadow_frag}};Jr.physical={uniforms:ri([Jr.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Je},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Je},clearcoatNormalScale:{value:new Ze(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Je},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Je},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Je},sheen:{value:0},sheenColor:{value:new We(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Je},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Je},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Je},transmissionSamplerSize:{value:new Ze},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Je},attenuationDistance:{value:0},attenuationColor:{value:new We(0)},specularColor:{value:new We(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Je},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Je},anisotropyVector:{value:new Ze},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Je}}]),vertexShader:ht.meshphysical_vert,fragmentShader:ht.meshphysical_frag};const ap={r:0,b:0,g:0};function Yne(n,e,t,i,r,s,o){const a=new We(0);let l=s===!0?0:1,u,c,h=null,d=0,f=null;function p(m,g){let v=!1,y=g.isScene===!0?g.background:null;switch(y&&y.isTexture&&(y=(g.backgroundBlurriness>0?t:e).get(y)),y===null?_(a,l):y&&y.isColor&&(_(y,1),v=!0),n.xr.getEnvironmentBlendMode()){case"opaque":v=!0;break;case"additive":i.buffers.color.setClear(0,0,0,1,o),v=!0;break;case"alpha-blend":i.buffers.color.setClear(0,0,0,0,o),v=!0;break}(n.autoClear||v)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),y&&(y.isCubeTexture||y.mapping===vg)?(c===void 0&&(c=new _i(new Gd(1,1,1),new jo({name:"BackgroundCubeMaterial",uniforms:ac(Jr.backgroundCube.uniforms),vertexShader:Jr.backgroundCube.vertexShader,fragmentShader:Jr.backgroundCube.fragmentShader,side:li,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(S,T,P){this.matrixWorld.copyPosition(P.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(c)),c.material.uniforms.envMap.value=y,c.material.uniforms.flipEnvMap.value=y.isCubeTexture&&y.isRenderTargetTexture===!1?-1:1,c.material.uniforms.backgroundBlurriness.value=g.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=g.backgroundIntensity,c.material.toneMapped=y.colorSpace!==nt,(h!==y||d!==y.version||f!==n.toneMapping)&&(c.material.needsUpdate=!0,h=y,d=y.version,f=n.toneMapping),c.layers.enableAll(),m.unshift(c,c.geometry,c.material,0,0,null)):y&&y.isTexture&&(u===void 0&&(u=new _i(new pS(2,2),new jo({name:"BackgroundMaterial",uniforms:ac(Jr.background.uniforms),vertexShader:Jr.background.vertexShader,fragmentShader:Jr.background.fragmentShader,side:Ks,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(u)),u.material.uniforms.t2D.value=y,u.material.uniforms.backgroundIntensity.value=g.backgroundIntensity,u.material.toneMapped=y.colorSpace!==nt,y.matrixAutoUpdate===!0&&y.updateMatrix(),u.material.uniforms.uvTransform.value.copy(y.matrix),(h!==y||d!==y.version||f!==n.toneMapping)&&(u.material.needsUpdate=!0,h=y,d=y.version,f=n.toneMapping),u.layers.enableAll(),m.unshift(u,u.geometry,u.material,0,0,null))}function _(m,g){m.getRGB(ap,h2(n)),i.buffers.color.setClear(ap.r,ap.g,ap.b,g,o)}return{getClearColor:function(){return a},setClearColor:function(m,g=1){a.set(m),l=g,_(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(m){l=m,_(a,l)},render:p}}function qne(n,e,t,i){const r=n.getParameter(n.MAX_VERTEX_ATTRIBS),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||s!==null,a={},l=m(null);let u=l,c=!1;function h(D,B,W,U,$){let J=!1;if(o){const j=_(U,W,B);u!==j&&(u=j,f(u.object)),J=g(D,U,W,$),J&&v(D,U,W,$)}else{const j=B.wireframe===!0;(u.geometry!==U.id||u.program!==W.id||u.wireframe!==j)&&(u.geometry=U.id,u.program=W.id,u.wireframe=j,J=!0)}$!==null&&t.update($,n.ELEMENT_ARRAY_BUFFER),(J||c)&&(c=!1,P(D,B,W,U),$!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get($).buffer))}function d(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}function f(D){return i.isWebGL2?n.bindVertexArray(D):s.bindVertexArrayOES(D)}function p(D){return i.isWebGL2?n.deleteVertexArray(D):s.deleteVertexArrayOES(D)}function _(D,B,W){const U=W.wireframe===!0;let $=a[D.id];$===void 0&&($={},a[D.id]=$);let J=$[B.id];J===void 0&&(J={},$[B.id]=J);let j=J[U];return j===void 0&&(j=m(d()),J[U]=j),j}function m(D){const B=[],W=[],U=[];for(let $=0;$<r;$++)B[$]=0,W[$]=0,U[$]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:B,enabledAttributes:W,attributeDivisors:U,object:D,attributes:{},index:null}}function g(D,B,W,U){const $=u.attributes,J=B.attributes;let j=0;const F=W.getAttributes();for(const X in F)if(F[X].location>=0){const ce=$[X];let ve=J[X];if(ve===void 0&&(X==="instanceMatrix"&&D.instanceMatrix&&(ve=D.instanceMatrix),X==="instanceColor"&&D.instanceColor&&(ve=D.instanceColor)),ce===void 0||ce.attribute!==ve||ve&&ce.data!==ve.data)return!0;j++}return u.attributesNum!==j||u.index!==U}function v(D,B,W,U){const $={},J=B.attributes;let j=0;const F=W.getAttributes();for(const X in F)if(F[X].location>=0){let ce=J[X];ce===void 0&&(X==="instanceMatrix"&&D.instanceMatrix&&(ce=D.instanceMatrix),X==="instanceColor"&&D.instanceColor&&(ce=D.instanceColor));const ve={};ve.attribute=ce,ce&&ce.data&&(ve.data=ce.data),$[X]=ve,j++}u.attributes=$,u.attributesNum=j,u.index=U}function y(){const D=u.newAttributes;for(let B=0,W=D.length;B<W;B++)D[B]=0}function x(D){b(D,0)}function b(D,B){const W=u.newAttributes,U=u.enabledAttributes,$=u.attributeDivisors;W[D]=1,U[D]===0&&(n.enableVertexAttribArray(D),U[D]=1),$[D]!==B&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](D,B),$[D]=B)}function S(){const D=u.newAttributes,B=u.enabledAttributes;for(let W=0,U=B.length;W<U;W++)B[W]!==D[W]&&(n.disableVertexAttribArray(W),B[W]=0)}function T(D,B,W,U,$,J,j){j===!0?n.vertexAttribIPointer(D,B,W,$,J):n.vertexAttribPointer(D,B,W,U,$,J)}function P(D,B,W,U){if(i.isWebGL2===!1&&(D.isInstancedMesh||U.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;y();const $=U.attributes,J=W.getAttributes(),j=B.defaultAttributeValues;for(const F in J){const X=J[F];if(X.location>=0){let re=$[F];if(re===void 0&&(F==="instanceMatrix"&&D.instanceMatrix&&(re=D.instanceMatrix),F==="instanceColor"&&D.instanceColor&&(re=D.instanceColor)),re!==void 0){const ce=re.normalized,ve=re.itemSize,ae=t.get(re);if(ae===void 0)continue;const Y=ae.buffer,ne=ae.type,he=ae.bytesPerElement,xe=i.isWebGL2===!0&&(ne===n.INT||ne===n.UNSIGNED_INT||re.gpuType===$O);if(re.isInterleavedBufferAttribute){const be=re.data,w=be.stride,V=re.offset;if(be.isInstancedInterleavedBuffer){for(let H=0;H<X.locationSize;H++)b(X.location+H,be.meshPerAttribute);D.isInstancedMesh!==!0&&U._maxInstanceCount===void 0&&(U._maxInstanceCount=be.meshPerAttribute*be.count)}else for(let H=0;H<X.locationSize;H++)x(X.location+H);n.bindBuffer(n.ARRAY_BUFFER,Y);for(let H=0;H<X.locationSize;H++)T(X.location+H,ve/X.locationSize,ne,ce,w*he,(V+ve/X.locationSize*H)*he,xe)}else{if(re.isInstancedBufferAttribute){for(let be=0;be<X.locationSize;be++)b(X.location+be,re.meshPerAttribute);D.isInstancedMesh!==!0&&U._maxInstanceCount===void 0&&(U._maxInstanceCount=re.meshPerAttribute*re.count)}else for(let be=0;be<X.locationSize;be++)x(X.location+be);n.bindBuffer(n.ARRAY_BUFFER,Y);for(let be=0;be<X.locationSize;be++)T(X.location+be,ve/X.locationSize,ne,ce,ve*he,ve/X.locationSize*be*he,xe)}}else if(j!==void 0){const ce=j[F];if(ce!==void 0)switch(ce.length){case 2:n.vertexAttrib2fv(X.location,ce);break;case 3:n.vertexAttrib3fv(X.location,ce);break;case 4:n.vertexAttrib4fv(X.location,ce);break;default:n.vertexAttrib1fv(X.location,ce)}}}}S()}function E(){L();for(const D in a){const B=a[D];for(const W in B){const U=B[W];for(const $ in U)p(U[$].object),delete U[$];delete B[W]}delete a[D]}}function M(D){if(a[D.id]===void 0)return;const B=a[D.id];for(const W in B){const U=B[W];for(const $ in U)p(U[$].object),delete U[$];delete B[W]}delete a[D.id]}function O(D){for(const B in a){const W=a[B];if(W[D.id]===void 0)continue;const U=W[D.id];for(const $ in U)p(U[$].object),delete U[$];delete W[D.id]}}function L(){C(),c=!0,u!==l&&(u=l,f(u.object))}function C(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:h,reset:L,resetDefaultState:C,dispose:E,releaseStatesOfGeometry:M,releaseStatesOfProgram:O,initAttributes:y,enableAttribute:x,disableUnusedAttributes:S}}function Kne(n,e,t,i){const r=i.isWebGL2;let s;function o(u){s=u}function a(u,c){n.drawArrays(s,u,c),t.update(c,s,1)}function l(u,c,h){if(h===0)return;let d,f;if(r)d=n,f="drawArraysInstanced";else if(d=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",d===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}d[f](s,u,c,h),t.update(c,s,h)}this.setMode=o,this.render=a,this.renderInstances=l}function Zne(n,e,t){let i;function r(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const T=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(T.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function s(T){if(T==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";T="mediump"}return T==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&n.constructor.name==="WebGL2RenderingContext";let a=t.precision!==void 0?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const u=o||e.has("WEBGL_draw_buffers"),c=t.logarithmicDepthBuffer===!0,h=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),d=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),f=n.getParameter(n.MAX_TEXTURE_SIZE),p=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),_=n.getParameter(n.MAX_VERTEX_ATTRIBS),m=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),g=n.getParameter(n.MAX_VARYING_VECTORS),v=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),y=d>0,x=o||e.has("OES_texture_float"),b=y&&x,S=o?n.getParameter(n.MAX_SAMPLES):0;return{isWebGL2:o,drawBuffers:u,getMaxAnisotropy:r,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:c,maxTextures:h,maxVertexTextures:d,maxTextureSize:f,maxCubemapSize:p,maxAttributes:_,maxVertexUniforms:m,maxVaryings:g,maxFragmentUniforms:v,vertexTextures:y,floatFragmentTextures:x,floatVertexTextures:b,maxSamples:S}}function Jne(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new Da,a=new Je,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,d){const f=h.length!==0||d||i!==0||r;return r=d,i=h.length,f},this.beginShadows=function(){s=!0,c(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(h,d){t=c(h,d,0)},this.setState=function(h,d,f){const p=h.clippingPlanes,_=h.clipIntersection,m=h.clipShadows,g=n.get(h);if(!r||p===null||p.length===0||s&&!m)s?c(null):u();else{const v=s?0:i,y=v*4;let x=g.clippingState||null;l.value=x,x=c(p,d,y,f);for(let b=0;b!==y;++b)x[b]=t[b];g.clippingState=x,this.numIntersection=_?this.numPlanes:0,this.numPlanes+=v}};function u(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function c(h,d,f,p){const _=h!==null?h.length:0;let m=null;if(_!==0){if(m=l.value,p!==!0||m===null){const g=f+_*4,v=d.matrixWorldInverse;a.getNormalMatrix(v),(m===null||m.length<g)&&(m=new Float32Array(g));for(let y=0,x=f;y!==_;++y,x+=4)o.copy(h[y]).applyMatrix4(v,a),o.normal.toArray(m,x),m[x+3]=o.constant}l.value=m,l.needsUpdate=!0}return e.numPlanes=_,e.numIntersection=0,m}}function Qne(n){let e=new WeakMap;function t(o,a){return a===Ay?o.mapping=tc:a===Py&&(o.mapping=nc),o}function i(o){if(o&&o.isTexture&&o.isRenderTargetTexture===!1){const a=o.mapping;if(a===Ay||a===Py)if(e.has(o)){const l=e.get(o).texture;return t(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const u=new fee(l.height/2);return u.fromEquirectangularTexture(n,o),e.set(o,u),o.addEventListener("dispose",r),t(u.texture,o.mapping)}else return null}}return o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}class mS extends f2{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,l=r-t;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=u*this.view.offsetX,o=s+u*this.view.width,a-=c*this.view.offsetY,l=a-c*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const xu=4,uA=[.125,.215,.35,.446,.526,.582],Ha=20,yv=new mS,cA=new We;let xv=null;const Fa=(1+Math.sqrt(5))/2,iu=1/Fa,hA=[new z(1,1,1),new z(-1,1,1),new z(1,1,-1),new z(-1,1,-1),new z(0,Fa,iu),new z(0,Fa,-iu),new z(iu,0,Fa),new z(-iu,0,Fa),new z(Fa,iu,0),new z(-Fa,iu,0)];class dA{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){xv=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=mA(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=pA(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(xv),e.scissorTest=!1,lp(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===tc||e.mapping===nc?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),xv=this._renderer.getRenderTarget();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:mi,minFilter:mi,generateMipmaps:!1,type:Ed,format:Zi,colorSpace:cs,depthBuffer:!1},r=fA(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=fA(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=eie(s)),this._blurMaterial=tie(s,e,t)}return r}_compileMaterial(e){const t=new _i(this._lodPlanes[0],e);this._renderer.compile(t,yv)}_sceneToCubeUV(e,t,i,r){const a=new si(90,1,t,i),l=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],c=this._renderer,h=c.autoClear,d=c.toneMapping;c.getClearColor(cA),c.toneMapping=js,c.autoClear=!1;const f=new Hs({name:"PMREM.Background",side:li,depthWrite:!1,depthTest:!1}),p=new _i(new Gd,f);let _=!1;const m=e.background;m?m.isColor&&(f.color.copy(m),e.background=null,_=!0):(f.color.copy(cA),_=!0);for(let g=0;g<6;g++){const v=g%3;v===0?(a.up.set(0,l[g],0),a.lookAt(u[g],0,0)):v===1?(a.up.set(0,0,l[g]),a.lookAt(0,u[g],0)):(a.up.set(0,l[g],0),a.lookAt(0,0,u[g]));const y=this._cubeSize;lp(r,v*y,g>2?y:0,y,y),c.setRenderTarget(r),_&&c.render(p,a),c.render(e,a)}p.geometry.dispose(),p.material.dispose(),c.toneMapping=d,c.autoClear=h,e.background=m}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===tc||e.mapping===nc;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=mA()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=pA());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new _i(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;lp(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(o,yv)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),o=hA[(r-1)%hA.length];this._blur(e,r-1,r,s,o)}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const l=this._renderer,u=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const c=3,h=new _i(this._lodPlanes[r],u),d=u.uniforms,f=this._sizeLods[i]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/(2*Ha-1),_=s/p,m=isFinite(s)?1+Math.floor(c*_):Ha;m>Ha&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${m} samples when the maximum is set to ${Ha}`);const g=[];let v=0;for(let T=0;T<Ha;++T){const P=T/_,E=Math.exp(-P*P/2);g.push(E),T===0?v+=E:T<m&&(v+=2*E)}for(let T=0;T<g.length;T++)g[T]=g[T]/v;d.envMap.value=e.texture,d.samples.value=m,d.weights.value=g,d.latitudinal.value=o==="latitudinal",a&&(d.poleAxis.value=a);const{_lodMax:y}=this;d.dTheta.value=p,d.mipInt.value=y-i;const x=this._sizeLods[r],b=3*x*(r>y-xu?r-y+xu:0),S=4*(this._cubeSize-x);lp(t,b,S,3*x,2*x),l.setRenderTarget(t),l.render(h,yv)}}function eie(n){const e=[],t=[],i=[];let r=n;const s=n-xu+1+uA.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>n-xu?l=uA[o-n+xu-1]:o===0&&(l=0),i.push(l);const u=1/(a-2),c=-u,h=1+u,d=[c,c,h,c,h,h,c,c,h,h,c,h],f=6,p=6,_=3,m=2,g=1,v=new Float32Array(_*p*f),y=new Float32Array(m*p*f),x=new Float32Array(g*p*f);for(let S=0;S<f;S++){const T=S%3*2/3-1,P=S>2?0:-1,E=[T,P,0,T+2/3,P,0,T+2/3,P+1,0,T,P,0,T+2/3,P+1,0,T,P+1,0];v.set(E,_*p*S),y.set(d,m*p*S);const M=[S,S,S,S,S,S];x.set(M,g*p*S)}const b=new kn;b.setAttribute("position",new Nt(v,_)),b.setAttribute("uv",new Nt(y,m)),b.setAttribute("faceIndex",new Nt(x,g)),e.push(b),r>xu&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}function fA(n,e,t){const i=new ml(n,e,t);return i.texture.mapping=vg,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function lp(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function tie(n,e,t){const i=new Float32Array(Ha),r=new z(0,1,0);return new jo({name:"SphericalGaussianBlur",defines:{n:Ha,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:gS(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Uo,depthTest:!1,depthWrite:!1})}function pA(){return new jo({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:gS(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Uo,depthTest:!1,depthWrite:!1})}function mA(){return new jo({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:gS(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Uo,depthTest:!1,depthWrite:!1})}function gS(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function nie(n){let e=new WeakMap,t=null;function i(a){if(a&&a.isTexture){const l=a.mapping,u=l===Ay||l===Py,c=l===tc||l===nc;if(u||c)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let h=e.get(a);return t===null&&(t=new dA(n)),h=u?t.fromEquirectangular(a,h):t.fromCubemap(a,h),e.set(a,h),h.texture}else{if(e.has(a))return e.get(a).texture;{const h=a.image;if(u&&h&&h.height>0||c&&h&&r(h)){t===null&&(t=new dA(n));const d=u?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,d),a.addEventListener("dispose",s),d.texture}else return null}}}return a}function r(a){let l=0;const u=6;for(let c=0;c<u;c++)a[c]!==void 0&&l++;return l===u}function s(a){const l=a.target;l.removeEventListener("dispose",s);const u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:i,dispose:o}}function iie(n){const e={};function t(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return t(i)!==null},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return r===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function rie(n,e,t,i){const r={},s=new WeakMap;function o(h){const d=h.target;d.index!==null&&e.remove(d.index);for(const p in d.attributes)e.remove(d.attributes[p]);for(const p in d.morphAttributes){const _=d.morphAttributes[p];for(let m=0,g=_.length;m<g;m++)e.remove(_[m])}d.removeEventListener("dispose",o),delete r[d.id];const f=s.get(d);f&&(e.remove(f),s.delete(d)),i.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,t.memory.geometries--}function a(h,d){return r[d.id]===!0||(d.addEventListener("dispose",o),r[d.id]=!0,t.memory.geometries++),d}function l(h){const d=h.attributes;for(const p in d)e.update(d[p],n.ARRAY_BUFFER);const f=h.morphAttributes;for(const p in f){const _=f[p];for(let m=0,g=_.length;m<g;m++)e.update(_[m],n.ARRAY_BUFFER)}}function u(h){const d=[],f=h.index,p=h.attributes.position;let _=0;if(f!==null){const v=f.array;_=f.version;for(let y=0,x=v.length;y<x;y+=3){const b=v[y+0],S=v[y+1],T=v[y+2];d.push(b,S,S,T,T,b)}}else{const v=p.array;_=p.version;for(let y=0,x=v.length/3-1;y<x;y+=3){const b=y+0,S=y+1,T=y+2;d.push(b,S,S,T,T,b)}}const m=new(i2(d)?c2:u2)(d,1);m.version=_;const g=s.get(h);g&&e.remove(g),s.set(h,m)}function c(h){const d=s.get(h);if(d){const f=h.index;f!==null&&d.version<f.version&&u(h)}else u(h);return s.get(h)}return{get:a,update:l,getWireframeAttribute:c}}function sie(n,e,t,i){const r=i.isWebGL2;let s;function o(d){s=d}let a,l;function u(d){a=d.type,l=d.bytesPerElement}function c(d,f){n.drawElements(s,f,a,d*l),t.update(f,s,1)}function h(d,f,p){if(p===0)return;let _,m;if(r)_=n,m="drawElementsInstanced";else if(_=e.get("ANGLE_instanced_arrays"),m="drawElementsInstancedANGLE",_===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}_[m](s,f,a,d*l,p),t.update(f,s,p)}this.setMode=o,this.setIndex=u,this.render=c,this.renderInstances=h}function oie(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:i}}function aie(n,e){return n[0]-e[0]}function lie(n,e){return Math.abs(e[1])-Math.abs(n[1])}function uie(n,e,t){const i={},r=new Float32Array(8),s=new WeakMap,o=new zt,a=[];for(let u=0;u<8;u++)a[u]=[u,0];function l(u,c,h){const d=u.morphTargetInfluences;if(e.isWebGL2===!0){const p=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,_=p!==void 0?p.length:0;let m=s.get(c);if(m===void 0||m.count!==_){let B=function(){C.dispose(),s.delete(c),c.removeEventListener("dispose",B)};var f=B;m!==void 0&&m.texture.dispose();const y=c.morphAttributes.position!==void 0,x=c.morphAttributes.normal!==void 0,b=c.morphAttributes.color!==void 0,S=c.morphAttributes.position||[],T=c.morphAttributes.normal||[],P=c.morphAttributes.color||[];let E=0;y===!0&&(E=1),x===!0&&(E=2),b===!0&&(E=3);let M=c.attributes.position.count*E,O=1;M>e.maxTextureSize&&(O=Math.ceil(M/e.maxTextureSize),M=e.maxTextureSize);const L=new Float32Array(M*O*4*_),C=new o2(L,M,O,_);C.type=ks,C.needsUpdate=!0;const D=E*4;for(let W=0;W<_;W++){const U=S[W],$=T[W],J=P[W],j=M*O*4*W;for(let F=0;F<U.count;F++){const X=F*D;y===!0&&(o.fromBufferAttribute(U,F),L[j+X+0]=o.x,L[j+X+1]=o.y,L[j+X+2]=o.z,L[j+X+3]=0),x===!0&&(o.fromBufferAttribute($,F),L[j+X+4]=o.x,L[j+X+5]=o.y,L[j+X+6]=o.z,L[j+X+7]=0),b===!0&&(o.fromBufferAttribute(J,F),L[j+X+8]=o.x,L[j+X+9]=o.y,L[j+X+10]=o.z,L[j+X+11]=J.itemSize===4?o.w:1)}}m={count:_,texture:C,size:new Ze(M,O)},s.set(c,m),c.addEventListener("dispose",B)}let g=0;for(let y=0;y<d.length;y++)g+=d[y];const v=c.morphTargetsRelative?1:1-g;h.getUniforms().setValue(n,"morphTargetBaseInfluence",v),h.getUniforms().setValue(n,"morphTargetInfluences",d),h.getUniforms().setValue(n,"morphTargetsTexture",m.texture,t),h.getUniforms().setValue(n,"morphTargetsTextureSize",m.size)}else{const p=d===void 0?0:d.length;let _=i[c.id];if(_===void 0||_.length!==p){_=[];for(let x=0;x<p;x++)_[x]=[x,0];i[c.id]=_}for(let x=0;x<p;x++){const b=_[x];b[0]=x,b[1]=d[x]}_.sort(lie);for(let x=0;x<8;x++)x<p&&_[x][1]?(a[x][0]=_[x][0],a[x][1]=_[x][1]):(a[x][0]=Number.MAX_SAFE_INTEGER,a[x][1]=0);a.sort(aie);const m=c.morphAttributes.position,g=c.morphAttributes.normal;let v=0;for(let x=0;x<8;x++){const b=a[x],S=b[0],T=b[1];S!==Number.MAX_SAFE_INTEGER&&T?(m&&c.getAttribute("morphTarget"+x)!==m[S]&&c.setAttribute("morphTarget"+x,m[S]),g&&c.getAttribute("morphNormal"+x)!==g[S]&&c.setAttribute("morphNormal"+x,g[S]),r[x]=T,v+=T):(m&&c.hasAttribute("morphTarget"+x)===!0&&c.deleteAttribute("morphTarget"+x),g&&c.hasAttribute("morphNormal"+x)===!0&&c.deleteAttribute("morphNormal"+x),r[x]=0)}const y=c.morphTargetsRelative?1:1-v;h.getUniforms().setValue(n,"morphTargetBaseInfluence",y),h.getUniforms().setValue(n,"morphTargetInfluences",r)}}return{update:l}}function cie(n,e,t,i){let r=new WeakMap;function s(l){const u=i.render.frame,c=l.geometry,h=e.get(l,c);if(r.get(h)!==u&&(e.update(h),r.set(h,u)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),r.get(l)!==u&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,n.ARRAY_BUFFER),r.set(l,u))),l.isSkinnedMesh){const d=l.skeleton;r.get(d)!==u&&(d.update(),r.set(d,u))}return h}function o(){r=new WeakMap}function a(l){const u=l.target;u.removeEventListener("dispose",a),t.remove(u.instanceMatrix),u.instanceColor!==null&&t.remove(u.instanceColor)}return{update:s,dispose:o}}const g2=new jn,_2=new o2,v2=new JQ,y2=new p2,gA=[],_A=[],vA=new Float32Array(16),yA=new Float32Array(9),xA=new Float32Array(4);function wc(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=gA[r];if(s===void 0&&(s=new Float32Array(r),gA[r]=s),e!==0){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function An(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function Pn(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function xg(n,e){let t=_A[e];t===void 0&&(t=new Int32Array(e),_A[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function hie(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function die(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(An(t,e))return;n.uniform2fv(this.addr,e),Pn(t,e)}}function fie(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(An(t,e))return;n.uniform3fv(this.addr,e),Pn(t,e)}}function pie(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(An(t,e))return;n.uniform4fv(this.addr,e),Pn(t,e)}}function mie(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(An(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Pn(t,e)}else{if(An(t,i))return;xA.set(i),n.uniformMatrix2fv(this.addr,!1,xA),Pn(t,i)}}function gie(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(An(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Pn(t,e)}else{if(An(t,i))return;yA.set(i),n.uniformMatrix3fv(this.addr,!1,yA),Pn(t,i)}}function _ie(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(An(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Pn(t,e)}else{if(An(t,i))return;vA.set(i),n.uniformMatrix4fv(this.addr,!1,vA),Pn(t,i)}}function vie(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function yie(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(An(t,e))return;n.uniform2iv(this.addr,e),Pn(t,e)}}function xie(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(An(t,e))return;n.uniform3iv(this.addr,e),Pn(t,e)}}function bie(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(An(t,e))return;n.uniform4iv(this.addr,e),Pn(t,e)}}function Sie(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function Eie(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(An(t,e))return;n.uniform2uiv(this.addr,e),Pn(t,e)}}function Tie(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(An(t,e))return;n.uniform3uiv(this.addr,e),Pn(t,e)}}function Mie(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(An(t,e))return;n.uniform4uiv(this.addr,e),Pn(t,e)}}function wie(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2D(e||g2,r)}function Aie(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||v2,r)}function Pie(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||y2,r)}function Cie(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||_2,r)}function Rie(n){switch(n){case 5126:return hie;case 35664:return die;case 35665:return fie;case 35666:return pie;case 35674:return mie;case 35675:return gie;case 35676:return _ie;case 5124:case 35670:return vie;case 35667:case 35671:return yie;case 35668:case 35672:return xie;case 35669:case 35673:return bie;case 5125:return Sie;case 36294:return Eie;case 36295:return Tie;case 36296:return Mie;case 35678:case 36198:case 36298:case 36306:case 35682:return wie;case 35679:case 36299:case 36307:return Aie;case 35680:case 36300:case 36308:case 36293:return Pie;case 36289:case 36303:case 36311:case 36292:return Cie}}function Iie(n,e){n.uniform1fv(this.addr,e)}function Lie(n,e){const t=wc(e,this.size,2);n.uniform2fv(this.addr,t)}function Oie(n,e){const t=wc(e,this.size,3);n.uniform3fv(this.addr,t)}function Die(n,e){const t=wc(e,this.size,4);n.uniform4fv(this.addr,t)}function Fie(n,e){const t=wc(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function Nie(n,e){const t=wc(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function Uie(n,e){const t=wc(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function Bie(n,e){n.uniform1iv(this.addr,e)}function kie(n,e){n.uniform2iv(this.addr,e)}function Vie(n,e){n.uniform3iv(this.addr,e)}function Gie(n,e){n.uniform4iv(this.addr,e)}function Hie(n,e){n.uniform1uiv(this.addr,e)}function zie(n,e){n.uniform2uiv(this.addr,e)}function Wie(n,e){n.uniform3uiv(this.addr,e)}function Xie(n,e){n.uniform4uiv(this.addr,e)}function jie(n,e,t){const i=this.cache,r=e.length,s=xg(t,r);An(i,s)||(n.uniform1iv(this.addr,s),Pn(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||g2,s[o])}function $ie(n,e,t){const i=this.cache,r=e.length,s=xg(t,r);An(i,s)||(n.uniform1iv(this.addr,s),Pn(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||v2,s[o])}function Yie(n,e,t){const i=this.cache,r=e.length,s=xg(t,r);An(i,s)||(n.uniform1iv(this.addr,s),Pn(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||y2,s[o])}function qie(n,e,t){const i=this.cache,r=e.length,s=xg(t,r);An(i,s)||(n.uniform1iv(this.addr,s),Pn(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||_2,s[o])}function Kie(n){switch(n){case 5126:return Iie;case 35664:return Lie;case 35665:return Oie;case 35666:return Die;case 35674:return Fie;case 35675:return Nie;case 35676:return Uie;case 5124:case 35670:return Bie;case 35667:case 35671:return kie;case 35668:case 35672:return Vie;case 35669:case 35673:return Gie;case 5125:return Hie;case 36294:return zie;case 36295:return Wie;case 36296:return Xie;case 35678:case 36198:case 36298:case 36306:case 35682:return jie;case 35679:case 36299:case 36307:return $ie;case 35680:case 36300:case 36308:case 36293:return Yie;case 36289:case 36303:case 36311:case 36292:return qie}}class Zie{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=Rie(t.type)}}class Jie{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=Kie(t.type)}}class Qie{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const bv=/(\w+)(\])?(\[|\.)?/g;function bA(n,e){n.seq.push(e),n.map[e.id]=e}function ere(n,e,t){const i=n.name,r=i.length;for(bv.lastIndex=0;;){const s=bv.exec(i),o=bv.lastIndex;let a=s[1];const l=s[2]==="]",u=s[3];if(l&&(a=a|0),u===void 0||u==="["&&o+2===r){bA(t,u===void 0?new Zie(a,n,e):new Jie(a,n,e));break}else{let h=t.map[a];h===void 0&&(h=new Qie(a),bA(t,h)),t=h}}}class Np{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r),o=e.getUniformLocation(t,s.name);ere(s,o,this)}}setValue(e,t,i,r){const s=this.map[t];s!==void 0&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=i[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function SA(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}let tre=0;function nre(n,e){const t=n.split(`
`),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join(`
`)}function ire(n){switch(n){case cs:return["Linear","( value )"];case nt:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),["Linear","( value )"]}}function EA(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),r=n.getShaderInfoLog(e).trim();if(i&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+`

`+r+`

`+nre(n.getShaderSource(e),o)}else return r}function rre(n,e){const t=ire(e);return"vec4 "+n+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function sre(n,e){let t;switch(e){case QJ:t="Linear";break;case eQ:t="Reinhard";break;case tQ:t="OptimizedCineon";break;case nQ:t="ACESFilmic";break;case iQ:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function ore(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Th).join(`
`)}function are(n){const e=[];for(const t in n){const i=n[t];i!==!1&&e.push("#define "+t+" "+i)}return e.join(`
`)}function lre(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}function Th(n){return n!==""}function TA(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function MA(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const ure=/^[ \t]*#include +<([\w\d./]+)>/gm;function Dy(n){return n.replace(ure,hre)}const cre=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function hre(n,e){let t=ht[e];if(t===void 0){const i=cre.get(e);if(i!==void 0)t=ht[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return Dy(t)}const dre=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function wA(n){return n.replace(dre,fre)}function fre(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function AA(n){let e="precision "+n.precision+` float;
precision `+n.precision+" int;";return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function pre(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===GO?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===IJ?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===Cs&&(e="SHADOWMAP_TYPE_VSM"),e}function mre(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case tc:case nc:e="ENVMAP_TYPE_CUBE";break;case vg:e="ENVMAP_TYPE_CUBE_UV";break}return e}function gre(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case nc:e="ENVMAP_MODE_REFRACTION";break}return e}function _re(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case WO:e="ENVMAP_BLENDING_MULTIPLY";break;case ZJ:e="ENVMAP_BLENDING_MIX";break;case JJ:e="ENVMAP_BLENDING_ADD";break}return e}function vre(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:i,maxMip:t}}function yre(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=pre(t),u=mre(t),c=gre(t),h=_re(t),d=vre(t),f=t.isWebGL2?"":ore(t),p=are(s),_=r.createProgram();let m,g,v=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(m=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(Th).join(`
`),m.length>0&&(m+=`
`),g=[f,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(Th).join(`
`),g.length>0&&(g+=`
`)):(m=[AA(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Th).join(`
`),g=[f,AA(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.envMap?"#define "+c:"",t.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==js?"#define TONE_MAPPING":"",t.toneMapping!==js?ht.tonemapping_pars_fragment:"",t.toneMapping!==js?sre("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",ht.colorspace_pars_fragment,rre("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Th).join(`
`)),o=Dy(o),o=TA(o,t),o=MA(o,t),a=Dy(a),a=TA(a,t),a=MA(a,t),o=wA(o),a=wA(a),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(v=`#version 300 es
`,m=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+m,g=["#define varying in",t.glslVersion===jw?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===jw?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+g);const y=v+m+o,x=v+g+a,b=SA(r,r.VERTEX_SHADER,y),S=SA(r,r.FRAGMENT_SHADER,x);if(r.attachShader(_,b),r.attachShader(_,S),t.index0AttributeName!==void 0?r.bindAttribLocation(_,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(_,0,"position"),r.linkProgram(_),n.debug.checkShaderErrors){const E=r.getProgramInfoLog(_).trim(),M=r.getShaderInfoLog(b).trim(),O=r.getShaderInfoLog(S).trim();let L=!0,C=!0;if(r.getProgramParameter(_,r.LINK_STATUS)===!1)if(L=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(r,_,b,S);else{const D=EA(r,b,"vertex"),B=EA(r,S,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(_,r.VALIDATE_STATUS)+`

Program Info Log: `+E+`
`+D+`
`+B)}else E!==""?console.warn("THREE.WebGLProgram: Program Info Log:",E):(M===""||O==="")&&(C=!1);C&&(this.diagnostics={runnable:L,programLog:E,vertexShader:{log:M,prefix:m},fragmentShader:{log:O,prefix:g}})}r.deleteShader(b),r.deleteShader(S);let T;this.getUniforms=function(){return T===void 0&&(T=new Np(r,_)),T};let P;return this.getAttributes=function(){return P===void 0&&(P=lre(r,_)),P},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(_),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=tre++,this.cacheKey=e,this.usedTimes=1,this.program=_,this.vertexShader=b,this.fragmentShader=S,this}let xre=0;class bre{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return i===void 0&&(i=new Sre(e),t.set(e,i)),i}}class Sre{constructor(e){this.id=xre++,this.code=e,this.usedTimes=0}}function Ere(n,e,t,i,r,s,o){const a=new a2,l=new bre,u=[],c=r.isWebGL2,h=r.logarithmicDepthBuffer,d=r.vertexTextures;let f=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function _(E){return E===0?"uv":`uv${E}`}function m(E,M,O,L,C){const D=L.fog,B=C.geometry,W=E.isMeshStandardMaterial?L.environment:null,U=(E.isMeshStandardMaterial?t:e).get(E.envMap||W),$=U&&U.mapping===vg?U.image.height:null,J=p[E.type];E.precision!==null&&(f=r.getMaxPrecision(E.precision),f!==E.precision&&console.warn("THREE.WebGLProgram.getParameters:",E.precision,"not supported, using",f,"instead."));const j=B.morphAttributes.position||B.morphAttributes.normal||B.morphAttributes.color,F=j!==void 0?j.length:0;let X=0;B.morphAttributes.position!==void 0&&(X=1),B.morphAttributes.normal!==void 0&&(X=2),B.morphAttributes.color!==void 0&&(X=3);let re,ce,ve,ae;if(J){const ui=Jr[J];re=ui.vertexShader,ce=ui.fragmentShader}else re=E.vertexShader,ce=E.fragmentShader,l.update(E),ve=l.getVertexShaderID(E),ae=l.getFragmentShaderID(E);const Y=n.getRenderTarget(),ne=C.isInstancedMesh===!0,he=!!E.map,xe=!!E.matcap,be=!!U,w=!!E.aoMap,V=!!E.lightMap,H=!!E.bumpMap,K=!!E.normalMap,Z=!!E.displacementMap,ee=!!E.emissiveMap,ge=!!E.metalnessMap,le=!!E.roughnessMap,fe=E.anisotropy>0,me=E.clearcoat>0,we=E.iridescence>0,I=E.sheen>0,A=E.transmission>0,G=fe&&!!E.anisotropyMap,Q=me&&!!E.clearcoatMap,ue=me&&!!E.clearcoatNormalMap,k=me&&!!E.clearcoatRoughnessMap,pe=we&&!!E.iridescenceMap,Ee=we&&!!E.iridescenceThicknessMap,se=I&&!!E.sheenColorMap,De=I&&!!E.sheenRoughnessMap,Ne=!!E.specularMap,Ue=!!E.specularColorMap,Ce=!!E.specularIntensityMap,Re=A&&!!E.transmissionMap,Ve=A&&!!E.thicknessMap,ft=!!E.gradientMap,q=!!E.alphaMap,Ie=E.alphaTest>0,de=!!E.alphaHash,Ae=!!E.extensions,Le=!!B.attributes.uv1,Et=!!B.attributes.uv2,Yt=!!B.attributes.uv3;return{isWebGL2:c,shaderID:J,shaderType:E.type,shaderName:E.name,vertexShader:re,fragmentShader:ce,defines:E.defines,customVertexShaderID:ve,customFragmentShaderID:ae,isRawShaderMaterial:E.isRawShaderMaterial===!0,glslVersion:E.glslVersion,precision:f,instancing:ne,instancingColor:ne&&C.instanceColor!==null,supportsVertexTextures:d,outputColorSpace:Y===null?n.outputColorSpace:Y.isXRRenderTarget===!0?Y.texture.colorSpace:cs,map:he,matcap:xe,envMap:be,envMapMode:be&&U.mapping,envMapCubeUVHeight:$,aoMap:w,lightMap:V,bumpMap:H,normalMap:K,displacementMap:d&&Z,emissiveMap:ee,normalMapObjectSpace:K&&E.normalMapType===xQ,normalMapTangentSpace:K&&E.normalMapType===hS,metalnessMap:ge,roughnessMap:le,anisotropy:fe,anisotropyMap:G,clearcoat:me,clearcoatMap:Q,clearcoatNormalMap:ue,clearcoatRoughnessMap:k,iridescence:we,iridescenceMap:pe,iridescenceThicknessMap:Ee,sheen:I,sheenColorMap:se,sheenRoughnessMap:De,specularMap:Ne,specularColorMap:Ue,specularIntensityMap:Ce,transmission:A,transmissionMap:Re,thicknessMap:Ve,gradientMap:ft,opaque:E.transparent===!1&&E.blending===Ru,alphaMap:q,alphaTest:Ie,alphaHash:de,combine:E.combine,mapUv:he&&_(E.map.channel),aoMapUv:w&&_(E.aoMap.channel),lightMapUv:V&&_(E.lightMap.channel),bumpMapUv:H&&_(E.bumpMap.channel),normalMapUv:K&&_(E.normalMap.channel),displacementMapUv:Z&&_(E.displacementMap.channel),emissiveMapUv:ee&&_(E.emissiveMap.channel),metalnessMapUv:ge&&_(E.metalnessMap.channel),roughnessMapUv:le&&_(E.roughnessMap.channel),anisotropyMapUv:G&&_(E.anisotropyMap.channel),clearcoatMapUv:Q&&_(E.clearcoatMap.channel),clearcoatNormalMapUv:ue&&_(E.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:k&&_(E.clearcoatRoughnessMap.channel),iridescenceMapUv:pe&&_(E.iridescenceMap.channel),iridescenceThicknessMapUv:Ee&&_(E.iridescenceThicknessMap.channel),sheenColorMapUv:se&&_(E.sheenColorMap.channel),sheenRoughnessMapUv:De&&_(E.sheenRoughnessMap.channel),specularMapUv:Ne&&_(E.specularMap.channel),specularColorMapUv:Ue&&_(E.specularColorMap.channel),specularIntensityMapUv:Ce&&_(E.specularIntensityMap.channel),transmissionMapUv:Re&&_(E.transmissionMap.channel),thicknessMapUv:Ve&&_(E.thicknessMap.channel),alphaMapUv:q&&_(E.alphaMap.channel),vertexTangents:!!B.attributes.tangent&&(K||fe),vertexColors:E.vertexColors,vertexAlphas:E.vertexColors===!0&&!!B.attributes.color&&B.attributes.color.itemSize===4,vertexUv1s:Le,vertexUv2s:Et,vertexUv3s:Yt,pointsUvs:C.isPoints===!0&&!!B.attributes.uv&&(he||q),fog:!!D,useFog:E.fog===!0,fogExp2:D&&D.isFogExp2,flatShading:E.flatShading===!0,sizeAttenuation:E.sizeAttenuation===!0,logarithmicDepthBuffer:h,skinning:C.isSkinnedMesh===!0,morphTargets:B.morphAttributes.position!==void 0,morphNormals:B.morphAttributes.normal!==void 0,morphColors:B.morphAttributes.color!==void 0,morphTargetsCount:F,morphTextureStride:X,numDirLights:M.directional.length,numPointLights:M.point.length,numSpotLights:M.spot.length,numSpotLightMaps:M.spotLightMap.length,numRectAreaLights:M.rectArea.length,numHemiLights:M.hemi.length,numDirLightShadows:M.directionalShadowMap.length,numPointLightShadows:M.pointShadowMap.length,numSpotLightShadows:M.spotShadowMap.length,numSpotLightShadowsWithMaps:M.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:E.dithering,shadowMapEnabled:n.shadowMap.enabled&&O.length>0,shadowMapType:n.shadowMap.type,toneMapping:E.toneMapped?n.toneMapping:js,useLegacyLights:n.useLegacyLights,premultipliedAlpha:E.premultipliedAlpha,doubleSided:E.side===qi,flipSided:E.side===li,useDepthPacking:E.depthPacking>=0,depthPacking:E.depthPacking||0,index0AttributeName:E.index0AttributeName,extensionDerivatives:Ae&&E.extensions.derivatives===!0,extensionFragDepth:Ae&&E.extensions.fragDepth===!0,extensionDrawBuffers:Ae&&E.extensions.drawBuffers===!0,extensionShaderTextureLOD:Ae&&E.extensions.shaderTextureLOD===!0,rendererExtensionFragDepth:c||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:c||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:c||i.has("EXT_shader_texture_lod"),customProgramCacheKey:E.customProgramCacheKey()}}function g(E){const M=[];if(E.shaderID?M.push(E.shaderID):(M.push(E.customVertexShaderID),M.push(E.customFragmentShaderID)),E.defines!==void 0)for(const O in E.defines)M.push(O),M.push(E.defines[O]);return E.isRawShaderMaterial===!1&&(v(M,E),y(M,E),M.push(n.outputColorSpace)),M.push(E.customProgramCacheKey),M.join()}function v(E,M){E.push(M.precision),E.push(M.outputColorSpace),E.push(M.envMapMode),E.push(M.envMapCubeUVHeight),E.push(M.mapUv),E.push(M.alphaMapUv),E.push(M.lightMapUv),E.push(M.aoMapUv),E.push(M.bumpMapUv),E.push(M.normalMapUv),E.push(M.displacementMapUv),E.push(M.emissiveMapUv),E.push(M.metalnessMapUv),E.push(M.roughnessMapUv),E.push(M.anisotropyMapUv),E.push(M.clearcoatMapUv),E.push(M.clearcoatNormalMapUv),E.push(M.clearcoatRoughnessMapUv),E.push(M.iridescenceMapUv),E.push(M.iridescenceThicknessMapUv),E.push(M.sheenColorMapUv),E.push(M.sheenRoughnessMapUv),E.push(M.specularMapUv),E.push(M.specularColorMapUv),E.push(M.specularIntensityMapUv),E.push(M.transmissionMapUv),E.push(M.thicknessMapUv),E.push(M.combine),E.push(M.fogExp2),E.push(M.sizeAttenuation),E.push(M.morphTargetsCount),E.push(M.morphAttributeCount),E.push(M.numDirLights),E.push(M.numPointLights),E.push(M.numSpotLights),E.push(M.numSpotLightMaps),E.push(M.numHemiLights),E.push(M.numRectAreaLights),E.push(M.numDirLightShadows),E.push(M.numPointLightShadows),E.push(M.numSpotLightShadows),E.push(M.numSpotLightShadowsWithMaps),E.push(M.shadowMapType),E.push(M.toneMapping),E.push(M.numClippingPlanes),E.push(M.numClipIntersection),E.push(M.depthPacking)}function y(E,M){a.disableAll(),M.isWebGL2&&a.enable(0),M.supportsVertexTextures&&a.enable(1),M.instancing&&a.enable(2),M.instancingColor&&a.enable(3),M.matcap&&a.enable(4),M.envMap&&a.enable(5),M.normalMapObjectSpace&&a.enable(6),M.normalMapTangentSpace&&a.enable(7),M.clearcoat&&a.enable(8),M.iridescence&&a.enable(9),M.alphaTest&&a.enable(10),M.vertexColors&&a.enable(11),M.vertexAlphas&&a.enable(12),M.vertexUv1s&&a.enable(13),M.vertexUv2s&&a.enable(14),M.vertexUv3s&&a.enable(15),M.vertexTangents&&a.enable(16),M.anisotropy&&a.enable(17),E.push(a.mask),a.disableAll(),M.fog&&a.enable(0),M.useFog&&a.enable(1),M.flatShading&&a.enable(2),M.logarithmicDepthBuffer&&a.enable(3),M.skinning&&a.enable(4),M.morphTargets&&a.enable(5),M.morphNormals&&a.enable(6),M.morphColors&&a.enable(7),M.premultipliedAlpha&&a.enable(8),M.shadowMapEnabled&&a.enable(9),M.useLegacyLights&&a.enable(10),M.doubleSided&&a.enable(11),M.flipSided&&a.enable(12),M.useDepthPacking&&a.enable(13),M.dithering&&a.enable(14),M.transmission&&a.enable(15),M.sheen&&a.enable(16),M.opaque&&a.enable(17),M.pointsUvs&&a.enable(18),E.push(a.mask)}function x(E){const M=p[E.type];let O;if(M){const L=Jr[M];O=d2.clone(L.uniforms)}else O=E.uniforms;return O}function b(E,M){let O;for(let L=0,C=u.length;L<C;L++){const D=u[L];if(D.cacheKey===M){O=D,++O.usedTimes;break}}return O===void 0&&(O=new yre(n,M,E,s),u.push(O)),O}function S(E){if(--E.usedTimes===0){const M=u.indexOf(E);u[M]=u[u.length-1],u.pop(),E.destroy()}}function T(E){l.remove(E)}function P(){l.dispose()}return{getParameters:m,getProgramCacheKey:g,getUniforms:x,acquireProgram:b,releaseProgram:S,releaseShaderCache:T,programs:u,dispose:P}}function Tre(){let n=new WeakMap;function e(s){let o=n.get(s);return o===void 0&&(o={},n.set(s,o)),o}function t(s){n.delete(s)}function i(s,o,a){n.get(s)[o]=a}function r(){n=new WeakMap}return{get:e,remove:t,update:i,dispose:r}}function Mre(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function PA(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function CA(){const n=[];let e=0;const t=[],i=[],r=[];function s(){e=0,t.length=0,i.length=0,r.length=0}function o(h,d,f,p,_,m){let g=n[e];return g===void 0?(g={id:h.id,object:h,geometry:d,material:f,groupOrder:p,renderOrder:h.renderOrder,z:_,group:m},n[e]=g):(g.id=h.id,g.object=h,g.geometry=d,g.material=f,g.groupOrder=p,g.renderOrder=h.renderOrder,g.z=_,g.group=m),e++,g}function a(h,d,f,p,_,m){const g=o(h,d,f,p,_,m);f.transmission>0?i.push(g):f.transparent===!0?r.push(g):t.push(g)}function l(h,d,f,p,_,m){const g=o(h,d,f,p,_,m);f.transmission>0?i.unshift(g):f.transparent===!0?r.unshift(g):t.unshift(g)}function u(h,d){t.length>1&&t.sort(h||Mre),i.length>1&&i.sort(d||PA),r.length>1&&r.sort(d||PA)}function c(){for(let h=e,d=n.length;h<d;h++){const f=n[h];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:t,transmissive:i,transparent:r,init:s,push:a,unshift:l,finish:c,sort:u}}function wre(){let n=new WeakMap;function e(i,r){const s=n.get(i);let o;return s===void 0?(o=new CA,n.set(i,[o])):r>=s.length?(o=new CA,s.push(o)):o=s[r],o}function t(){n=new WeakMap}return{get:e,dispose:t}}function Are(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new z,color:new We};break;case"SpotLight":t={position:new z,direction:new z,color:new We,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new z,color:new We,distance:0,decay:0};break;case"HemisphereLight":t={direction:new z,skyColor:new We,groundColor:new We};break;case"RectAreaLight":t={color:new We,position:new z,halfWidth:new z,halfHeight:new z};break}return n[e.id]=t,t}}}function Pre(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ze};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ze};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ze,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let Cre=0;function Rre(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function Ire(n,e){const t=new Are,i=Pre(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let c=0;c<9;c++)r.probe.push(new z);const s=new z,o=new Qe,a=new Qe;function l(c,h){let d=0,f=0,p=0;for(let O=0;O<9;O++)r.probe[O].set(0,0,0);let _=0,m=0,g=0,v=0,y=0,x=0,b=0,S=0,T=0,P=0;c.sort(Rre);const E=h===!0?Math.PI:1;for(let O=0,L=c.length;O<L;O++){const C=c[O],D=C.color,B=C.intensity,W=C.distance,U=C.shadow&&C.shadow.map?C.shadow.map.texture:null;if(C.isAmbientLight)d+=D.r*B*E,f+=D.g*B*E,p+=D.b*B*E;else if(C.isLightProbe)for(let $=0;$<9;$++)r.probe[$].addScaledVector(C.sh.coefficients[$],B);else if(C.isDirectionalLight){const $=t.get(C);if($.color.copy(C.color).multiplyScalar(C.intensity*E),C.castShadow){const J=C.shadow,j=i.get(C);j.shadowBias=J.bias,j.shadowNormalBias=J.normalBias,j.shadowRadius=J.radius,j.shadowMapSize=J.mapSize,r.directionalShadow[_]=j,r.directionalShadowMap[_]=U,r.directionalShadowMatrix[_]=C.shadow.matrix,x++}r.directional[_]=$,_++}else if(C.isSpotLight){const $=t.get(C);$.position.setFromMatrixPosition(C.matrixWorld),$.color.copy(D).multiplyScalar(B*E),$.distance=W,$.coneCos=Math.cos(C.angle),$.penumbraCos=Math.cos(C.angle*(1-C.penumbra)),$.decay=C.decay,r.spot[g]=$;const J=C.shadow;if(C.map&&(r.spotLightMap[T]=C.map,T++,J.updateMatrices(C),C.castShadow&&P++),r.spotLightMatrix[g]=J.matrix,C.castShadow){const j=i.get(C);j.shadowBias=J.bias,j.shadowNormalBias=J.normalBias,j.shadowRadius=J.radius,j.shadowMapSize=J.mapSize,r.spotShadow[g]=j,r.spotShadowMap[g]=U,S++}g++}else if(C.isRectAreaLight){const $=t.get(C);$.color.copy(D).multiplyScalar(B),$.halfWidth.set(C.width*.5,0,0),$.halfHeight.set(0,C.height*.5,0),r.rectArea[v]=$,v++}else if(C.isPointLight){const $=t.get(C);if($.color.copy(C.color).multiplyScalar(C.intensity*E),$.distance=C.distance,$.decay=C.decay,C.castShadow){const J=C.shadow,j=i.get(C);j.shadowBias=J.bias,j.shadowNormalBias=J.normalBias,j.shadowRadius=J.radius,j.shadowMapSize=J.mapSize,j.shadowCameraNear=J.camera.near,j.shadowCameraFar=J.camera.far,r.pointShadow[m]=j,r.pointShadowMap[m]=U,r.pointShadowMatrix[m]=C.shadow.matrix,b++}r.point[m]=$,m++}else if(C.isHemisphereLight){const $=t.get(C);$.skyColor.copy(C.color).multiplyScalar(B*E),$.groundColor.copy(C.groundColor).multiplyScalar(B*E),r.hemi[y]=$,y++}}v>0&&(e.isWebGL2||n.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=Pe.LTC_FLOAT_1,r.rectAreaLTC2=Pe.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=Pe.LTC_HALF_1,r.rectAreaLTC2=Pe.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=d,r.ambient[1]=f,r.ambient[2]=p;const M=r.hash;(M.directionalLength!==_||M.pointLength!==m||M.spotLength!==g||M.rectAreaLength!==v||M.hemiLength!==y||M.numDirectionalShadows!==x||M.numPointShadows!==b||M.numSpotShadows!==S||M.numSpotMaps!==T)&&(r.directional.length=_,r.spot.length=g,r.rectArea.length=v,r.point.length=m,r.hemi.length=y,r.directionalShadow.length=x,r.directionalShadowMap.length=x,r.pointShadow.length=b,r.pointShadowMap.length=b,r.spotShadow.length=S,r.spotShadowMap.length=S,r.directionalShadowMatrix.length=x,r.pointShadowMatrix.length=b,r.spotLightMatrix.length=S+T-P,r.spotLightMap.length=T,r.numSpotLightShadowsWithMaps=P,M.directionalLength=_,M.pointLength=m,M.spotLength=g,M.rectAreaLength=v,M.hemiLength=y,M.numDirectionalShadows=x,M.numPointShadows=b,M.numSpotShadows=S,M.numSpotMaps=T,r.version=Cre++)}function u(c,h){let d=0,f=0,p=0,_=0,m=0;const g=h.matrixWorldInverse;for(let v=0,y=c.length;v<y;v++){const x=c[v];if(x.isDirectionalLight){const b=r.directional[d];b.direction.setFromMatrixPosition(x.matrixWorld),s.setFromMatrixPosition(x.target.matrixWorld),b.direction.sub(s),b.direction.transformDirection(g),d++}else if(x.isSpotLight){const b=r.spot[p];b.position.setFromMatrixPosition(x.matrixWorld),b.position.applyMatrix4(g),b.direction.setFromMatrixPosition(x.matrixWorld),s.setFromMatrixPosition(x.target.matrixWorld),b.direction.sub(s),b.direction.transformDirection(g),p++}else if(x.isRectAreaLight){const b=r.rectArea[_];b.position.setFromMatrixPosition(x.matrixWorld),b.position.applyMatrix4(g),a.identity(),o.copy(x.matrixWorld),o.premultiply(g),a.extractRotation(o),b.halfWidth.set(x.width*.5,0,0),b.halfHeight.set(0,x.height*.5,0),b.halfWidth.applyMatrix4(a),b.halfHeight.applyMatrix4(a),_++}else if(x.isPointLight){const b=r.point[f];b.position.setFromMatrixPosition(x.matrixWorld),b.position.applyMatrix4(g),f++}else if(x.isHemisphereLight){const b=r.hemi[m];b.direction.setFromMatrixPosition(x.matrixWorld),b.direction.transformDirection(g),m++}}}return{setup:l,setupView:u,state:r}}function RA(n,e){const t=new Ire(n,e),i=[],r=[];function s(){i.length=0,r.length=0}function o(h){i.push(h)}function a(h){r.push(h)}function l(h){t.setup(i,h)}function u(h){t.setupView(i,h)}return{init:s,state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:l,setupLightsView:u,pushLight:o,pushShadow:a}}function Lre(n,e){let t=new WeakMap;function i(s,o=0){const a=t.get(s);let l;return a===void 0?(l=new RA(n,e),t.set(s,[l])):o>=a.length?(l=new RA(n,e),a.push(l)):l=a[o],l}function r(){t=new WeakMap}return{get:i,dispose:r}}class Ore extends ss{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=vQ,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Dre extends ss{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const Fre=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Nre=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function Ure(n,e,t){let i=new fS;const r=new Ze,s=new Ze,o=new zt,a=new Ore({depthPacking:yQ}),l=new Dre,u={},c=t.maxTextureSize,h={[Ks]:li,[li]:Ks,[qi]:qi},d=new jo({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ze},radius:{value:4}},vertexShader:Fre,fragmentShader:Nre}),f=d.clone();f.defines.HORIZONTAL_PASS=1;const p=new kn;p.setAttribute("position",new Nt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const _=new _i(p,d),m=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=GO;let g=this.type;this.render=function(b,S,T){if(m.enabled===!1||m.autoUpdate===!1&&m.needsUpdate===!1||b.length===0)return;const P=n.getRenderTarget(),E=n.getActiveCubeFace(),M=n.getActiveMipmapLevel(),O=n.state;O.setBlending(Uo),O.buffers.color.setClear(1,1,1,1),O.buffers.depth.setTest(!0),O.setScissorTest(!1);const L=g!==Cs&&this.type===Cs,C=g===Cs&&this.type!==Cs;for(let D=0,B=b.length;D<B;D++){const W=b[D],U=W.shadow;if(U===void 0){console.warn("THREE.WebGLShadowMap:",W,"has no shadow.");continue}if(U.autoUpdate===!1&&U.needsUpdate===!1)continue;r.copy(U.mapSize);const $=U.getFrameExtents();if(r.multiply($),s.copy(U.mapSize),(r.x>c||r.y>c)&&(r.x>c&&(s.x=Math.floor(c/$.x),r.x=s.x*$.x,U.mapSize.x=s.x),r.y>c&&(s.y=Math.floor(c/$.y),r.y=s.y*$.y,U.mapSize.y=s.y)),U.map===null||L===!0||C===!0){const j=this.type!==Cs?{minFilter:Dn,magFilter:Dn}:{};U.map!==null&&U.map.dispose(),U.map=new ml(r.x,r.y,j),U.map.texture.name=W.name+".shadowMap",U.camera.updateProjectionMatrix()}n.setRenderTarget(U.map),n.clear();const J=U.getViewportCount();for(let j=0;j<J;j++){const F=U.getViewport(j);o.set(s.x*F.x,s.y*F.y,s.x*F.z,s.y*F.w),O.viewport(o),U.updateMatrices(W,j),i=U.getFrustum(),x(S,T,U.camera,W,this.type)}U.isPointLightShadow!==!0&&this.type===Cs&&v(U,T),U.needsUpdate=!1}g=this.type,m.needsUpdate=!1,n.setRenderTarget(P,E,M)};function v(b,S){const T=e.update(_);d.defines.VSM_SAMPLES!==b.blurSamples&&(d.defines.VSM_SAMPLES=b.blurSamples,f.defines.VSM_SAMPLES=b.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),b.mapPass===null&&(b.mapPass=new ml(r.x,r.y)),d.uniforms.shadow_pass.value=b.map.texture,d.uniforms.resolution.value=b.mapSize,d.uniforms.radius.value=b.radius,n.setRenderTarget(b.mapPass),n.clear(),n.renderBufferDirect(S,null,T,d,_,null),f.uniforms.shadow_pass.value=b.mapPass.texture,f.uniforms.resolution.value=b.mapSize,f.uniforms.radius.value=b.radius,n.setRenderTarget(b.map),n.clear(),n.renderBufferDirect(S,null,T,f,_,null)}function y(b,S,T,P){let E=null;const M=T.isPointLight===!0?b.customDistanceMaterial:b.customDepthMaterial;if(M!==void 0)E=M;else if(E=T.isPointLight===!0?l:a,n.localClippingEnabled&&S.clipShadows===!0&&Array.isArray(S.clippingPlanes)&&S.clippingPlanes.length!==0||S.displacementMap&&S.displacementScale!==0||S.alphaMap&&S.alphaTest>0||S.map&&S.alphaTest>0){const O=E.uuid,L=S.uuid;let C=u[O];C===void 0&&(C={},u[O]=C);let D=C[L];D===void 0&&(D=E.clone(),C[L]=D),E=D}if(E.visible=S.visible,E.wireframe=S.wireframe,P===Cs?E.side=S.shadowSide!==null?S.shadowSide:S.side:E.side=S.shadowSide!==null?S.shadowSide:h[S.side],E.alphaMap=S.alphaMap,E.alphaTest=S.alphaTest,E.map=S.map,E.clipShadows=S.clipShadows,E.clippingPlanes=S.clippingPlanes,E.clipIntersection=S.clipIntersection,E.displacementMap=S.displacementMap,E.displacementScale=S.displacementScale,E.displacementBias=S.displacementBias,E.wireframeLinewidth=S.wireframeLinewidth,E.linewidth=S.linewidth,T.isPointLight===!0&&E.isMeshDistanceMaterial===!0){const O=n.properties.get(E);O.light=T}return E}function x(b,S,T,P,E){if(b.visible===!1)return;if(b.layers.test(S.layers)&&(b.isMesh||b.isLine||b.isPoints)&&(b.castShadow||b.receiveShadow&&E===Cs)&&(!b.frustumCulled||i.intersectsObject(b))){b.modelViewMatrix.multiplyMatrices(T.matrixWorldInverse,b.matrixWorld);const L=e.update(b),C=b.material;if(Array.isArray(C)){const D=L.groups;for(let B=0,W=D.length;B<W;B++){const U=D[B],$=C[U.materialIndex];if($&&$.visible){const J=y(b,$,P,E);n.renderBufferDirect(T,null,L,J,b,U)}}}else if(C.visible){const D=y(b,C,P,E);n.renderBufferDirect(T,null,L,D,b,null)}}const O=b.children;for(let L=0,C=O.length;L<C;L++)x(O[L],S,T,P,E)}}function Bre(n,e,t){const i=t.isWebGL2;function r(){let q=!1;const Ie=new zt;let de=null;const Ae=new zt(0,0,0,0);return{setMask:function(Le){de!==Le&&!q&&(n.colorMask(Le,Le,Le,Le),de=Le)},setLocked:function(Le){q=Le},setClear:function(Le,Et,Yt,mn,ui){ui===!0&&(Le*=mn,Et*=mn,Yt*=mn),Ie.set(Le,Et,Yt,mn),Ae.equals(Ie)===!1&&(n.clearColor(Le,Et,Yt,mn),Ae.copy(Ie))},reset:function(){q=!1,de=null,Ae.set(-1,0,0,0)}}}function s(){let q=!1,Ie=null,de=null,Ae=null;return{setTest:function(Le){Le?Y(n.DEPTH_TEST):ne(n.DEPTH_TEST)},setMask:function(Le){Ie!==Le&&!q&&(n.depthMask(Le),Ie=Le)},setFunc:function(Le){if(de!==Le){switch(Le){case WJ:n.depthFunc(n.NEVER);break;case XJ:n.depthFunc(n.ALWAYS);break;case jJ:n.depthFunc(n.LESS);break;case wy:n.depthFunc(n.LEQUAL);break;case $J:n.depthFunc(n.EQUAL);break;case YJ:n.depthFunc(n.GEQUAL);break;case qJ:n.depthFunc(n.GREATER);break;case KJ:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}de=Le}},setLocked:function(Le){q=Le},setClear:function(Le){Ae!==Le&&(n.clearDepth(Le),Ae=Le)},reset:function(){q=!1,Ie=null,de=null,Ae=null}}}function o(){let q=!1,Ie=null,de=null,Ae=null,Le=null,Et=null,Yt=null,mn=null,ui=null;return{setTest:function(qt){q||(qt?Y(n.STENCIL_TEST):ne(n.STENCIL_TEST))},setMask:function(qt){Ie!==qt&&!q&&(n.stencilMask(qt),Ie=qt)},setFunc:function(qt,Di,Vn){(de!==qt||Ae!==Di||Le!==Vn)&&(n.stencilFunc(qt,Di,Vn),de=qt,Ae=Di,Le=Vn)},setOp:function(qt,Di,Vn){(Et!==qt||Yt!==Di||mn!==Vn)&&(n.stencilOp(qt,Di,Vn),Et=qt,Yt=Di,mn=Vn)},setLocked:function(qt){q=qt},setClear:function(qt){ui!==qt&&(n.clearStencil(qt),ui=qt)},reset:function(){q=!1,Ie=null,de=null,Ae=null,Le=null,Et=null,Yt=null,mn=null,ui=null}}}const a=new r,l=new s,u=new o,c=new WeakMap,h=new WeakMap;let d={},f={},p=new WeakMap,_=[],m=null,g=!1,v=null,y=null,x=null,b=null,S=null,T=null,P=null,E=!1,M=null,O=null,L=null,C=null,D=null;const B=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let W=!1,U=0;const $=n.getParameter(n.VERSION);$.indexOf("WebGL")!==-1?(U=parseFloat(/^WebGL (\d)/.exec($)[1]),W=U>=1):$.indexOf("OpenGL ES")!==-1&&(U=parseFloat(/^OpenGL ES (\d)/.exec($)[1]),W=U>=2);let J=null,j={};const F=n.getParameter(n.SCISSOR_BOX),X=n.getParameter(n.VIEWPORT),re=new zt().fromArray(F),ce=new zt().fromArray(X);function ve(q,Ie,de,Ae){const Le=new Uint8Array(4),Et=n.createTexture();n.bindTexture(q,Et),n.texParameteri(q,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(q,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let Yt=0;Yt<de;Yt++)i&&(q===n.TEXTURE_3D||q===n.TEXTURE_2D_ARRAY)?n.texImage3D(Ie,0,n.RGBA,1,1,Ae,0,n.RGBA,n.UNSIGNED_BYTE,Le):n.texImage2D(Ie+Yt,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,Le);return Et}const ae={};ae[n.TEXTURE_2D]=ve(n.TEXTURE_2D,n.TEXTURE_2D,1),ae[n.TEXTURE_CUBE_MAP]=ve(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(ae[n.TEXTURE_2D_ARRAY]=ve(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),ae[n.TEXTURE_3D]=ve(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),l.setClear(1),u.setClear(0),Y(n.DEPTH_TEST),l.setFunc(wy),Z(!1),ee(_w),Y(n.CULL_FACE),H(Uo);function Y(q){d[q]!==!0&&(n.enable(q),d[q]=!0)}function ne(q){d[q]!==!1&&(n.disable(q),d[q]=!1)}function he(q,Ie){return f[q]!==Ie?(n.bindFramebuffer(q,Ie),f[q]=Ie,i&&(q===n.DRAW_FRAMEBUFFER&&(f[n.FRAMEBUFFER]=Ie),q===n.FRAMEBUFFER&&(f[n.DRAW_FRAMEBUFFER]=Ie)),!0):!1}function xe(q,Ie){let de=_,Ae=!1;if(q)if(de=p.get(Ie),de===void 0&&(de=[],p.set(Ie,de)),q.isWebGLMultipleRenderTargets){const Le=q.texture;if(de.length!==Le.length||de[0]!==n.COLOR_ATTACHMENT0){for(let Et=0,Yt=Le.length;Et<Yt;Et++)de[Et]=n.COLOR_ATTACHMENT0+Et;de.length=Le.length,Ae=!0}}else de[0]!==n.COLOR_ATTACHMENT0&&(de[0]=n.COLOR_ATTACHMENT0,Ae=!0);else de[0]!==n.BACK&&(de[0]=n.BACK,Ae=!0);Ae&&(t.isWebGL2?n.drawBuffers(de):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(de))}function be(q){return m!==q?(n.useProgram(q),m=q,!0):!1}const w={[pu]:n.FUNC_ADD,[OJ]:n.FUNC_SUBTRACT,[DJ]:n.FUNC_REVERSE_SUBTRACT};if(i)w[bw]=n.MIN,w[Sw]=n.MAX;else{const q=e.get("EXT_blend_minmax");q!==null&&(w[bw]=q.MIN_EXT,w[Sw]=q.MAX_EXT)}const V={[FJ]:n.ZERO,[NJ]:n.ONE,[UJ]:n.SRC_COLOR,[HO]:n.SRC_ALPHA,[zJ]:n.SRC_ALPHA_SATURATE,[GJ]:n.DST_COLOR,[kJ]:n.DST_ALPHA,[BJ]:n.ONE_MINUS_SRC_COLOR,[zO]:n.ONE_MINUS_SRC_ALPHA,[HJ]:n.ONE_MINUS_DST_COLOR,[VJ]:n.ONE_MINUS_DST_ALPHA};function H(q,Ie,de,Ae,Le,Et,Yt,mn){if(q===Uo){g===!0&&(ne(n.BLEND),g=!1);return}if(g===!1&&(Y(n.BLEND),g=!0),q!==LJ){if(q!==v||mn!==E){if((y!==pu||S!==pu)&&(n.blendEquation(n.FUNC_ADD),y=pu,S=pu),mn)switch(q){case Ru:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case vw:n.blendFunc(n.ONE,n.ONE);break;case yw:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case xw:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",q);break}else switch(q){case Ru:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case vw:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case yw:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case xw:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",q);break}x=null,b=null,T=null,P=null,v=q,E=mn}return}Le=Le||Ie,Et=Et||de,Yt=Yt||Ae,(Ie!==y||Le!==S)&&(n.blendEquationSeparate(w[Ie],w[Le]),y=Ie,S=Le),(de!==x||Ae!==b||Et!==T||Yt!==P)&&(n.blendFuncSeparate(V[de],V[Ae],V[Et],V[Yt]),x=de,b=Ae,T=Et,P=Yt),v=q,E=!1}function K(q,Ie){q.side===qi?ne(n.CULL_FACE):Y(n.CULL_FACE);let de=q.side===li;Ie&&(de=!de),Z(de),q.blending===Ru&&q.transparent===!1?H(Uo):H(q.blending,q.blendEquation,q.blendSrc,q.blendDst,q.blendEquationAlpha,q.blendSrcAlpha,q.blendDstAlpha,q.premultipliedAlpha),l.setFunc(q.depthFunc),l.setTest(q.depthTest),l.setMask(q.depthWrite),a.setMask(q.colorWrite);const Ae=q.stencilWrite;u.setTest(Ae),Ae&&(u.setMask(q.stencilWriteMask),u.setFunc(q.stencilFunc,q.stencilRef,q.stencilFuncMask),u.setOp(q.stencilFail,q.stencilZFail,q.stencilZPass)),le(q.polygonOffset,q.polygonOffsetFactor,q.polygonOffsetUnits),q.alphaToCoverage===!0?Y(n.SAMPLE_ALPHA_TO_COVERAGE):ne(n.SAMPLE_ALPHA_TO_COVERAGE)}function Z(q){M!==q&&(q?n.frontFace(n.CW):n.frontFace(n.CCW),M=q)}function ee(q){q!==CJ?(Y(n.CULL_FACE),q!==O&&(q===_w?n.cullFace(n.BACK):q===RJ?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):ne(n.CULL_FACE),O=q}function ge(q){q!==L&&(W&&n.lineWidth(q),L=q)}function le(q,Ie,de){q?(Y(n.POLYGON_OFFSET_FILL),(C!==Ie||D!==de)&&(n.polygonOffset(Ie,de),C=Ie,D=de)):ne(n.POLYGON_OFFSET_FILL)}function fe(q){q?Y(n.SCISSOR_TEST):ne(n.SCISSOR_TEST)}function me(q){q===void 0&&(q=n.TEXTURE0+B-1),J!==q&&(n.activeTexture(q),J=q)}function we(q,Ie,de){de===void 0&&(J===null?de=n.TEXTURE0+B-1:de=J);let Ae=j[de];Ae===void 0&&(Ae={type:void 0,texture:void 0},j[de]=Ae),(Ae.type!==q||Ae.texture!==Ie)&&(J!==de&&(n.activeTexture(de),J=de),n.bindTexture(q,Ie||ae[q]),Ae.type=q,Ae.texture=Ie)}function I(){const q=j[J];q!==void 0&&q.type!==void 0&&(n.bindTexture(q.type,null),q.type=void 0,q.texture=void 0)}function A(){try{n.compressedTexImage2D.apply(n,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function G(){try{n.compressedTexImage3D.apply(n,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function Q(){try{n.texSubImage2D.apply(n,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function ue(){try{n.texSubImage3D.apply(n,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function k(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function pe(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function Ee(){try{n.texStorage2D.apply(n,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function se(){try{n.texStorage3D.apply(n,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function De(){try{n.texImage2D.apply(n,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function Ne(){try{n.texImage3D.apply(n,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function Ue(q){re.equals(q)===!1&&(n.scissor(q.x,q.y,q.z,q.w),re.copy(q))}function Ce(q){ce.equals(q)===!1&&(n.viewport(q.x,q.y,q.z,q.w),ce.copy(q))}function Re(q,Ie){let de=h.get(Ie);de===void 0&&(de=new WeakMap,h.set(Ie,de));let Ae=de.get(q);Ae===void 0&&(Ae=n.getUniformBlockIndex(Ie,q.name),de.set(q,Ae))}function Ve(q,Ie){const Ae=h.get(Ie).get(q);c.get(Ie)!==Ae&&(n.uniformBlockBinding(Ie,Ae,q.__bindingPointIndex),c.set(Ie,Ae))}function ft(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),i===!0&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),d={},J=null,j={},f={},p=new WeakMap,_=[],m=null,g=!1,v=null,y=null,x=null,b=null,S=null,T=null,P=null,E=!1,M=null,O=null,L=null,C=null,D=null,re.set(0,0,n.canvas.width,n.canvas.height),ce.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),u.reset()}return{buffers:{color:a,depth:l,stencil:u},enable:Y,disable:ne,bindFramebuffer:he,drawBuffers:xe,useProgram:be,setBlending:H,setMaterial:K,setFlipSided:Z,setCullFace:ee,setLineWidth:ge,setPolygonOffset:le,setScissorTest:fe,activeTexture:me,bindTexture:we,unbindTexture:I,compressedTexImage2D:A,compressedTexImage3D:G,texImage2D:De,texImage3D:Ne,updateUBOMapping:Re,uniformBlockBinding:Ve,texStorage2D:Ee,texStorage3D:se,texSubImage2D:Q,texSubImage3D:ue,compressedTexSubImage2D:k,compressedTexSubImage3D:pe,scissor:Ue,viewport:Ce,reset:ft}}function kre(n,e,t,i,r,s,o){const a=r.isWebGL2,l=r.maxTextures,u=r.maxCubemapSize,c=r.maxTextureSize,h=r.maxSamples,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap;let _;const m=new WeakMap;let g=!1;try{g=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function v(I,A){return g?new OffscreenCanvas(I,A):Md("canvas")}function y(I,A,G,Q){let ue=1;if((I.width>Q||I.height>Q)&&(ue=Q/Math.max(I.width,I.height)),ue<1||A===!0)if(typeof HTMLImageElement<"u"&&I instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&I instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&I instanceof ImageBitmap){const k=A?mm:Math.floor,pe=k(ue*I.width),Ee=k(ue*I.height);_===void 0&&(_=v(pe,Ee));const se=G?v(pe,Ee):_;return se.width=pe,se.height=Ee,se.getContext("2d").drawImage(I,0,0,pe,Ee),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+I.width+"x"+I.height+") to ("+pe+"x"+Ee+")."),se}else return"data"in I&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+I.width+"x"+I.height+")."),I;return I}function x(I){return Oy(I.width)&&Oy(I.height)}function b(I){return a?!1:I.wrapS!==Ki||I.wrapT!==Ki||I.minFilter!==Dn&&I.minFilter!==mi}function S(I,A){return I.generateMipmaps&&A&&I.minFilter!==Dn&&I.minFilter!==mi}function T(I){n.generateMipmap(I)}function P(I,A,G,Q,ue=!1){if(a===!1)return A;if(I!==null){if(n[I]!==void 0)return n[I];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+I+"'")}let k=A;return A===n.RED&&(G===n.FLOAT&&(k=n.R32F),G===n.HALF_FLOAT&&(k=n.R16F),G===n.UNSIGNED_BYTE&&(k=n.R8)),A===n.RG&&(G===n.FLOAT&&(k=n.RG32F),G===n.HALF_FLOAT&&(k=n.RG16F),G===n.UNSIGNED_BYTE&&(k=n.RG8)),A===n.RGBA&&(G===n.FLOAT&&(k=n.RGBA32F),G===n.HALF_FLOAT&&(k=n.RGBA16F),G===n.UNSIGNED_BYTE&&(k=Q===nt&&ue===!1?n.SRGB8_ALPHA8:n.RGBA8),G===n.UNSIGNED_SHORT_4_4_4_4&&(k=n.RGBA4),G===n.UNSIGNED_SHORT_5_5_5_1&&(k=n.RGB5_A1)),(k===n.R16F||k===n.R32F||k===n.RG16F||k===n.RG32F||k===n.RGBA16F||k===n.RGBA32F)&&e.get("EXT_color_buffer_float"),k}function E(I,A,G){return S(I,G)===!0||I.isFramebufferTexture&&I.minFilter!==Dn&&I.minFilter!==mi?Math.log2(Math.max(A.width,A.height))+1:I.mipmaps!==void 0&&I.mipmaps.length>0?I.mipmaps.length:I.isCompressedTexture&&Array.isArray(I.image)?A.mipmaps.length:1}function M(I){return I===Dn||I===Cy||I===Fp?n.NEAREST:n.LINEAR}function O(I){const A=I.target;A.removeEventListener("dispose",O),C(A),A.isVideoTexture&&p.delete(A)}function L(I){const A=I.target;A.removeEventListener("dispose",L),B(A)}function C(I){const A=i.get(I);if(A.__webglInit===void 0)return;const G=I.source,Q=m.get(G);if(Q){const ue=Q[A.__cacheKey];ue.usedTimes--,ue.usedTimes===0&&D(I),Object.keys(Q).length===0&&m.delete(G)}i.remove(I)}function D(I){const A=i.get(I);n.deleteTexture(A.__webglTexture);const G=I.source,Q=m.get(G);delete Q[A.__cacheKey],o.memory.textures--}function B(I){const A=I.texture,G=i.get(I),Q=i.get(A);if(Q.__webglTexture!==void 0&&(n.deleteTexture(Q.__webglTexture),o.memory.textures--),I.depthTexture&&I.depthTexture.dispose(),I.isWebGLCubeRenderTarget)for(let ue=0;ue<6;ue++)n.deleteFramebuffer(G.__webglFramebuffer[ue]),G.__webglDepthbuffer&&n.deleteRenderbuffer(G.__webglDepthbuffer[ue]);else{if(n.deleteFramebuffer(G.__webglFramebuffer),G.__webglDepthbuffer&&n.deleteRenderbuffer(G.__webglDepthbuffer),G.__webglMultisampledFramebuffer&&n.deleteFramebuffer(G.__webglMultisampledFramebuffer),G.__webglColorRenderbuffer)for(let ue=0;ue<G.__webglColorRenderbuffer.length;ue++)G.__webglColorRenderbuffer[ue]&&n.deleteRenderbuffer(G.__webglColorRenderbuffer[ue]);G.__webglDepthRenderbuffer&&n.deleteRenderbuffer(G.__webglDepthRenderbuffer)}if(I.isWebGLMultipleRenderTargets)for(let ue=0,k=A.length;ue<k;ue++){const pe=i.get(A[ue]);pe.__webglTexture&&(n.deleteTexture(pe.__webglTexture),o.memory.textures--),i.remove(A[ue])}i.remove(A),i.remove(I)}let W=0;function U(){W=0}function $(){const I=W;return I>=l&&console.warn("THREE.WebGLTextures: Trying to use "+I+" texture units while this GPU supports only "+l),W+=1,I}function J(I){const A=[];return A.push(I.wrapS),A.push(I.wrapT),A.push(I.wrapR||0),A.push(I.magFilter),A.push(I.minFilter),A.push(I.anisotropy),A.push(I.internalFormat),A.push(I.format),A.push(I.type),A.push(I.generateMipmaps),A.push(I.premultiplyAlpha),A.push(I.flipY),A.push(I.unpackAlignment),A.push(I.colorSpace),A.join()}function j(I,A){const G=i.get(I);if(I.isVideoTexture&&me(I),I.isRenderTargetTexture===!1&&I.version>0&&G.__version!==I.version){const Q=I.image;if(Q===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Q.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{he(G,I,A);return}}t.bindTexture(n.TEXTURE_2D,G.__webglTexture,n.TEXTURE0+A)}function F(I,A){const G=i.get(I);if(I.version>0&&G.__version!==I.version){he(G,I,A);return}t.bindTexture(n.TEXTURE_2D_ARRAY,G.__webglTexture,n.TEXTURE0+A)}function X(I,A){const G=i.get(I);if(I.version>0&&G.__version!==I.version){he(G,I,A);return}t.bindTexture(n.TEXTURE_3D,G.__webglTexture,n.TEXTURE0+A)}function re(I,A){const G=i.get(I);if(I.version>0&&G.__version!==I.version){xe(G,I,A);return}t.bindTexture(n.TEXTURE_CUBE_MAP,G.__webglTexture,n.TEXTURE0+A)}const ce={[ic]:n.REPEAT,[Ki]:n.CLAMP_TO_EDGE,[dm]:n.MIRRORED_REPEAT},ve={[Dn]:n.NEAREST,[Cy]:n.NEAREST_MIPMAP_NEAREST,[Fp]:n.NEAREST_MIPMAP_LINEAR,[mi]:n.LINEAR,[jO]:n.LINEAR_MIPMAP_NEAREST,[pl]:n.LINEAR_MIPMAP_LINEAR},ae={[SQ]:n.NEVER,[CQ]:n.ALWAYS,[EQ]:n.LESS,[MQ]:n.LEQUAL,[TQ]:n.EQUAL,[PQ]:n.GEQUAL,[wQ]:n.GREATER,[AQ]:n.NOTEQUAL};function Y(I,A,G){if(G?(n.texParameteri(I,n.TEXTURE_WRAP_S,ce[A.wrapS]),n.texParameteri(I,n.TEXTURE_WRAP_T,ce[A.wrapT]),(I===n.TEXTURE_3D||I===n.TEXTURE_2D_ARRAY)&&n.texParameteri(I,n.TEXTURE_WRAP_R,ce[A.wrapR]),n.texParameteri(I,n.TEXTURE_MAG_FILTER,ve[A.magFilter]),n.texParameteri(I,n.TEXTURE_MIN_FILTER,ve[A.minFilter])):(n.texParameteri(I,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(I,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(I===n.TEXTURE_3D||I===n.TEXTURE_2D_ARRAY)&&n.texParameteri(I,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(A.wrapS!==Ki||A.wrapT!==Ki)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(I,n.TEXTURE_MAG_FILTER,M(A.magFilter)),n.texParameteri(I,n.TEXTURE_MIN_FILTER,M(A.minFilter)),A.minFilter!==Dn&&A.minFilter!==mi&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),A.compareFunction&&(n.texParameteri(I,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(I,n.TEXTURE_COMPARE_FUNC,ae[A.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){const Q=e.get("EXT_texture_filter_anisotropic");if(A.magFilter===Dn||A.minFilter!==Fp&&A.minFilter!==pl||A.type===ks&&e.has("OES_texture_float_linear")===!1||a===!1&&A.type===Ed&&e.has("OES_texture_half_float_linear")===!1)return;(A.anisotropy>1||i.get(A).__currentAnisotropy)&&(n.texParameterf(I,Q.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(A.anisotropy,r.getMaxAnisotropy())),i.get(A).__currentAnisotropy=A.anisotropy)}}function ne(I,A){let G=!1;I.__webglInit===void 0&&(I.__webglInit=!0,A.addEventListener("dispose",O));const Q=A.source;let ue=m.get(Q);ue===void 0&&(ue={},m.set(Q,ue));const k=J(A);if(k!==I.__cacheKey){ue[k]===void 0&&(ue[k]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,G=!0),ue[k].usedTimes++;const pe=ue[I.__cacheKey];pe!==void 0&&(ue[I.__cacheKey].usedTimes--,pe.usedTimes===0&&D(A)),I.__cacheKey=k,I.__webglTexture=ue[k].texture}return G}function he(I,A,G){let Q=n.TEXTURE_2D;(A.isDataArrayTexture||A.isCompressedArrayTexture)&&(Q=n.TEXTURE_2D_ARRAY),A.isData3DTexture&&(Q=n.TEXTURE_3D);const ue=ne(I,A),k=A.source;t.bindTexture(Q,I.__webglTexture,n.TEXTURE0+G);const pe=i.get(k);if(k.version!==pe.__version||ue===!0){t.activeTexture(n.TEXTURE0+G),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,A.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,A.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,A.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,n.NONE);const Ee=b(A)&&x(A.image)===!1;let se=y(A.image,Ee,!1,c);se=we(A,se);const De=x(se)||a,Ne=s.convert(A.format,A.colorSpace);let Ue=s.convert(A.type),Ce=P(A.internalFormat,Ne,Ue,A.colorSpace);Y(Q,A,De);let Re;const Ve=A.mipmaps,ft=a&&A.isVideoTexture!==!0,q=pe.__version===void 0||ue===!0,Ie=E(A,se,De);if(A.isDepthTexture)Ce=n.DEPTH_COMPONENT,a?A.type===ks?Ce=n.DEPTH_COMPONENT32F:A.type===Ro?Ce=n.DEPTH_COMPONENT24:A.type===ol?Ce=n.DEPTH24_STENCIL8:Ce=n.DEPTH_COMPONENT16:A.type===ks&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),A.format===al&&Ce===n.DEPTH_COMPONENT&&A.type!==uS&&A.type!==Ro&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),A.type=Ro,Ue=s.convert(A.type)),A.format===rc&&Ce===n.DEPTH_COMPONENT&&(Ce=n.DEPTH_STENCIL,A.type!==ol&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),A.type=ol,Ue=s.convert(A.type))),q&&(ft?t.texStorage2D(n.TEXTURE_2D,1,Ce,se.width,se.height):t.texImage2D(n.TEXTURE_2D,0,Ce,se.width,se.height,0,Ne,Ue,null));else if(A.isDataTexture)if(Ve.length>0&&De){ft&&q&&t.texStorage2D(n.TEXTURE_2D,Ie,Ce,Ve[0].width,Ve[0].height);for(let de=0,Ae=Ve.length;de<Ae;de++)Re=Ve[de],ft?t.texSubImage2D(n.TEXTURE_2D,de,0,0,Re.width,Re.height,Ne,Ue,Re.data):t.texImage2D(n.TEXTURE_2D,de,Ce,Re.width,Re.height,0,Ne,Ue,Re.data);A.generateMipmaps=!1}else ft?(q&&t.texStorage2D(n.TEXTURE_2D,Ie,Ce,se.width,se.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,se.width,se.height,Ne,Ue,se.data)):t.texImage2D(n.TEXTURE_2D,0,Ce,se.width,se.height,0,Ne,Ue,se.data);else if(A.isCompressedTexture)if(A.isCompressedArrayTexture){ft&&q&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Ie,Ce,Ve[0].width,Ve[0].height,se.depth);for(let de=0,Ae=Ve.length;de<Ae;de++)Re=Ve[de],A.format!==Zi?Ne!==null?ft?t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,de,0,0,0,Re.width,Re.height,se.depth,Ne,Re.data,0,0):t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,de,Ce,Re.width,Re.height,se.depth,0,Re.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ft?t.texSubImage3D(n.TEXTURE_2D_ARRAY,de,0,0,0,Re.width,Re.height,se.depth,Ne,Ue,Re.data):t.texImage3D(n.TEXTURE_2D_ARRAY,de,Ce,Re.width,Re.height,se.depth,0,Ne,Ue,Re.data)}else{ft&&q&&t.texStorage2D(n.TEXTURE_2D,Ie,Ce,Ve[0].width,Ve[0].height);for(let de=0,Ae=Ve.length;de<Ae;de++)Re=Ve[de],A.format!==Zi?Ne!==null?ft?t.compressedTexSubImage2D(n.TEXTURE_2D,de,0,0,Re.width,Re.height,Ne,Re.data):t.compressedTexImage2D(n.TEXTURE_2D,de,Ce,Re.width,Re.height,0,Re.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ft?t.texSubImage2D(n.TEXTURE_2D,de,0,0,Re.width,Re.height,Ne,Ue,Re.data):t.texImage2D(n.TEXTURE_2D,de,Ce,Re.width,Re.height,0,Ne,Ue,Re.data)}else if(A.isDataArrayTexture)ft?(q&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Ie,Ce,se.width,se.height,se.depth),t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,se.width,se.height,se.depth,Ne,Ue,se.data)):t.texImage3D(n.TEXTURE_2D_ARRAY,0,Ce,se.width,se.height,se.depth,0,Ne,Ue,se.data);else if(A.isData3DTexture)ft?(q&&t.texStorage3D(n.TEXTURE_3D,Ie,Ce,se.width,se.height,se.depth),t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,se.width,se.height,se.depth,Ne,Ue,se.data)):t.texImage3D(n.TEXTURE_3D,0,Ce,se.width,se.height,se.depth,0,Ne,Ue,se.data);else if(A.isFramebufferTexture){if(q)if(ft)t.texStorage2D(n.TEXTURE_2D,Ie,Ce,se.width,se.height);else{let de=se.width,Ae=se.height;for(let Le=0;Le<Ie;Le++)t.texImage2D(n.TEXTURE_2D,Le,Ce,de,Ae,0,Ne,Ue,null),de>>=1,Ae>>=1}}else if(Ve.length>0&&De){ft&&q&&t.texStorage2D(n.TEXTURE_2D,Ie,Ce,Ve[0].width,Ve[0].height);for(let de=0,Ae=Ve.length;de<Ae;de++)Re=Ve[de],ft?t.texSubImage2D(n.TEXTURE_2D,de,0,0,Ne,Ue,Re):t.texImage2D(n.TEXTURE_2D,de,Ce,Ne,Ue,Re);A.generateMipmaps=!1}else ft?(q&&t.texStorage2D(n.TEXTURE_2D,Ie,Ce,se.width,se.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,Ne,Ue,se)):t.texImage2D(n.TEXTURE_2D,0,Ce,Ne,Ue,se);S(A,De)&&T(Q),pe.__version=k.version,A.onUpdate&&A.onUpdate(A)}I.__version=A.version}function xe(I,A,G){if(A.image.length!==6)return;const Q=ne(I,A),ue=A.source;t.bindTexture(n.TEXTURE_CUBE_MAP,I.__webglTexture,n.TEXTURE0+G);const k=i.get(ue);if(ue.version!==k.__version||Q===!0){t.activeTexture(n.TEXTURE0+G),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,A.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,A.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,A.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,n.NONE);const pe=A.isCompressedTexture||A.image[0].isCompressedTexture,Ee=A.image[0]&&A.image[0].isDataTexture,se=[];for(let de=0;de<6;de++)!pe&&!Ee?se[de]=y(A.image[de],!1,!0,u):se[de]=Ee?A.image[de].image:A.image[de],se[de]=we(A,se[de]);const De=se[0],Ne=x(De)||a,Ue=s.convert(A.format,A.colorSpace),Ce=s.convert(A.type),Re=P(A.internalFormat,Ue,Ce,A.colorSpace),Ve=a&&A.isVideoTexture!==!0,ft=k.__version===void 0||Q===!0;let q=E(A,De,Ne);Y(n.TEXTURE_CUBE_MAP,A,Ne);let Ie;if(pe){Ve&&ft&&t.texStorage2D(n.TEXTURE_CUBE_MAP,q,Re,De.width,De.height);for(let de=0;de<6;de++){Ie=se[de].mipmaps;for(let Ae=0;Ae<Ie.length;Ae++){const Le=Ie[Ae];A.format!==Zi?Ue!==null?Ve?t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+de,Ae,0,0,Le.width,Le.height,Ue,Le.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+de,Ae,Re,Le.width,Le.height,0,Le.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Ve?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+de,Ae,0,0,Le.width,Le.height,Ue,Ce,Le.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+de,Ae,Re,Le.width,Le.height,0,Ue,Ce,Le.data)}}}else{Ie=A.mipmaps,Ve&&ft&&(Ie.length>0&&q++,t.texStorage2D(n.TEXTURE_CUBE_MAP,q,Re,se[0].width,se[0].height));for(let de=0;de<6;de++)if(Ee){Ve?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+de,0,0,0,se[de].width,se[de].height,Ue,Ce,se[de].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+de,0,Re,se[de].width,se[de].height,0,Ue,Ce,se[de].data);for(let Ae=0;Ae<Ie.length;Ae++){const Et=Ie[Ae].image[de].image;Ve?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+de,Ae+1,0,0,Et.width,Et.height,Ue,Ce,Et.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+de,Ae+1,Re,Et.width,Et.height,0,Ue,Ce,Et.data)}}else{Ve?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+de,0,0,0,Ue,Ce,se[de]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+de,0,Re,Ue,Ce,se[de]);for(let Ae=0;Ae<Ie.length;Ae++){const Le=Ie[Ae];Ve?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+de,Ae+1,0,0,Ue,Ce,Le.image[de]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+de,Ae+1,Re,Ue,Ce,Le.image[de])}}}S(A,Ne)&&T(n.TEXTURE_CUBE_MAP),k.__version=ue.version,A.onUpdate&&A.onUpdate(A)}I.__version=A.version}function be(I,A,G,Q,ue){const k=s.convert(G.format,G.colorSpace),pe=s.convert(G.type),Ee=P(G.internalFormat,k,pe,G.colorSpace);i.get(A).__hasExternalTextures||(ue===n.TEXTURE_3D||ue===n.TEXTURE_2D_ARRAY?t.texImage3D(ue,0,Ee,A.width,A.height,A.depth,0,k,pe,null):t.texImage2D(ue,0,Ee,A.width,A.height,0,k,pe,null)),t.bindFramebuffer(n.FRAMEBUFFER,I),fe(A)?d.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,Q,ue,i.get(G).__webglTexture,0,le(A)):(ue===n.TEXTURE_2D||ue>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&ue<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,Q,ue,i.get(G).__webglTexture,0),t.bindFramebuffer(n.FRAMEBUFFER,null)}function w(I,A,G){if(n.bindRenderbuffer(n.RENDERBUFFER,I),A.depthBuffer&&!A.stencilBuffer){let Q=n.DEPTH_COMPONENT16;if(G||fe(A)){const ue=A.depthTexture;ue&&ue.isDepthTexture&&(ue.type===ks?Q=n.DEPTH_COMPONENT32F:ue.type===Ro&&(Q=n.DEPTH_COMPONENT24));const k=le(A);fe(A)?d.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,k,Q,A.width,A.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,k,Q,A.width,A.height)}else n.renderbufferStorage(n.RENDERBUFFER,Q,A.width,A.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,I)}else if(A.depthBuffer&&A.stencilBuffer){const Q=le(A);G&&fe(A)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,Q,n.DEPTH24_STENCIL8,A.width,A.height):fe(A)?d.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Q,n.DEPTH24_STENCIL8,A.width,A.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,A.width,A.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,I)}else{const Q=A.isWebGLMultipleRenderTargets===!0?A.texture:[A.texture];for(let ue=0;ue<Q.length;ue++){const k=Q[ue],pe=s.convert(k.format,k.colorSpace),Ee=s.convert(k.type),se=P(k.internalFormat,pe,Ee,k.colorSpace),De=le(A);G&&fe(A)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,De,se,A.width,A.height):fe(A)?d.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,De,se,A.width,A.height):n.renderbufferStorage(n.RENDERBUFFER,se,A.width,A.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function V(I,A){if(A&&A.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,I),!(A.depthTexture&&A.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(A.depthTexture).__webglTexture||A.depthTexture.image.width!==A.width||A.depthTexture.image.height!==A.height)&&(A.depthTexture.image.width=A.width,A.depthTexture.image.height=A.height,A.depthTexture.needsUpdate=!0),j(A.depthTexture,0);const Q=i.get(A.depthTexture).__webglTexture,ue=le(A);if(A.depthTexture.format===al)fe(A)?d.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Q,0,ue):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Q,0);else if(A.depthTexture.format===rc)fe(A)?d.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Q,0,ue):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Q,0);else throw new Error("Unknown depthTexture format")}function H(I){const A=i.get(I),G=I.isWebGLCubeRenderTarget===!0;if(I.depthTexture&&!A.__autoAllocateDepthBuffer){if(G)throw new Error("target.depthTexture not supported in Cube render targets");V(A.__webglFramebuffer,I)}else if(G){A.__webglDepthbuffer=[];for(let Q=0;Q<6;Q++)t.bindFramebuffer(n.FRAMEBUFFER,A.__webglFramebuffer[Q]),A.__webglDepthbuffer[Q]=n.createRenderbuffer(),w(A.__webglDepthbuffer[Q],I,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,A.__webglFramebuffer),A.__webglDepthbuffer=n.createRenderbuffer(),w(A.__webglDepthbuffer,I,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function K(I,A,G){const Q=i.get(I);A!==void 0&&be(Q.__webglFramebuffer,I,I.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D),G!==void 0&&H(I)}function Z(I){const A=I.texture,G=i.get(I),Q=i.get(A);I.addEventListener("dispose",L),I.isWebGLMultipleRenderTargets!==!0&&(Q.__webglTexture===void 0&&(Q.__webglTexture=n.createTexture()),Q.__version=A.version,o.memory.textures++);const ue=I.isWebGLCubeRenderTarget===!0,k=I.isWebGLMultipleRenderTargets===!0,pe=x(I)||a;if(ue){G.__webglFramebuffer=[];for(let Ee=0;Ee<6;Ee++)G.__webglFramebuffer[Ee]=n.createFramebuffer()}else{if(G.__webglFramebuffer=n.createFramebuffer(),k)if(r.drawBuffers){const Ee=I.texture;for(let se=0,De=Ee.length;se<De;se++){const Ne=i.get(Ee[se]);Ne.__webglTexture===void 0&&(Ne.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&I.samples>0&&fe(I)===!1){const Ee=k?A:[A];G.__webglMultisampledFramebuffer=n.createFramebuffer(),G.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,G.__webglMultisampledFramebuffer);for(let se=0;se<Ee.length;se++){const De=Ee[se];G.__webglColorRenderbuffer[se]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,G.__webglColorRenderbuffer[se]);const Ne=s.convert(De.format,De.colorSpace),Ue=s.convert(De.type),Ce=P(De.internalFormat,Ne,Ue,De.colorSpace,I.isXRRenderTarget===!0),Re=le(I);n.renderbufferStorageMultisample(n.RENDERBUFFER,Re,Ce,I.width,I.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+se,n.RENDERBUFFER,G.__webglColorRenderbuffer[se])}n.bindRenderbuffer(n.RENDERBUFFER,null),I.depthBuffer&&(G.__webglDepthRenderbuffer=n.createRenderbuffer(),w(G.__webglDepthRenderbuffer,I,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(ue){t.bindTexture(n.TEXTURE_CUBE_MAP,Q.__webglTexture),Y(n.TEXTURE_CUBE_MAP,A,pe);for(let Ee=0;Ee<6;Ee++)be(G.__webglFramebuffer[Ee],I,A,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee);S(A,pe)&&T(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(k){const Ee=I.texture;for(let se=0,De=Ee.length;se<De;se++){const Ne=Ee[se],Ue=i.get(Ne);t.bindTexture(n.TEXTURE_2D,Ue.__webglTexture),Y(n.TEXTURE_2D,Ne,pe),be(G.__webglFramebuffer,I,Ne,n.COLOR_ATTACHMENT0+se,n.TEXTURE_2D),S(Ne,pe)&&T(n.TEXTURE_2D)}t.unbindTexture()}else{let Ee=n.TEXTURE_2D;(I.isWebGL3DRenderTarget||I.isWebGLArrayRenderTarget)&&(a?Ee=I.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(Ee,Q.__webglTexture),Y(Ee,A,pe),be(G.__webglFramebuffer,I,A,n.COLOR_ATTACHMENT0,Ee),S(A,pe)&&T(Ee),t.unbindTexture()}I.depthBuffer&&H(I)}function ee(I){const A=x(I)||a,G=I.isWebGLMultipleRenderTargets===!0?I.texture:[I.texture];for(let Q=0,ue=G.length;Q<ue;Q++){const k=G[Q];if(S(k,A)){const pe=I.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,Ee=i.get(k).__webglTexture;t.bindTexture(pe,Ee),T(pe),t.unbindTexture()}}}function ge(I){if(a&&I.samples>0&&fe(I)===!1){const A=I.isWebGLMultipleRenderTargets?I.texture:[I.texture],G=I.width,Q=I.height;let ue=n.COLOR_BUFFER_BIT;const k=[],pe=I.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Ee=i.get(I),se=I.isWebGLMultipleRenderTargets===!0;if(se)for(let De=0;De<A.length;De++)t.bindFramebuffer(n.FRAMEBUFFER,Ee.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+De,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,Ee.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+De,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,Ee.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ee.__webglFramebuffer);for(let De=0;De<A.length;De++){k.push(n.COLOR_ATTACHMENT0+De),I.depthBuffer&&k.push(pe);const Ne=Ee.__ignoreDepthValues!==void 0?Ee.__ignoreDepthValues:!1;if(Ne===!1&&(I.depthBuffer&&(ue|=n.DEPTH_BUFFER_BIT),I.stencilBuffer&&(ue|=n.STENCIL_BUFFER_BIT)),se&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Ee.__webglColorRenderbuffer[De]),Ne===!0&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[pe]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[pe])),se){const Ue=i.get(A[De]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,Ue,0)}n.blitFramebuffer(0,0,G,Q,0,0,G,Q,ue,n.NEAREST),f&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,k)}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),se)for(let De=0;De<A.length;De++){t.bindFramebuffer(n.FRAMEBUFFER,Ee.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+De,n.RENDERBUFFER,Ee.__webglColorRenderbuffer[De]);const Ne=i.get(A[De]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,Ee.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+De,n.TEXTURE_2D,Ne,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ee.__webglMultisampledFramebuffer)}}function le(I){return Math.min(h,I.samples)}function fe(I){const A=i.get(I);return a&&I.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&A.__useRenderToTexture!==!1}function me(I){const A=o.render.frame;p.get(I)!==A&&(p.set(I,A),I.update())}function we(I,A){const G=I.colorSpace,Q=I.format,ue=I.type;return I.isCompressedTexture===!0||I.format===Ly||G!==cs&&G!==ll&&(G===nt?a===!1?e.has("EXT_sRGB")===!0&&Q===Zi?(I.format=Ly,I.minFilter=mi,I.generateMipmaps=!1):A=r2.sRGBToLinear(A):(Q!==Zi||ue!==Bo)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",G)),A}this.allocateTextureUnit=$,this.resetTextureUnits=U,this.setTexture2D=j,this.setTexture2DArray=F,this.setTexture3D=X,this.setTextureCube=re,this.rebindTextures=K,this.setupRenderTarget=Z,this.updateRenderTargetMipmap=ee,this.updateMultisampleRenderTarget=ge,this.setupDepthRenderbuffer=H,this.setupFrameBufferTexture=be,this.useMultisampledRTT=fe}function Vre(n,e,t){const i=t.isWebGL2;function r(s,o=ll){let a;if(s===Bo)return n.UNSIGNED_BYTE;if(s===YO)return n.UNSIGNED_SHORT_4_4_4_4;if(s===qO)return n.UNSIGNED_SHORT_5_5_5_1;if(s===rQ)return n.BYTE;if(s===sQ)return n.SHORT;if(s===uS)return n.UNSIGNED_SHORT;if(s===$O)return n.INT;if(s===Ro)return n.UNSIGNED_INT;if(s===ks)return n.FLOAT;if(s===Ed)return i?n.HALF_FLOAT:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===oQ)return n.ALPHA;if(s===Zi)return n.RGBA;if(s===aQ)return n.LUMINANCE;if(s===lQ)return n.LUMINANCE_ALPHA;if(s===al)return n.DEPTH_COMPONENT;if(s===rc)return n.DEPTH_STENCIL;if(s===Ly)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===uQ)return n.RED;if(s===KO)return n.RED_INTEGER;if(s===cQ)return n.RG;if(s===ZO)return n.RG_INTEGER;if(s===JO)return n.RGBA_INTEGER;if(s===q_||s===K_||s===Z_||s===J_)if(o===nt)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===q_)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===K_)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===Z_)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===J_)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===q_)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===K_)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===Z_)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===J_)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===Ew||s===Tw||s===Mw||s===ww)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===Ew)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===Tw)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===Mw)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===ww)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===hQ)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===Aw||s===Pw)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===Aw)return o===nt?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===Pw)return o===nt?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===Cw||s===Rw||s===Iw||s===Lw||s===Ow||s===Dw||s===Fw||s===Nw||s===Uw||s===Bw||s===kw||s===Vw||s===Gw||s===Hw)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===Cw)return o===nt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===Rw)return o===nt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===Iw)return o===nt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===Lw)return o===nt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===Ow)return o===nt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===Dw)return o===nt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===Fw)return o===nt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===Nw)return o===nt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===Uw)return o===nt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===Bw)return o===nt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===kw)return o===nt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===Vw)return o===nt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===Gw)return o===nt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===Hw)return o===nt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===Q_)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===Q_)return o===nt?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(s===dQ||s===zw||s===Ww||s===Xw)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(s===Q_)return a.COMPRESSED_RED_RGTC1_EXT;if(s===zw)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===Ww)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===Xw)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===ol?i?n.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):n[s]!==void 0?n[s]:null}return{convert:r}}class Gre extends si{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Ri extends Ft{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Hre={type:"move"};class Sv{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Ri,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Ri,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new z,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new z),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Ri,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new z,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new z),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,u=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(u&&e.hand){o=!0;for(const _ of e.hand.values()){const m=t.getJointPose(_,i),g=this._getHandJoint(u,_);m!==null&&(g.matrix.fromArray(m.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.matrixWorldNeedsUpdate=!0,g.jointRadius=m.radius),g.visible=m!==null}const c=u.joints["index-finger-tip"],h=u.joints["thumb-tip"],d=c.position.distanceTo(h.position),f=.02,p=.005;u.inputState.pinching&&d>f+p?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&d<=f-p&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(r=t.getPose(e.targetRaySpace,i),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(Hre)))}return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),u!==null&&(u.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const i=new Ri;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class zre extends jn{constructor(e,t,i,r,s,o,a,l,u,c){if(c=c!==void 0?c:al,c!==al&&c!==rc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&c===al&&(i=Ro),i===void 0&&c===rc&&(i=ol),super(null,r,s,o,a,l,c,i,u),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:Dn,this.minFilter=l!==void 0?l:Dn,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class Wre extends Ko{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=1,u=null,c=null,h=null,d=null,f=null,p=null;const _=t.getContextAttributes();let m=null,g=null;const v=[],y=[],x=new si;x.layers.enable(1),x.viewport=new zt;const b=new si;b.layers.enable(2),b.viewport=new zt;const S=[x,b],T=new Gre;T.layers.enable(1),T.layers.enable(2);let P=null,E=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(F){let X=v[F];return X===void 0&&(X=new Sv,v[F]=X),X.getTargetRaySpace()},this.getControllerGrip=function(F){let X=v[F];return X===void 0&&(X=new Sv,v[F]=X),X.getGripSpace()},this.getHand=function(F){let X=v[F];return X===void 0&&(X=new Sv,v[F]=X),X.getHandSpace()};function M(F){const X=y.indexOf(F.inputSource);if(X===-1)return;const re=v[X];re!==void 0&&(re.update(F.inputSource,F.frame,u||o),re.dispatchEvent({type:F.type,data:F.inputSource}))}function O(){r.removeEventListener("select",M),r.removeEventListener("selectstart",M),r.removeEventListener("selectend",M),r.removeEventListener("squeeze",M),r.removeEventListener("squeezestart",M),r.removeEventListener("squeezeend",M),r.removeEventListener("end",O),r.removeEventListener("inputsourceschange",L);for(let F=0;F<v.length;F++){const X=y[F];X!==null&&(y[F]=null,v[F].disconnect(X))}P=null,E=null,e.setRenderTarget(m),f=null,d=null,h=null,r=null,g=null,j.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(F){s=F,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(F){a=F,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||o},this.setReferenceSpace=function(F){u=F},this.getBaseLayer=function(){return d!==null?d:f},this.getBinding=function(){return h},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=async function(F){if(r=F,r!==null){if(m=e.getRenderTarget(),r.addEventListener("select",M),r.addEventListener("selectstart",M),r.addEventListener("selectend",M),r.addEventListener("squeeze",M),r.addEventListener("squeezestart",M),r.addEventListener("squeezeend",M),r.addEventListener("end",O),r.addEventListener("inputsourceschange",L),_.xrCompatible!==!0&&await t.makeXRCompatible(),r.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const X={antialias:r.renderState.layers===void 0?_.antialias:!0,alpha:!0,depth:_.depth,stencil:_.stencil,framebufferScaleFactor:s};f=new XRWebGLLayer(r,t,X),r.updateRenderState({baseLayer:f}),g=new ml(f.framebufferWidth,f.framebufferHeight,{format:Zi,type:Bo,colorSpace:e.outputColorSpace,stencilBuffer:_.stencil})}else{let X=null,re=null,ce=null;_.depth&&(ce=_.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,X=_.stencil?rc:al,re=_.stencil?ol:Ro);const ve={colorFormat:t.RGBA8,depthFormat:ce,scaleFactor:s};h=new XRWebGLBinding(r,t),d=h.createProjectionLayer(ve),r.updateRenderState({layers:[d]}),g=new ml(d.textureWidth,d.textureHeight,{format:Zi,type:Bo,depthTexture:new zre(d.textureWidth,d.textureHeight,re,void 0,void 0,void 0,void 0,void 0,void 0,X),stencilBuffer:_.stencil,colorSpace:e.outputColorSpace,samples:_.antialias?4:0});const ae=e.properties.get(g);ae.__ignoreDepthValues=d.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(l),u=null,o=await r.requestReferenceSpace(a),j.setContext(r),j.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode};function L(F){for(let X=0;X<F.removed.length;X++){const re=F.removed[X],ce=y.indexOf(re);ce>=0&&(y[ce]=null,v[ce].disconnect(re))}for(let X=0;X<F.added.length;X++){const re=F.added[X];let ce=y.indexOf(re);if(ce===-1){for(let ae=0;ae<v.length;ae++)if(ae>=y.length){y.push(re),ce=ae;break}else if(y[ae]===null){y[ae]=re,ce=ae;break}if(ce===-1)break}const ve=v[ce];ve&&ve.connect(re)}}const C=new z,D=new z;function B(F,X,re){C.setFromMatrixPosition(X.matrixWorld),D.setFromMatrixPosition(re.matrixWorld);const ce=C.distanceTo(D),ve=X.projectionMatrix.elements,ae=re.projectionMatrix.elements,Y=ve[14]/(ve[10]-1),ne=ve[14]/(ve[10]+1),he=(ve[9]+1)/ve[5],xe=(ve[9]-1)/ve[5],be=(ve[8]-1)/ve[0],w=(ae[8]+1)/ae[0],V=Y*be,H=Y*w,K=ce/(-be+w),Z=K*-be;X.matrixWorld.decompose(F.position,F.quaternion,F.scale),F.translateX(Z),F.translateZ(K),F.matrixWorld.compose(F.position,F.quaternion,F.scale),F.matrixWorldInverse.copy(F.matrixWorld).invert();const ee=Y+K,ge=ne+K,le=V-Z,fe=H+(ce-Z),me=he*ne/ge*ee,we=xe*ne/ge*ee;F.projectionMatrix.makePerspective(le,fe,me,we,ee,ge),F.projectionMatrixInverse.copy(F.projectionMatrix).invert()}function W(F,X){X===null?F.matrixWorld.copy(F.matrix):F.matrixWorld.multiplyMatrices(X.matrixWorld,F.matrix),F.matrixWorldInverse.copy(F.matrixWorld).invert()}this.updateCamera=function(F){if(r===null)return;T.near=b.near=x.near=F.near,T.far=b.far=x.far=F.far,(P!==T.near||E!==T.far)&&(r.updateRenderState({depthNear:T.near,depthFar:T.far}),P=T.near,E=T.far);const X=F.parent,re=T.cameras;W(T,X);for(let ce=0;ce<re.length;ce++)W(re[ce],X);re.length===2?B(T,x,b):T.projectionMatrix.copy(x.projectionMatrix),U(F,T,X)};function U(F,X,re){re===null?F.matrix.copy(X.matrixWorld):(F.matrix.copy(re.matrixWorld),F.matrix.invert(),F.matrix.multiply(X.matrixWorld)),F.matrix.decompose(F.position,F.quaternion,F.scale),F.updateMatrixWorld(!0);const ce=F.children;for(let ve=0,ae=ce.length;ve<ae;ve++)ce[ve].updateMatrixWorld(!0);F.projectionMatrix.copy(X.projectionMatrix),F.projectionMatrixInverse.copy(X.projectionMatrixInverse),F.isPerspectiveCamera&&(F.fov=oc*2*Math.atan(1/F.projectionMatrix.elements[5]),F.zoom=1)}this.getCamera=function(){return T},this.getFoveation=function(){if(!(d===null&&f===null))return l},this.setFoveation=function(F){l=F,d!==null&&(d.fixedFoveation=F),f!==null&&f.fixedFoveation!==void 0&&(f.fixedFoveation=F)};let $=null;function J(F,X){if(c=X.getViewerPose(u||o),p=X,c!==null){const re=c.views;f!==null&&(e.setRenderTargetFramebuffer(g,f.framebuffer),e.setRenderTarget(g));let ce=!1;re.length!==T.cameras.length&&(T.cameras.length=0,ce=!0);for(let ve=0;ve<re.length;ve++){const ae=re[ve];let Y=null;if(f!==null)Y=f.getViewport(ae);else{const he=h.getViewSubImage(d,ae);Y=he.viewport,ve===0&&(e.setRenderTargetTextures(g,he.colorTexture,d.ignoreDepthValues?void 0:he.depthStencilTexture),e.setRenderTarget(g))}let ne=S[ve];ne===void 0&&(ne=new si,ne.layers.enable(ve),ne.viewport=new zt,S[ve]=ne),ne.matrix.fromArray(ae.transform.matrix),ne.matrix.decompose(ne.position,ne.quaternion,ne.scale),ne.projectionMatrix.fromArray(ae.projectionMatrix),ne.projectionMatrixInverse.copy(ne.projectionMatrix).invert(),ne.viewport.set(Y.x,Y.y,Y.width,Y.height),ve===0&&(T.matrix.copy(ne.matrix),T.matrix.decompose(T.position,T.quaternion,T.scale)),ce===!0&&T.cameras.push(ne)}}for(let re=0;re<v.length;re++){const ce=y[re],ve=v[re];ce!==null&&ve!==void 0&&ve.update(ce,X,u||o)}$&&$(F,X),X.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:X}),p=null}const j=new m2;j.setAnimationLoop(J),this.setAnimationLoop=function(F){$=F},this.dispose=function(){}}}function Xre(n,e){function t(m,g){m.matrixAutoUpdate===!0&&m.updateMatrix(),g.value.copy(m.matrix)}function i(m,g){g.color.getRGB(m.fogColor.value,h2(n)),g.isFog?(m.fogNear.value=g.near,m.fogFar.value=g.far):g.isFogExp2&&(m.fogDensity.value=g.density)}function r(m,g,v,y,x){g.isMeshBasicMaterial||g.isMeshLambertMaterial?s(m,g):g.isMeshToonMaterial?(s(m,g),h(m,g)):g.isMeshPhongMaterial?(s(m,g),c(m,g)):g.isMeshStandardMaterial?(s(m,g),d(m,g),g.isMeshPhysicalMaterial&&f(m,g,x)):g.isMeshMatcapMaterial?(s(m,g),p(m,g)):g.isMeshDepthMaterial?s(m,g):g.isMeshDistanceMaterial?(s(m,g),_(m,g)):g.isMeshNormalMaterial?s(m,g):g.isLineBasicMaterial?(o(m,g),g.isLineDashedMaterial&&a(m,g)):g.isPointsMaterial?l(m,g,v,y):g.isSpriteMaterial?u(m,g):g.isShadowMaterial?(m.color.value.copy(g.color),m.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}function s(m,g){m.opacity.value=g.opacity,g.color&&m.diffuse.value.copy(g.color),g.emissive&&m.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(m.map.value=g.map,t(g.map,m.mapTransform)),g.alphaMap&&(m.alphaMap.value=g.alphaMap,t(g.alphaMap,m.alphaMapTransform)),g.bumpMap&&(m.bumpMap.value=g.bumpMap,t(g.bumpMap,m.bumpMapTransform),m.bumpScale.value=g.bumpScale,g.side===li&&(m.bumpScale.value*=-1)),g.normalMap&&(m.normalMap.value=g.normalMap,t(g.normalMap,m.normalMapTransform),m.normalScale.value.copy(g.normalScale),g.side===li&&m.normalScale.value.negate()),g.displacementMap&&(m.displacementMap.value=g.displacementMap,t(g.displacementMap,m.displacementMapTransform),m.displacementScale.value=g.displacementScale,m.displacementBias.value=g.displacementBias),g.emissiveMap&&(m.emissiveMap.value=g.emissiveMap,t(g.emissiveMap,m.emissiveMapTransform)),g.specularMap&&(m.specularMap.value=g.specularMap,t(g.specularMap,m.specularMapTransform)),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);const v=e.get(g).envMap;if(v&&(m.envMap.value=v,m.flipEnvMap.value=v.isCubeTexture&&v.isRenderTargetTexture===!1?-1:1,m.reflectivity.value=g.reflectivity,m.ior.value=g.ior,m.refractionRatio.value=g.refractionRatio),g.lightMap){m.lightMap.value=g.lightMap;const y=n.useLegacyLights===!0?Math.PI:1;m.lightMapIntensity.value=g.lightMapIntensity*y,t(g.lightMap,m.lightMapTransform)}g.aoMap&&(m.aoMap.value=g.aoMap,m.aoMapIntensity.value=g.aoMapIntensity,t(g.aoMap,m.aoMapTransform))}function o(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,g.map&&(m.map.value=g.map,t(g.map,m.mapTransform))}function a(m,g){m.dashSize.value=g.dashSize,m.totalSize.value=g.dashSize+g.gapSize,m.scale.value=g.scale}function l(m,g,v,y){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.size.value=g.size*v,m.scale.value=y*.5,g.map&&(m.map.value=g.map,t(g.map,m.uvTransform)),g.alphaMap&&(m.alphaMap.value=g.alphaMap,t(g.alphaMap,m.alphaMapTransform)),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest)}function u(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.rotation.value=g.rotation,g.map&&(m.map.value=g.map,t(g.map,m.mapTransform)),g.alphaMap&&(m.alphaMap.value=g.alphaMap,t(g.alphaMap,m.alphaMapTransform)),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest)}function c(m,g){m.specular.value.copy(g.specular),m.shininess.value=Math.max(g.shininess,1e-4)}function h(m,g){g.gradientMap&&(m.gradientMap.value=g.gradientMap)}function d(m,g){m.metalness.value=g.metalness,g.metalnessMap&&(m.metalnessMap.value=g.metalnessMap,t(g.metalnessMap,m.metalnessMapTransform)),m.roughness.value=g.roughness,g.roughnessMap&&(m.roughnessMap.value=g.roughnessMap,t(g.roughnessMap,m.roughnessMapTransform)),e.get(g).envMap&&(m.envMapIntensity.value=g.envMapIntensity)}function f(m,g,v){m.ior.value=g.ior,g.sheen>0&&(m.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),m.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(m.sheenColorMap.value=g.sheenColorMap,t(g.sheenColorMap,m.sheenColorMapTransform)),g.sheenRoughnessMap&&(m.sheenRoughnessMap.value=g.sheenRoughnessMap,t(g.sheenRoughnessMap,m.sheenRoughnessMapTransform))),g.clearcoat>0&&(m.clearcoat.value=g.clearcoat,m.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(m.clearcoatMap.value=g.clearcoatMap,t(g.clearcoatMap,m.clearcoatMapTransform)),g.clearcoatRoughnessMap&&(m.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap,t(g.clearcoatRoughnessMap,m.clearcoatRoughnessMapTransform)),g.clearcoatNormalMap&&(m.clearcoatNormalMap.value=g.clearcoatNormalMap,t(g.clearcoatNormalMap,m.clearcoatNormalMapTransform),m.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),g.side===li&&m.clearcoatNormalScale.value.negate())),g.iridescence>0&&(m.iridescence.value=g.iridescence,m.iridescenceIOR.value=g.iridescenceIOR,m.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],m.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(m.iridescenceMap.value=g.iridescenceMap,t(g.iridescenceMap,m.iridescenceMapTransform)),g.iridescenceThicknessMap&&(m.iridescenceThicknessMap.value=g.iridescenceThicknessMap,t(g.iridescenceThicknessMap,m.iridescenceThicknessMapTransform))),g.transmission>0&&(m.transmission.value=g.transmission,m.transmissionSamplerMap.value=v.texture,m.transmissionSamplerSize.value.set(v.width,v.height),g.transmissionMap&&(m.transmissionMap.value=g.transmissionMap,t(g.transmissionMap,m.transmissionMapTransform)),m.thickness.value=g.thickness,g.thicknessMap&&(m.thicknessMap.value=g.thicknessMap,t(g.thicknessMap,m.thicknessMapTransform)),m.attenuationDistance.value=g.attenuationDistance,m.attenuationColor.value.copy(g.attenuationColor)),g.anisotropy>0&&(m.anisotropyVector.value.set(g.anisotropy*Math.cos(g.anisotropyRotation),g.anisotropy*Math.sin(g.anisotropyRotation)),g.anisotropyMap&&(m.anisotropyMap.value=g.anisotropyMap,t(g.anisotropyMap,m.anisotropyMapTransform))),m.specularIntensity.value=g.specularIntensity,m.specularColor.value.copy(g.specularColor),g.specularColorMap&&(m.specularColorMap.value=g.specularColorMap,t(g.specularColorMap,m.specularColorMapTransform)),g.specularIntensityMap&&(m.specularIntensityMap.value=g.specularIntensityMap,t(g.specularIntensityMap,m.specularIntensityMapTransform))}function p(m,g){g.matcap&&(m.matcap.value=g.matcap)}function _(m,g){const v=e.get(g).light;m.referencePosition.value.setFromMatrixPosition(v.matrixWorld),m.nearDistance.value=v.shadow.camera.near,m.farDistance.value=v.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function jre(n,e,t,i){let r={},s={},o=[];const a=t.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(v,y){const x=y.program;i.uniformBlockBinding(v,x)}function u(v,y){let x=r[v.id];x===void 0&&(p(v),x=c(v),r[v.id]=x,v.addEventListener("dispose",m));const b=y.program;i.updateUBOMapping(v,b);const S=e.render.frame;s[v.id]!==S&&(d(v),s[v.id]=S)}function c(v){const y=h();v.__bindingPointIndex=y;const x=n.createBuffer(),b=v.__size,S=v.usage;return n.bindBuffer(n.UNIFORM_BUFFER,x),n.bufferData(n.UNIFORM_BUFFER,b,S),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,y,x),x}function h(){for(let v=0;v<a;v++)if(o.indexOf(v)===-1)return o.push(v),v;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(v){const y=r[v.id],x=v.uniforms,b=v.__cache;n.bindBuffer(n.UNIFORM_BUFFER,y);for(let S=0,T=x.length;S<T;S++){const P=x[S];if(f(P,S,b)===!0){const E=P.__offset,M=Array.isArray(P.value)?P.value:[P.value];let O=0;for(let L=0;L<M.length;L++){const C=M[L],D=_(C);typeof C=="number"?(P.__data[0]=C,n.bufferSubData(n.UNIFORM_BUFFER,E+O,P.__data)):C.isMatrix3?(P.__data[0]=C.elements[0],P.__data[1]=C.elements[1],P.__data[2]=C.elements[2],P.__data[3]=C.elements[0],P.__data[4]=C.elements[3],P.__data[5]=C.elements[4],P.__data[6]=C.elements[5],P.__data[7]=C.elements[0],P.__data[8]=C.elements[6],P.__data[9]=C.elements[7],P.__data[10]=C.elements[8],P.__data[11]=C.elements[0]):(C.toArray(P.__data,O),O+=D.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,E,P.__data)}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function f(v,y,x){const b=v.value;if(x[y]===void 0){if(typeof b=="number")x[y]=b;else{const S=Array.isArray(b)?b:[b],T=[];for(let P=0;P<S.length;P++)T.push(S[P].clone());x[y]=T}return!0}else if(typeof b=="number"){if(x[y]!==b)return x[y]=b,!0}else{const S=Array.isArray(x[y])?x[y]:[x[y]],T=Array.isArray(b)?b:[b];for(let P=0;P<S.length;P++){const E=S[P];if(E.equals(T[P])===!1)return E.copy(T[P]),!0}}return!1}function p(v){const y=v.uniforms;let x=0;const b=16;let S=0;for(let T=0,P=y.length;T<P;T++){const E=y[T],M={boundary:0,storage:0},O=Array.isArray(E.value)?E.value:[E.value];for(let L=0,C=O.length;L<C;L++){const D=O[L],B=_(D);M.boundary+=B.boundary,M.storage+=B.storage}if(E.__data=new Float32Array(M.storage/Float32Array.BYTES_PER_ELEMENT),E.__offset=x,T>0){S=x%b;const L=b-S;S!==0&&L-M.boundary<0&&(x+=b-S,E.__offset=x)}x+=M.storage}return S=x%b,S>0&&(x+=b-S),v.__size=x,v.__cache={},this}function _(v){const y={boundary:0,storage:0};return typeof v=="number"?(y.boundary=4,y.storage=4):v.isVector2?(y.boundary=8,y.storage=8):v.isVector3||v.isColor?(y.boundary=16,y.storage=12):v.isVector4?(y.boundary=16,y.storage=16):v.isMatrix3?(y.boundary=48,y.storage=48):v.isMatrix4?(y.boundary=64,y.storage=64):v.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",v),y}function m(v){const y=v.target;y.removeEventListener("dispose",m);const x=o.indexOf(y.__bindingPointIndex);o.splice(x,1),n.deleteBuffer(r[y.id]),delete r[y.id],delete s[y.id]}function g(){for(const v in r)n.deleteBuffer(r[v]);o=[],r={},s={}}return{bind:l,update:u,dispose:g}}function $re(){const n=Md("canvas");return n.style.display="block",n}class x2{constructor(e={}){const{canvas:t=$re(),context:i=null,depth:r=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:u=!1,powerPreference:c="default",failIfMajorPerformanceCaveat:h=!1}=e;this.isWebGLRenderer=!0;let d;i!==null?d=i.getContextAttributes().alpha:d=o;const f=new Uint32Array(4),p=new Int32Array(4);let _=null,m=null;const g=[],v=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputColorSpace=nt,this.useLegacyLights=!0,this.toneMapping=js,this.toneMappingExposure=1;const y=this;let x=!1,b=0,S=0,T=null,P=-1,E=null;const M=new zt,O=new zt;let L=null;const C=new We(0);let D=0,B=t.width,W=t.height,U=1,$=null,J=null;const j=new zt(0,0,B,W),F=new zt(0,0,B,W);let X=!1;const re=new fS;let ce=!1,ve=!1,ae=null;const Y=new Qe,ne=new Ze,he=new z,xe={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function be(){return T===null?U:1}let w=i;function V(N,ie){for(let _e=0;_e<N.length;_e++){const te=N[_e],ye=t.getContext(te,ie);if(ye!==null)return ye}return null}try{const N={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:u,powerPreference:c,failIfMajorPerformanceCaveat:h};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${Er}`),t.addEventListener("webglcontextlost",Ie,!1),t.addEventListener("webglcontextrestored",de,!1),t.addEventListener("webglcontextcreationerror",Ae,!1),w===null){const ie=["webgl2","webgl","experimental-webgl"];if(y.isWebGL1Renderer===!0&&ie.shift(),w=V(ie,N),w===null)throw V(ie)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&w instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),w.getShaderPrecisionFormat===void 0&&(w.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(N){throw console.error("THREE.WebGLRenderer: "+N.message),N}let H,K,Z,ee,ge,le,fe,me,we,I,A,G,Q,ue,k,pe,Ee,se,De,Ne,Ue,Ce,Re,Ve;function ft(){H=new iie(w),K=new Zne(w,H,e),H.init(K),Ce=new Vre(w,H,K),Z=new Bre(w,H,K),ee=new oie(w),ge=new Tre,le=new kre(w,H,Z,ge,K,Ce,ee),fe=new Qne(y),me=new nie(y),we=new gee(w,K),Re=new qne(w,H,we,K),I=new rie(w,we,ee,Re),A=new cie(w,I,we,ee),De=new uie(w,K,le),pe=new Jne(ge),G=new Ere(y,fe,me,H,K,Re,pe),Q=new Xre(y,ge),ue=new wre,k=new Lre(H,K),se=new Yne(y,fe,me,Z,A,d,l),Ee=new Ure(y,A,K),Ve=new jre(w,ee,K,Z),Ne=new Kne(w,H,ee,K),Ue=new sie(w,H,ee,K),ee.programs=G.programs,y.capabilities=K,y.extensions=H,y.properties=ge,y.renderLists=ue,y.shadowMap=Ee,y.state=Z,y.info=ee}ft();const q=new Wre(y,w);this.xr=q,this.getContext=function(){return w},this.getContextAttributes=function(){return w.getContextAttributes()},this.forceContextLoss=function(){const N=H.get("WEBGL_lose_context");N&&N.loseContext()},this.forceContextRestore=function(){const N=H.get("WEBGL_lose_context");N&&N.restoreContext()},this.getPixelRatio=function(){return U},this.setPixelRatio=function(N){N!==void 0&&(U=N,this.setSize(B,W,!1))},this.getSize=function(N){return N.set(B,W)},this.setSize=function(N,ie,_e=!0){if(q.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}B=N,W=ie,t.width=Math.floor(N*U),t.height=Math.floor(ie*U),_e===!0&&(t.style.width=N+"px",t.style.height=ie+"px"),this.setViewport(0,0,N,ie)},this.getDrawingBufferSize=function(N){return N.set(B*U,W*U).floor()},this.setDrawingBufferSize=function(N,ie,_e){B=N,W=ie,U=_e,t.width=Math.floor(N*_e),t.height=Math.floor(ie*_e),this.setViewport(0,0,N,ie)},this.getCurrentViewport=function(N){return N.copy(M)},this.getViewport=function(N){return N.copy(j)},this.setViewport=function(N,ie,_e,te){N.isVector4?j.set(N.x,N.y,N.z,N.w):j.set(N,ie,_e,te),Z.viewport(M.copy(j).multiplyScalar(U).floor())},this.getScissor=function(N){return N.copy(F)},this.setScissor=function(N,ie,_e,te){N.isVector4?F.set(N.x,N.y,N.z,N.w):F.set(N,ie,_e,te),Z.scissor(O.copy(F).multiplyScalar(U).floor())},this.getScissorTest=function(){return X},this.setScissorTest=function(N){Z.setScissorTest(X=N)},this.setOpaqueSort=function(N){$=N},this.setTransparentSort=function(N){J=N},this.getClearColor=function(N){return N.copy(se.getClearColor())},this.setClearColor=function(){se.setClearColor.apply(se,arguments)},this.getClearAlpha=function(){return se.getClearAlpha()},this.setClearAlpha=function(){se.setClearAlpha.apply(se,arguments)},this.clear=function(N=!0,ie=!0,_e=!0){let te=0;if(N){let ye=!1;if(T!==null){const Be=T.texture.format;ye=Be===JO||Be===ZO||Be===KO}if(ye){const Be=T.texture.type,Ye=Be===Bo||Be===Ro||Be===uS||Be===ol||Be===YO||Be===qO,tt=se.getClearColor(),it=se.getClearAlpha(),mt=tt.r,ot=tt.g,ct=tt.b;Ye?(f[0]=mt,f[1]=ot,f[2]=ct,f[3]=it,w.clearBufferuiv(w.COLOR,0,f)):(p[0]=mt,p[1]=ot,p[2]=ct,p[3]=it,w.clearBufferiv(w.COLOR,0,p))}else te|=w.COLOR_BUFFER_BIT}ie&&(te|=w.DEPTH_BUFFER_BIT),_e&&(te|=w.STENCIL_BUFFER_BIT),w.clear(te)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Ie,!1),t.removeEventListener("webglcontextrestored",de,!1),t.removeEventListener("webglcontextcreationerror",Ae,!1),ue.dispose(),k.dispose(),ge.dispose(),fe.dispose(),me.dispose(),A.dispose(),Re.dispose(),Ve.dispose(),G.dispose(),q.dispose(),q.removeEventListener("sessionstart",qt),q.removeEventListener("sessionend",Di),ae&&(ae.dispose(),ae=null),Vn.stop()};function Ie(N){N.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),x=!0}function de(){console.log("THREE.WebGLRenderer: Context Restored."),x=!1;const N=ee.autoReset,ie=Ee.enabled,_e=Ee.autoUpdate,te=Ee.needsUpdate,ye=Ee.type;ft(),ee.autoReset=N,Ee.enabled=ie,Ee.autoUpdate=_e,Ee.needsUpdate=te,Ee.type=ye}function Ae(N){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",N.statusMessage)}function Le(N){const ie=N.target;ie.removeEventListener("dispose",Le),Et(ie)}function Et(N){Yt(N),ge.remove(N)}function Yt(N){const ie=ge.get(N).programs;ie!==void 0&&(ie.forEach(function(_e){G.releaseProgram(_e)}),N.isShaderMaterial&&G.releaseShaderCache(N))}this.renderBufferDirect=function(N,ie,_e,te,ye,Be){ie===null&&(ie=xe);const Ye=ye.isMesh&&ye.matrixWorld.determinant()<0,tt=wg(N,ie,_e,te,ye);Z.setMaterial(te,Ye);let it=_e.index,mt=1;te.wireframe===!0&&(it=I.getWireframeAttribute(_e),mt=2);const ot=_e.drawRange,ct=_e.attributes.position;let un=ot.start*mt,dn=(ot.start+ot.count)*mt;Be!==null&&(un=Math.max(un,Be.start*mt),dn=Math.min(dn,(Be.start+Be.count)*mt)),it!==null?(un=Math.max(un,0),dn=Math.min(dn,it.count)):ct!=null&&(un=Math.max(un,0),dn=Math.min(dn,ct.count));const ur=dn-un;if(ur<0||ur===1/0)return;Re.setup(ye,te,tt,_e,it);let gs,gn=Ne;if(it!==null&&(gs=we.get(it),gn=Ue,gn.setIndex(gs)),ye.isMesh)te.wireframe===!0?(Z.setLineWidth(te.wireframeLinewidth*be()),gn.setMode(w.LINES)):gn.setMode(w.TRIANGLES);else if(ye.isLine){let Tt=te.linewidth;Tt===void 0&&(Tt=1),Z.setLineWidth(Tt*be()),ye.isLineSegments?gn.setMode(w.LINES):ye.isLineLoop?gn.setMode(w.LINE_LOOP):gn.setMode(w.LINE_STRIP)}else ye.isPoints?gn.setMode(w.POINTS):ye.isSprite&&gn.setMode(w.TRIANGLES);if(ye.isInstancedMesh)gn.renderInstances(un,ur,ye.count);else if(_e.isInstancedBufferGeometry){const Tt=_e._maxInstanceCount!==void 0?_e._maxInstanceCount:1/0,Pg=Math.min(_e.instanceCount,Tt);gn.renderInstances(un,ur,Pg)}else gn.render(un,ur)},this.compile=function(N,ie){function _e(te,ye,Be){te.transparent===!0&&te.side===qi&&te.forceSinglePass===!1?(te.side=li,te.needsUpdate=!0,ms(te,ye,Be),te.side=Ks,te.needsUpdate=!0,ms(te,ye,Be),te.side=qi):ms(te,ye,Be)}m=k.get(N),m.init(),v.push(m),N.traverseVisible(function(te){te.isLight&&te.layers.test(ie.layers)&&(m.pushLight(te),te.castShadow&&m.pushShadow(te))}),m.setupLights(y.useLegacyLights),N.traverse(function(te){const ye=te.material;if(ye)if(Array.isArray(ye))for(let Be=0;Be<ye.length;Be++){const Ye=ye[Be];_e(Ye,N,te)}else _e(ye,N,te)}),v.pop(),m=null};let mn=null;function ui(N){mn&&mn(N)}function qt(){Vn.stop()}function Di(){Vn.start()}const Vn=new m2;Vn.setAnimationLoop(ui),typeof self<"u"&&Vn.setContext(self),this.setAnimationLoop=function(N){mn=N,q.setAnimationLoop(N),N===null?Vn.stop():Vn.start()},q.addEventListener("sessionstart",qt),q.addEventListener("sessionend",Di),this.render=function(N,ie){if(ie!==void 0&&ie.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(x===!0)return;N.matrixWorldAutoUpdate===!0&&N.updateMatrixWorld(),ie.parent===null&&ie.matrixWorldAutoUpdate===!0&&ie.updateMatrixWorld(),q.enabled===!0&&q.isPresenting===!0&&(q.cameraAutoUpdate===!0&&q.updateCamera(ie),ie=q.getCamera()),N.isScene===!0&&N.onBeforeRender(y,N,ie,T),m=k.get(N,v.length),m.init(),v.push(m),Y.multiplyMatrices(ie.projectionMatrix,ie.matrixWorldInverse),re.setFromProjectionMatrix(Y),ve=this.localClippingEnabled,ce=pe.init(this.clippingPlanes,ve),_=ue.get(N,g.length),_.init(),g.push(_),Mg(N,ie,0,y.sortObjects),_.finish(),y.sortObjects===!0&&_.sort($,J),this.info.render.frame++,ce===!0&&pe.beginShadows();const _e=m.state.shadowsArray;if(Ee.render(_e,N,ie),ce===!0&&pe.endShadows(),this.info.autoReset===!0&&this.info.reset(),se.render(_,N),m.setupLights(y.useLegacyLights),ie.isArrayCamera){const te=ie.cameras;for(let ye=0,Be=te.length;ye<Be;ye++){const Ye=te[ye];Xd(_,N,Ye,Ye.viewport)}}else Xd(_,N,ie);T!==null&&(le.updateMultisampleRenderTarget(T),le.updateRenderTargetMipmap(T)),N.isScene===!0&&N.onAfterRender(y,N,ie),Re.resetDefaultState(),P=-1,E=null,v.pop(),v.length>0?m=v[v.length-1]:m=null,g.pop(),g.length>0?_=g[g.length-1]:_=null};function Mg(N,ie,_e,te){if(N.visible===!1)return;if(N.layers.test(ie.layers)){if(N.isGroup)_e=N.renderOrder;else if(N.isLOD)N.autoUpdate===!0&&N.update(ie);else if(N.isLight)m.pushLight(N),N.castShadow&&m.pushShadow(N);else if(N.isSprite){if(!N.frustumCulled||re.intersectsSprite(N)){te&&he.setFromMatrixPosition(N.matrixWorld).applyMatrix4(Y);const Ye=A.update(N),tt=N.material;tt.visible&&_.push(N,Ye,tt,_e,he.z,null)}}else if((N.isMesh||N.isLine||N.isPoints)&&(!N.frustumCulled||re.intersectsObject(N))){const Ye=A.update(N),tt=N.material;if(te&&(N.boundingSphere!==void 0?(N.boundingSphere===null&&N.computeBoundingSphere(),he.copy(N.boundingSphere.center)):(Ye.boundingSphere===null&&Ye.computeBoundingSphere(),he.copy(Ye.boundingSphere.center)),he.applyMatrix4(N.matrixWorld).applyMatrix4(Y)),Array.isArray(tt)){const it=Ye.groups;for(let mt=0,ot=it.length;mt<ot;mt++){const ct=it[mt],un=tt[ct.materialIndex];un&&un.visible&&_.push(N,Ye,un,_e,he.z,ct)}}else tt.visible&&_.push(N,Ye,tt,_e,he.z,null)}}const Be=N.children;for(let Ye=0,tt=Be.length;Ye<tt;Ye++)Mg(Be[Ye],ie,_e,te)}function Xd(N,ie,_e,te){const ye=N.opaque,Be=N.transmissive,Ye=N.transparent;m.setupLightsView(_e),ce===!0&&pe.setGlobalState(y.clippingPlanes,_e),Be.length>0&&jd(ye,Be,ie,_e),te&&Z.viewport(M.copy(te)),ye.length>0&&wl(ye,ie,_e),Be.length>0&&wl(Be,ie,_e),Ye.length>0&&wl(Ye,ie,_e),Z.buffers.depth.setTest(!0),Z.buffers.depth.setMask(!0),Z.buffers.color.setMask(!0),Z.setPolygonOffset(!1)}function jd(N,ie,_e,te){const ye=K.isWebGL2;ae===null&&(ae=new ml(1,1,{generateMipmaps:!0,type:H.has("EXT_color_buffer_half_float")?Ed:Bo,minFilter:pl,samples:ye?4:0})),y.getDrawingBufferSize(ne),ye?ae.setSize(ne.x,ne.y):ae.setSize(mm(ne.x),mm(ne.y));const Be=y.getRenderTarget();y.setRenderTarget(ae),y.getClearColor(C),D=y.getClearAlpha(),D<1&&y.setClearColor(16777215,.5),y.clear();const Ye=y.toneMapping;y.toneMapping=js,wl(N,_e,te),le.updateMultisampleRenderTarget(ae),le.updateRenderTargetMipmap(ae);let tt=!1;for(let it=0,mt=ie.length;it<mt;it++){const ot=ie[it],ct=ot.object,un=ot.geometry,dn=ot.material,ur=ot.group;if(dn.side===qi&&ct.layers.test(te.layers)){const gs=dn.side;dn.side=li,dn.needsUpdate=!0,$d(ct,_e,te,un,dn,ur),dn.side=gs,dn.needsUpdate=!0,tt=!0}}tt===!0&&(le.updateMultisampleRenderTarget(ae),le.updateRenderTargetMipmap(ae)),y.setRenderTarget(Be),y.setClearColor(C,D),y.toneMapping=Ye}function wl(N,ie,_e){const te=ie.isScene===!0?ie.overrideMaterial:null;for(let ye=0,Be=N.length;ye<Be;ye++){const Ye=N[ye],tt=Ye.object,it=Ye.geometry,mt=te===null?Ye.material:te,ot=Ye.group;tt.layers.test(_e.layers)&&$d(tt,ie,_e,it,mt,ot)}}function $d(N,ie,_e,te,ye,Be){N.onBeforeRender(y,ie,_e,te,ye,Be),N.modelViewMatrix.multiplyMatrices(_e.matrixWorldInverse,N.matrixWorld),N.normalMatrix.getNormalMatrix(N.modelViewMatrix),ye.onBeforeRender(y,ie,_e,te,N,Be),ye.transparent===!0&&ye.side===qi&&ye.forceSinglePass===!1?(ye.side=li,ye.needsUpdate=!0,y.renderBufferDirect(_e,ie,te,ye,N,Be),ye.side=Ks,ye.needsUpdate=!0,y.renderBufferDirect(_e,ie,te,ye,N,Be),ye.side=qi):y.renderBufferDirect(_e,ie,te,ye,N,Be),N.onAfterRender(y,ie,_e,te,ye,Be)}function ms(N,ie,_e){ie.isScene!==!0&&(ie=xe);const te=ge.get(N),ye=m.state.lights,Be=m.state.shadowsArray,Ye=ye.state.version,tt=G.getParameters(N,ye.state,Be,ie,_e),it=G.getProgramCacheKey(tt);let mt=te.programs;te.environment=N.isMeshStandardMaterial?ie.environment:null,te.fog=ie.fog,te.envMap=(N.isMeshStandardMaterial?me:fe).get(N.envMap||te.environment),mt===void 0&&(N.addEventListener("dispose",Le),mt=new Map,te.programs=mt);let ot=mt.get(it);if(ot!==void 0){if(te.currentProgram===ot&&te.lightsStateVersion===Ye)return Yd(N,tt),ot}else tt.uniforms=G.getUniforms(N),N.onBuild(_e,tt,y),N.onBeforeCompile(tt,y),ot=G.acquireProgram(tt,it),mt.set(it,ot),te.uniforms=tt.uniforms;const ct=te.uniforms;(!N.isShaderMaterial&&!N.isRawShaderMaterial||N.clipping===!0)&&(ct.clippingPlanes=pe.uniform),Yd(N,tt),te.needsLights=Ag(N),te.lightsStateVersion=Ye,te.needsLights&&(ct.ambientLightColor.value=ye.state.ambient,ct.lightProbe.value=ye.state.probe,ct.directionalLights.value=ye.state.directional,ct.directionalLightShadows.value=ye.state.directionalShadow,ct.spotLights.value=ye.state.spot,ct.spotLightShadows.value=ye.state.spotShadow,ct.rectAreaLights.value=ye.state.rectArea,ct.ltc_1.value=ye.state.rectAreaLTC1,ct.ltc_2.value=ye.state.rectAreaLTC2,ct.pointLights.value=ye.state.point,ct.pointLightShadows.value=ye.state.pointShadow,ct.hemisphereLights.value=ye.state.hemi,ct.directionalShadowMap.value=ye.state.directionalShadowMap,ct.directionalShadowMatrix.value=ye.state.directionalShadowMatrix,ct.spotShadowMap.value=ye.state.spotShadowMap,ct.spotLightMatrix.value=ye.state.spotLightMatrix,ct.spotLightMap.value=ye.state.spotLightMap,ct.pointShadowMap.value=ye.state.pointShadowMap,ct.pointShadowMatrix.value=ye.state.pointShadowMatrix);const un=ot.getUniforms(),dn=Np.seqWithValue(un.seq,ct);return te.currentProgram=ot,te.uniformsList=dn,ot}function Yd(N,ie){const _e=ge.get(N);_e.outputColorSpace=ie.outputColorSpace,_e.instancing=ie.instancing,_e.skinning=ie.skinning,_e.morphTargets=ie.morphTargets,_e.morphNormals=ie.morphNormals,_e.morphColors=ie.morphColors,_e.morphTargetsCount=ie.morphTargetsCount,_e.numClippingPlanes=ie.numClippingPlanes,_e.numIntersection=ie.numClipIntersection,_e.vertexAlphas=ie.vertexAlphas,_e.vertexTangents=ie.vertexTangents,_e.toneMapping=ie.toneMapping}function wg(N,ie,_e,te,ye){ie.isScene!==!0&&(ie=xe),le.resetTextureUnits();const Be=ie.fog,Ye=te.isMeshStandardMaterial?ie.environment:null,tt=T===null?y.outputColorSpace:T.isXRRenderTarget===!0?T.texture.colorSpace:cs,it=(te.isMeshStandardMaterial?me:fe).get(te.envMap||Ye),mt=te.vertexColors===!0&&!!_e.attributes.color&&_e.attributes.color.itemSize===4,ot=!!_e.attributes.tangent&&(!!te.normalMap||te.anisotropy>0),ct=!!_e.morphAttributes.position,un=!!_e.morphAttributes.normal,dn=!!_e.morphAttributes.color,ur=te.toneMapped?y.toneMapping:js,gs=_e.morphAttributes.position||_e.morphAttributes.normal||_e.morphAttributes.color,gn=gs!==void 0?gs.length:0,Tt=ge.get(te),Pg=m.state.lights;if(ce===!0&&(ve===!0||N!==E)){const Ei=N===E&&te.id===P;pe.setState(te,N,Ei)}let Cn=!1;te.version===Tt.__version?(Tt.needsLights&&Tt.lightsStateVersion!==Pg.state.version||Tt.outputColorSpace!==tt||ye.isInstancedMesh&&Tt.instancing===!1||!ye.isInstancedMesh&&Tt.instancing===!0||ye.isSkinnedMesh&&Tt.skinning===!1||!ye.isSkinnedMesh&&Tt.skinning===!0||Tt.envMap!==it||te.fog===!0&&Tt.fog!==Be||Tt.numClippingPlanes!==void 0&&(Tt.numClippingPlanes!==pe.numPlanes||Tt.numIntersection!==pe.numIntersection)||Tt.vertexAlphas!==mt||Tt.vertexTangents!==ot||Tt.morphTargets!==ct||Tt.morphNormals!==un||Tt.morphColors!==dn||Tt.toneMapping!==ur||K.isWebGL2===!0&&Tt.morphTargetsCount!==gn)&&(Cn=!0):(Cn=!0,Tt.__version=te.version);let Qo=Tt.currentProgram;Cn===!0&&(Qo=ms(te,ie,ye));let wS=!1,Rc=!1,Cg=!1;const Qn=Qo.getUniforms(),ea=Tt.uniforms;if(Z.useProgram(Qo.program)&&(wS=!0,Rc=!0,Cg=!0),te.id!==P&&(P=te.id,Rc=!0),wS||E!==N){if(Qn.setValue(w,"projectionMatrix",N.projectionMatrix),K.logarithmicDepthBuffer&&Qn.setValue(w,"logDepthBufFC",2/(Math.log(N.far+1)/Math.LN2)),E!==N&&(E=N,Rc=!0,Cg=!0),te.isShaderMaterial||te.isMeshPhongMaterial||te.isMeshToonMaterial||te.isMeshStandardMaterial||te.envMap){const Ei=Qn.map.cameraPosition;Ei!==void 0&&Ei.setValue(w,he.setFromMatrixPosition(N.matrixWorld))}(te.isMeshPhongMaterial||te.isMeshToonMaterial||te.isMeshLambertMaterial||te.isMeshBasicMaterial||te.isMeshStandardMaterial||te.isShaderMaterial)&&Qn.setValue(w,"isOrthographic",N.isOrthographicCamera===!0),(te.isMeshPhongMaterial||te.isMeshToonMaterial||te.isMeshLambertMaterial||te.isMeshBasicMaterial||te.isMeshStandardMaterial||te.isShaderMaterial||te.isShadowMaterial||ye.isSkinnedMesh)&&Qn.setValue(w,"viewMatrix",N.matrixWorldInverse)}if(ye.isSkinnedMesh){Qn.setOptional(w,ye,"bindMatrix"),Qn.setOptional(w,ye,"bindMatrixInverse");const Ei=ye.skeleton;Ei&&(K.floatVertexTextures?(Ei.boneTexture===null&&Ei.computeBoneTexture(),Qn.setValue(w,"boneTexture",Ei.boneTexture,le),Qn.setValue(w,"boneTextureSize",Ei.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const Rg=_e.morphAttributes;if((Rg.position!==void 0||Rg.normal!==void 0||Rg.color!==void 0&&K.isWebGL2===!0)&&De.update(ye,_e,Qo),(Rc||Tt.receiveShadow!==ye.receiveShadow)&&(Tt.receiveShadow=ye.receiveShadow,Qn.setValue(w,"receiveShadow",ye.receiveShadow)),te.isMeshGouraudMaterial&&te.envMap!==null&&(ea.envMap.value=it,ea.flipEnvMap.value=it.isCubeTexture&&it.isRenderTargetTexture===!1?-1:1),Rc&&(Qn.setValue(w,"toneMappingExposure",y.toneMappingExposure),Tt.needsLights&&qd(ea,Cg),Be&&te.fog===!0&&Q.refreshFogUniforms(ea,Be),Q.refreshMaterialUniforms(ea,te,U,W,ae),Np.upload(w,Tt.uniformsList,ea,le)),te.isShaderMaterial&&te.uniformsNeedUpdate===!0&&(Np.upload(w,Tt.uniformsList,ea,le),te.uniformsNeedUpdate=!1),te.isSpriteMaterial&&Qn.setValue(w,"center",ye.center),Qn.setValue(w,"modelViewMatrix",ye.modelViewMatrix),Qn.setValue(w,"normalMatrix",ye.normalMatrix),Qn.setValue(w,"modelMatrix",ye.matrixWorld),te.isShaderMaterial||te.isRawShaderMaterial){const Ei=te.uniformsGroups;for(let Ig=0,tD=Ei.length;Ig<tD;Ig++)if(K.isWebGL2){const AS=Ei[Ig];Ve.update(AS,Qo),Ve.bind(AS,Qo)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Qo}function qd(N,ie){N.ambientLightColor.needsUpdate=ie,N.lightProbe.needsUpdate=ie,N.directionalLights.needsUpdate=ie,N.directionalLightShadows.needsUpdate=ie,N.pointLights.needsUpdate=ie,N.pointLightShadows.needsUpdate=ie,N.spotLights.needsUpdate=ie,N.spotLightShadows.needsUpdate=ie,N.rectAreaLights.needsUpdate=ie,N.hemisphereLights.needsUpdate=ie}function Ag(N){return N.isMeshLambertMaterial||N.isMeshToonMaterial||N.isMeshPhongMaterial||N.isMeshStandardMaterial||N.isShadowMaterial||N.isShaderMaterial&&N.lights===!0}this.getActiveCubeFace=function(){return b},this.getActiveMipmapLevel=function(){return S},this.getRenderTarget=function(){return T},this.setRenderTargetTextures=function(N,ie,_e){ge.get(N.texture).__webglTexture=ie,ge.get(N.depthTexture).__webglTexture=_e;const te=ge.get(N);te.__hasExternalTextures=!0,te.__hasExternalTextures&&(te.__autoAllocateDepthBuffer=_e===void 0,te.__autoAllocateDepthBuffer||H.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),te.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(N,ie){const _e=ge.get(N);_e.__webglFramebuffer=ie,_e.__useDefaultFramebuffer=ie===void 0},this.setRenderTarget=function(N,ie=0,_e=0){T=N,b=ie,S=_e;let te=!0,ye=null,Be=!1,Ye=!1;if(N){const it=ge.get(N);it.__useDefaultFramebuffer!==void 0?(Z.bindFramebuffer(w.FRAMEBUFFER,null),te=!1):it.__webglFramebuffer===void 0?le.setupRenderTarget(N):it.__hasExternalTextures&&le.rebindTextures(N,ge.get(N.texture).__webglTexture,ge.get(N.depthTexture).__webglTexture);const mt=N.texture;(mt.isData3DTexture||mt.isDataArrayTexture||mt.isCompressedArrayTexture)&&(Ye=!0);const ot=ge.get(N).__webglFramebuffer;N.isWebGLCubeRenderTarget?(ye=ot[ie],Be=!0):K.isWebGL2&&N.samples>0&&le.useMultisampledRTT(N)===!1?ye=ge.get(N).__webglMultisampledFramebuffer:ye=ot,M.copy(N.viewport),O.copy(N.scissor),L=N.scissorTest}else M.copy(j).multiplyScalar(U).floor(),O.copy(F).multiplyScalar(U).floor(),L=X;if(Z.bindFramebuffer(w.FRAMEBUFFER,ye)&&K.drawBuffers&&te&&Z.drawBuffers(N,ye),Z.viewport(M),Z.scissor(O),Z.setScissorTest(L),Be){const it=ge.get(N.texture);w.framebufferTexture2D(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0,w.TEXTURE_CUBE_MAP_POSITIVE_X+ie,it.__webglTexture,_e)}else if(Ye){const it=ge.get(N.texture),mt=ie||0;w.framebufferTextureLayer(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0,it.__webglTexture,_e||0,mt)}P=-1},this.readRenderTargetPixels=function(N,ie,_e,te,ye,Be,Ye){if(!(N&&N.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let tt=ge.get(N).__webglFramebuffer;if(N.isWebGLCubeRenderTarget&&Ye!==void 0&&(tt=tt[Ye]),tt){Z.bindFramebuffer(w.FRAMEBUFFER,tt);try{const it=N.texture,mt=it.format,ot=it.type;if(mt!==Zi&&Ce.convert(mt)!==w.getParameter(w.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const ct=ot===Ed&&(H.has("EXT_color_buffer_half_float")||K.isWebGL2&&H.has("EXT_color_buffer_float"));if(ot!==Bo&&Ce.convert(ot)!==w.getParameter(w.IMPLEMENTATION_COLOR_READ_TYPE)&&!(ot===ks&&(K.isWebGL2||H.has("OES_texture_float")||H.has("WEBGL_color_buffer_float")))&&!ct){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ie>=0&&ie<=N.width-te&&_e>=0&&_e<=N.height-ye&&w.readPixels(ie,_e,te,ye,Ce.convert(mt),Ce.convert(ot),Be)}finally{const it=T!==null?ge.get(T).__webglFramebuffer:null;Z.bindFramebuffer(w.FRAMEBUFFER,it)}}},this.copyFramebufferToTexture=function(N,ie,_e=0){const te=Math.pow(2,-_e),ye=Math.floor(ie.image.width*te),Be=Math.floor(ie.image.height*te);le.setTexture2D(ie,0),w.copyTexSubImage2D(w.TEXTURE_2D,_e,0,0,N.x,N.y,ye,Be),Z.unbindTexture()},this.copyTextureToTexture=function(N,ie,_e,te=0){const ye=ie.image.width,Be=ie.image.height,Ye=Ce.convert(_e.format),tt=Ce.convert(_e.type);le.setTexture2D(_e,0),w.pixelStorei(w.UNPACK_FLIP_Y_WEBGL,_e.flipY),w.pixelStorei(w.UNPACK_PREMULTIPLY_ALPHA_WEBGL,_e.premultiplyAlpha),w.pixelStorei(w.UNPACK_ALIGNMENT,_e.unpackAlignment),ie.isDataTexture?w.texSubImage2D(w.TEXTURE_2D,te,N.x,N.y,ye,Be,Ye,tt,ie.image.data):ie.isCompressedTexture?w.compressedTexSubImage2D(w.TEXTURE_2D,te,N.x,N.y,ie.mipmaps[0].width,ie.mipmaps[0].height,Ye,ie.mipmaps[0].data):w.texSubImage2D(w.TEXTURE_2D,te,N.x,N.y,Ye,tt,ie.image),te===0&&_e.generateMipmaps&&w.generateMipmap(w.TEXTURE_2D),Z.unbindTexture()},this.copyTextureToTexture3D=function(N,ie,_e,te,ye=0){if(y.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Be=N.max.x-N.min.x+1,Ye=N.max.y-N.min.y+1,tt=N.max.z-N.min.z+1,it=Ce.convert(te.format),mt=Ce.convert(te.type);let ot;if(te.isData3DTexture)le.setTexture3D(te,0),ot=w.TEXTURE_3D;else if(te.isDataArrayTexture)le.setTexture2DArray(te,0),ot=w.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}w.pixelStorei(w.UNPACK_FLIP_Y_WEBGL,te.flipY),w.pixelStorei(w.UNPACK_PREMULTIPLY_ALPHA_WEBGL,te.premultiplyAlpha),w.pixelStorei(w.UNPACK_ALIGNMENT,te.unpackAlignment);const ct=w.getParameter(w.UNPACK_ROW_LENGTH),un=w.getParameter(w.UNPACK_IMAGE_HEIGHT),dn=w.getParameter(w.UNPACK_SKIP_PIXELS),ur=w.getParameter(w.UNPACK_SKIP_ROWS),gs=w.getParameter(w.UNPACK_SKIP_IMAGES),gn=_e.isCompressedTexture?_e.mipmaps[0]:_e.image;w.pixelStorei(w.UNPACK_ROW_LENGTH,gn.width),w.pixelStorei(w.UNPACK_IMAGE_HEIGHT,gn.height),w.pixelStorei(w.UNPACK_SKIP_PIXELS,N.min.x),w.pixelStorei(w.UNPACK_SKIP_ROWS,N.min.y),w.pixelStorei(w.UNPACK_SKIP_IMAGES,N.min.z),_e.isDataTexture||_e.isData3DTexture?w.texSubImage3D(ot,ye,ie.x,ie.y,ie.z,Be,Ye,tt,it,mt,gn.data):_e.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),w.compressedTexSubImage3D(ot,ye,ie.x,ie.y,ie.z,Be,Ye,tt,it,gn.data)):w.texSubImage3D(ot,ye,ie.x,ie.y,ie.z,Be,Ye,tt,it,mt,gn),w.pixelStorei(w.UNPACK_ROW_LENGTH,ct),w.pixelStorei(w.UNPACK_IMAGE_HEIGHT,un),w.pixelStorei(w.UNPACK_SKIP_PIXELS,dn),w.pixelStorei(w.UNPACK_SKIP_ROWS,ur),w.pixelStorei(w.UNPACK_SKIP_IMAGES,gs),ye===0&&te.generateMipmaps&&w.generateMipmap(ot),Z.unbindTexture()},this.initTexture=function(N){N.isCubeTexture?le.setTextureCube(N,0):N.isData3DTexture?le.setTexture3D(N,0):N.isDataArrayTexture||N.isCompressedArrayTexture?le.setTexture2DArray(N,0):le.setTexture2D(N,0),Z.unbindTexture()},this.resetState=function(){b=0,S=0,T=null,Z.reset(),Re.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Vs}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===nt?ko:e2}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===ko?nt:cs}}class Yre extends x2{}Yre.prototype.isWebGL1Renderer=!0;class qre extends Ft{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class Kre{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Iy,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Rr()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Rr()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Rr()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const ei=new z;class _S{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)ei.fromBufferAttribute(this,t),ei.applyMatrix4(e),this.setXYZ(t,ei.x,ei.y,ei.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)ei.fromBufferAttribute(this,t),ei.applyNormalMatrix(e),this.setXYZ(t,ei.x,ei.y,ei.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)ei.fromBufferAttribute(this,t),ei.transformDirection(e),this.setXYZ(t,ei.x,ei.y,ei.z);return this}setX(e,t){return this.normalized&&(t=Vt(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Vt(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Vt(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Vt(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Gs(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Gs(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Gs(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Gs(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Vt(t,this.array),i=Vt(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Vt(t,this.array),i=Vt(i,this.array),r=Vt(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Vt(t,this.array),i=Vt(i,this.array),r=Vt(r,this.array),s=Vt(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new Nt(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new _S(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const IA=new z,LA=new zt,OA=new zt,Zre=new z,DA=new Qe,ru=new z,Ev=new fs,FA=new Qe,Tv=new yg;class b2 extends _i{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Qe,this.bindMatrixInverse=new Qe,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new to),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)ru.fromBufferAttribute(t,i),this.applyBoneTransform(i,ru),this.boundingBox.expandByPoint(ru)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new fs),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)ru.fromBufferAttribute(t,i),this.applyBoneTransform(i,ru),this.boundingSphere.expandByPoint(ru)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const i=this.material,r=this.matrixWorld;i!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Ev.copy(this.boundingSphere),Ev.applyMatrix4(r),e.ray.intersectsSphere(Ev)!==!1&&(FA.copy(r).invert(),Tv.copy(e.ray).applyMatrix4(FA),!(this.boundingBox!==null&&Tv.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,Tv)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new zt,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const i=this.skeleton,r=this.geometry;LA.fromBufferAttribute(r.attributes.skinIndex,e),OA.fromBufferAttribute(r.attributes.skinWeight,e),IA.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=OA.getComponent(s);if(o!==0){const a=LA.getComponent(s);DA.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(Zre.copy(IA).applyMatrix4(DA),o)}}return t.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}}class S2 extends Ft{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Jre extends jn{constructor(e=null,t=1,i=1,r,s,o,a,l,u=Dn,c=Dn,h,d){super(null,o,a,l,u,c,r,s,h,d),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const NA=new Qe,Qre=new Qe;class Hd{constructor(e=[],t=[]){this.uuid=Rr(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new Qe)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new Qe;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const a=e[s]?e[s].matrixWorld:Qre;NA.multiplyMatrices(a,t[s]),NA.toArray(i,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new Hd(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=n2(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new Jre(t,e,e,Zi,ks);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=t[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new S2),this.bones.push(o),this.boneInverses.push(new Qe().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,s=t.length;r<s;r++){const o=t[r];e.bones.push(o.uuid);const a=i[r];e.boneInverses.push(a.toArray())}return e}}class UA extends Nt{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const su=new Qe,BA=new Qe,up=[],kA=new to,ese=new Qe,eh=new _i,th=new fs;class tse extends _i{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new UA(new Float32Array(i*16),16),this.instanceColor=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,ese)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new to),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,su),kA.copy(e.boundingBox).applyMatrix4(su),this.boundingBox.union(kA)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new fs),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,su),th.copy(e.boundingSphere).applyMatrix4(su),this.boundingSphere.union(th)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){const i=this.matrixWorld,r=this.count;if(eh.geometry=this.geometry,eh.material=this.material,eh.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),th.copy(this.boundingSphere),th.applyMatrix4(i),e.ray.intersectsSphere(th)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,su),BA.multiplyMatrices(i,su),eh.matrixWorld=BA,eh.raycast(e,up);for(let o=0,a=up.length;o<a;o++){const l=up[o];l.instanceId=s,l.object=this,t.push(l)}up.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new UA(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class Ml extends ss{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new We(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const VA=new z,GA=new z,HA=new Qe,Mv=new yg,cp=new fs;class bg extends Ft{constructor(e=new kn,t=new Ml){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)VA.fromBufferAttribute(t,r-1),GA.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=VA.distanceTo(GA);e.setAttribute("lineDistance",new Ir(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),cp.copy(i.boundingSphere),cp.applyMatrix4(r),cp.radius+=s,e.ray.intersectsSphere(cp)===!1)return;HA.copy(r).invert(),Mv.copy(e.ray).applyMatrix4(HA);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,u=new z,c=new z,h=new z,d=new z,f=this.isLineSegments?2:1,p=i.index,m=i.attributes.position;if(p!==null){const g=Math.max(0,o.start),v=Math.min(p.count,o.start+o.count);for(let y=g,x=v-1;y<x;y+=f){const b=p.getX(y),S=p.getX(y+1);if(u.fromBufferAttribute(m,b),c.fromBufferAttribute(m,S),Mv.distanceSqToSegment(u,c,d,h)>l)continue;d.applyMatrix4(this.matrixWorld);const P=e.ray.origin.distanceTo(d);P<e.near||P>e.far||t.push({distance:P,point:h.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}else{const g=Math.max(0,o.start),v=Math.min(m.count,o.start+o.count);for(let y=g,x=v-1;y<x;y+=f){if(u.fromBufferAttribute(m,y),c.fromBufferAttribute(m,y+1),Mv.distanceSqToSegment(u,c,d,h)>l)continue;d.applyMatrix4(this.matrixWorld);const S=e.ray.origin.distanceTo(d);S<e.near||S>e.far||t.push({distance:S,point:h.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const zA=new z,WA=new z;class zd extends bg{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)zA.fromBufferAttribute(t,r),WA.fromBufferAttribute(t,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+zA.distanceTo(WA);e.setAttribute("lineDistance",new Ir(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class nse extends bg{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class E2 extends ss{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new We(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const XA=new Qe,Fy=new yg,hp=new fs,dp=new z;class ise extends Ft{constructor(e=new kn,t=new E2){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),hp.copy(i.boundingSphere),hp.applyMatrix4(r),hp.radius+=s,e.ray.intersectsSphere(hp)===!1)return;XA.copy(r).invert(),Fy.copy(e.ray).applyMatrix4(XA);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,u=i.index,h=i.attributes.position;if(u!==null){const d=Math.max(0,o.start),f=Math.min(u.count,o.start+o.count);for(let p=d,_=f;p<_;p++){const m=u.getX(p);dp.fromBufferAttribute(h,m),jA(dp,m,l,r,e,t,this)}}else{const d=Math.max(0,o.start),f=Math.min(h.count,o.start+o.count);for(let p=d,_=f;p<_;p++)dp.fromBufferAttribute(h,p),jA(dp,p,l,r,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function jA(n,e,t,i,r,s,o){const a=Fy.distanceSqToPoint(n);if(a<t){const l=new z;Fy.closestPointToPoint(n,l),l.applyMatrix4(i);const u=r.ray.origin.distanceTo(l);if(u<r.near||u>r.far)return;s.push({distance:u,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class vS extends ss{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new We(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new We(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=hS,this.normalScale=new Ze(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Jo extends vS{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Ze(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return zn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new We(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new We(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new We(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}function mo(n,e,t){return T2(n)?new n.constructor(n.subarray(e,t!==void 0?t:n.length)):n.slice(e,t)}function fp(n,e,t){return!n||!t&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function T2(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function rse(n){function e(r,s){return n[r]-n[s]}const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(e),i}function $A(n,e,t){const i=n.length,r=new n.constructor(i);for(let s=0,o=0;o!==i;++s){const a=t[s]*e;for(let l=0;l!==e;++l)r[o++]=n[a+l]}return r}function M2(n,e,t,i){let r=1,s=n[0];for(;s!==void 0&&s[i]===void 0;)s=n[r++];if(s===void 0)return;let o=s[i];if(o!==void 0)if(Array.isArray(o))do o=s[i],o!==void 0&&(e.push(s.time),t.push.apply(t,o)),s=n[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[i],o!==void 0&&(e.push(s.time),o.toArray(t,t.length)),s=n[r++];while(s!==void 0);else do o=s[i],o!==void 0&&(e.push(s.time),t.push(o)),s=n[r++];while(s!==void 0)}class Wd{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(r===void 0){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(!(e>=s)){const a=t[1];e<a&&(i=2,s=a);for(let l=i-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0;break n}break e}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class sse extends Wd{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:vu,endingEnd:vu}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(a===void 0)switch(this.getSettings_().endingStart){case yu:s=e,a=2*t-i;break;case fm:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(l===void 0)switch(this.getSettings_().endingEnd){case yu:o=e,l=2*i-t;break;case fm:o=1,l=i+r[1]-r[0];break;default:o=e-1,l=t}const u=(i-t)*.5,c=this.valueSize;this._weightPrev=u/(t-a),this._weightNext=u/(l-i),this._offsetPrev=s*c,this._offsetNext=o*c}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,u=l-a,c=this._offsetPrev,h=this._offsetNext,d=this._weightPrev,f=this._weightNext,p=(i-t)/(r-t),_=p*p,m=_*p,g=-d*m+2*d*_-d*p,v=(1+d)*m+(-1.5-2*d)*_+(-.5+d)*p+1,y=(-1-f)*m+(1.5+f)*_+.5*p,x=f*m-f*_;for(let b=0;b!==a;++b)s[b]=g*o[c+b]+v*o[u+b]+y*o[l+b]+x*o[h+b];return s}}class w2 extends Wd{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,u=l-a,c=(i-t)/(r-t),h=1-c;for(let d=0;d!==a;++d)s[d]=o[u+d]*h+o[l+d]*c;return s}}class ose extends Wd{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class ps{constructor(e,t,i,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=fp(t,this.TimeBufferType),this.values=fp(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:fp(e.times,Array),values:fp(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new ose(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new w2(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new sse(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Td:t=this.InterpolantFactoryMethodDiscrete;break;case sc:t=this.InterpolantFactoryMethodLinear;break;case ev:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Td;case this.InterpolantFactoryMethodLinear:return sc;case this.InterpolantFactoryMethodSmooth:return ev}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;o!==-1&&i[o]>t;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=mo(i,s,o),this.values=mo(this.values,s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=i[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(r!==void 0&&T2(r))for(let a=0,l=r.length;a!==l;++a){const u=r[a];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,u),e=!1;break}}return e}optimize(){const e=mo(this.times),t=mo(this.values),i=this.getValueSize(),r=this.getInterpolation()===ev,s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const u=e[a],c=e[a+1];if(u!==c&&(a!==1||u!==e[0]))if(r)l=!0;else{const h=a*i,d=h-i,f=h+i;for(let p=0;p!==i;++p){const _=t[h+p];if(_!==t[d+p]||_!==t[f+p]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const h=a*i,d=o*i;for(let f=0;f!==i;++f)t[d+f]=t[h+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,l=o*i,u=0;u!==i;++u)t[l+u]=t[a+u];++o}return o!==e.length?(this.times=mo(e,0,o),this.values=mo(t,0,o*i)):(this.times=e,this.values=t),this}clone(){const e=mo(this.times,0),t=mo(this.values,0),i=this.constructor,r=new i(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}ps.prototype.TimeBufferType=Float32Array;ps.prototype.ValueBufferType=Float32Array;ps.prototype.DefaultInterpolation=sc;class Ac extends ps{}Ac.prototype.ValueTypeName="bool";Ac.prototype.ValueBufferType=Array;Ac.prototype.DefaultInterpolation=Td;Ac.prototype.InterpolantFactoryMethodLinear=void 0;Ac.prototype.InterpolantFactoryMethodSmooth=void 0;class A2 extends ps{}A2.prototype.ValueTypeName="color";class gl extends ps{}gl.prototype.ValueTypeName="number";class ase extends Wd{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(i-t)/(r-t);let u=e*a;for(let c=u+a;u!==c;u+=4)Xe.slerpFlat(s,0,o,u-a,o,u,l);return s}}class _l extends ps{InterpolantFactoryMethodLinear(e){return new ase(this.times,this.values,this.getValueSize(),e)}}_l.prototype.ValueTypeName="quaternion";_l.prototype.DefaultInterpolation=sc;_l.prototype.InterpolantFactoryMethodSmooth=void 0;class Pc extends ps{}Pc.prototype.ValueTypeName="string";Pc.prototype.ValueBufferType=Array;Pc.prototype.DefaultInterpolation=Td;Pc.prototype.InterpolantFactoryMethodLinear=void 0;Pc.prototype.InterpolantFactoryMethodSmooth=void 0;class lc extends ps{}lc.prototype.ValueTypeName="vector";class gm{constructor(e,t=-1,i,r=cS){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=Rr(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)t.push(use(i[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)t.push(ps.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],u=[];l.push((a+s-1)%s,a,(a+1)%s),u.push(0,1,0);const c=rse(l);l=$A(l,1,c),u=$A(u,1,c),!r&&l[0]===0&&(l.push(s),u.push(u[0])),o.push(new gl(".morphTargetInfluences["+t[a].name+"]",l,u).scale(1/i))}return new this(e,-1,o)}static findByName(e,t){let i=e;if(!Array.isArray(e)){const r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const u=e[a],c=u.name.match(s);if(c&&c.length>1){const h=c[1];let d=r[h];d||(r[h]=d=[]),d.push(u)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(h,d,f,p,_){if(f.length!==0){const m=[],g=[];M2(f,m,g,p),m.length!==0&&_.push(new h(d,m,g))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const u=e.hierarchy||[];for(let h=0;h<u.length;h++){const d=u[h].keys;if(!(!d||d.length===0))if(d[0].morphTargets){const f={};let p;for(p=0;p<d.length;p++)if(d[p].morphTargets)for(let _=0;_<d[p].morphTargets.length;_++)f[d[p].morphTargets[_]]=-1;for(const _ in f){const m=[],g=[];for(let v=0;v!==d[p].morphTargets.length;++v){const y=d[p];m.push(y.time),g.push(y.morphTarget===_?1:0)}r.push(new gl(".morphTargetInfluence["+_+"]",m,g))}l=f.length*o}else{const f=".bones["+t[h].name+"]";i(lc,f+".position",d,"pos",r),i(_l,f+".quaternion",d,"rot",r),i(lc,f+".scale",d,"scl",r)}}return r.length===0?null:new this(s,l,r,a)}resetDuration(){const e=this.tracks;let t=0;for(let i=0,r=e.length;i!==r;++i){const s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function lse(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return gl;case"vector":case"vector2":case"vector3":case"vector4":return lc;case"color":return A2;case"quaternion":return _l;case"bool":case"boolean":return Ac;case"string":return Pc}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function use(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=lse(n.type);if(n.times===void 0){const t=[],i=[];M2(n.keys,t,i,"value"),n.times=t,n.values=i}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const uc={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class cse{constructor(e,t,i){const r=this;let s=!1,o=0,a=0,l;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(c){a++,s===!1&&r.onStart!==void 0&&r.onStart(c,o,a),s=!0},this.itemEnd=function(c){o++,r.onProgress!==void 0&&r.onProgress(c,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(c){r.onError!==void 0&&r.onError(c)},this.resolveURL=function(c){return l?l(c):c},this.setURLModifier=function(c){return l=c,this},this.addHandler=function(c,h){return u.push(c,h),this},this.removeHandler=function(c){const h=u.indexOf(c);return h!==-1&&u.splice(h,2),this},this.getHandler=function(c){for(let h=0,d=u.length;h<d;h+=2){const f=u[h],p=u[h+1];if(f.global&&(f.lastIndex=0),f.test(c))return p}return null}}}const hse=new cse;class Cc{constructor(e){this.manager=e!==void 0?e:hse,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(r,s){i.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}Cc.DEFAULT_MATERIAL_NAME="__DEFAULT";const ws={};class dse extends Error{constructor(e,t){super(e),this.response=t}}class P2 extends Cc{constructor(e){super(e)}load(e,t,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=uc.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(ws[e]!==void 0){ws[e].push({onLoad:t,onProgress:i,onError:r});return}ws[e]=[],ws[e].push({onLoad:t,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(u=>{if(u.status===200||u.status===0){if(u.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||u.body===void 0||u.body.getReader===void 0)return u;const c=ws[e],h=u.body.getReader(),d=u.headers.get("Content-Length")||u.headers.get("X-File-Size"),f=d?parseInt(d):0,p=f!==0;let _=0;const m=new ReadableStream({start(g){v();function v(){h.read().then(({done:y,value:x})=>{if(y)g.close();else{_+=x.byteLength;const b=new ProgressEvent("progress",{lengthComputable:p,loaded:_,total:f});for(let S=0,T=c.length;S<T;S++){const P=c[S];P.onProgress&&P.onProgress(b)}g.enqueue(x),v()}})}}});return new Response(m)}else throw new dse(`fetch for "${u.url}" responded with ${u.status}: ${u.statusText}`,u)}).then(u=>{switch(l){case"arraybuffer":return u.arrayBuffer();case"blob":return u.blob();case"document":return u.text().then(c=>new DOMParser().parseFromString(c,a));case"json":return u.json();default:if(a===void 0)return u.text();{const h=/charset="?([^;"\s]*)"?/i.exec(a),d=h&&h[1]?h[1].toLowerCase():void 0,f=new TextDecoder(d);return u.arrayBuffer().then(p=>f.decode(p))}}}).then(u=>{uc.add(e,u);const c=ws[e];delete ws[e];for(let h=0,d=c.length;h<d;h++){const f=c[h];f.onLoad&&f.onLoad(u)}}).catch(u=>{const c=ws[e];if(c===void 0)throw this.manager.itemError(e),u;delete ws[e];for(let h=0,d=c.length;h<d;h++){const f=c[h];f.onError&&f.onError(u)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class C2 extends Cc{constructor(e){super(e)}load(e,t,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=uc.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=Md("img");function l(){c(),uc.add(e,this),t&&t(this),s.manager.itemEnd(e)}function u(h){c(),r&&r(h),s.manager.itemError(e),s.manager.itemEnd(e)}function c(){a.removeEventListener("load",l,!1),a.removeEventListener("error",u,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",u,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class fse extends Cc{constructor(e){super(e)}load(e,t,i,r){const s=new jn,o=new C2(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},i,r),s}}class Sg extends Ft{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new We(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}const wv=new Qe,YA=new z,qA=new z;class yS{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ze(512,512),this.map=null,this.mapPass=null,this.matrix=new Qe,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new fS,this._frameExtents=new Ze(1,1),this._viewportCount=1,this._viewports=[new zt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;YA.setFromMatrixPosition(e.matrixWorld),t.position.copy(YA),qA.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(qA),t.updateMatrixWorld(),wv.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(wv),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(wv)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class pse extends yS{constructor(){super(new si(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=oc*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class mse extends Sg{constructor(e,t,i=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Ft.DEFAULT_UP),this.updateMatrix(),this.target=new Ft,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new pse}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const KA=new Qe,nh=new z,Av=new z;class gse extends yS{constructor(){super(new si(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Ze(4,2),this._viewportCount=6,this._viewports=[new zt(2,1,1,1),new zt(0,1,1,1),new zt(3,1,1,1),new zt(1,1,1,1),new zt(3,0,1,1),new zt(1,0,1,1)],this._cubeDirections=[new z(1,0,0),new z(-1,0,0),new z(0,0,1),new z(0,0,-1),new z(0,1,0),new z(0,-1,0)],this._cubeUps=[new z(0,1,0),new z(0,1,0),new z(0,1,0),new z(0,1,0),new z(0,0,1),new z(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),nh.setFromMatrixPosition(e.matrixWorld),i.position.copy(nh),Av.copy(i.position),Av.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(Av),i.updateMatrixWorld(),r.makeTranslation(-nh.x,-nh.y,-nh.z),KA.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(KA)}}class _se extends Sg{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new gse}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class vse extends yS{constructor(){super(new mS(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class R2 extends Sg{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Ft.DEFAULT_UP),this.updateMatrix(),this.target=new Ft,this.shadow=new vse}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class yse extends Sg{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Ny{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class xse extends Cc{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=uc.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){uc.add(e,l),t&&t(l),s.manager.itemEnd(e)}).catch(function(l){r&&r(l),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}class bse{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=ZA(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=ZA();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function ZA(){return(typeof performance>"u"?Date:performance).now()}class Sse{constructor(e,t,i){this.binding=e,this.valueSize=i;let r,s,o;switch(t){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const i=this.buffer,r=this.valueSize,s=e*r+r;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==r;++a)i[s+a]=i[a];o=t}else{o+=t;const a=t/o;this._mixBufferRegion(i,s,0,a,r)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,i=this.valueSize,r=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,i=this.buffer,r=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=t*this._origIndex;this._mixBufferRegion(i,r,l,1-s,t)}o>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*t,1,t);for(let l=t,u=t+t;l!==u;++l)if(i[l]!==i[l+t]){a.setValue(i,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,i=this.valueSize,r=i*this._origIndex;e.getValue(t,r);for(let s=i,o=r;s!==o;++s)t[s]=t[r+s%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let i=e;i<t;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[t+i]=this.buffer[e+i]}_select(e,t,i,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[t+o]=e[i+o]}_slerp(e,t,i,r){Xe.slerpFlat(e,t,e,t,e,i,r)}_slerpAdditive(e,t,i,r,s){const o=this._workIndex*s;Xe.multiplyQuaternionsFlat(e,o,e,t,e,i),Xe.slerpFlat(e,t,e,t,e,o,r)}_lerp(e,t,i,r,s){const o=1-r;for(let a=0;a!==s;++a){const l=t+a;e[l]=e[l]*o+e[i+a]*r}}_lerpAdditive(e,t,i,r,s){for(let o=0;o!==s;++o){const a=t+o;e[a]=e[a]+e[i+o]*r}}}const xS="\\[\\]\\.:\\/",Ese=new RegExp("["+xS+"]","g"),bS="[^"+xS+"]",Tse="[^"+xS.replace("\\.","")+"]",Mse=/((?:WC+[\/:])*)/.source.replace("WC",bS),wse=/(WCOD+)?/.source.replace("WCOD",Tse),Ase=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",bS),Pse=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",bS),Cse=new RegExp("^"+Mse+wse+Ase+Pse+"$"),Rse=["material","materials","bones","map"];class Ise{constructor(e,t,i){const r=i||It.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}class It{constructor(e,t,i){this.path=t,this.parsedPath=i||It.parseTrackName(t),this.node=It.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,i){return e&&e.isAnimationObjectGroup?new It.Composite(e,t,i):new It(e,t,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Ese,"")}static parseTrackName(e){const t=Cse.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=i.nodeName.substring(r+1);Rse.indexOf(s)!==-1&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=s)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(t);if(i!==void 0)return i}if(e.children){const i=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===t||a.uuid===t)return a;const l=i(a.children);if(l)return l}return null},r=i(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)e[t++]=i[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,i=t.objectName,r=t.propertyName;let s=t.propertyIndex;if(e||(e=It.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(i){let u=t.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let c=0;c<e.length;c++)if(e[c].name===u){u=c;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(u!==void 0){if(e[u]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[u]}}const o=e[r];if(o===void 0){const u=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+r+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}It.Composite=Ise;It.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};It.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};It.prototype.GetterByBindingType=[It.prototype._getValue_direct,It.prototype._getValue_array,It.prototype._getValue_arrayElement,It.prototype._getValue_toArray];It.prototype.SetterByBindingTypeAndVersioning=[[It.prototype._setValue_direct,It.prototype._setValue_direct_setNeedsUpdate,It.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[It.prototype._setValue_array,It.prototype._setValue_array_setNeedsUpdate,It.prototype._setValue_array_setMatrixWorldNeedsUpdate],[It.prototype._setValue_arrayElement,It.prototype._setValue_arrayElement_setNeedsUpdate,It.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[It.prototype._setValue_fromArray,It.prototype._setValue_fromArray_setNeedsUpdate,It.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Lse{constructor(e,t,i=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=i,this.blendMode=r;const s=t.tracks,o=s.length,a=new Array(o),l={endingStart:vu,endingEnd:vu};for(let u=0;u!==o;++u){const c=s[u].createInterpolant(null);a[u]=c,c.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=pQ,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){const r=this._clip.duration,s=e._clip.duration,o=s/r,a=r/s;e.warp(1,o,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,i){return e.crossFadeFrom(this,t,i)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,i){const r=this._mixer,s=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,u=a.sampleValues;return l[0]=s,l[1]=s+i,u[0]=e/o,u[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,i,r){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const l=(e-s)*i;l<0||i===0?t=0:(this._startTime=null,t=i*l)}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const l=this._interpolants,u=this._propertyBindings;switch(this.blendMode){case gQ:for(let c=0,h=l.length;c!==h;++c)l[c].evaluate(o),u[c].accumulateAdditive(a);break;case cS:default:for(let c=0,h=l.length;c!==h;++c)l[c].evaluate(o),u[c].accumulate(r,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const i=this._weightInterpolant;if(i!==null){const r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const i=this._timeScaleInterpolant;if(i!==null){const r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,i=this.loop;let r=this.time+e,s=this._loopCount;const o=i===mQ;if(e===0)return s===-1?r:o&&(s&1)===1?t-r:r;if(i===fQ){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),r>=t||r<0){const a=Math.floor(r/t);r-=t*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const u=e<0;this._setEndings(u,!u,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&(s&1)===1)return t-r}return r}_setEndings(e,t,i){const r=this._interpolantSettings;i?(r.endingStart=yu,r.endingEnd=yu):(e?r.endingStart=this.zeroSlopeAtStart?yu:vu:r.endingStart=fm,t?r.endingEnd=this.zeroSlopeAtEnd?yu:vu:r.endingEnd=fm)}_scheduleFading(e,t,i){const r=this._mixer,s=r.time;let o=this._weightInterpolant;o===null&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=t,a[1]=s+e,l[1]=i,this}}const Ose=new Float32Array(1);class Dse extends Ko{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const i=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,a=e._interpolants,l=i.uuid,u=this._bindingsByRootAndName;let c=u[l];c===void 0&&(c={},u[l]=c);for(let h=0;h!==s;++h){const d=r[h],f=d.name;let p=c[f];if(p!==void 0)++p.referenceCount,o[h]=p;else{if(p=o[h],p!==void 0){p._cacheIndex===null&&(++p.referenceCount,this._addInactiveBinding(p,l,f));continue}const _=t&&t._propertyBindings[h].binding.parsedPath;p=new Sse(It.create(i,f,_),d.ValueTypeName,d.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,l,f),o[h]=p}a[h].resultBuffer=p.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const i=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,i)}const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,i){const r=this._actions,s=this._actionsByClip;let o=s[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[i]=e}_removeInactiveAction(e){const t=this._actions,i=t[t.length-1],r=e._cacheIndex;i._cacheIndex=r,t[r]=i,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,u=l[l.length-1],c=e._byClipCacheIndex;u._byClipCacheIndex=c,l[c]=u,l.pop(),e._byClipCacheIndex=null;const h=a.actionByRoot,d=(e._localRoot||this._root).uuid;delete h[d],l.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,i=e._cacheIndex,r=this._nActiveActions++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackAction(e){const t=this._actions,i=e._cacheIndex,r=--this._nActiveActions,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_addInactiveBinding(e,t,i){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[t];o===void 0&&(o={},r[t]=o),o[i]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,i=e.binding,r=i.rootNode.uuid,s=i.path,o=this._bindingsByRootAndName,a=o[r],l=t[t.length-1],u=e._cacheIndex;l._cacheIndex=u,t[u]=l,t.pop(),delete a[s],Object.keys(a).length===0&&delete o[r]}_lendBinding(e){const t=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackBinding(e){const t=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let i=e[t];return i===void 0&&(i=new w2(new Float32Array(2),new Float32Array(2),1,Ose),i.__cacheIndex=t,e[t]=i),i}_takeBackControlInterpolant(e){const t=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=t[r];e.__cacheIndex=r,t[r]=e,s.__cacheIndex=i,t[i]=s}clipAction(e,t,i){const r=t||this._root,s=r.uuid;let o=typeof e=="string"?gm.findByName(r,e):e;const a=o!==null?o.uuid:e,l=this._actionsByClip[a];let u=null;if(i===void 0&&(o!==null?i=o.blendMode:i=cS),l!==void 0){const h=l.actionByRoot[s];if(h!==void 0&&h.blendMode===i)return h;u=l.knownActions[0],o===null&&(o=u._clip)}if(o===null)return null;const c=new Lse(this,o,t,i);return this._bindAction(c,u),this._addInactiveAction(c,a,s),c}existingAction(e,t){const i=t||this._root,r=i.uuid,s=typeof e=="string"?gm.findByName(i,e):e,o=s?s.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[r]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let i=t-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;const t=this._actions,i=this._nActiveActions,r=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let u=0;u!==i;++u)t[u]._update(r,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let u=0;u!==l;++u)a[u].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,i=e.uuid,r=this._actionsByClip,s=r[i];if(s!==void 0){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const u=o[a];this._deactivateAction(u);const c=u._cacheIndex,h=t[t.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,h._cacheIndex=c,t[c]=h,t.pop(),this._removeInactiveBindingsForAction(u)}delete r[i]}}uncacheRoot(e){const t=e.uuid,i=this._actionsByClip;for(const o in i){const a=i[o].actionByRoot,l=a[t];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const r=this._bindingsByRootAndName,s=r[t];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const i=this.existingAction(e,t);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class JA{constructor(e,t,i,r,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=i,this.elementSize=r,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class QA{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(zn(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Fse extends zd{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new kn;r.setAttribute("position",new Ir(t,3)),r.setAttribute("color",new Ir(i,3));const s=new Ml({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(e,t,i){const r=new We,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(t),r.toArray(s,6),r.toArray(s,9),r.set(i),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Er}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Er);/*!
 * @pixiv/three-vrm v2.0.1
 * VRM file loader for three.js.
 *
 * Copyright (c) 2019-2023 pixiv Inc.
 * @pixiv/three-vrm is distributed under MIT License
 * https://github.com/pixiv/three-vrm/blob/release/LICENSE
 *//*!
 * @pixiv/three-vrm-core v2.0.1
 * The implementation of core features of VRM, for @pixiv/three-vrm
 *
 * Copyright (c) 2020-2023 pixiv Inc.
 * @pixiv/three-vrm-core is distributed under MIT License
 * https://github.com/pixiv/three-vrm/blob/release/LICENSE
 */class e1 extends Ft{get overrideBlinkAmount(){return this.overrideBlink==="block"?0<this.weight?1:0:this.overrideBlink==="blend"?this.weight:0}get overrideLookAtAmount(){return this.overrideLookAt==="block"?0<this.weight?1:0:this.overrideLookAt==="blend"?this.weight:0}get overrideMouthAmount(){return this.overrideMouth==="block"?0<this.weight?1:0:this.overrideMouth==="blend"?this.weight:0}constructor(e){super(),this.weight=0,this.isBinary=!1,this.overrideBlink="none",this.overrideLookAt="none",this.overrideMouth="none",this._binds=[],this.name=`VRMExpression_${e}`,this.expressionName=e,this.type="VRMExpression",this.visible=!1}addBind(e){this._binds.push(e)}applyWeight(e){var t;let i=this.isBinary?this.weight<=.5?0:1:this.weight;i*=(t=e==null?void 0:e.multiplier)!==null&&t!==void 0?t:1,this._binds.forEach(r=>r.applyWeight(i))}clearAppliedWeight(){this._binds.forEach(e=>e.clearAppliedWeight())}}function Ct(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(c){try{u(i.next(c))}catch(h){o(h)}}function l(c){try{u(i.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(a,l)}u((i=i.apply(n,e||[])).next())})}function I2(n,e,t){var i,r;const s=n.parser.json,o=(i=s.nodes)===null||i===void 0?void 0:i[e];if(o==null)return console.warn(`extractPrimitivesInternal: Attempt to use nodes[${e}] of glTF but the node doesn't exist`),null;const a=o.mesh;if(a==null)return null;const l=(r=s.meshes)===null||r===void 0?void 0:r[a];if(l==null)return console.warn(`extractPrimitivesInternal: Attempt to use meshes[${a}] of glTF but the mesh doesn't exist`),null;const u=l.primitives.length,c=[];return t.traverse(h=>{c.length<u&&h.isMesh&&c.push(h)}),c}function t1(n,e){return Ct(this,void 0,void 0,function*(){const t=yield n.parser.getDependency("node",e);return I2(n,e,t)})}function n1(n){return Ct(this,void 0,void 0,function*(){const e=yield n.parser.getDependencies("node"),t=new Map;return e.forEach((i,r)=>{const s=I2(n,r,i);s!=null&&t.set(r,s)}),t})}function i1(n,e){var t,i;const r=parseInt(Er,10);let s=null;if(r>=133)s=(i=(t=n.associations.get(e))===null||t===void 0?void 0:t.materials)!==null&&i!==void 0?i:null;else{const a=n.associations.get(e);(a==null?void 0:a.type)==="materials"&&(s=a.index)}return s}const Uy={Aa:"aa",Ih:"ih",Ou:"ou",Ee:"ee",Oh:"oh",Blink:"blink",Happy:"happy",Angry:"angry",Sad:"sad",Relaxed:"relaxed",LookUp:"lookUp",Surprised:"surprised",LookDown:"lookDown",LookLeft:"lookLeft",LookRight:"lookRight",BlinkLeft:"blinkLeft",BlinkRight:"blinkRight",Neutral:"neutral"};function L2(n){return Math.max(Math.min(n,1),0)}class _m{get expressions(){return this._expressions.concat()}get expressionMap(){return Object.assign({},this._expressionMap)}get presetExpressionMap(){const e={},t=new Set(Object.values(Uy));return Object.entries(this._expressionMap).forEach(([i,r])=>{t.has(i)&&(e[i]=r)}),e}get customExpressionMap(){const e={},t=new Set(Object.values(Uy));return Object.entries(this._expressionMap).forEach(([i,r])=>{t.has(i)||(e[i]=r)}),e}constructor(){this.blinkExpressionNames=["blink","blinkLeft","blinkRight"],this.lookAtExpressionNames=["lookLeft","lookRight","lookUp","lookDown"],this.mouthExpressionNames=["aa","ee","ih","oh","ou"],this._expressions=[],this._expressionMap={}}copy(e){return this._expressions.concat().forEach(i=>{this.unregisterExpression(i)}),e._expressions.forEach(i=>{this.registerExpression(i)}),this.blinkExpressionNames=e.blinkExpressionNames.concat(),this.lookAtExpressionNames=e.lookAtExpressionNames.concat(),this.mouthExpressionNames=e.mouthExpressionNames.concat(),this}clone(){return new _m().copy(this)}getExpression(e){var t;return(t=this._expressionMap[e])!==null&&t!==void 0?t:null}registerExpression(e){this._expressions.push(e),this._expressionMap[e.expressionName]=e}unregisterExpression(e){const t=this._expressions.indexOf(e);t===-1&&console.warn("VRMExpressionManager: The specified expressions is not registered"),this._expressions.splice(t,1),delete this._expressionMap[e.expressionName]}getValue(e){var t;const i=this.getExpression(e);return(t=i==null?void 0:i.weight)!==null&&t!==void 0?t:null}setValue(e,t){const i=this.getExpression(e);i&&(i.weight=L2(t))}getExpressionTrackName(e){const t=this.getExpression(e);return t?`${t.name}.weight`:null}update(){const e=this._calculateWeightMultipliers();this._expressions.forEach(t=>{t.clearAppliedWeight()}),this._expressions.forEach(t=>{let i=1;const r=t.expressionName;this.blinkExpressionNames.indexOf(r)!==-1&&(i*=e.blink),this.lookAtExpressionNames.indexOf(r)!==-1&&(i*=e.lookAt),this.mouthExpressionNames.indexOf(r)!==-1&&(i*=e.mouth),t.applyWeight({multiplier:i})})}_calculateWeightMultipliers(){let e=1,t=1,i=1;return this._expressions.forEach(r=>{e-=r.overrideBlinkAmount,t-=r.overrideLookAtAmount,i-=r.overrideMouthAmount}),e=Math.max(0,e),t=Math.max(0,t),i=Math.max(0,i),{blink:e,lookAt:t,mouth:i}}}const ih={Color:"color",EmissionColor:"emissionColor",ShadeColor:"shadeColor",MatcapColor:"matcapColor",RimColor:"rimColor",OutlineColor:"outlineColor"},Nse={_Color:ih.Color,_EmissionColor:ih.EmissionColor,_ShadeColor:ih.ShadeColor,_RimColor:ih.RimColor,_OutlineColor:ih.OutlineColor},Use=new We;class wd{constructor({material:e,type:t,targetValue:i}){var r,s,o;this.material=e,this.type=t,this.targetValue=i;const a=(r=Object.entries(wd._propertyNameMapMap).find(([u])=>e[u]===!0))===null||r===void 0?void 0:r[1],l=(s=a==null?void 0:a[t])!==null&&s!==void 0?s:null;if(l==null)console.warn(`Tried to add a material color bind to the material ${(o=e.name)!==null&&o!==void 0?o:"(no name)"}, the type ${t} but the material or the type is not supported.`),this._state=null;else{const c=e[l].clone(),h=new We(i.r-c.r,i.g-c.g,i.b-c.b);this._state={propertyName:l,initialValue:c,deltaValue:h}}}applyWeight(e){if(this._state==null)return;const{propertyName:t,deltaValue:i}=this._state,r=this.material[t];r!==void 0&&(r.add(Use.copy(i).multiplyScalar(e)),typeof this.material.shouldApplyUniforms=="boolean"&&(this.material.shouldApplyUniforms=!0))}clearAppliedWeight(){if(this._state==null)return;const{propertyName:e,initialValue:t}=this._state,i=this.material[e];i!==void 0&&(i.copy(t),typeof this.material.shouldApplyUniforms=="boolean"&&(this.material.shouldApplyUniforms=!0))}}wd._propertyNameMapMap={isMeshStandardMaterial:{color:"color",emissionColor:"emissive"},isMeshBasicMaterial:{color:"color"},isMToonMaterial:{color:"color",emissionColor:"emissive",outlineColor:"outlineColorFactor",matcapColor:"matcapFactor",rimColor:"parametricRimColorFactor",shadeColor:"shadeColorFactor"}};class r1{constructor({primitives:e,index:t,weight:i}){this.primitives=e,this.index=t,this.weight=i}applyWeight(e){this.primitives.forEach(t=>{var i;((i=t.morphTargetInfluences)===null||i===void 0?void 0:i[this.index])!=null&&(t.morphTargetInfluences[this.index]+=this.weight*e)})}clearAppliedWeight(){this.primitives.forEach(e=>{var t;((t=e.morphTargetInfluences)===null||t===void 0?void 0:t[this.index])!=null&&(e.morphTargetInfluences[this.index]=0)})}}const s1=new Ze;class Ad{constructor({material:e,scale:t,offset:i}){var r,s;this.material=e,this.scale=t,this.offset=i;const o=(r=Object.entries(Ad._propertyNamesMap).find(([a])=>e[a]===!0))===null||r===void 0?void 0:r[1];o==null?(console.warn(`Tried to add a texture transform bind to the material ${(s=e.name)!==null&&s!==void 0?s:"(no name)"} but the material is not supported.`),this._properties=[]):(this._properties=[],o.forEach(a=>{var l;const u=(l=e[a])===null||l===void 0?void 0:l.clone();if(!u)return null;e[a]=u;const c=u.offset.clone(),h=u.repeat.clone(),d=i.clone().sub(c),f=t.clone().sub(h);this._properties.push({name:a,initialOffset:c,deltaOffset:d,initialScale:h,deltaScale:f})}))}applyWeight(e){this._properties.forEach(t=>{const i=this.material[t.name];i!==void 0&&(i.offset.add(s1.copy(t.deltaOffset).multiplyScalar(e)),i.repeat.add(s1.copy(t.deltaScale).multiplyScalar(e)),i.needsUpdate=!0)})}clearAppliedWeight(){this._properties.forEach(e=>{const t=this.material[e.name];t!==void 0&&(t.offset.copy(e.initialOffset),t.repeat.copy(e.initialScale),t.needsUpdate=!0)})}}Ad._propertyNamesMap={isMeshStandardMaterial:["map","emissiveMap","bumpMap","normalMap","displacementMap","roughnessMap","metalnessMap","alphaMap"],isMeshBasicMaterial:["map","specularMap","alphaMap"],isMToonMaterial:["map","normalMap","emissiveMap","shadeMultiplyTexture","rimMultiplyTexture","outlineWidthMultiplyTexture","uvAnimationMaskTexture"]};const Bse=new Set(["1.0","1.0-beta"]);class Eg{get name(){return"VRMExpressionLoaderPlugin"}constructor(e){this.parser=e}afterRoot(e){return Ct(this,void 0,void 0,function*(){e.userData.vrmExpressionManager=yield this._import(e)})}_import(e){return Ct(this,void 0,void 0,function*(){const t=yield this._v1Import(e);if(t)return t;const i=yield this._v0Import(e);return i||null})}_v1Import(e){var t,i;return Ct(this,void 0,void 0,function*(){const r=this.parser.json;if(!(((t=r.extensionsUsed)===null||t===void 0?void 0:t.indexOf("VRMC_vrm"))!==-1))return null;const o=(i=r.extensions)===null||i===void 0?void 0:i.VRMC_vrm;if(!o)return null;const a=o.specVersion;if(!Bse.has(a))return console.warn(`VRMExpressionLoaderPlugin: Unknown VRMC_vrm specVersion "${a}"`),null;const l=o.expressions;if(!l)return null;const u=new Set(Object.values(Uy)),c=new Map;l.preset!=null&&Object.entries(l.preset).forEach(([d,f])=>{if(f!=null){if(!u.has(d)){console.warn(`VRMExpressionLoaderPlugin: Unknown preset name "${d}" detected. Ignoring the expression`);return}c.set(d,f)}}),l.custom!=null&&Object.entries(l.custom).forEach(([d,f])=>{if(u.has(d)){console.warn(`VRMExpressionLoaderPlugin: Custom expression cannot have preset name "${d}". Ignoring the expression`);return}c.set(d,f)});const h=new _m;return yield Promise.all(Array.from(c.entries()).map(([d,f])=>Ct(this,void 0,void 0,function*(){var p,_,m,g,v,y,x;const b=new e1(d);if(e.scene.add(b),b.isBinary=(p=f.isBinary)!==null&&p!==void 0?p:!1,b.overrideBlink=(_=f.overrideBlink)!==null&&_!==void 0?_:"none",b.overrideLookAt=(m=f.overrideLookAt)!==null&&m!==void 0?m:"none",b.overrideMouth=(g=f.overrideMouth)!==null&&g!==void 0?g:"none",(v=f.morphTargetBinds)===null||v===void 0||v.forEach(S=>Ct(this,void 0,void 0,function*(){var T;if(S.node===void 0||S.index===void 0)return;const P=yield t1(e,S.node),E=S.index;if(!P.every(M=>Array.isArray(M.morphTargetInfluences)&&E<M.morphTargetInfluences.length)){console.warn(`VRMExpressionLoaderPlugin: ${f.name} attempts to index morph #${E} but not found.`);return}b.addBind(new r1({primitives:P,index:E,weight:(T=S.weight)!==null&&T!==void 0?T:1}))})),f.materialColorBinds||f.textureTransformBinds){const S=[];e.scene.traverse(T=>{const P=T.material;P&&S.push(P)}),(y=f.materialColorBinds)===null||y===void 0||y.forEach(T=>Ct(this,void 0,void 0,function*(){S.filter(E=>{const M=i1(this.parser,E);return T.material===M}).forEach(E=>{b.addBind(new wd({material:E,type:T.type,targetValue:new We().fromArray(T.targetValue)}))})})),(x=f.textureTransformBinds)===null||x===void 0||x.forEach(T=>Ct(this,void 0,void 0,function*(){S.filter(E=>{const M=i1(this.parser,E);return T.material===M}).forEach(E=>{var M,O;b.addBind(new Ad({material:E,offset:new Ze().fromArray((M=T.offset)!==null&&M!==void 0?M:[0,0]),scale:new Ze().fromArray((O=T.scale)!==null&&O!==void 0?O:[1,1])}))})}))}h.registerExpression(b)}))),h})}_v0Import(e){var t;return Ct(this,void 0,void 0,function*(){const i=this.parser.json,r=(t=i.extensions)===null||t===void 0?void 0:t.VRM;if(!r)return null;const s=r.blendShapeMaster;if(!s)return null;const o=new _m,a=s.blendShapeGroups;if(!a)return o;const l=new Set;return yield Promise.all(a.map(u=>Ct(this,void 0,void 0,function*(){var c;const h=u.presetName,d=h!=null&&Eg.v0v1PresetNameMap[h]||null,f=d??u.name;if(f==null){console.warn("VRMExpressionLoaderPlugin: One of custom expressions has no name. Ignoring the expression");return}if(l.has(f)){console.warn(`VRMExpressionLoaderPlugin: An expression preset ${h} has duplicated entries. Ignoring the expression`);return}l.add(f);const p=new e1(f);e.scene.add(p),p.isBinary=(c=u.isBinary)!==null&&c!==void 0?c:!1,u.binds&&u.binds.forEach(m=>Ct(this,void 0,void 0,function*(){var g;if(m.mesh===void 0||m.index===void 0)return;const v=[];(g=i.nodes)===null||g===void 0||g.forEach((x,b)=>{x.mesh===m.mesh&&v.push(b)});const y=m.index;yield Promise.all(v.map(x=>Ct(this,void 0,void 0,function*(){var b;const S=yield t1(e,x);if(!S.every(T=>Array.isArray(T.morphTargetInfluences)&&y<T.morphTargetInfluences.length)){console.warn(`VRMExpressionLoaderPlugin: ${u.name} attempts to index ${y}th morph but not found.`);return}p.addBind(new r1({primitives:S,index:y,weight:.01*((b=m.weight)!==null&&b!==void 0?b:100)}))})))}));const _=u.materialValues;_&&_.length!==0&&_.forEach(m=>{if(m.materialName===void 0||m.propertyName===void 0||m.targetValue===void 0)return;const g=[];e.scene.traverse(y=>{if(y.material){const x=y.material;Array.isArray(x)?g.push(...x.filter(b=>(b.name===m.materialName||b.name===m.materialName+" (Outline)")&&g.indexOf(b)===-1)):x.name===m.materialName&&g.indexOf(x)===-1&&g.push(x)}});const v=m.propertyName;g.forEach(y=>{if(v==="_MainTex_ST"){const b=new Ze(m.targetValue[0],m.targetValue[1]),S=new Ze(m.targetValue[2],m.targetValue[3]);p.addBind(new Ad({material:y,scale:b,offset:S}));return}const x=Nse[v];if(x){p.addBind(new wd({material:y,type:x,targetValue:new We(...m.targetValue.slice(0,3))}));return}console.warn(v+" is not supported")})}),o.registerExpression(p)}))),o})}}Eg.v0v1PresetNameMap={a:"aa",e:"ee",i:"ih",o:"oh",u:"ou",blink:"blink",joy:"happy",angry:"angry",sorrow:"sad",fun:"relaxed",lookup:"lookUp",lookdown:"lookDown",lookleft:"lookLeft",lookright:"lookRight",blink_l:"blinkLeft",blink_r:"blinkRight",neutral:"neutral"};class ts{constructor(e,t){this._firstPersonOnlyLayer=ts.DEFAULT_FIRSTPERSON_ONLY_LAYER,this._thirdPersonOnlyLayer=ts.DEFAULT_THIRDPERSON_ONLY_LAYER,this._initializedLayers=!1,this.humanoid=e,this.meshAnnotations=t}copy(e){if(this.humanoid!==e.humanoid)throw new Error("VRMFirstPerson: humanoid must be same in order to copy");return this.meshAnnotations=e.meshAnnotations.map(t=>({meshes:t.meshes.concat(),type:t.type})),this}clone(){return new ts(this.humanoid,this.meshAnnotations).copy(this)}get firstPersonOnlyLayer(){return this._firstPersonOnlyLayer}get thirdPersonOnlyLayer(){return this._thirdPersonOnlyLayer}setup({firstPersonOnlyLayer:e=ts.DEFAULT_FIRSTPERSON_ONLY_LAYER,thirdPersonOnlyLayer:t=ts.DEFAULT_THIRDPERSON_ONLY_LAYER}={}){this._initializedLayers||(this._firstPersonOnlyLayer=e,this._thirdPersonOnlyLayer=t,this.meshAnnotations.forEach(i=>{i.meshes.forEach(r=>{i.type==="firstPersonOnly"?(r.layers.set(this._firstPersonOnlyLayer),r.traverse(s=>s.layers.set(this._firstPersonOnlyLayer))):i.type==="thirdPersonOnly"?(r.layers.set(this._thirdPersonOnlyLayer),r.traverse(s=>s.layers.set(this._thirdPersonOnlyLayer))):i.type==="auto"&&this._createHeadlessModel(r)})}),this._initializedLayers=!0)}_excludeTriangles(e,t,i,r){let s=0;if(t!=null&&t.length>0)for(let o=0;o<e.length;o+=3){const a=e[o],l=e[o+1],u=e[o+2],c=t[a],h=i[a];if(c[0]>0&&r.includes(h[0])||c[1]>0&&r.includes(h[1])||c[2]>0&&r.includes(h[2])||c[3]>0&&r.includes(h[3]))continue;const d=t[l],f=i[l];if(d[0]>0&&r.includes(f[0])||d[1]>0&&r.includes(f[1])||d[2]>0&&r.includes(f[2])||d[3]>0&&r.includes(f[3]))continue;const p=t[u],_=i[u];p[0]>0&&r.includes(_[0])||p[1]>0&&r.includes(_[1])||p[2]>0&&r.includes(_[2])||p[3]>0&&r.includes(_[3])||(e[s++]=a,e[s++]=l,e[s++]=u)}return s}_createErasedMesh(e,t){const i=new b2(e.geometry.clone(),e.material);i.name=`${e.name}(erase)`,i.frustumCulled=e.frustumCulled,i.layers.set(this._firstPersonOnlyLayer);const r=i.geometry,s=r.getAttribute("skinIndex"),o=s instanceof JA?[]:s.array,a=[];for(let _=0;_<o.length;_+=4)a.push([o[_],o[_+1],o[_+2],o[_+3]]);const l=r.getAttribute("skinWeight"),u=l instanceof JA?[]:l.array,c=[];for(let _=0;_<u.length;_+=4)c.push([u[_],u[_+1],u[_+2],u[_+3]]);const h=r.getIndex();if(!h)throw new Error("The geometry doesn't have an index buffer");const d=Array.from(h.array),f=this._excludeTriangles(d,c,a,t),p=[];for(let _=0;_<f;_++)p[_]=d[_];return r.setIndex(p),e.onBeforeRender&&(i.onBeforeRender=e.onBeforeRender),i.bind(new Hd(e.skeleton.bones,e.skeleton.boneInverses),new Qe),i}_createHeadlessModelForSkinnedMesh(e,t){const i=[];if(t.skeleton.bones.forEach((s,o)=>{this._isEraseTarget(s)&&i.push(o)}),!i.length){t.layers.enable(this._thirdPersonOnlyLayer),t.layers.enable(this._firstPersonOnlyLayer);return}t.layers.set(this._thirdPersonOnlyLayer);const r=this._createErasedMesh(t,i);e.add(r)}_createHeadlessModel(e){if(e.type==="Group")if(e.layers.set(this._thirdPersonOnlyLayer),this._isEraseTarget(e))e.traverse(t=>t.layers.set(this._thirdPersonOnlyLayer));else{const t=new Ri;t.name=`_headless_${e.name}`,t.layers.set(this._firstPersonOnlyLayer),e.parent.add(t),e.children.filter(i=>i.type==="SkinnedMesh").forEach(i=>{const r=i;this._createHeadlessModelForSkinnedMesh(t,r)})}else if(e.type==="SkinnedMesh"){const t=e;this._createHeadlessModelForSkinnedMesh(e.parent,t)}else this._isEraseTarget(e)&&(e.layers.set(this._thirdPersonOnlyLayer),e.traverse(t=>t.layers.set(this._thirdPersonOnlyLayer)))}_isEraseTarget(e){return e===this.humanoid.getRawBoneNode("head")?!0:e.parent?this._isEraseTarget(e.parent):!1}}ts.DEFAULT_FIRSTPERSON_ONLY_LAYER=9;ts.DEFAULT_THIRDPERSON_ONLY_LAYER=10;const kse=new Set(["1.0","1.0-beta"]);class Vse{get name(){return"VRMFirstPersonLoaderPlugin"}constructor(e){this.parser=e}afterRoot(e){return Ct(this,void 0,void 0,function*(){const t=e.userData.vrmHumanoid;if(t!==null){if(t===void 0)throw new Error("VRMFirstPersonLoaderPlugin: vrmHumanoid is undefined. VRMHumanoidLoaderPlugin have to be used first");e.userData.vrmFirstPerson=yield this._import(e,t)}})}_import(e,t){return Ct(this,void 0,void 0,function*(){if(t==null)return null;const i=yield this._v1Import(e,t);if(i)return i;const r=yield this._v0Import(e,t);return r||null})}_v1Import(e,t){var i,r;return Ct(this,void 0,void 0,function*(){const s=this.parser.json;if(!(((i=s.extensionsUsed)===null||i===void 0?void 0:i.indexOf("VRMC_vrm"))!==-1))return null;const a=(r=s.extensions)===null||r===void 0?void 0:r.VRMC_vrm;if(!a)return null;const l=a.specVersion;if(!kse.has(l))return console.warn(`VRMFirstPersonLoaderPlugin: Unknown VRMC_vrm specVersion "${l}"`),null;const u=a.firstPerson;if(!u)return null;const c=[],h=yield n1(e);return Array.from(h.entries()).forEach(([d,f])=>{var p;const _=u.meshAnnotations?u.meshAnnotations.find(m=>m.node===d):void 0;c.push({meshes:f,type:(p=_==null?void 0:_.type)!==null&&p!==void 0?p:"both"})}),new ts(t,c)})}_v0Import(e,t){var i;return Ct(this,void 0,void 0,function*(){const r=this.parser.json,s=(i=r.extensions)===null||i===void 0?void 0:i.VRM;if(!s)return null;const o=s.firstPerson;if(!o)return null;const a=[],l=yield n1(e);return Array.from(l.entries()).forEach(([u,c])=>{const h=r.nodes[u],d=o.meshAnnotations?o.meshAnnotations.find(f=>f.mesh===h.mesh):void 0;a.push({meshes:c,type:this._convertV0FlagToV1Type(d==null?void 0:d.firstPersonFlag)})}),new ts(t,a)})}_convertV0FlagToV1Type(e){return e==="FirstPersonOnly"?"firstPersonOnly":e==="ThirdPersonOnly"?"thirdPersonOnly":e==="Auto"?"auto":"both"}}const o1=new z,a1=new z,Gse=new Xe;class l1 extends Ri{constructor(e){super(),this.vrmHumanoid=e,this._boneAxesMap=new Map,Object.values(e.humanBones).forEach(t=>{const i=new Fse(1);i.matrixAutoUpdate=!1,i.material.depthTest=!1,i.material.depthWrite=!1,this.add(i),this._boneAxesMap.set(t,i)})}dispose(){Array.from(this._boneAxesMap.values()).forEach(e=>{e.geometry.dispose(),e.material.dispose()})}updateMatrixWorld(e){Array.from(this._boneAxesMap.entries()).forEach(([t,i])=>{t.node.updateWorldMatrix(!0,!1),t.node.matrixWorld.decompose(o1,Gse,a1);const r=o1.set(.1,.1,.1).divide(a1);i.matrix.copy(t.node.matrixWorld).scale(r)}),super.updateMatrixWorld(e)}}const Pv=["hips","spine","chest","upperChest","neck","head","leftEye","rightEye","jaw","leftUpperLeg","leftLowerLeg","leftFoot","leftToes","rightUpperLeg","rightLowerLeg","rightFoot","rightToes","leftShoulder","leftUpperArm","leftLowerArm","leftHand","rightShoulder","rightUpperArm","rightLowerArm","rightHand","leftThumbMetacarpal","leftThumbProximal","leftThumbDistal","leftIndexProximal","leftIndexIntermediate","leftIndexDistal","leftMiddleProximal","leftMiddleIntermediate","leftMiddleDistal","leftRingProximal","leftRingIntermediate","leftRingDistal","leftLittleProximal","leftLittleIntermediate","leftLittleDistal","rightThumbMetacarpal","rightThumbProximal","rightThumbDistal","rightIndexProximal","rightIndexIntermediate","rightIndexDistal","rightMiddleProximal","rightMiddleIntermediate","rightMiddleDistal","rightRingProximal","rightRingIntermediate","rightRingDistal","rightLittleProximal","rightLittleIntermediate","rightLittleDistal"],By={hips:null,spine:"hips",chest:"spine",upperChest:"chest",neck:"upperChest",head:"neck",leftEye:"head",rightEye:"head",jaw:"head",leftUpperLeg:"hips",leftLowerLeg:"leftUpperLeg",leftFoot:"leftLowerLeg",leftToes:"leftFoot",rightUpperLeg:"hips",rightLowerLeg:"rightUpperLeg",rightFoot:"rightLowerLeg",rightToes:"rightFoot",leftShoulder:"upperChest",leftUpperArm:"leftShoulder",leftLowerArm:"leftUpperArm",leftHand:"leftLowerArm",rightShoulder:"upperChest",rightUpperArm:"rightShoulder",rightLowerArm:"rightUpperArm",rightHand:"rightLowerArm",leftThumbMetacarpal:"leftHand",leftThumbProximal:"leftThumbMetacarpal",leftThumbDistal:"leftThumbProximal",leftIndexProximal:"leftHand",leftIndexIntermediate:"leftIndexProximal",leftIndexDistal:"leftIndexIntermediate",leftMiddleProximal:"leftHand",leftMiddleIntermediate:"leftMiddleProximal",leftMiddleDistal:"leftMiddleIntermediate",leftRingProximal:"leftHand",leftRingIntermediate:"leftRingProximal",leftRingDistal:"leftRingIntermediate",leftLittleProximal:"leftHand",leftLittleIntermediate:"leftLittleProximal",leftLittleDistal:"leftLittleIntermediate",rightThumbMetacarpal:"rightHand",rightThumbProximal:"rightThumbMetacarpal",rightThumbDistal:"rightThumbProximal",rightIndexProximal:"rightHand",rightIndexIntermediate:"rightIndexProximal",rightIndexDistal:"rightIndexIntermediate",rightMiddleProximal:"rightHand",rightMiddleIntermediate:"rightMiddleProximal",rightMiddleDistal:"rightMiddleIntermediate",rightRingProximal:"rightHand",rightRingIntermediate:"rightRingProximal",rightRingDistal:"rightRingIntermediate",rightLittleProximal:"rightHand",rightLittleIntermediate:"rightLittleProximal",rightLittleDistal:"rightLittleIntermediate"};function O2(n){return n.invert?n.invert():n.inverse(),n}const ya=new z,xa=new Xe;class ky{constructor(e){this.humanBones=e,this.restPose=this.getAbsolutePose()}getAbsolutePose(){const e={};return Object.keys(this.humanBones).forEach(t=>{const i=t,r=this.getBoneNode(i);r&&(ya.copy(r.position),xa.copy(r.quaternion),e[i]={position:ya.toArray(),rotation:xa.toArray()})}),e}getPose(){const e={};return Object.keys(this.humanBones).forEach(t=>{const i=t,r=this.getBoneNode(i);if(!r)return;ya.set(0,0,0),xa.identity();const s=this.restPose[i];s!=null&&s.position&&ya.fromArray(s.position).negate(),s!=null&&s.rotation&&O2(xa.fromArray(s.rotation)),ya.add(r.position),xa.premultiply(r.quaternion),e[i]={position:ya.toArray(),rotation:xa.toArray()}}),e}setPose(e){Object.entries(e).forEach(([t,i])=>{const r=t,s=this.getBoneNode(r);if(!s)return;const o=this.restPose[r];o&&(i!=null&&i.position&&(s.position.fromArray(i.position),o.position&&s.position.add(ya.fromArray(o.position))),i!=null&&i.rotation&&(s.quaternion.fromArray(i.rotation),o.rotation&&s.quaternion.multiply(xa.fromArray(o.rotation))))})}resetPose(){Object.entries(this.restPose).forEach(([e,t])=>{const i=this.getBoneNode(e);i&&(t!=null&&t.position&&i.position.fromArray(t.position),t!=null&&t.rotation&&i.quaternion.fromArray(t.rotation))})}getBone(e){var t;return(t=this.humanBones[e])!==null&&t!==void 0?t:void 0}getBoneNode(e){var t,i;return(i=(t=this.humanBones[e])===null||t===void 0?void 0:t.node)!==null&&i!==void 0?i:null}}const Hse=new z,zse=new Xe,Wse=new z;class vm extends ky{static _setupTransforms(e){const t=new Ft;t.name="VRMHumanoidRig";const i={},r={},s={};Pv.forEach(l=>{const u=e.getBoneNode(l);if(u){const c=new z,h=new Xe;u.updateWorldMatrix(!0,!1),u.matrixWorld.decompose(c,h,Hse),i[l]=c,r[l]=h,s[l]=u.quaternion.clone()}});const o={},a={};return Pv.forEach(l=>{var u;const c=e.getBoneNode(l);if(c){const h=i[l];let d=l,f,p;for(;f==null&&(d=By[d],d!=null);)f=i[d],p=r[d];const _=new Ft;_.name="Normalized_"+c.name,(d?(u=a[d])===null||u===void 0?void 0:u.node:t).add(_),_.position.copy(h),f&&_.position.sub(f),a[l]={node:_},o[l]=p??new Xe}}),{rigBones:a,root:t,parentWorldRotations:o,boneRotations:s}}constructor(e){const{rigBones:t,root:i,parentWorldRotations:r,boneRotations:s}=vm._setupTransforms(e);super(t),this.original=e,this.root=i,this._parentWorldRotations=r,this._boneRotations=s}update(){Pv.forEach(e=>{const t=this.original.getBoneNode(e);if(t!=null){const i=this.getBoneNode(e),r=this._parentWorldRotations[e],s=zse.copy(r).invert(),o=this._boneRotations[e];if(t.quaternion.copy(i.quaternion).multiply(r).premultiply(s).multiply(o),e==="hips"){const a=i.getWorldPosition(Wse);t.parent.updateWorldMatrix(!0,!1);const l=t.parent.matrixWorld,u=a.applyMatrix4(l.invert());t.position.copy(u)}}})}}class ym{get restPose(){return console.warn("VRMHumanoid: restPose is deprecated. Use either rawRestPose or normalizedRestPose instead."),this.rawRestPose}get rawRestPose(){return this._rawHumanBones.restPose}get normalizedRestPose(){return this._normalizedHumanBones.restPose}get humanBones(){return this._rawHumanBones.humanBones}get rawHumanBones(){return this._rawHumanBones.humanBones}get normalizedHumanBones(){return this._normalizedHumanBones.humanBones}get normalizedHumanBonesRoot(){return this._normalizedHumanBones.root}constructor(e,t){var i;this.autoUpdateHumanBones=(i=t==null?void 0:t.autoUpdateHumanBones)!==null&&i!==void 0?i:!0,this._rawHumanBones=new ky(e),this._normalizedHumanBones=new vm(this._rawHumanBones)}copy(e){return this.autoUpdateHumanBones=e.autoUpdateHumanBones,this._rawHumanBones=new ky(e.humanBones),this._normalizedHumanBones=new vm(this._rawHumanBones),this}clone(){return new ym(this.humanBones,{autoUpdateHumanBones:this.autoUpdateHumanBones}).copy(this)}getAbsolutePose(){return console.warn("VRMHumanoid: getAbsolutePose() is deprecated. Use either getRawAbsolutePose() or getNormalizedAbsolutePose() instead."),this.getRawAbsolutePose()}getRawAbsolutePose(){return this._rawHumanBones.getAbsolutePose()}getNormalizedAbsolutePose(){return this._normalizedHumanBones.getAbsolutePose()}getPose(){return console.warn("VRMHumanoid: getPose() is deprecated. Use either getRawPose() or getNormalizedPose() instead."),this.getRawPose()}getRawPose(){return this._rawHumanBones.getPose()}getNormalizedPose(){return this._normalizedHumanBones.getPose()}setPose(e){return console.warn("VRMHumanoid: setPose() is deprecated. Use either setRawPose() or setNormalizedPose() instead."),this.setRawPose(e)}setRawPose(e){return this._rawHumanBones.setPose(e)}setNormalizedPose(e){return this._normalizedHumanBones.setPose(e)}resetPose(){return console.warn("VRMHumanoid: resetPose() is deprecated. Use either resetRawPose() or resetNormalizedPose() instead."),this.resetRawPose()}resetRawPose(){return this._rawHumanBones.resetPose()}resetNormalizedPose(){return this._normalizedHumanBones.resetPose()}getBone(e){return console.warn("VRMHumanoid: getBone() is deprecated. Use either getRawBone() or getNormalizedBone() instead."),this.getRawBone(e)}getRawBone(e){return this._rawHumanBones.getBone(e)}getNormalizedBone(e){return this._normalizedHumanBones.getBone(e)}getBoneNode(e){return console.warn("VRMHumanoid: getBoneNode() is deprecated. Use either getRawBoneNode() or getNormalizedBoneNode() instead."),this.getRawBoneNode(e)}getRawBoneNode(e){return this._rawHumanBones.getBoneNode(e)}getNormalizedBoneNode(e){return this._normalizedHumanBones.getBoneNode(e)}update(){this.autoUpdateHumanBones&&this._normalizedHumanBones.update()}}const Xse={Hips:"hips",Spine:"spine",Head:"head",LeftUpperLeg:"leftUpperLeg",LeftLowerLeg:"leftLowerLeg",LeftFoot:"leftFoot",RightUpperLeg:"rightUpperLeg",RightLowerLeg:"rightLowerLeg",RightFoot:"rightFoot",LeftUpperArm:"leftUpperArm",LeftLowerArm:"leftLowerArm",LeftHand:"leftHand",RightUpperArm:"rightUpperArm",RightLowerArm:"rightLowerArm",RightHand:"rightHand"},jse=new Set(["1.0","1.0-beta"]),u1={leftThumbProximal:"leftThumbMetacarpal",leftThumbIntermediate:"leftThumbProximal",rightThumbProximal:"rightThumbMetacarpal",rightThumbIntermediate:"rightThumbProximal"};class $se{get name(){return"VRMHumanoidLoaderPlugin"}constructor(e,t){this.parser=e,this.helperRoot=t==null?void 0:t.helperRoot,this.autoUpdateHumanBones=t==null?void 0:t.autoUpdateHumanBones}afterRoot(e){return Ct(this,void 0,void 0,function*(){e.userData.vrmHumanoid=yield this._import(e)})}_import(e){return Ct(this,void 0,void 0,function*(){const t=yield this._v1Import(e);if(t)return t;const i=yield this._v0Import(e);return i||null})}_v1Import(e){var t,i;return Ct(this,void 0,void 0,function*(){const r=this.parser.json;if(!(((t=r.extensionsUsed)===null||t===void 0?void 0:t.indexOf("VRMC_vrm"))!==-1))return null;const o=(i=r.extensions)===null||i===void 0?void 0:i.VRMC_vrm;if(!o)return null;const a=o.specVersion;if(!jse.has(a))return console.warn(`VRMHumanoidLoaderPlugin: Unknown VRMC_vrm specVersion "${a}"`),null;const l=o.humanoid;if(!l)return null;const u=l.humanBones.leftThumbIntermediate!=null||l.humanBones.rightThumbIntermediate!=null,c={};l.humanBones!=null&&(yield Promise.all(Object.entries(l.humanBones).map(([d,f])=>Ct(this,void 0,void 0,function*(){let p=d;const _=f.node;if(u){const g=u1[p];g!=null&&(p=g)}const m=yield this.parser.getDependency("node",_);if(m==null){console.warn(`A glTF node bound to the humanoid bone ${p} (index = ${_}) does not exist`);return}c[p]={node:m}}))));const h=new ym(this._ensureRequiredBonesExist(c),{autoUpdateHumanBones:this.autoUpdateHumanBones});if(e.scene.add(h.normalizedHumanBonesRoot),this.helperRoot){const d=new l1(h);this.helperRoot.add(d),d.renderOrder=this.helperRoot.renderOrder}return h})}_v0Import(e){var t;return Ct(this,void 0,void 0,function*(){const r=(t=this.parser.json.extensions)===null||t===void 0?void 0:t.VRM;if(!r)return null;const s=r.humanoid;if(!s)return null;const o={};s.humanBones!=null&&(yield Promise.all(s.humanBones.map(l=>Ct(this,void 0,void 0,function*(){const u=l.bone,c=l.node;if(u==null||c==null)return;const h=yield this.parser.getDependency("node",c);if(h==null){console.warn(`A glTF node bound to the humanoid bone ${u} (index = ${c}) does not exist`);return}const d=u1[u],f=d??u;if(o[f]!=null){console.warn(`Multiple bone entries for ${f} detected (index = ${c}), ignoring duplicated entries.`);return}o[f]={node:h}}))));const a=new ym(this._ensureRequiredBonesExist(o),{autoUpdateHumanBones:this.autoUpdateHumanBones});if(e.scene.add(a.normalizedHumanBonesRoot),this.helperRoot){const l=new l1(a);this.helperRoot.add(l),l.renderOrder=this.helperRoot.renderOrder}return a})}_ensureRequiredBonesExist(e){const t=Object.values(Xse).filter(i=>e[i]==null);if(t.length>0)throw new Error(`VRMHumanoidLoaderPlugin: These humanoid bones are required but not exist: ${t.join(", ")}`);return e}}class c1 extends kn{constructor(){super(),this._currentTheta=0,this._currentRadius=0,this.theta=0,this.radius=0,this._currentTheta=0,this._currentRadius=0,this._attrPos=new Nt(new Float32Array(65*3),3),this.setAttribute("position",this._attrPos),this._attrIndex=new Nt(new Uint16Array(3*63),1),this.setIndex(this._attrIndex),this._buildIndex(),this.update()}update(){let e=!1;this._currentTheta!==this.theta&&(this._currentTheta=this.theta,e=!0),this._currentRadius!==this.radius&&(this._currentRadius=this.radius,e=!0),e&&this._buildPosition()}_buildPosition(){this._attrPos.setXYZ(0,0,0,0);for(let e=0;e<64;e++){const t=e/63*this._currentTheta;this._attrPos.setXYZ(e+1,this._currentRadius*Math.sin(t),0,this._currentRadius*Math.cos(t))}this._attrPos.needsUpdate=!0}_buildIndex(){for(let e=0;e<63;e++)this._attrIndex.setXYZ(e*3,0,e+1,e+2);this._attrIndex.needsUpdate=!0}}class Yse extends kn{constructor(){super(),this.radius=0,this._currentRadius=0,this.tail=new z,this._currentTail=new z,this._attrPos=new Nt(new Float32Array(294),3),this.setAttribute("position",this._attrPos),this._attrIndex=new Nt(new Uint16Array(194),1),this.setIndex(this._attrIndex),this._buildIndex(),this.update()}update(){let e=!1;this._currentRadius!==this.radius&&(this._currentRadius=this.radius,e=!0),this._currentTail.equals(this.tail)||(this._currentTail.copy(this.tail),e=!0),e&&this._buildPosition()}_buildPosition(){for(let e=0;e<32;e++){const t=e/16*Math.PI;this._attrPos.setXYZ(e,Math.cos(t),Math.sin(t),0),this._attrPos.setXYZ(32+e,0,Math.cos(t),Math.sin(t)),this._attrPos.setXYZ(64+e,Math.sin(t),0,Math.cos(t))}this.scale(this._currentRadius,this._currentRadius,this._currentRadius),this.translate(this._currentTail.x,this._currentTail.y,this._currentTail.z),this._attrPos.setXYZ(96,0,0,0),this._attrPos.setXYZ(97,this._currentTail.x,this._currentTail.y,this._currentTail.z),this._attrPos.needsUpdate=!0}_buildIndex(){for(let e=0;e<32;e++){const t=(e+1)%32;this._attrIndex.setXY(e*2,e,t),this._attrIndex.setXY(64+e*2,32+e,32+t),this._attrIndex.setXY(128+e*2,64+e,64+t)}this._attrIndex.setXY(192,96,97),this._attrIndex.needsUpdate=!0}}const pp=new Xe,h1=new Xe,rh=new z,d1=new z,f1=Math.sqrt(2)/2,qse=new Xe(0,0,-f1,f1),Kse=new z(0,1,0);class Zse extends Ri{constructor(e){super(),this.matrixAutoUpdate=!1,this.vrmLookAt=e;{const t=new c1;t.radius=.5;const i=new Hs({color:65280,transparent:!0,opacity:.5,side:qi,depthTest:!1,depthWrite:!1});this._meshPitch=new _i(t,i),this.add(this._meshPitch)}{const t=new c1;t.radius=.5;const i=new Hs({color:16711680,transparent:!0,opacity:.5,side:qi,depthTest:!1,depthWrite:!1});this._meshYaw=new _i(t,i),this.add(this._meshYaw)}{const t=new Yse;t.radius=.1;const i=new Ml({color:16777215,depthTest:!1,depthWrite:!1});this._lineTarget=new zd(t,i),this._lineTarget.frustumCulled=!1,this.add(this._lineTarget)}}dispose(){this._meshYaw.geometry.dispose(),this._meshYaw.material.dispose(),this._meshPitch.geometry.dispose(),this._meshPitch.material.dispose(),this._lineTarget.geometry.dispose(),this._lineTarget.material.dispose()}updateMatrixWorld(e){const t=Kt.DEG2RAD*this.vrmLookAt.yaw;this._meshYaw.geometry.theta=t,this._meshYaw.geometry.update();const i=Kt.DEG2RAD*this.vrmLookAt.pitch;this._meshPitch.geometry.theta=i,this._meshPitch.geometry.update(),this.vrmLookAt.getLookAtWorldPosition(rh),this.vrmLookAt.getLookAtWorldQuaternion(pp),pp.multiply(this.vrmLookAt.getFaceFrontQuaternion(h1)),this._meshYaw.position.copy(rh),this._meshYaw.quaternion.copy(pp),this._meshPitch.position.copy(rh),this._meshPitch.quaternion.copy(pp),this._meshPitch.quaternion.multiply(h1.setFromAxisAngle(Kse,t)),this._meshPitch.quaternion.multiply(qse);const{target:r,autoUpdate:s}=this.vrmLookAt;r!=null&&s&&(r.getWorldPosition(d1).sub(rh),this._lineTarget.geometry.tail.copy(d1),this._lineTarget.geometry.update(),this._lineTarget.position.copy(rh)),super.updateMatrixWorld(e)}}const Jse=new z,Qse=new z;function Vy(n,e){return n.matrixWorld.decompose(Jse,e,Qse),e}function Up(n){return[Math.atan2(-n.z,n.x),Math.atan2(n.y,Math.sqrt(n.x*n.x+n.z*n.z))]}function p1(n){const e=Math.round(n/2/Math.PI);return n-2*Math.PI*e}const m1=new z(0,0,1),eoe=new z,toe=new z,noe=new z,ioe=new Xe,Cv=new Xe,g1=new Xe,roe=new Xe,Rv=new Zo;class cc{get yaw(){return this._yaw}set yaw(e){this._yaw=e,this._needsUpdate=!0}get pitch(){return this._pitch}set pitch(e){this._pitch=e,this._needsUpdate=!0}get euler(){return console.warn("VRMLookAt: euler is deprecated. use getEuler() instead."),this.getEuler(new Zo)}constructor(e,t){this.offsetFromHeadBone=new z,this.autoUpdate=!0,this.faceFront=new z(0,0,1),this.humanoid=e,this.applier=t,this._yaw=0,this._pitch=0,this._needsUpdate=!0,this._restHeadWorldQuaternion=this.getLookAtWorldQuaternion(new Xe)}getEuler(e){return e.set(Kt.DEG2RAD*this._pitch,Kt.DEG2RAD*this._yaw,0,"YXZ")}copy(e){if(this.humanoid!==e.humanoid)throw new Error("VRMLookAt: humanoid must be same in order to copy");return this.offsetFromHeadBone.copy(e.offsetFromHeadBone),this.applier=e.applier,this.autoUpdate=e.autoUpdate,this.target=e.target,this.faceFront.copy(e.faceFront),this}clone(){return new cc(this.humanoid,this.applier).copy(this)}reset(){this._yaw=0,this._pitch=0,this._needsUpdate=!0}getLookAtWorldPosition(e){const t=this.humanoid.getRawBoneNode("head");return e.copy(this.offsetFromHeadBone).applyMatrix4(t.matrixWorld)}getLookAtWorldQuaternion(e){const t=this.humanoid.getRawBoneNode("head");return Vy(t,e)}getFaceFrontQuaternion(e){if(this.faceFront.distanceToSquared(m1)<.01)return e.copy(this._restHeadWorldQuaternion).invert();const[t,i]=Up(this.faceFront);return Rv.set(0,.5*Math.PI+t,i,"YZX"),e.setFromEuler(Rv).premultiply(roe.copy(this._restHeadWorldQuaternion).invert())}getLookAtWorldDirection(e){return this.getLookAtWorldQuaternion(Cv),this.getFaceFrontQuaternion(g1),e.copy(m1).applyQuaternion(Cv).applyQuaternion(g1).applyEuler(this.getEuler(Rv))}lookAt(e){const t=ioe.copy(this._restHeadWorldQuaternion).multiply(O2(this.getLookAtWorldQuaternion(Cv))),i=this.getLookAtWorldPosition(toe),r=noe.copy(e).sub(i).applyQuaternion(t).normalize(),[s,o]=Up(this.faceFront),[a,l]=Up(r),u=p1(a-s),c=p1(o-l);this._yaw=Kt.RAD2DEG*u,this._pitch=Kt.RAD2DEG*c,this._needsUpdate=!0}update(e){this.target!=null&&this.autoUpdate&&this.lookAt(this.target.getWorldPosition(eoe)),this._needsUpdate&&(this._needsUpdate=!1,this.applier.applyYawPitch(this._yaw,this._pitch))}}cc.EULER_ORDER="YXZ";const soe=new z(0,0,1),zr=new Xe,ou=new Xe,ki=new Zo(0,0,0,"YXZ");class Bp{constructor(e,t,i,r,s){this.humanoid=e,this.rangeMapHorizontalInner=t,this.rangeMapHorizontalOuter=i,this.rangeMapVerticalDown=r,this.rangeMapVerticalUp=s,this.faceFront=new z(0,0,1),this._restQuatLeftEye=new Xe,this._restQuatRightEye=new Xe,this._restLeftEyeParentWorldQuat=new Xe,this._restRightEyeParentWorldQuat=new Xe;const o=this.humanoid.getRawBoneNode("leftEye"),a=this.humanoid.getRawBoneNode("rightEye");o&&(this._restQuatLeftEye.copy(o.quaternion),Vy(o.parent,this._restLeftEyeParentWorldQuat)),a&&(this._restQuatRightEye.copy(a.quaternion),Vy(a.parent,this._restRightEyeParentWorldQuat))}applyYawPitch(e,t){const i=this.humanoid.getRawBoneNode("leftEye"),r=this.humanoid.getRawBoneNode("rightEye"),s=this.humanoid.getNormalizedBoneNode("leftEye"),o=this.humanoid.getNormalizedBoneNode("rightEye");i&&(t<0?ki.x=-Kt.DEG2RAD*this.rangeMapVerticalDown.map(-t):ki.x=Kt.DEG2RAD*this.rangeMapVerticalUp.map(t),e<0?ki.y=-Kt.DEG2RAD*this.rangeMapHorizontalInner.map(-e):ki.y=Kt.DEG2RAD*this.rangeMapHorizontalOuter.map(e),zr.setFromEuler(ki),this._getWorldFaceFrontQuat(ou),s.quaternion.copy(ou).multiply(zr).multiply(ou.invert()),zr.copy(this._restLeftEyeParentWorldQuat),i.quaternion.copy(s.quaternion).multiply(zr).premultiply(zr.invert()).multiply(this._restQuatLeftEye)),r&&(t<0?ki.x=-Kt.DEG2RAD*this.rangeMapVerticalDown.map(-t):ki.x=Kt.DEG2RAD*this.rangeMapVerticalUp.map(t),e<0?ki.y=-Kt.DEG2RAD*this.rangeMapHorizontalOuter.map(-e):ki.y=Kt.DEG2RAD*this.rangeMapHorizontalInner.map(e),zr.setFromEuler(ki),this._getWorldFaceFrontQuat(ou),o.quaternion.copy(ou).multiply(zr).multiply(ou.invert()),zr.copy(this._restRightEyeParentWorldQuat),r.quaternion.copy(o.quaternion).multiply(zr).premultiply(zr.invert()).multiply(this._restQuatRightEye))}lookAt(e){console.warn("VRMLookAtBoneApplier: lookAt() is deprecated. use apply() instead.");const t=Kt.RAD2DEG*e.y,i=Kt.RAD2DEG*e.x;this.applyYawPitch(t,i)}_getWorldFaceFrontQuat(e){if(this.faceFront.distanceToSquared(soe)<.01)return e.identity();const[t,i]=Up(this.faceFront);return ki.set(0,.5*Math.PI+t,i,"YZX"),e.setFromEuler(ki)}}Bp.type="bone";class Gy{constructor(e,t,i,r,s){this.expressions=e,this.rangeMapHorizontalInner=t,this.rangeMapHorizontalOuter=i,this.rangeMapVerticalDown=r,this.rangeMapVerticalUp=s}applyYawPitch(e,t){t<0?(this.expressions.setValue("lookDown",0),this.expressions.setValue("lookUp",this.rangeMapVerticalUp.map(-t))):(this.expressions.setValue("lookUp",0),this.expressions.setValue("lookDown",this.rangeMapVerticalDown.map(t))),e<0?(this.expressions.setValue("lookLeft",0),this.expressions.setValue("lookRight",this.rangeMapHorizontalOuter.map(-e))):(this.expressions.setValue("lookRight",0),this.expressions.setValue("lookLeft",this.rangeMapHorizontalOuter.map(e)))}lookAt(e){console.warn("VRMLookAtBoneApplier: lookAt() is deprecated. use apply() instead.");const t=Kt.RAD2DEG*e.y,i=Kt.RAD2DEG*e.x;this.applyYawPitch(t,i)}}Gy.type="expression";class _1{constructor(e,t){this.inputMaxValue=e,this.outputScale=t}map(e){return this.outputScale*L2(e/this.inputMaxValue)}}const ooe=new Set(["1.0","1.0-beta"]),mp=.01;class D2{get name(){return"VRMLookAtLoaderPlugin"}constructor(e,t){this.parser=e,this.helperRoot=t==null?void 0:t.helperRoot}afterRoot(e){return Ct(this,void 0,void 0,function*(){const t=e.userData.vrmHumanoid;if(t===null)return;if(t===void 0)throw new Error("VRMLookAtLoaderPlugin: vrmHumanoid is undefined. VRMHumanoidLoaderPlugin have to be used first");const i=e.userData.vrmExpressionManager;if(i!==null){if(i===void 0)throw new Error("VRMLookAtLoaderPlugin: vrmExpressionManager is undefined. VRMExpressionLoaderPlugin have to be used first");e.userData.vrmLookAt=yield this._import(e,t,i)}})}_import(e,t,i){return Ct(this,void 0,void 0,function*(){if(t==null||i==null)return null;const r=yield this._v1Import(e,t,i);if(r)return r;const s=yield this._v0Import(e,t,i);return s||null})}_v1Import(e,t,i){var r,s,o;return Ct(this,void 0,void 0,function*(){const a=this.parser.json;if(!(((r=a.extensionsUsed)===null||r===void 0?void 0:r.indexOf("VRMC_vrm"))!==-1))return null;const u=(s=a.extensions)===null||s===void 0?void 0:s.VRMC_vrm;if(!u)return null;const c=u.specVersion;if(!ooe.has(c))return console.warn(`VRMLookAtLoaderPlugin: Unknown VRMC_vrm specVersion "${c}"`),null;const h=u.lookAt;if(!h)return null;const d=h.type==="expression"?1:10,f=this._v1ImportRangeMap(h.rangeMapHorizontalInner,d),p=this._v1ImportRangeMap(h.rangeMapHorizontalOuter,d),_=this._v1ImportRangeMap(h.rangeMapVerticalDown,d),m=this._v1ImportRangeMap(h.rangeMapVerticalUp,d);let g;h.type==="expression"?g=new Gy(i,f,p,_,m):g=new Bp(t,f,p,_,m);const v=this._importLookAt(t,g);return v.offsetFromHeadBone.fromArray((o=h.offsetFromHeadBone)!==null&&o!==void 0?o:[0,.06,0]),v})}_v1ImportRangeMap(e,t){var i,r;let s=(i=e==null?void 0:e.inputMaxValue)!==null&&i!==void 0?i:90;const o=(r=e==null?void 0:e.outputScale)!==null&&r!==void 0?r:t;return s<mp&&(console.warn("VRMLookAtLoaderPlugin: inputMaxValue of a range map is too small. Consider reviewing the range map!"),s=mp),new _1(s,o)}_v0Import(e,t,i){var r,s,o,a;return Ct(this,void 0,void 0,function*(){const u=(r=this.parser.json.extensions)===null||r===void 0?void 0:r.VRM;if(!u)return null;const c=u.firstPerson;if(!c)return null;const h=c.lookAtTypeName==="BlendShape"?1:10,d=this._v0ImportDegreeMap(c.lookAtHorizontalInner,h),f=this._v0ImportDegreeMap(c.lookAtHorizontalOuter,h),p=this._v0ImportDegreeMap(c.lookAtVerticalDown,h),_=this._v0ImportDegreeMap(c.lookAtVerticalUp,h);let m;c.lookAtTypeName==="BlendShape"?m=new Gy(i,d,f,p,_):m=new Bp(t,d,f,p,_);const g=this._importLookAt(t,m);return c.firstPersonBoneOffset?g.offsetFromHeadBone.set((s=c.firstPersonBoneOffset.x)!==null&&s!==void 0?s:0,(o=c.firstPersonBoneOffset.y)!==null&&o!==void 0?o:.06,-((a=c.firstPersonBoneOffset.z)!==null&&a!==void 0?a:0)):g.offsetFromHeadBone.set(0,.06,0),g.faceFront.set(0,0,-1),m instanceof Bp&&m.faceFront.set(0,0,-1),g})}_v0ImportDegreeMap(e,t){var i,r;const s=e==null?void 0:e.curve;JSON.stringify(s)!=="[0,0,0,1,1,1,1,0]"&&console.warn("Curves of LookAtDegreeMap defined in VRM 0.0 are not supported");let o=(i=e==null?void 0:e.xRange)!==null&&i!==void 0?i:90;const a=(r=e==null?void 0:e.yRange)!==null&&r!==void 0?r:t;return o<mp&&(console.warn("VRMLookAtLoaderPlugin: xRange of a degree map is too small. Consider reviewing the degree map!"),o=mp),new _1(o,a)}_importLookAt(e,t){const i=new cc(e,t);if(this.helperRoot){const r=new Zse(i);this.helperRoot.add(r),r.renderOrder=this.helperRoot.renderOrder}return i}}function aoe(n,e){return typeof n!="string"||n===""?"":(/^https?:\/\//i.test(e)&&/^\//.test(n)&&(e=e.replace(/(^https?:\/\/[^/]+).*/i,"$1")),/^(https?:)?\/\//i.test(n)||/^data:.*,.*$/i.test(n)||/^blob:.*$/i.test(n)?n:e+n)}const loe=new Set(["1.0","1.0-beta"]);class uoe{get name(){return"VRMMetaLoaderPlugin"}constructor(e,t){var i,r,s;this.parser=e,this.needThumbnailImage=(i=t==null?void 0:t.needThumbnailImage)!==null&&i!==void 0?i:!0,this.acceptLicenseUrls=(r=t==null?void 0:t.acceptLicenseUrls)!==null&&r!==void 0?r:["https://vrm.dev/licenses/1.0/"],this.acceptV0Meta=(s=t==null?void 0:t.acceptV0Meta)!==null&&s!==void 0?s:!0}afterRoot(e){return Ct(this,void 0,void 0,function*(){e.userData.vrmMeta=yield this._import(e)})}_import(e){return Ct(this,void 0,void 0,function*(){const t=yield this._v1Import(e);if(t!=null)return t;const i=yield this._v0Import(e);return i??null})}_v1Import(e){var t,i,r;return Ct(this,void 0,void 0,function*(){const s=this.parser.json;if(!(((t=s.extensionsUsed)===null||t===void 0?void 0:t.indexOf("VRMC_vrm"))!==-1))return null;const a=(i=s.extensions)===null||i===void 0?void 0:i.VRMC_vrm;if(a==null)return null;const l=a.specVersion;if(!loe.has(l))return console.warn(`VRMMetaLoaderPlugin: Unknown VRMC_vrm specVersion "${l}"`),null;const u=a.meta;if(!u)return null;const c=u.licenseUrl;if(!new Set(this.acceptLicenseUrls).has(c))throw new Error(`VRMMetaLoaderPlugin: The license url "${c}" is not accepted`);let d;return this.needThumbnailImage&&u.thumbnailImage!=null&&(d=(r=yield this._extractGLTFImage(u.thumbnailImage))!==null&&r!==void 0?r:void 0),{metaVersion:"1",name:u.name,version:u.version,authors:u.authors,copyrightInformation:u.copyrightInformation,contactInformation:u.contactInformation,references:u.references,thirdPartyLicenses:u.thirdPartyLicenses,thumbnailImage:d,licenseUrl:u.licenseUrl,avatarPermission:u.avatarPermission,allowExcessivelyViolentUsage:u.allowExcessivelyViolentUsage,allowExcessivelySexualUsage:u.allowExcessivelySexualUsage,commercialUsage:u.commercialUsage,allowPoliticalOrReligiousUsage:u.allowPoliticalOrReligiousUsage,allowAntisocialOrHateUsage:u.allowAntisocialOrHateUsage,creditNotation:u.creditNotation,allowRedistribution:u.allowRedistribution,modification:u.modification,otherLicenseUrl:u.otherLicenseUrl}})}_v0Import(e){var t;return Ct(this,void 0,void 0,function*(){const r=(t=this.parser.json.extensions)===null||t===void 0?void 0:t.VRM;if(!r)return null;const s=r.meta;if(!s)return null;if(!this.acceptV0Meta)throw new Error("VRMMetaLoaderPlugin: Attempted to load VRM0.0 meta but acceptV0Meta is false");let o;return this.needThumbnailImage&&s.texture!=null&&s.texture!==-1&&(o=yield this.parser.getDependency("texture",s.texture)),{metaVersion:"0",allowedUserName:s.allowedUserName,author:s.author,commercialUssageName:s.commercialUssageName,contactInformation:s.contactInformation,licenseName:s.licenseName,otherLicenseUrl:s.otherLicenseUrl,otherPermissionUrl:s.otherPermissionUrl,reference:s.reference,sexualUssageName:s.sexualUssageName,texture:o??void 0,title:s.title,version:s.version,violentUssageName:s.violentUssageName}})}_extractGLTFImage(e){var t;return Ct(this,void 0,void 0,function*(){const r=(t=this.parser.json.images)===null||t===void 0?void 0:t[e];if(r==null)return console.warn(`VRMMetaLoaderPlugin: Attempt to use images[${e}] of glTF as a thumbnail but the image doesn't exist`),null;let s=r.uri;if(r.bufferView!=null){const a=yield this.parser.getDependency("bufferView",r.bufferView),l=new Blob([a],{type:r.mimeType});s=URL.createObjectURL(l)}return s==null?(console.warn(`VRMMetaLoaderPlugin: Attempt to use images[${e}] of glTF as a thumbnail but the image couldn't load properly`),null):yield new C2().loadAsync(aoe(s,this.parser.options.path)).catch(a=>(console.error(a),console.warn("VRMMetaLoaderPlugin: Failed to load a thumbnail image"),null))})}}class coe{constructor(e){this.scene=e.scene,this.meta=e.meta,this.humanoid=e.humanoid,this.expressionManager=e.expressionManager,this.firstPerson=e.firstPerson,this.lookAt=e.lookAt}update(e){this.humanoid.update(),this.lookAt&&this.lookAt.update(e),this.expressionManager&&this.expressionManager.update()}}let hoe=class extends coe{constructor(e){super(e),this.materials=e.materials,this.springBoneManager=e.springBoneManager,this.nodeConstraintManager=e.nodeConstraintManager}update(e){super.update(e),this.nodeConstraintManager&&this.nodeConstraintManager.update(),this.springBoneManager&&this.springBoneManager.update(e),this.materials&&this.materials.forEach(t=>{t.update&&t.update(e)})}};function gp(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(c){try{u(i.next(c))}catch(h){o(h)}}function l(c){try{u(i.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(a,l)}u((i=i.apply(n,e||[])).next())})}/*!
 * @pixiv/three-vrm-materials-mtoon v2.0.1
 * MToon (toon material) module for @pixiv/three-vrm
 *
 * Copyright (c) 2020-2023 pixiv Inc.
 * @pixiv/three-vrm-materials-mtoon is distributed under MIT License
 * https://github.com/pixiv/three-vrm/blob/release/LICENSE
 */function $a(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(c){try{u(i.next(c))}catch(h){o(h)}}function l(c){try{u(i.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(a,l)}u((i=i.apply(n,e||[])).next())})}var doe=`// #define PHONG

varying vec3 vViewPosition;

#ifndef FLAT_SHADED
  varying vec3 vNormal;
#endif

#include <common>

// #include <uv_pars_vertex>
#ifdef MTOON_USE_UV
  varying vec2 vUv;

  // COMPAT: pre-r151 uses a common uvTransform
  #if THREE_VRM_THREE_REVISION < 151
    uniform mat3 uvTransform;
  #endif
#endif

// #include <uv2_pars_vertex>
// COMAPT: pre-r151 uses uv2 for lightMap and aoMap
#if THREE_VRM_THREE_REVISION < 151
  #if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
    attribute vec2 uv2;
    varying vec2 vUv2;
    uniform mat3 uv2Transform;
  #endif
#endif

// #include <displacementmap_pars_vertex>
// #include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

#ifdef USE_OUTLINEWIDTHMULTIPLYTEXTURE
  uniform sampler2D outlineWidthMultiplyTexture;
  uniform mat3 outlineWidthMultiplyTextureUvTransform;
#endif

uniform float outlineWidthFactor;

void main() {

  // #include <uv_vertex>
  #ifdef MTOON_USE_UV
    // COMPAT: pre-r151 uses a common uvTransform
    #if THREE_VRM_THREE_REVISION >= 151
      vUv = uv;
    #else
      vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
    #endif
  #endif

  // #include <uv2_vertex>
  // COMAPT: pre-r151 uses uv2 for lightMap and aoMap
  #if THREE_VRM_THREE_REVISION < 151
    #if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
      vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
    #endif
  #endif

  #include <color_vertex>

  #include <beginnormal_vertex>
  #include <morphnormal_vertex>
  #include <skinbase_vertex>
  #include <skinnormal_vertex>

  // we need this to compute the outline properly
  objectNormal = normalize( objectNormal );

  #include <defaultnormal_vertex>

  #ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED
    vNormal = normalize( transformedNormal );
  #endif

  #include <begin_vertex>

  #include <morphtarget_vertex>
  #include <skinning_vertex>
  // #include <displacementmap_vertex>
  #include <project_vertex>
  #include <logdepthbuf_vertex>
  #include <clipping_planes_vertex>

  vViewPosition = - mvPosition.xyz;

  float outlineTex = 1.0;

  #ifdef OUTLINE
    #ifdef USE_OUTLINEWIDTHMULTIPLYTEXTURE
      vec2 outlineWidthMultiplyTextureUv = ( outlineWidthMultiplyTextureUvTransform * vec3( vUv, 1 ) ).xy;
      outlineTex = texture2D( outlineWidthMultiplyTexture, outlineWidthMultiplyTextureUv ).g;
    #endif

    #ifdef OUTLINE_WIDTH_WORLD
      float worldNormalLength = length( transformedNormal );
      vec3 outlineOffset = outlineWidthFactor * outlineTex * worldNormalLength * objectNormal;
      gl_Position = projectionMatrix * modelViewMatrix * vec4( outlineOffset + transformed, 1.0 );
    #endif

    #ifdef OUTLINE_WIDTH_SCREEN
      vec3 clipNormal = ( projectionMatrix * modelViewMatrix * vec4( objectNormal, 0.0 ) ).xyz;
      vec2 projectedNormal = normalize( clipNormal.xy );
      projectedNormal.x *= projectionMatrix[ 0 ].x / projectionMatrix[ 1 ].y;
      gl_Position.xy += 2.0 * outlineWidthFactor * outlineTex * projectedNormal.xy;
    #endif

    gl_Position.z += 1E-6 * gl_Position.w; // anti-artifact magic
  #endif

  #include <worldpos_vertex>
  // #include <envmap_vertex>
  #include <shadowmap_vertex>
  #include <fog_vertex>

}`,foe=`// #define PHONG

uniform vec3 litFactor;

uniform float opacity;

uniform vec3 shadeColorFactor;
#ifdef USE_SHADEMULTIPLYTEXTURE
  uniform sampler2D shadeMultiplyTexture;
  uniform mat3 shadeMultiplyTextureUvTransform;
#endif

uniform float shadingShiftFactor;
uniform float shadingToonyFactor;

#ifdef USE_SHADINGSHIFTTEXTURE
  uniform sampler2D shadingShiftTexture;
  uniform mat3 shadingShiftTextureUvTransform;
  uniform float shadingShiftTextureScale;
#endif

uniform float giEqualizationFactor;

uniform vec3 parametricRimColorFactor;
#ifdef USE_RIMMULTIPLYTEXTURE
  uniform sampler2D rimMultiplyTexture;
  uniform mat3 rimMultiplyTextureUvTransform;
#endif
uniform float rimLightingMixFactor;
uniform float parametricRimFresnelPowerFactor;
uniform float parametricRimLiftFactor;

#ifdef USE_MATCAPTEXTURE
  uniform vec3 matcapFactor;
  uniform sampler2D matcapTexture;
  uniform mat3 matcapTextureUvTransform;
#endif

uniform vec3 emissive;
uniform float emissiveIntensity;

uniform vec3 outlineColorFactor;
uniform float outlineLightingMixFactor;

#ifdef USE_UVANIMATIONMASKTEXTURE
  uniform sampler2D uvAnimationMaskTexture;
  uniform mat3 uvAnimationMaskTextureUvTransform;
#endif

uniform float uvAnimationScrollXOffset;
uniform float uvAnimationScrollYOffset;
uniform float uvAnimationRotationPhase;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>

// #include <uv_pars_fragment>
#if ( defined( MTOON_USE_UV ) && !defined( MTOON_UVS_VERTEX_ONLY ) )
  varying vec2 vUv;
#endif

// #include <uv2_pars_fragment>
// COMAPT: pre-r151 uses uv2 for lightMap and aoMap
#if THREE_VRM_THREE_REVISION < 151
  #if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
    varying vec2 vUv2;
  #endif
#endif

#include <map_pars_fragment>

#ifdef USE_MAP
  uniform mat3 mapUvTransform;
#endif

// #include <alphamap_pars_fragment>

#if THREE_VRM_THREE_REVISION >= 132
  #include <alphatest_pars_fragment>
#endif

#include <aomap_pars_fragment>
// #include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>

#ifdef USE_EMISSIVEMAP
  uniform mat3 emissiveMapUvTransform;
#endif

// #include <envmap_common_pars_fragment>
// #include <envmap_pars_fragment>
// #include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>

// #include <bsdfs>
// COMPAT: pre-r151 doesn't have BRDF_Lambert in <common>
#if THREE_VRM_THREE_REVISION < 151
  vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
    return RECIPROCAL_PI * diffuseColor;
  }
#endif

#include <lights_pars_begin>

#if THREE_VRM_THREE_REVISION >= 132
  #include <normal_pars_fragment>
#endif

// #include <lights_phong_pars_fragment>
varying vec3 vViewPosition;

#if THREE_VRM_THREE_REVISION < 132
  #ifndef FLAT_SHADED
    varying vec3 vNormal;
  #endif
#endif

struct MToonMaterial {
  vec3 diffuseColor;
  vec3 shadeColor;
  float shadingShift;
};

float linearstep( float a, float b, float t ) {
  return clamp( ( t - a ) / ( b - a ), 0.0, 1.0 );
}

/**
 * Convert NdotL into toon shading factor using shadingShift and shadingToony
 */
float getShading(
  const in float dotNL,
  const in float shadow,
  const in float shadingShift
) {
  float shading = dotNL;
  shading = shading + shadingShift;
  shading = linearstep( -1.0 + shadingToonyFactor, 1.0 - shadingToonyFactor, shading );
  shading *= shadow;
  return shading;
}

/**
 * Mix diffuseColor and shadeColor using shading factor and light color
 */
vec3 getDiffuse(
  const in MToonMaterial material,
  const in float shading,
  in vec3 lightColor
) {
  #ifdef DEBUG_LITSHADERATE
    return vec3( BRDF_Lambert( shading * lightColor ) );
  #endif

  #if THREE_VRM_THREE_REVISION < 132
    #ifndef PHYSICALLY_CORRECT_LIGHTS
      lightColor *= PI;
    #endif
  #endif

  vec3 col = lightColor * BRDF_Lambert( mix( material.shadeColor, material.diffuseColor, shading ) );

  // The "comment out if you want to PBR absolutely" line
  #ifdef V0_COMPAT_SHADE
    col = min( col, material.diffuseColor );
  #endif

  return col;
}

void RE_Direct_MToon( const in IncidentLight directLight, const in GeometricContext geometry, const in MToonMaterial material, const in float shadow, inout ReflectedLight reflectedLight ) {
  float dotNL = clamp( dot( geometry.normal, directLight.direction ), -1.0, 1.0 );
  vec3 irradiance = directLight.color;

  #if THREE_VRM_THREE_REVISION < 132
    #ifndef PHYSICALLY_CORRECT_LIGHTS
      irradiance *= PI;
    #endif
  #endif

  // directSpecular will be used for rim lighting, not an actual specular
  reflectedLight.directSpecular += irradiance;

  irradiance *= dotNL;

  float shading = getShading( dotNL, shadow, material.shadingShift );

  // toon shaded diffuse
  reflectedLight.directDiffuse += getDiffuse( material, shading, directLight.color );
}

void RE_IndirectDiffuse_MToon( const in vec3 irradiance, const in GeometricContext geometry, const in MToonMaterial material, inout ReflectedLight reflectedLight ) {
  // indirect diffuse will use diffuseColor, no shadeColor involved
  reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

  // directSpecular will be used for rim lighting, not an actual specular
  reflectedLight.directSpecular += irradiance;
}

#define RE_Direct RE_Direct_MToon
#define RE_IndirectDiffuse RE_IndirectDiffuse_MToon
#define Material_LightProbeLOD( material ) (0)

#include <shadowmap_pars_fragment>
// #include <bumpmap_pars_fragment>

// #include <normalmap_pars_fragment>
#ifdef USE_NORMALMAP

  uniform sampler2D normalMap;
  uniform mat3 normalMapUvTransform;
  uniform vec2 normalScale;

#endif

// COMPAT: USE_NORMALMAP_OBJECTSPACE used to be OBJECTSPACE_NORMALMAP in pre-r151
#if defined( USE_NORMALMAP_OBJECTSPACE ) || defined( OBJECTSPACE_NORMALMAP )

  uniform mat3 normalMatrix;

#endif

// COMPAT: USE_NORMALMAP_TANGENTSPACE used to be TANGENTSPACE_NORMALMAP in pre-r151
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( TANGENTSPACE_NORMALMAP ) )

  // Per-Pixel Tangent Space Normal Mapping
  // http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html

  // three-vrm specific change: it requires \`uv\` as an input in order to support uv scrolls

  // Temporary compat against shader change @ Three.js r126, r151
  #if THREE_VRM_THREE_REVISION >= 151

    mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {

      vec3 q0 = dFdx( eye_pos.xyz );
      vec3 q1 = dFdy( eye_pos.xyz );
      vec2 st0 = dFdx( uv.st );
      vec2 st1 = dFdy( uv.st );

      vec3 N = surf_norm;

      vec3 q1perp = cross( q1, N );
      vec3 q0perp = cross( N, q0 );

      vec3 T = q1perp * st0.x + q0perp * st1.x;
      vec3 B = q1perp * st0.y + q0perp * st1.y;

      float det = max( dot( T, T ), dot( B, B ) );
      float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );

      return mat3( T * scale, B * scale, N );

    }

  #elif THREE_VRM_THREE_REVISION >= 126

    vec3 perturbNormal2Arb( vec2 uv, vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {

      vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
      vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
      vec2 st0 = dFdx( uv.st );
      vec2 st1 = dFdy( uv.st );

      vec3 N = normalize( surf_norm );

      vec3 q1perp = cross( q1, N );
      vec3 q0perp = cross( N, q0 );

      vec3 T = q1perp * st0.x + q0perp * st1.x;
      vec3 B = q1perp * st0.y + q0perp * st1.y;

      // three-vrm specific change: Workaround for the issue that happens when delta of uv = 0.0
      // TODO: Is this still required? Or shall I make a PR about it?
      if ( length( T ) == 0.0 || length( B ) == 0.0 ) {
        return surf_norm;
      }

      float det = max( dot( T, T ), dot( B, B ) );
      float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );

      return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );

    }

  #else

    vec3 perturbNormal2Arb( vec2 uv, vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {

      // Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988

      vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
      vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
      vec2 st0 = dFdx( uv.st );
      vec2 st1 = dFdy( uv.st );

      float scale = sign( st1.t * st0.s - st0.t * st1.s ); // we do not care about the magnitude

      vec3 S = ( q0 * st1.t - q1 * st0.t ) * scale;
      vec3 T = ( - q0 * st1.s + q1 * st0.s ) * scale;

      // three-vrm specific change: Workaround for the issue that happens when delta of uv = 0.0
      // TODO: Is this still required? Or shall I make a PR about it?

      if ( length( S ) == 0.0 || length( T ) == 0.0 ) {
        return surf_norm;
      }

      S = normalize( S );
      T = normalize( T );
      vec3 N = normalize( surf_norm );

      #ifdef DOUBLE_SIDED

        // Workaround for Adreno GPUs gl_FrontFacing bug. See #15850 and #10331

        bool frontFacing = dot( cross( S, T ), N ) > 0.0;

        mapN.xy *= ( float( frontFacing ) * 2.0 - 1.0 );

      #else

        mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );

      #endif

      mat3 tsn = mat3( S, T, N );
      return normalize( tsn * mapN );

    }

  #endif

#endif

// #include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

// == post correction ==========================================================
void postCorrection() {
  #include <tonemapping_fragment>
  #include <encodings_fragment>
  #include <fog_fragment>
  #include <premultiplied_alpha_fragment>
  #include <dithering_fragment>
}

// == main procedure ===========================================================
void main() {
  #include <clipping_planes_fragment>

  vec2 uv = vec2(0.5, 0.5);

  #if ( defined( MTOON_USE_UV ) && !defined( MTOON_UVS_VERTEX_ONLY ) )
    uv = vUv;

    float uvAnimMask = 1.0;
    #ifdef USE_UVANIMATIONMASKTEXTURE
      vec2 uvAnimationMaskTextureUv = ( uvAnimationMaskTextureUvTransform * vec3( uv, 1 ) ).xy;
      uvAnimMask = texture2D( uvAnimationMaskTexture, uvAnimationMaskTextureUv ).b;
    #endif

    uv = uv + vec2( uvAnimationScrollXOffset, uvAnimationScrollYOffset ) * uvAnimMask;
    float uvRotCos = cos( uvAnimationRotationPhase * uvAnimMask );
    float uvRotSin = sin( uvAnimationRotationPhase * uvAnimMask );
    uv = mat2( uvRotCos, -uvRotSin, uvRotSin, uvRotCos ) * ( uv - 0.5 ) + 0.5;
  #endif

  #ifdef DEBUG_UV
    gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
    #if ( defined( MTOON_USE_UV ) && !defined( MTOON_UVS_VERTEX_ONLY ) )
      gl_FragColor = vec4( uv, 0.0, 1.0 );
    #endif
    return;
  #endif

  vec4 diffuseColor = vec4( litFactor, opacity );
  ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
  vec3 totalEmissiveRadiance = emissive * emissiveIntensity;

  #include <logdepthbuf_fragment>

  // #include <map_fragment>
  #ifdef USE_MAP
    vec2 mapUv = ( mapUvTransform * vec3( uv, 1 ) ).xy;
    vec4 sampledDiffuseColor = texture2D( map, mapUv );
    #ifdef DECODE_VIDEO_TEXTURE
      sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
    #endif
    diffuseColor *= sampledDiffuseColor;
  #endif

  // #include <color_fragment>
  #if ( defined( USE_COLOR ) && !defined( IGNORE_VERTEX_COLOR ) )
    diffuseColor.rgb *= vColor;
  #endif

  // #include <alphamap_fragment>

  #include <alphatest_fragment>

  // #include <specularmap_fragment>

  // #include <normal_fragment_begin>
  float faceDirection = gl_FrontFacing ? 1.0 : -1.0;

  #ifdef FLAT_SHADED

    vec3 fdx = dFdx( vViewPosition );
    vec3 fdy = dFdy( vViewPosition );
    vec3 normal = normalize( cross( fdx, fdy ) );

  #else

    vec3 normal = normalize( vNormal );

    #ifdef DOUBLE_SIDED

      normal *= faceDirection;

    #endif

  #endif

  #ifdef USE_NORMALMAP

    vec2 normalMapUv = ( normalMapUvTransform * vec3( uv, 1 ) ).xy;

  #endif

  #ifdef USE_NORMALMAP_TANGENTSPACE

    #ifdef USE_TANGENT

      mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );

    #else

      mat3 tbn = getTangentFrame( - vViewPosition, normal, normalMapUv );

    #endif

    #if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )

      tbn[0] *= faceDirection;
      tbn[1] *= faceDirection;

    #endif

  #endif

  #ifdef USE_CLEARCOAT_NORMALMAP

    #ifdef USE_TANGENT

      mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );

    #else

      mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );

    #endif

    #if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )

      tbn2[0] *= faceDirection;
      tbn2[1] *= faceDirection;

    #endif

  #endif

  // non perturbed normal for clearcoat among others

  vec3 geometryNormal = normal;

  #ifdef OUTLINE
    normal *= -1.0;
  #endif

  // #include <normal_fragment_maps>

  // COMPAT: USE_NORMALMAP_OBJECTSPACE used to be OBJECTSPACE_NORMALMAP in pre-r151
  #if defined( USE_NORMALMAP_OBJECTSPACE ) || defined( OBJECTSPACE_NORMALMAP )

    normal = texture2D( normalMap, normalMapUv ).xyz * 2.0 - 1.0; // overrides both flatShading and attribute normals

    #ifdef FLIP_SIDED

      normal = - normal;

    #endif

    #ifdef DOUBLE_SIDED

      // Temporary compat against shader change @ Three.js r126
      // See: #21205, #21307, #21299
      #if THREE_VRM_THREE_REVISION >= 126

        normal = normal * faceDirection;

      #else

        normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );

      #endif

    #endif

    normal = normalize( normalMatrix * normal );

  // COMPAT: USE_NORMALMAP_TANGENTSPACE used to be TANGENTSPACE_NORMALMAP in pre-r151
  #elif defined( USE_NORMALMAP_TANGENTSPACE ) || defined( TANGENTSPACE_NORMALMAP )

    vec3 mapN = texture2D( normalMap, normalMapUv ).xyz * 2.0 - 1.0;
    mapN.xy *= normalScale;

    // COMPAT: pre-r151
    #if THREE_VRM_THREE_REVISION >= 151 || defined( USE_TANGENT )

      normal = normalize( tbn * mapN );

    #else

      // pre-r126
      #if THREE_VRM_THREE_REVISION >= 126

        normal = perturbNormal2Arb( uv, -vViewPosition, normal, mapN, faceDirection );

      #else

        normal = perturbNormal2Arb( uv, -vViewPosition, normal, mapN );

      #endif

    #endif

  #endif

  // #include <emissivemap_fragment>
  #ifdef USE_EMISSIVEMAP
    vec2 emissiveMapUv = ( emissiveMapUvTransform * vec3( uv, 1 ) ).xy;
    totalEmissiveRadiance *= texture2D( emissiveMap, emissiveMapUv ).rgb;
  #endif

  #ifdef DEBUG_NORMAL
    gl_FragColor = vec4( 0.5 + 0.5 * normal, 1.0 );
    return;
  #endif

  // -- MToon: lighting --------------------------------------------------------
  // accumulation
  // #include <lights_phong_fragment>
  MToonMaterial material;

  material.diffuseColor = diffuseColor.rgb;

  material.shadeColor = shadeColorFactor;
  #ifdef USE_SHADEMULTIPLYTEXTURE
    vec2 shadeMultiplyTextureUv = ( shadeMultiplyTextureUvTransform * vec3( uv, 1 ) ).xy;
    material.shadeColor *= texture2D( shadeMultiplyTexture, shadeMultiplyTextureUv ).rgb;
  #endif

  #if ( defined( USE_COLOR ) && !defined( IGNORE_VERTEX_COLOR ) )
    material.shadeColor.rgb *= vColor;
  #endif

  material.shadingShift = shadingShiftFactor;
  #ifdef USE_SHADINGSHIFTTEXTURE
    vec2 shadingShiftTextureUv = ( shadingShiftTextureUvTransform * vec3( uv, 1 ) ).xy;
    material.shadingShift += texture2D( shadingShiftTexture, shadingShiftTextureUv ).r * shadingShiftTextureScale;
  #endif

  // #include <lights_fragment_begin>

  // MToon Specific changes:
  // Since we want to take shadows into account of shading instead of irradiance,
  // we had to modify the codes that multiplies the results of shadowmap into color of direct lights.

  GeometricContext geometry;

  geometry.position = - vViewPosition;
  geometry.normal = normal;
  geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );

  #ifdef CLEARCOAT

    geometry.clearcoatNormal = clearcoatNormal;

  #endif

  IncidentLight directLight;

  // since these variables will be used in unrolled loop, we have to define in prior
  float shadow;

  #if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )

    PointLight pointLight;
    #if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
    PointLightShadow pointLightShadow;
    #endif

    #pragma unroll_loop_start
    for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {

      pointLight = pointLights[ i ];

      #if THREE_VRM_THREE_REVISION >= 132
        getPointLightInfo( pointLight, geometry, directLight );
      #else
        getPointDirectLightIrradiance( pointLight, geometry, directLight );
      #endif

      shadow = 1.0;
      #if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
      pointLightShadow = pointLightShadows[ i ];
      shadow = all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
      #endif

      RE_Direct( directLight, geometry, material, shadow, reflectedLight );

    }
    #pragma unroll_loop_end

  #endif

  #if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )

    SpotLight spotLight;
    #if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
    SpotLightShadow spotLightShadow;
    #endif

    #pragma unroll_loop_start
    for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {

      spotLight = spotLights[ i ];

      #if THREE_VRM_THREE_REVISION >= 132
        getSpotLightInfo( spotLight, geometry, directLight );
      #else
        getSpotDirectLightIrradiance( spotLight, geometry, directLight );
      #endif

      shadow = 1.0;
      #if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
      spotLightShadow = spotLightShadows[ i ];
      shadow = all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
      #endif

      RE_Direct( directLight, geometry, material, shadow, reflectedLight );

    }
    #pragma unroll_loop_end

  #endif

  #if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )

    DirectionalLight directionalLight;
    #if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
    DirectionalLightShadow directionalLightShadow;
    #endif

    #pragma unroll_loop_start
    for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {

      directionalLight = directionalLights[ i ];

      #if THREE_VRM_THREE_REVISION >= 132
        getDirectionalLightInfo( directionalLight, geometry, directLight );
      #else
        getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
      #endif

      shadow = 1.0;
      #if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
      directionalLightShadow = directionalLightShadows[ i ];
      shadow = all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
      #endif

      RE_Direct( directLight, geometry, material, shadow, reflectedLight );

    }
    #pragma unroll_loop_end

  #endif

  // #if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )

  //   RectAreaLight rectAreaLight;

  //   #pragma unroll_loop_start
  //   for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {

  //     rectAreaLight = rectAreaLights[ i ];
  //     RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );

  //   }
  //   #pragma unroll_loop_end

  // #endif

  #if defined( RE_IndirectDiffuse )

    vec3 iblIrradiance = vec3( 0.0 );

    vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );

    #if THREE_VRM_THREE_REVISION >= 133
      irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
    #else
      irradiance += getLightProbeIrradiance( lightProbe, geometry );
    #endif

    #if ( NUM_HEMI_LIGHTS > 0 )

      #pragma unroll_loop_start
      for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {

        #if THREE_VRM_THREE_REVISION >= 133
          irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
        #else
          irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
        #endif

      }
      #pragma unroll_loop_end

    #endif

  #endif

  // #if defined( RE_IndirectSpecular )

  //   vec3 radiance = vec3( 0.0 );
  //   vec3 clearcoatRadiance = vec3( 0.0 );

  // #endif

  #include <lights_fragment_maps>
  #include <lights_fragment_end>

  // modulation
  #include <aomap_fragment>

  vec3 col = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;

  #ifdef DEBUG_LITSHADERATE
    gl_FragColor = vec4( col, diffuseColor.a );
    postCorrection();
    return;
  #endif

  // -- MToon: rim lighting -----------------------------------------
  vec3 viewDir = normalize( vViewPosition );

  #ifndef PHYSICALLY_CORRECT_LIGHTS
    reflectedLight.directSpecular /= PI;
  #endif
  vec3 rimMix = mix( vec3( 1.0 ), reflectedLight.directSpecular, 1.0 );

  vec3 rim = parametricRimColorFactor * pow( saturate( 1.0 - dot( viewDir, normal ) + parametricRimLiftFactor ), parametricRimFresnelPowerFactor );

  #ifdef USE_MATCAPTEXTURE
    {
      vec3 x = normalize( vec3( viewDir.z, 0.0, -viewDir.x ) );
      vec3 y = cross( viewDir, x ); // guaranteed to be normalized
      vec2 sphereUv = 0.5 + 0.5 * vec2( dot( x, normal ), -dot( y, normal ) );
      sphereUv = ( matcapTextureUvTransform * vec3( sphereUv, 1 ) ).xy;
      vec3 matcap = texture2D( matcapTexture, sphereUv ).rgb;
      rim += matcapFactor * matcap;
    }
  #endif

  #ifdef USE_RIMMULTIPLYTEXTURE
    vec2 rimMultiplyTextureUv = ( rimMultiplyTextureUvTransform * vec3( uv, 1 ) ).xy;
    rim *= texture2D( rimMultiplyTexture, rimMultiplyTextureUv ).rgb;
  #endif

  col += rimMix * rim;

  // -- MToon: Emission --------------------------------------------------------
  col += totalEmissiveRadiance;

  // #include <envmap_fragment>

  // -- Almost done! -----------------------------------------------------------
  #if defined( OUTLINE )
    col = outlineColorFactor.rgb * mix( vec3( 1.0 ), col, outlineLightingMixFactor );
  #endif

  gl_FragColor = vec4( col, diffuseColor.a );
  postCorrection();
}
`;const poe={None:"none",Normal:"normal",LitShadeRate:"litShadeRate",UV:"uv"},Iv={None:"none",WorldCoordinates:"worldCoordinates",ScreenCoordinates:"screenCoordinates"},moe={3e3:"",3001:"srgb"};function Lv(n){return parseInt(Er,10)>=152?n.colorSpace:moe[n.encoding]}class Ov extends jo{get color(){return this.uniforms.litFactor.value}set color(e){this.uniforms.litFactor.value=e}get map(){return this.uniforms.map.value}set map(e){this.uniforms.map.value=e}get normalMap(){return this.uniforms.normalMap.value}set normalMap(e){this.uniforms.normalMap.value=e}get normalScale(){return this.uniforms.normalScale.value}set normalScale(e){this.uniforms.normalScale.value=e}get emissive(){return this.uniforms.emissive.value}set emissive(e){this.uniforms.emissive.value=e}get emissiveIntensity(){return this.uniforms.emissiveIntensity.value}set emissiveIntensity(e){this.uniforms.emissiveIntensity.value=e}get emissiveMap(){return this.uniforms.emissiveMap.value}set emissiveMap(e){this.uniforms.emissiveMap.value=e}get shadeColorFactor(){return this.uniforms.shadeColorFactor.value}set shadeColorFactor(e){this.uniforms.shadeColorFactor.value=e}get shadeMultiplyTexture(){return this.uniforms.shadeMultiplyTexture.value}set shadeMultiplyTexture(e){this.uniforms.shadeMultiplyTexture.value=e}get shadingShiftFactor(){return this.uniforms.shadingShiftFactor.value}set shadingShiftFactor(e){this.uniforms.shadingShiftFactor.value=e}get shadingShiftTexture(){return this.uniforms.shadingShiftTexture.value}set shadingShiftTexture(e){this.uniforms.shadingShiftTexture.value=e}get shadingShiftTextureScale(){return this.uniforms.shadingShiftTextureScale.value}set shadingShiftTextureScale(e){this.uniforms.shadingShiftTextureScale.value=e}get shadingToonyFactor(){return this.uniforms.shadingToonyFactor.value}set shadingToonyFactor(e){this.uniforms.shadingToonyFactor.value=e}get giEqualizationFactor(){return this.uniforms.giEqualizationFactor.value}set giEqualizationFactor(e){this.uniforms.giEqualizationFactor.value=e}get matcapFactor(){return this.uniforms.matcapFactor.value}set matcapFactor(e){this.uniforms.matcapFactor.value=e}get matcapTexture(){return this.uniforms.matcapTexture.value}set matcapTexture(e){this.uniforms.matcapTexture.value=e}get parametricRimColorFactor(){return this.uniforms.parametricRimColorFactor.value}set parametricRimColorFactor(e){this.uniforms.parametricRimColorFactor.value=e}get rimMultiplyTexture(){return this.uniforms.rimMultiplyTexture.value}set rimMultiplyTexture(e){this.uniforms.rimMultiplyTexture.value=e}get rimLightingMixFactor(){return this.uniforms.rimLightingMixFactor.value}set rimLightingMixFactor(e){this.uniforms.rimLightingMixFactor.value=e}get parametricRimFresnelPowerFactor(){return this.uniforms.parametricRimFresnelPowerFactor.value}set parametricRimFresnelPowerFactor(e){this.uniforms.parametricRimFresnelPowerFactor.value=e}get parametricRimLiftFactor(){return this.uniforms.parametricRimLiftFactor.value}set parametricRimLiftFactor(e){this.uniforms.parametricRimLiftFactor.value=e}get outlineWidthMultiplyTexture(){return this.uniforms.outlineWidthMultiplyTexture.value}set outlineWidthMultiplyTexture(e){this.uniforms.outlineWidthMultiplyTexture.value=e}get outlineWidthFactor(){return this.uniforms.outlineWidthFactor.value}set outlineWidthFactor(e){this.uniforms.outlineWidthFactor.value=e}get outlineColorFactor(){return this.uniforms.outlineColorFactor.value}set outlineColorFactor(e){this.uniforms.outlineColorFactor.value=e}get outlineLightingMixFactor(){return this.uniforms.outlineLightingMixFactor.value}set outlineLightingMixFactor(e){this.uniforms.outlineLightingMixFactor.value=e}get uvAnimationMaskTexture(){return this.uniforms.uvAnimationMaskTexture.value}set uvAnimationMaskTexture(e){this.uniforms.uvAnimationMaskTexture.value=e}get uvAnimationScrollXOffset(){return this.uniforms.uvAnimationScrollXOffset.value}set uvAnimationScrollXOffset(e){this.uniforms.uvAnimationScrollXOffset.value=e}get uvAnimationScrollYOffset(){return this.uniforms.uvAnimationScrollYOffset.value}set uvAnimationScrollYOffset(e){this.uniforms.uvAnimationScrollYOffset.value=e}get uvAnimationRotationPhase(){return this.uniforms.uvAnimationRotationPhase.value}set uvAnimationRotationPhase(e){this.uniforms.uvAnimationRotationPhase.value=e}get ignoreVertexColor(){return this._ignoreVertexColor}set ignoreVertexColor(e){this._ignoreVertexColor=e,this.needsUpdate=!0}get v0CompatShade(){return this._v0CompatShade}set v0CompatShade(e){this._v0CompatShade=e,this.needsUpdate=!0}get debugMode(){return this._debugMode}set debugMode(e){this._debugMode=e,this.needsUpdate=!0}get outlineWidthMode(){return this._outlineWidthMode}set outlineWidthMode(e){this._outlineWidthMode=e,this.needsUpdate=!0}get isOutline(){return this._isOutline}set isOutline(e){this._isOutline=e,this.needsUpdate=!0}get isMToonMaterial(){return!0}constructor(e={}){super({vertexShader:doe,fragmentShader:foe}),this.uvAnimationScrollXSpeedFactor=0,this.uvAnimationScrollYSpeedFactor=0,this.uvAnimationRotationSpeedFactor=0,this.fog=!0,this.normalMapType=hS,this._ignoreVertexColor=!0,this._v0CompatShade=!1,this._debugMode=poe.None,this._outlineWidthMode=Iv.None,this._isOutline=!1,e.transparentWithZWrite&&(e.depthWrite=!0),delete e.transparentWithZWrite,e.fog=!0,e.lights=!0,e.clipping=!0,parseInt(Er,10)<129&&(e.skinning=e.skinning||!1),parseInt(Er,10)<131&&(e.morphTargets=e.morphTargets||!1,e.morphNormals=e.morphNormals||!1),this.uniforms=d2.merge([Pe.common,Pe.normalmap,Pe.emissivemap,Pe.fog,Pe.lights,{litFactor:{value:new We(1,1,1)},mapUvTransform:{value:new Je},colorAlpha:{value:1},normalMapUvTransform:{value:new Je},shadeColorFactor:{value:new We(.97,.81,.86)},shadeMultiplyTexture:{value:null},shadeMultiplyTextureUvTransform:{value:new Je},shadingShiftFactor:{value:0},shadingShiftTexture:{value:null},shadingShiftTextureUvTransform:{value:new Je},shadingShiftTextureScale:{value:1},shadingToonyFactor:{value:.9},giEqualizationFactor:{value:.9},matcapFactor:{value:new We(0,0,0)},matcapTexture:{value:null},matcapTextureUvTransform:{value:new Je},parametricRimColorFactor:{value:new We(0,0,0)},rimMultiplyTexture:{value:null},rimMultiplyTextureUvTransform:{value:new Je},rimLightingMixFactor:{value:0},parametricRimFresnelPowerFactor:{value:1},parametricRimLiftFactor:{value:0},emissive:{value:new We(0,0,0)},emissiveIntensity:{value:1},emissiveMapUvTransform:{value:new Je},outlineWidthMultiplyTexture:{value:null},outlineWidthMultiplyTextureUvTransform:{value:new Je},outlineWidthFactor:{value:.5},outlineColorFactor:{value:new We(0,0,0)},outlineLightingMixFactor:{value:1},uvAnimationMaskTexture:{value:null},uvAnimationMaskTextureUvTransform:{value:new Je},uvAnimationScrollXOffset:{value:0},uvAnimationScrollYOffset:{value:0},uvAnimationRotationPhase:{value:0}},e.uniforms]),this.setValues(e),this._uploadUniformsWorkaround(),this.customProgramCacheKey=()=>[...Object.entries(this._generateDefines()).map(([t,i])=>`${t}:${i}`),this.matcapTexture?`matcapTextureColorSpace:${Lv(this.matcapTexture)}`:"",this.shadeMultiplyTexture?`shadeMultiplyTextureColorSpace:${Lv(this.shadeMultiplyTexture)}`:"",this.rimMultiplyTexture?`rimMultiplyTextureColorSpace:${Lv(this.rimMultiplyTexture)}`:""].join(","),this.onBeforeCompile=t=>{const i=parseInt(Er,10),r=Object.entries(Object.assign(Object.assign({},this._generateDefines()),this.defines)).filter(([s,o])=>!!o).map(([s,o])=>`#define ${s} ${o}`).join(`
`)+`
`;t.vertexShader=r+t.vertexShader,t.fragmentShader=r+t.fragmentShader,i<132&&(t.fragmentShader=t.fragmentShader.replace("#include <normal_pars_fragment>",""),t.fragmentShader=t.fragmentShader.replace("#include <alphatest_pars_fragment>",""))}}update(e){this._uploadUniformsWorkaround(),this._updateUVAnimation(e)}copy(e){return super.copy(e),this.map=e.map,this.normalMap=e.normalMap,this.emissiveMap=e.emissiveMap,this.shadeMultiplyTexture=e.shadeMultiplyTexture,this.shadingShiftTexture=e.shadingShiftTexture,this.matcapTexture=e.matcapTexture,this.rimMultiplyTexture=e.rimMultiplyTexture,this.outlineWidthMultiplyTexture=e.outlineWidthMultiplyTexture,this.uvAnimationMaskTexture=e.uvAnimationMaskTexture,this.normalMapType=e.normalMapType,this.uvAnimationScrollXSpeedFactor=e.uvAnimationScrollXSpeedFactor,this.uvAnimationScrollYSpeedFactor=e.uvAnimationScrollYSpeedFactor,this.uvAnimationRotationSpeedFactor=e.uvAnimationRotationSpeedFactor,this.ignoreVertexColor=e.ignoreVertexColor,this.v0CompatShade=e.v0CompatShade,this.debugMode=e.debugMode,this.outlineWidthMode=e.outlineWidthMode,this.isOutline=e.isOutline,this.needsUpdate=!0,this}_updateUVAnimation(e){this.uniforms.uvAnimationScrollXOffset.value+=e*this.uvAnimationScrollXSpeedFactor,this.uniforms.uvAnimationScrollYOffset.value+=e*this.uvAnimationScrollYSpeedFactor,this.uniforms.uvAnimationRotationPhase.value+=e*this.uvAnimationRotationSpeedFactor,this.uniformsNeedUpdate=!0}_uploadUniformsWorkaround(){this.uniforms.opacity.value=this.opacity,this._updateTextureMatrix(this.uniforms.map,this.uniforms.mapUvTransform),this._updateTextureMatrix(this.uniforms.normalMap,this.uniforms.normalMapUvTransform),this._updateTextureMatrix(this.uniforms.emissiveMap,this.uniforms.emissiveMapUvTransform),this._updateTextureMatrix(this.uniforms.shadeMultiplyTexture,this.uniforms.shadeMultiplyTextureUvTransform),this._updateTextureMatrix(this.uniforms.shadingShiftTexture,this.uniforms.shadingShiftTextureUvTransform),this._updateTextureMatrix(this.uniforms.matcapTexture,this.uniforms.matcapTextureUvTransform),this._updateTextureMatrix(this.uniforms.rimMultiplyTexture,this.uniforms.rimMultiplyTextureUvTransform),this._updateTextureMatrix(this.uniforms.outlineWidthMultiplyTexture,this.uniforms.outlineWidthMultiplyTextureUvTransform),this._updateTextureMatrix(this.uniforms.uvAnimationMaskTexture,this.uniforms.uvAnimationMaskTextureUvTransform),parseInt(Er,10)>=132&&(this.uniforms.alphaTest.value=this.alphaTest),this.uniformsNeedUpdate=!0}_generateDefines(){const e=parseInt(Er,10),t=this.outlineWidthMultiplyTexture!==null,i=this.map!==null||this.emissiveMap!==null||this.shadeMultiplyTexture!==null||this.shadingShiftTexture!==null||this.rimMultiplyTexture!==null||this.uvAnimationMaskTexture!==null;return{THREE_VRM_THREE_REVISION:e,OUTLINE:this._isOutline,MTOON_USE_UV:t||i,MTOON_UVS_VERTEX_ONLY:t&&!i,V0_COMPAT_SHADE:this._v0CompatShade,USE_SHADEMULTIPLYTEXTURE:this.shadeMultiplyTexture!==null,USE_SHADINGSHIFTTEXTURE:this.shadingShiftTexture!==null,USE_MATCAPTEXTURE:this.matcapTexture!==null,USE_RIMMULTIPLYTEXTURE:this.rimMultiplyTexture!==null,USE_OUTLINEWIDTHMULTIPLYTEXTURE:this._isOutline&&this.outlineWidthMultiplyTexture!==null,USE_UVANIMATIONMASKTEXTURE:this.uvAnimationMaskTexture!==null,IGNORE_VERTEX_COLOR:this._ignoreVertexColor===!0,DEBUG_NORMAL:this._debugMode==="normal",DEBUG_LITSHADERATE:this._debugMode==="litShadeRate",DEBUG_UV:this._debugMode==="uv",OUTLINE_WIDTH_WORLD:this._isOutline&&this._outlineWidthMode===Iv.WorldCoordinates,OUTLINE_WIDTH_SCREEN:this._isOutline&&this._outlineWidthMode===Iv.ScreenCoordinates}}_updateTextureMatrix(e,t){e.value&&(e.value.matrixAutoUpdate&&e.value.updateMatrix(),t.value.copy(e.value.matrix))}}const goe={"":3e3,srgb:3001};function _oe(n,e){parseInt(Er,10)>=152?n.colorSpace=e:n.encoding=goe[e]}class voe{get pending(){return Promise.all(this._pendings)}constructor(e,t){this._parser=e,this._materialParams=t,this._pendings=[]}assignPrimitive(e,t){t!=null&&(this._materialParams[e]=t)}assignColor(e,t,i){t!=null&&(this._materialParams[e]=new We().fromArray(t),i&&this._materialParams[e].convertSRGBToLinear())}assignTexture(e,t,i){return $a(this,void 0,void 0,function*(){const r=(()=>$a(this,void 0,void 0,function*(){t!=null&&(yield this._parser.assignTexture(this._materialParams,e,t),i&&_oe(this._materialParams[e],"srgb"))}))();return this._pendings.push(r),r})}assignTextureByIndex(e,t,i){return $a(this,void 0,void 0,function*(){return this.assignTexture(e,t!=null?{index:t}:void 0,i)})}}const yoe=new Set(["1.0","1.0-beta"]);class Lu{get name(){return Lu.EXTENSION_NAME}constructor(e,t={}){var i,r,s;this.parser=e,this.renderOrderOffset=(i=t.renderOrderOffset)!==null&&i!==void 0?i:0,this.v0CompatShade=(r=t.v0CompatShade)!==null&&r!==void 0?r:!1,this.debugMode=(s=t.debugMode)!==null&&s!==void 0?s:"none",this._mToonMaterialSet=new Set}beforeRoot(){return $a(this,void 0,void 0,function*(){this._removeUnlitExtensionIfMToonExists()})}afterRoot(e){return $a(this,void 0,void 0,function*(){e.userData.vrmMToonMaterials=Array.from(this._mToonMaterialSet)})}getMaterialType(e){return this._getMToonExtension(e)?Ov:null}extendMaterialParams(e,t){const i=this._getMToonExtension(e);return i?this._extendMaterialParams(i,t):null}loadMesh(e){var t;return $a(this,void 0,void 0,function*(){const i=this.parser,s=(t=i.json.meshes)===null||t===void 0?void 0:t[e];if(s==null)throw new Error(`MToonMaterialLoaderPlugin: Attempt to use meshes[${e}] of glTF but the mesh doesn't exist`);const o=s.primitives,a=yield i.loadMesh(e);if(o.length===1){const l=a,u=o[0].material;u!=null&&this._setupPrimitive(l,u)}else{const l=a;for(let u=0;u<o.length;u++){const c=l.children[u],h=o[u].material;h!=null&&this._setupPrimitive(c,h)}}return a})}_removeUnlitExtensionIfMToonExists(){const i=this.parser.json.materials;i==null||i.map((r,s)=>{var o;this._getMToonExtension(s)&&(!((o=r.extensions)===null||o===void 0)&&o.KHR_materials_unlit)&&delete r.extensions.KHR_materials_unlit})}_getMToonExtension(e){var t,i;const o=(t=this.parser.json.materials)===null||t===void 0?void 0:t[e];if(o==null){console.warn(`MToonMaterialLoaderPlugin: Attempt to use materials[${e}] of glTF but the material doesn't exist`);return}const a=(i=o.extensions)===null||i===void 0?void 0:i[Lu.EXTENSION_NAME];if(a==null)return;const l=a.specVersion;if(!yoe.has(l)){console.warn(`MToonMaterialLoaderPlugin: Unknown ${Lu.EXTENSION_NAME} specVersion "${l}"`);return}return a}_extendMaterialParams(e,t){var i;return $a(this,void 0,void 0,function*(){delete t.metalness,delete t.roughness;const r=new voe(this.parser,t);r.assignPrimitive("transparentWithZWrite",e.transparentWithZWrite),r.assignColor("shadeColorFactor",e.shadeColorFactor),r.assignTexture("shadeMultiplyTexture",e.shadeMultiplyTexture,!0),r.assignPrimitive("shadingShiftFactor",e.shadingShiftFactor),r.assignTexture("shadingShiftTexture",e.shadingShiftTexture,!0),r.assignPrimitive("shadingShiftTextureScale",(i=e.shadingShiftTexture)===null||i===void 0?void 0:i.scale),r.assignPrimitive("shadingToonyFactor",e.shadingToonyFactor),r.assignPrimitive("giEqualizationFactor",e.giEqualizationFactor),r.assignColor("matcapFactor",e.matcapFactor),r.assignTexture("matcapTexture",e.matcapTexture,!0),r.assignColor("parametricRimColorFactor",e.parametricRimColorFactor),r.assignTexture("rimMultiplyTexture",e.rimMultiplyTexture,!0),r.assignPrimitive("rimLightingMixFactor",e.rimLightingMixFactor),r.assignPrimitive("parametricRimFresnelPowerFactor",e.parametricRimFresnelPowerFactor),r.assignPrimitive("parametricRimLiftFactor",e.parametricRimLiftFactor),r.assignPrimitive("outlineWidthMode",e.outlineWidthMode),r.assignPrimitive("outlineWidthFactor",e.outlineWidthFactor),r.assignTexture("outlineWidthMultiplyTexture",e.outlineWidthMultiplyTexture,!1),r.assignColor("outlineColorFactor",e.outlineColorFactor),r.assignPrimitive("outlineLightingMixFactor",e.outlineLightingMixFactor),r.assignTexture("uvAnimationMaskTexture",e.uvAnimationMaskTexture,!1),r.assignPrimitive("uvAnimationScrollXSpeedFactor",e.uvAnimationScrollXSpeedFactor),r.assignPrimitive("uvAnimationScrollYSpeedFactor",e.uvAnimationScrollYSpeedFactor),r.assignPrimitive("uvAnimationRotationSpeedFactor",e.uvAnimationRotationSpeedFactor),r.assignPrimitive("v0CompatShade",this.v0CompatShade),r.assignPrimitive("debugMode",this.debugMode),yield r.pending})}_setupPrimitive(e,t){const i=this._getMToonExtension(t);if(i){const r=this._parseRenderOrder(i);e.renderOrder=r+this.renderOrderOffset,this._generateOutline(e),this._addToMaterialSet(e);return}}_generateOutline(e){const t=e.material;if(!(t instanceof Ov)||t.outlineWidthMode==="none"||t.outlineWidthFactor<=0)return;e.material=[t];const i=t.clone();i.name+=" (Outline)",i.isOutline=!0,i.side=li,e.material.push(i);const r=e.geometry,s=r.index?r.index.count:r.attributes.position.count/3;r.addGroup(0,s,0),r.addGroup(0,s,1)}_addToMaterialSet(e){const t=e.material,i=new Set;Array.isArray(t)?t.forEach(r=>i.add(r)):i.add(t);for(const r of i)r instanceof Ov&&this._mToonMaterialSet.add(r)}_parseRenderOrder(e){var t;return(e.transparentWithZWrite?0:19)+((t=e.renderQueueOffsetNumber)!==null&&t!==void 0?t:0)}}Lu.EXTENSION_NAME="VRMC_materials_mtoon";/*!
 * @pixiv/three-vrm-materials-hdr-emissive-multiplier v2.0.1
 * Support VRMC_hdr_emissiveMultiplier for @pixiv/three-vrm
 *
 * Copyright (c) 2020-2023 pixiv Inc.
 * @pixiv/three-vrm-materials-hdr-emissive-multiplier is distributed under MIT License
 * https://github.com/pixiv/three-vrm/blob/release/LICENSE
 */function xoe(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(c){try{u(i.next(c))}catch(h){o(h)}}function l(c){try{u(i.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(a,l)}u((i=i.apply(n,e||[])).next())})}class Pd{get name(){return Pd.EXTENSION_NAME}constructor(e){this.parser=e}extendMaterialParams(e,t){return xoe(this,void 0,void 0,function*(){const i=this._getHDREmissiveMultiplierExtension(e);if(i==null)return;console.warn("VRMMaterialsHDREmissiveMultiplierLoaderPlugin: `VRMC_materials_hdr_emissiveMultiplier` is archived. Use `KHR_materials_emissive_strength` instead.");const r=i.emissiveMultiplier;t.emissiveIntensity=r})}_getHDREmissiveMultiplierExtension(e){var t,i;const o=(t=this.parser.json.materials)===null||t===void 0?void 0:t[e];if(o==null){console.warn(`VRMMaterialsHDREmissiveMultiplierLoaderPlugin: Attempt to use materials[${e}] of glTF but the material doesn't exist`);return}const a=(i=o.extensions)===null||i===void 0?void 0:i[Pd.EXTENSION_NAME];if(a!=null)return a}}Pd.EXTENSION_NAME="VRMC_materials_hdr_emissiveMultiplier";/*!
 * @pixiv/three-vrm-materials-v0compat v2.0.1
 * VRM0.0 materials compatibility layer plugin for @pixiv/three-vrm
 *
 * Copyright (c) 2020-2023 pixiv Inc.
 * @pixiv/three-vrm-materials-v0compat is distributed under MIT License
 * https://github.com/pixiv/three-vrm/blob/release/LICENSE
 */function boe(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(c){try{u(i.next(c))}catch(h){o(h)}}function l(c){try{u(i.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(a,l)}u((i=i.apply(n,e||[])).next())})}function au(n){return Math.pow(n,2.2)}class Soe{get name(){return"VRMMaterialsV0CompatPlugin"}constructor(e){var t;this.parser=e,this._renderQueueMapTransparent=new Map,this._renderQueueMapTransparentZWrite=new Map;const i=this.parser.json;i.extensionsUsed=(t=i.extensionsUsed)!==null&&t!==void 0?t:[],i.extensionsUsed.indexOf("KHR_texture_transform")===-1&&i.extensionsUsed.push("KHR_texture_transform")}beforeRoot(){var e;return boe(this,void 0,void 0,function*(){const t=this.parser.json,i=(e=t.extensions)===null||e===void 0?void 0:e.VRM,r=i==null?void 0:i.materialProperties;r&&(this._populateRenderQueueMap(r),r.forEach((s,o)=>{var a,l;const u=(a=t.materials)===null||a===void 0?void 0:a[o];if(u==null){console.warn(`VRMMaterialsV0CompatPlugin: Attempt to use materials[${o}] of glTF but the material doesn't exist`);return}if(s.shader==="VRM/MToon"){const c=this._parseV0MToonProperties(s,u);t.materials[o]=c}else if(!((l=s.shader)===null||l===void 0)&&l.startsWith("VRM/Unlit")){const c=this._parseV0UnlitProperties(s,u);t.materials[o]=c}else s.shader==="VRM_USE_GLTFSHADER"||console.warn(`VRMMaterialsV0CompatPlugin: Unknown shader: ${s.shader}`)}))})}_parseV0MToonProperties(e,t){var i,r,s,o,a,l,u,c,h,d,f,p,_,m,g,v,y,x,b,S,T,P,E,M,O,L,C,D,B,W,U,$,J,j,F,X,re,ce,ve,ae,Y,ne,he,xe;const be=(r=(i=e.keywordMap)===null||i===void 0?void 0:i._ALPHABLEND_ON)!==null&&r!==void 0?r:!1,V=((s=e.floatProperties)===null||s===void 0?void 0:s._ZWrite)===1&&be,H=this._v0ParseRenderQueue(e),K=(a=(o=e.keywordMap)===null||o===void 0?void 0:o._ALPHATEST_ON)!==null&&a!==void 0?a:!1,Z=be?"BLEND":K?"MASK":"OPAQUE",ee=K?(l=e.floatProperties)===null||l===void 0?void 0:l._Cutoff:void 0,le=((c=(u=e.floatProperties)===null||u===void 0?void 0:u._CullMode)!==null&&c!==void 0?c:2)===0,fe=this._portTextureTransform(e),me=(d=(h=e.vectorProperties)===null||h===void 0?void 0:h._Color)===null||d===void 0?void 0:d.map((qd,Ag)=>Ag===3?qd:au(qd)),we=(f=e.textureProperties)===null||f===void 0?void 0:f._MainTex,I=we!=null?{index:we,extensions:Object.assign({},fe)}:void 0,A=(p=e.floatProperties)===null||p===void 0?void 0:p._BumpScale,G=(_=e.textureProperties)===null||_===void 0?void 0:_._BumpMap,Q=G!=null?{index:G,scale:A,extensions:Object.assign({},fe)}:void 0,ue=(g=(m=e.vectorProperties)===null||m===void 0?void 0:m._EmissionColor)===null||g===void 0?void 0:g.map(au),k=(v=e.textureProperties)===null||v===void 0?void 0:v._EmissionMap,pe=k!=null?{index:k,extensions:Object.assign({},fe)}:void 0,Ee=(x=(y=e.vectorProperties)===null||y===void 0?void 0:y._ShadeColor)===null||x===void 0?void 0:x.map(au),se=(b=e.textureProperties)===null||b===void 0?void 0:b._ShadeTexture,De=se!=null?{index:se,extensions:Object.assign({},fe)}:void 0;let Ne=(T=(S=e.floatProperties)===null||S===void 0?void 0:S._ShadeShift)!==null&&T!==void 0?T:0,Ue=(E=(P=e.floatProperties)===null||P===void 0?void 0:P._ShadeToony)!==null&&E!==void 0?E:.9;Ue=Kt.lerp(Ue,1,.5+.5*Ne),Ne=-Ne-(1-Ue);const Ce=(M=e.floatProperties)===null||M===void 0?void 0:M._IndirectLightIntensity,Re=Ce?1-Ce:void 0,Ve=(O=e.textureProperties)===null||O===void 0?void 0:O._SphereAdd,ft=Ve!=null?[1,1,1]:void 0,q=Ve!=null?{index:Ve}:void 0,Ie=(L=e.floatProperties)===null||L===void 0?void 0:L._RimLightingMix,de=(C=e.textureProperties)===null||C===void 0?void 0:C._RimTexture,Ae=de!=null?{index:de,extensions:Object.assign({},fe)}:void 0,Le=(B=(D=e.vectorProperties)===null||D===void 0?void 0:D._RimColor)===null||B===void 0?void 0:B.map(au),Et=(W=e.floatProperties)===null||W===void 0?void 0:W._RimFresnelPower,Yt=(U=e.floatProperties)===null||U===void 0?void 0:U._RimLift,mn=["none","worldCoordinates","screenCoordinates"][(J=($=e.floatProperties)===null||$===void 0?void 0:$._OutlineWidthMode)!==null&&J!==void 0?J:0];let ui=(F=(j=e.floatProperties)===null||j===void 0?void 0:j._OutlineWidth)!==null&&F!==void 0?F:0;ui=.01*ui;const qt=(X=e.textureProperties)===null||X===void 0?void 0:X._OutlineWidthTexture,Di=qt!=null?{index:qt,extensions:Object.assign({},fe)}:void 0,Vn=(ce=(re=e.vectorProperties)===null||re===void 0?void 0:re._OutlineColor)===null||ce===void 0?void 0:ce.map(au),Xd=((ve=e.floatProperties)===null||ve===void 0?void 0:ve._OutlineColorMode)===1?(ae=e.floatProperties)===null||ae===void 0?void 0:ae._OutlineLightingMix:0,jd=(Y=e.textureProperties)===null||Y===void 0?void 0:Y._UvAnimMaskTexture,wl=jd!=null?{index:jd,extensions:Object.assign({},fe)}:void 0,$d=(ne=e.floatProperties)===null||ne===void 0?void 0:ne._UvAnimScrollX;let ms=(he=e.floatProperties)===null||he===void 0?void 0:he._UvAnimScrollY;ms!=null&&(ms=-ms);const Yd=(xe=e.floatProperties)===null||xe===void 0?void 0:xe._UvAnimRotation,wg={specVersion:"1.0",transparentWithZWrite:V,renderQueueOffsetNumber:H,shadeColorFactor:Ee,shadeMultiplyTexture:De,shadingShiftFactor:Ne,shadingToonyFactor:Ue,giEqualizationFactor:Re,matcapFactor:ft,matcapTexture:q,rimLightingMixFactor:Ie,rimMultiplyTexture:Ae,parametricRimColorFactor:Le,parametricRimFresnelPowerFactor:Et,parametricRimLiftFactor:Yt,outlineWidthMode:mn,outlineWidthFactor:ui,outlineWidthMultiplyTexture:Di,outlineColorFactor:Vn,outlineLightingMixFactor:Xd,uvAnimationMaskTexture:wl,uvAnimationScrollXSpeedFactor:$d,uvAnimationScrollYSpeedFactor:ms,uvAnimationRotationSpeedFactor:Yd};return Object.assign(Object.assign({},t),{pbrMetallicRoughness:{baseColorFactor:me,baseColorTexture:I},normalTexture:Q,emissiveTexture:pe,emissiveFactor:ue,alphaMode:Z,alphaCutoff:ee,doubleSided:le,extensions:{VRMC_materials_mtoon:wg}})}_parseV0UnlitProperties(e,t){var i,r,s,o;const a=e.shader==="VRM/UnlitTransparentZWrite",l=e.shader==="VRM/UnlitTransparent"||a,u=this._v0ParseRenderQueue(e),c=e.shader==="VRM/UnlitCutout",h=l?"BLEND":c?"MASK":"OPAQUE",d=c?(i=e.floatProperties)===null||i===void 0?void 0:i._Cutoff:void 0,f=this._portTextureTransform(e),p=(s=(r=e.vectorProperties)===null||r===void 0?void 0:r._Color)===null||s===void 0?void 0:s.map(au),_=(o=e.textureProperties)===null||o===void 0?void 0:o._MainTex,m=_!=null?{index:_,extensions:Object.assign({},f)}:void 0,g={specVersion:"1.0",transparentWithZWrite:a,renderQueueOffsetNumber:u,shadeColorFactor:p,shadeMultiplyTexture:m};return Object.assign(Object.assign({},t),{pbrMetallicRoughness:{baseColorFactor:p,baseColorTexture:m},alphaMode:h,alphaCutoff:d,extensions:{VRMC_materials_mtoon:g}})}_portTextureTransform(e){var t,i,r,s,o;const a=(t=e.vectorProperties)===null||t===void 0?void 0:t._MainTex;if(a==null)return{};const l=[(i=a==null?void 0:a[0])!==null&&i!==void 0?i:0,(r=a==null?void 0:a[1])!==null&&r!==void 0?r:0],u=[(s=a==null?void 0:a[2])!==null&&s!==void 0?s:1,(o=a==null?void 0:a[3])!==null&&o!==void 0?o:1];return l[1]=u[1]*(1-l[1])%1,{KHR_texture_transform:{offset:l,scale:u}}}_v0ParseRenderQueue(e){var t,i,r;const s=(i=(t=e.keywordMap)===null||t===void 0?void 0:t._ALPHABLEND_ON)!==null&&i!==void 0?i:!1,o=((r=e.floatProperties)===null||r===void 0?void 0:r._ZWrite)===1;let a=0;if(s){const l=e.renderQueue;l!=null&&(o?a=this._renderQueueMapTransparentZWrite.get(l):a=this._renderQueueMapTransparent.get(l))}return a}_populateRenderQueueMap(e){const t=new Set,i=new Set;e.forEach(r=>{var s,o,a;const l=(o=(s=r.keywordMap)===null||s===void 0?void 0:s._ALPHABLEND_ON)!==null&&o!==void 0?o:!1,u=((a=r.floatProperties)===null||a===void 0?void 0:a._ZWrite)===1;if(l){const c=r.renderQueue;c!=null&&(u?i.add(c):t.add(c))}}),t.size>10&&console.warn(`VRMMaterialsV0CompatPlugin: This VRM uses ${t.size} render queues for Transparent materials while VRM 1.0 only supports up to 10 render queues. The model might not be rendered correctly.`),i.size>10&&console.warn(`VRMMaterialsV0CompatPlugin: This VRM uses ${i.size} render queues for TransparentZWrite materials while VRM 1.0 only supports up to 10 render queues. The model might not be rendered correctly.`),Array.from(t).sort().forEach((r,s)=>{const o=Math.min(Math.max(s-t.size+1,-9),0);this._renderQueueMapTransparent.set(r,o)}),Array.from(i).sort().forEach((r,s)=>{const o=Math.min(Math.max(s,0),9);this._renderQueueMapTransparentZWrite.set(r,o)})}}/*!
 * @pixiv/three-vrm-node-constraint v2.0.1
 * Node constraint module for @pixiv/three-vrm
 *
 * Copyright (c) 2020-2023 pixiv Inc.
 * @pixiv/three-vrm-node-constraint is distributed under MIT License
 * https://github.com/pixiv/three-vrm/blob/release/LICENSE
 */const go=new z;class Dv extends Ri{constructor(e){super(),this._attrPosition=new Nt(new Float32Array([0,0,0,0,0,0]),3),this._attrPosition.setUsage(RQ);const t=new kn;t.setAttribute("position",this._attrPosition);const i=new Ml({color:16711935,depthTest:!1,depthWrite:!1});this._line=new bg(t,i),this.add(this._line),this.constraint=e}updateMatrixWorld(e){go.setFromMatrixPosition(this.constraint.destination.matrixWorld),this._attrPosition.setXYZ(0,go.x,go.y,go.z),this.constraint.source&&go.setFromMatrixPosition(this.constraint.source.matrixWorld),this._attrPosition.setXYZ(1,go.x,go.y,go.z),this._attrPosition.needsUpdate=!0,super.updateMatrixWorld(e)}}function v1(n,e){return e.set(n.elements[12],n.elements[13],n.elements[14])}const Eoe=new z,Toe=new z;function Moe(n,e){return n.decompose(Eoe,e,Toe),e}function xm(n){return n.invert?n.invert():n.inverse(),n}class SS{constructor(e,t){this.destination=e,this.source=t,this.weight=1}}const woe=new z,Aoe=new z,Poe=new z,Coe=new Xe,Roe=new Xe,Ioe=new Xe;class Loe extends SS{get aimAxis(){return this._aimAxis}set aimAxis(e){this._aimAxis=e,this._v3AimAxis.set(e==="PositiveX"?1:e==="NegativeX"?-1:0,e==="PositiveY"?1:e==="NegativeY"?-1:0,e==="PositiveZ"?1:e==="NegativeZ"?-1:0)}get dependencies(){const e=new Set([this.source]);return this.destination.parent&&e.add(this.destination.parent),e}constructor(e,t){super(e,t),this._aimAxis="PositiveX",this._v3AimAxis=new z(1,0,0),this._dstRestQuat=new Xe}setInitState(){this._dstRestQuat.copy(this.destination.quaternion)}update(){this.destination.updateWorldMatrix(!0,!1),this.source.updateWorldMatrix(!0,!1);const e=Coe.identity(),t=Roe.identity();this.destination.parent&&(Moe(this.destination.parent.matrixWorld,e),xm(t.copy(e)));const i=woe.copy(this._v3AimAxis).applyQuaternion(this._dstRestQuat).applyQuaternion(e),r=v1(this.source.matrixWorld,Aoe).sub(v1(this.destination.matrixWorld,Poe)).normalize(),s=Ioe.setFromUnitVectors(i,r).premultiply(t).multiply(e).multiply(this._dstRestQuat);this.destination.quaternion.copy(this._dstRestQuat).slerp(s,this.weight)}}function y1(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(c){try{u(i.next(c))}catch(h){o(h)}}function l(c){try{u(i.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(a,l)}u((i=i.apply(n,e||[])).next())})}function Ooe(n,e){const t=[n];let i=n.parent;for(;i!==null;)t.unshift(i),i=i.parent;t.forEach(r=>{e(r)})}class Doe{constructor(){this._constraints=new Set,this._objectConstraintsMap=new Map}get constraints(){return this._constraints}addConstraint(e){this._constraints.add(e);let t=this._objectConstraintsMap.get(e.destination);t==null&&(t=new Set,this._objectConstraintsMap.set(e.destination,t)),t.add(e)}deleteConstraint(e){this._constraints.delete(e),this._objectConstraintsMap.get(e.destination).delete(e)}setInitState(){const e=new Set,t=new Set;for(const i of this._constraints)this._processConstraint(i,e,t,r=>r.setInitState())}update(){const e=new Set,t=new Set;for(const i of this._constraints)this._processConstraint(i,e,t,r=>r.update())}_processConstraint(e,t,i,r){if(i.has(e))return;if(t.has(e))throw new Error("VRMNodeConstraintManager: Circular dependency detected while updating constraints");t.add(e);const s=e.dependencies;for(const o of s)Ooe(o,a=>{const l=this._objectConstraintsMap.get(a);if(l)for(const u of l)this._processConstraint(u,t,i,r)});r(e),i.add(e)}}const Foe=new Xe,Noe=new Xe;class Uoe extends SS{get dependencies(){return new Set([this.source])}constructor(e,t){super(e,t),this._dstRestQuat=new Xe,this._invSrcRestQuat=new Xe}setInitState(){this._dstRestQuat.copy(this.destination.quaternion),xm(this._invSrcRestQuat.copy(this.source.quaternion))}update(){const e=Foe.copy(this._invSrcRestQuat).multiply(this.source.quaternion),t=Noe.copy(this._dstRestQuat).multiply(e);this.destination.quaternion.copy(this._dstRestQuat).slerp(t,this.weight)}}const Boe=new z,koe=new Xe,Voe=new Xe;class Goe extends SS{get rollAxis(){return this._rollAxis}set rollAxis(e){this._rollAxis=e,this._v3RollAxis.set(e==="X"?1:0,e==="Y"?1:0,e==="Z"?1:0)}get dependencies(){return new Set([this.source])}constructor(e,t){super(e,t),this._rollAxis="X",this._v3RollAxis=new z(1,0,0),this._dstRestQuat=new Xe,this._invDstRestQuat=new Xe,this._invSrcRestQuatMulDstRestQuat=new Xe}setInitState(){this._dstRestQuat.copy(this.destination.quaternion),xm(this._invDstRestQuat.copy(this._dstRestQuat)),xm(this._invSrcRestQuatMulDstRestQuat.copy(this.source.quaternion)).multiply(this._dstRestQuat)}update(){const e=koe.copy(this._invDstRestQuat).multiply(this.source.quaternion).multiply(this._invSrcRestQuatMulDstRestQuat),t=Boe.copy(this._v3RollAxis).applyQuaternion(e),r=Voe.setFromUnitVectors(t,this._v3RollAxis).premultiply(this._dstRestQuat).multiply(e);this.destination.quaternion.copy(this._dstRestQuat).slerp(r,this.weight)}}const Hoe=new Set(["1.0","1.0-beta"]);class Ya{get name(){return Ya.EXTENSION_NAME}constructor(e,t){this.parser=e,this.helperRoot=t==null?void 0:t.helperRoot}afterRoot(e){return y1(this,void 0,void 0,function*(){e.userData.vrmNodeConstraintManager=yield this._import(e)})}_import(e){var t;return y1(this,void 0,void 0,function*(){const i=this.parser.json;if(!(((t=i.extensionsUsed)===null||t===void 0?void 0:t.indexOf(Ya.EXTENSION_NAME))!==-1))return null;const s=new Doe,o=yield this.parser.getDependencies("node");return o.forEach((a,l)=>{var u;const c=i.nodes[l],h=(u=c==null?void 0:c.extensions)===null||u===void 0?void 0:u[Ya.EXTENSION_NAME];if(h==null)return;const d=h.specVersion;if(!Hoe.has(d)){console.warn(`VRMNodeConstraintLoaderPlugin: Unknown ${Ya.EXTENSION_NAME} specVersion "${d}"`);return}const f=h.constraint;if(f.roll!=null){const p=this._importRollConstraint(a,o,f.roll);s.addConstraint(p)}else if(f.aim!=null){const p=this._importAimConstraint(a,o,f.aim);s.addConstraint(p)}else if(f.rotation!=null){const p=this._importRotationConstraint(a,o,f.rotation);s.addConstraint(p)}}),e.scene.updateMatrixWorld(),s.setInitState(),s})}_importRollConstraint(e,t,i){const{source:r,rollAxis:s,weight:o}=i,a=t[r],l=new Goe(e,a);if(s!=null&&(l.rollAxis=s),o!=null&&(l.weight=o),this.helperRoot){const u=new Dv(l);this.helperRoot.add(u)}return l}_importAimConstraint(e,t,i){const{source:r,aimAxis:s,weight:o}=i,a=t[r],l=new Loe(e,a);if(s!=null&&(l.aimAxis=s),o!=null&&(l.weight=o),this.helperRoot){const u=new Dv(l);this.helperRoot.add(u)}return l}_importRotationConstraint(e,t,i){const{source:r,weight:s}=i,o=t[r],a=new Uoe(e,o);if(s!=null&&(a.weight=s),this.helperRoot){const l=new Dv(a);this.helperRoot.add(l)}return a}}Ya.EXTENSION_NAME="VRMC_node_constraint";/*!
 * @pixiv/three-vrm-springbone v2.0.0
 * Spring bone module for @pixiv/three-vrm
 *
 * Copyright (c) 2020-2023 pixiv Inc.
 * @pixiv/three-vrm-springbone is distributed under MIT License
 * https://github.com/pixiv/three-vrm/blob/release/LICENSE
 */class F2{}const Fv=new z,ba=new z;class N2 extends F2{get type(){return"capsule"}constructor(e){var t,i,r;super(),this.offset=(t=e==null?void 0:e.offset)!==null&&t!==void 0?t:new z(0,0,0),this.tail=(i=e==null?void 0:e.tail)!==null&&i!==void 0?i:new z(0,0,0),this.radius=(r=e==null?void 0:e.radius)!==null&&r!==void 0?r:0}calculateCollision(e,t,i,r){Fv.copy(this.offset).applyMatrix4(e),ba.copy(this.tail).applyMatrix4(e),ba.sub(Fv);const s=ba.lengthSq();r.copy(t).sub(Fv);const o=ba.dot(r);o<=0||(s<=o||ba.multiplyScalar(o/s),r.sub(ba));const a=i+this.radius,l=r.length()-a;return r.normalize(),l}}class U2 extends F2{get type(){return"sphere"}constructor(e){var t,i;super(),this.offset=(t=e==null?void 0:e.offset)!==null&&t!==void 0?t:new z(0,0,0),this.radius=(i=e==null?void 0:e.radius)!==null&&i!==void 0?i:0}calculateCollision(e,t,i,r){r.copy(this.offset).applyMatrix4(e),r.negate().add(t);const s=i+this.radius,o=r.length()-s;return r.normalize(),o}}const Wr=new z;class zoe extends kn{constructor(e){super(),this.worldScale=1,this._currentRadius=0,this._currentOffset=new z,this._currentTail=new z,this._shape=e,this._attrPos=new Nt(new Float32Array(396),3),this.setAttribute("position",this._attrPos),this._attrIndex=new Nt(new Uint16Array(264),1),this.setIndex(this._attrIndex),this._buildIndex(),this.update()}update(){let e=!1;const t=this._shape.radius/this.worldScale;this._currentRadius!==t&&(this._currentRadius=t,e=!0),this._currentOffset.equals(this._shape.offset)||(this._currentOffset.copy(this._shape.offset),e=!0);const i=Wr.copy(this._shape.tail).divideScalar(this.worldScale);this._currentTail.distanceToSquared(i)>1e-10&&(this._currentTail.copy(i),e=!0),e&&this._buildPosition()}_buildPosition(){Wr.copy(this._currentTail).sub(this._currentOffset);const e=Wr.length()/this._currentRadius;for(let r=0;r<=16;r++){const s=r/16*Math.PI;this._attrPos.setXYZ(r,-Math.sin(s),-Math.cos(s),0),this._attrPos.setXYZ(17+r,e+Math.sin(s),Math.cos(s),0),this._attrPos.setXYZ(34+r,-Math.sin(s),0,-Math.cos(s)),this._attrPos.setXYZ(51+r,e+Math.sin(s),0,Math.cos(s))}for(let r=0;r<32;r++){const s=r/16*Math.PI;this._attrPos.setXYZ(68+r,0,Math.sin(s),Math.cos(s)),this._attrPos.setXYZ(100+r,e,Math.sin(s),Math.cos(s))}const t=Math.atan2(Wr.y,Math.sqrt(Wr.x*Wr.x+Wr.z*Wr.z)),i=-Math.atan2(Wr.z,Wr.x);this.rotateZ(t),this.rotateY(i),this.scale(this._currentRadius,this._currentRadius,this._currentRadius),this.translate(this._currentOffset.x,this._currentOffset.y,this._currentOffset.z),this._attrPos.needsUpdate=!0}_buildIndex(){for(let e=0;e<34;e++){const t=(e+1)%34;this._attrIndex.setXY(e*2,e,t),this._attrIndex.setXY(68+e*2,34+e,34+t)}for(let e=0;e<32;e++){const t=(e+1)%32;this._attrIndex.setXY(136+e*2,68+e,68+t),this._attrIndex.setXY(200+e*2,100+e,100+t)}this._attrIndex.needsUpdate=!0}}class Woe extends kn{constructor(e){super(),this.worldScale=1,this._currentRadius=0,this._currentOffset=new z,this._shape=e,this._attrPos=new Nt(new Float32Array(32*3*3),3),this.setAttribute("position",this._attrPos),this._attrIndex=new Nt(new Uint16Array(64*3),1),this.setIndex(this._attrIndex),this._buildIndex(),this.update()}update(){let e=!1;const t=this._shape.radius/this.worldScale;this._currentRadius!==t&&(this._currentRadius=t,e=!0),this._currentOffset.equals(this._shape.offset)||(this._currentOffset.copy(this._shape.offset),e=!0),e&&this._buildPosition()}_buildPosition(){for(let e=0;e<32;e++){const t=e/16*Math.PI;this._attrPos.setXYZ(e,Math.cos(t),Math.sin(t),0),this._attrPos.setXYZ(32+e,0,Math.cos(t),Math.sin(t)),this._attrPos.setXYZ(64+e,Math.sin(t),0,Math.cos(t))}this.scale(this._currentRadius,this._currentRadius,this._currentRadius),this.translate(this._currentOffset.x,this._currentOffset.y,this._currentOffset.z),this._attrPos.needsUpdate=!0}_buildIndex(){for(let e=0;e<32;e++){const t=(e+1)%32;this._attrIndex.setXY(e*2,e,t),this._attrIndex.setXY(64+e*2,32+e,32+t),this._attrIndex.setXY(128+e*2,64+e,64+t)}this._attrIndex.needsUpdate=!0}}const Xoe=new z;class x1 extends Ri{constructor(e){if(super(),this.matrixAutoUpdate=!1,this.collider=e,this.collider.shape instanceof U2)this._geometry=new Woe(this.collider.shape);else if(this.collider.shape instanceof N2)this._geometry=new zoe(this.collider.shape);else throw new Error("VRMSpringBoneColliderHelper: Unknown collider shape type detected");const t=new Ml({color:16711935,depthTest:!1,depthWrite:!1});this._line=new zd(this._geometry,t),this.add(this._line)}dispose(){this._geometry.dispose()}updateMatrixWorld(e){this.collider.updateWorldMatrix(!0,!1),this.matrix.copy(this.collider.matrixWorld);const t=this.matrix.elements;this._geometry.worldScale=Xoe.set(t[0],t[1],t[2]).length(),this._geometry.update(),super.updateMatrixWorld(e)}}class joe extends kn{constructor(e){super(),this.worldScale=1,this._currentRadius=0,this._currentTail=new z,this._springBone=e,this._attrPos=new Nt(new Float32Array(294),3),this.setAttribute("position",this._attrPos),this._attrIndex=new Nt(new Uint16Array(194),1),this.setIndex(this._attrIndex),this._buildIndex(),this.update()}update(){let e=!1;const t=this._springBone.settings.hitRadius/this.worldScale;this._currentRadius!==t&&(this._currentRadius=t,e=!0),this._currentTail.equals(this._springBone.initialLocalChildPosition)||(this._currentTail.copy(this._springBone.initialLocalChildPosition),e=!0),e&&this._buildPosition()}_buildPosition(){for(let e=0;e<32;e++){const t=e/16*Math.PI;this._attrPos.setXYZ(e,Math.cos(t),Math.sin(t),0),this._attrPos.setXYZ(32+e,0,Math.cos(t),Math.sin(t)),this._attrPos.setXYZ(64+e,Math.sin(t),0,Math.cos(t))}this.scale(this._currentRadius,this._currentRadius,this._currentRadius),this.translate(this._currentTail.x,this._currentTail.y,this._currentTail.z),this._attrPos.setXYZ(96,0,0,0),this._attrPos.setXYZ(97,this._currentTail.x,this._currentTail.y,this._currentTail.z),this._attrPos.needsUpdate=!0}_buildIndex(){for(let e=0;e<32;e++){const t=(e+1)%32;this._attrIndex.setXY(e*2,e,t),this._attrIndex.setXY(64+e*2,32+e,32+t),this._attrIndex.setXY(128+e*2,64+e,64+t)}this._attrIndex.setXY(192,96,97),this._attrIndex.needsUpdate=!0}}const $oe=new z;class Yoe extends Ri{constructor(e){super(),this.matrixAutoUpdate=!1,this.springBone=e,this._geometry=new joe(this.springBone);const t=new Ml({color:16776960,depthTest:!1,depthWrite:!1});this._line=new zd(this._geometry,t),this.add(this._line)}dispose(){this._geometry.dispose()}updateMatrixWorld(e){this.springBone.bone.updateWorldMatrix(!0,!1),this.matrix.copy(this.springBone.bone.matrixWorld);const t=this.matrix.elements;this._geometry.worldScale=$oe.set(t[0],t[1],t[2]).length(),this._geometry.update(),super.updateMatrixWorld(e)}}class b1 extends Ft{constructor(e){super(),this.shape=e}}const qoe=new Qe;function B2(n){return n.invert?n.invert():n.getInverse(qoe.copy(n)),n}class Koe{get inverse(){return this._shouldUpdateInverse&&(this._inverseCache.copy(this.matrix),B2(this._inverseCache),this._shouldUpdateInverse=!1),this._inverseCache}constructor(e){this._inverseCache=new Qe,this._shouldUpdateInverse=!0,this.matrix=e;const t={set:(i,r,s)=>(this._shouldUpdateInverse=!0,i[r]=s,!0)};this._originalElements=e.elements,e.elements=new Proxy(e.elements,t)}revert(){this.matrix.elements=this._originalElements}}const Zoe=new Qe,As=new z,sh=new z,Joe=new z,lu=new z,S1=new z,oh=new z,E1=new Xe,uu=new Qe,Qoe=new Qe;class eae{get center(){return this._center}set center(e){var t;!((t=this._center)===null||t===void 0)&&t.userData.inverseCacheProxy&&(this._center.userData.inverseCacheProxy.revert(),delete this._center.userData.inverseCacheProxy),this._center=e,this._center&&(this._center.userData.inverseCacheProxy||(this._center.userData.inverseCacheProxy=new Koe(this._center.matrixWorld)))}get initialLocalChildPosition(){return this._initialLocalChildPosition}get _parentMatrixWorld(){return this.bone.parent?this.bone.parent.matrixWorld:Zoe}constructor(e,t,i={},r=[]){var s,o,a,l,u,c;this._currentTail=new z,this._prevTail=new z,this._boneAxis=new z,this._worldSpaceBoneLength=0,this._center=null,this._initialLocalMatrix=new Qe,this._initialLocalRotation=new Xe,this._initialLocalChildPosition=new z,this.bone=e,this.bone.matrixAutoUpdate=!1,this.child=t,this.settings={hitRadius:(s=i.hitRadius)!==null&&s!==void 0?s:0,stiffness:(o=i.stiffness)!==null&&o!==void 0?o:1,gravityPower:(a=i.gravityPower)!==null&&a!==void 0?a:0,gravityDir:(u=(l=i.gravityDir)===null||l===void 0?void 0:l.clone())!==null&&u!==void 0?u:new z(0,-1,0),dragForce:(c=i.dragForce)!==null&&c!==void 0?c:.4},this.colliderGroups=r}setInitState(){this._initialLocalMatrix.copy(this.bone.matrix),this._initialLocalRotation.copy(this.bone.quaternion),this.child?this._initialLocalChildPosition.copy(this.child.position):this._initialLocalChildPosition.copy(this.bone.position).normalize().multiplyScalar(.07);const e=this._getMatrixWorldToCenter(uu);this.bone.localToWorld(this._currentTail.copy(this._initialLocalChildPosition)).applyMatrix4(e),this._prevTail.copy(this._currentTail),this._boneAxis.copy(this._initialLocalChildPosition).normalize()}reset(){this.bone.quaternion.copy(this._initialLocalRotation),this.bone.updateMatrix(),this.bone.matrixWorld.multiplyMatrices(this._parentMatrixWorld,this.bone.matrix);const e=this._getMatrixWorldToCenter(uu);this.bone.localToWorld(this._currentTail.copy(this._initialLocalChildPosition)).applyMatrix4(e),this._prevTail.copy(this._currentTail)}update(e){if(e<=0)return;this._calcWorldSpaceBoneLength(),lu.setFromMatrixPosition(this.bone.matrixWorld);let t=this._getMatrixWorldToCenter(uu);S1.copy(lu).applyMatrix4(t);const i=E1.setFromRotationMatrix(t),r=Qoe.copy(t).multiply(this._parentMatrixWorld),s=sh.copy(this._boneAxis).applyMatrix4(this._initialLocalMatrix).applyMatrix4(r).sub(S1).normalize(),o=Joe.copy(this.settings.gravityDir).applyQuaternion(i).normalize(),a=this._getMatrixCenterToWorld(uu);oh.copy(this._currentTail).add(As.copy(this._currentTail).sub(this._prevTail).multiplyScalar(1-this.settings.dragForce)).add(As.copy(s).multiplyScalar(this.settings.stiffness*e)).add(As.copy(o).multiplyScalar(this.settings.gravityPower*e)).applyMatrix4(a),oh.sub(lu).normalize().multiplyScalar(this._worldSpaceBoneLength).add(lu),this._collision(oh),t=this._getMatrixWorldToCenter(uu),this._prevTail.copy(this._currentTail),this._currentTail.copy(As.copy(oh).applyMatrix4(t));const l=B2(uu.copy(this._parentMatrixWorld).multiply(this._initialLocalMatrix)),u=E1.setFromUnitVectors(this._boneAxis,As.copy(oh).applyMatrix4(l).normalize());this.bone.quaternion.copy(this._initialLocalRotation).multiply(u),this.bone.updateMatrix(),this.bone.matrixWorld.multiplyMatrices(this._parentMatrixWorld,this.bone.matrix)}_collision(e){this.colliderGroups.forEach(t=>{t.colliders.forEach(i=>{const r=i.shape.calculateCollision(i.matrixWorld,e,this.settings.hitRadius,As);r<0&&(e.add(As.multiplyScalar(-r)),e.sub(lu).normalize().multiplyScalar(this._worldSpaceBoneLength).add(lu))})})}_calcWorldSpaceBoneLength(){As.setFromMatrixPosition(this.bone.matrixWorld),this.child?sh.setFromMatrixPosition(this.child.matrixWorld):(sh.copy(this._initialLocalChildPosition),sh.applyMatrix4(this.bone.matrixWorld)),this._worldSpaceBoneLength=As.sub(sh).length()}_getMatrixCenterToWorld(e){return this._center?e.copy(this._center.matrixWorld):e.identity(),e}_getMatrixWorldToCenter(e){return this._center?e.copy(this._center.userData.inverseCacheProxy.inverse):e.identity(),e}}function _p(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(c){try{u(i.next(c))}catch(h){o(h)}}function l(c){try{u(i.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(a,l)}u((i=i.apply(n,e||[])).next())})}function tae(n,e){const t=[];let i=n;for(;i!==null;)t.unshift(i),i=i.parent;t.forEach(r=>{e(r)})}function k2(n,e){n.children.forEach(t=>{e(t)||k2(t,e)})}class T1{constructor(){this._joints=new Set,this._objectSpringBonesMap=new Map}get joints(){return this._joints}get springBones(){return console.warn("VRMSpringBoneManager: springBones is deprecated. use joints instead."),this._joints}get colliderGroups(){const e=new Set;return this._joints.forEach(t=>{t.colliderGroups.forEach(i=>{e.add(i)})}),Array.from(e)}get colliders(){const e=new Set;return this.colliderGroups.forEach(t=>{t.colliders.forEach(i=>{e.add(i)})}),Array.from(e)}addJoint(e){this._joints.add(e);let t=this._objectSpringBonesMap.get(e.bone);t==null&&(t=new Set,this._objectSpringBonesMap.set(e.bone,t)),t.add(e)}addSpringBone(e){console.warn("VRMSpringBoneManager: addSpringBone() is deprecated. use addJoint() instead."),this.addJoint(e)}deleteJoint(e){this._joints.delete(e),this._objectSpringBonesMap.get(e.bone).delete(e)}deleteSpringBone(e){console.warn("VRMSpringBoneManager: deleteSpringBone() is deprecated. use deleteJoint() instead."),this.deleteJoint(e)}setInitState(){const e=new Set,t=new Set,i=new Set;for(const r of this._joints)this._processSpringBone(r,e,t,i,s=>s.setInitState())}reset(){const e=new Set,t=new Set,i=new Set;for(const r of this._joints)this._processSpringBone(r,e,t,i,s=>s.reset())}update(e){const t=new Set,i=new Set,r=new Set;for(const s of this._joints)this._processSpringBone(s,t,i,r,o=>o.update(e)),k2(s.bone,o=>{var a,l;return((l=(a=this._objectSpringBonesMap.get(o))===null||a===void 0?void 0:a.size)!==null&&l!==void 0?l:0)>0?!0:(o.updateWorldMatrix(!1,!1),!1)})}_processSpringBone(e,t,i,r,s){if(i.has(e))return;if(t.has(e))throw new Error("VRMSpringBoneManager: Circular dependency detected while updating springbones");t.add(e);const o=this._getDependencies(e);for(const a of o)tae(a,l=>{const u=this._objectSpringBonesMap.get(l);if(u)for(const c of u)this._processSpringBone(c,t,i,r,s);else r.has(l)||(l.updateWorldMatrix(!1,!1),r.add(l))});e.bone.updateMatrix(),e.bone.updateWorldMatrix(!1,!1),s(e),r.add(e.bone),i.add(e)}_getDependencies(e){const t=new Set,i=e.bone.parent;return i&&t.add(i),e.colliderGroups.forEach(r=>{r.colliders.forEach(s=>{t.add(s)})}),t}}const nae=new Set(["1.0","1.0-beta"]);class qa{get name(){return qa.EXTENSION_NAME}constructor(e,t){this.parser=e,this.jointHelperRoot=t==null?void 0:t.jointHelperRoot,this.colliderHelperRoot=t==null?void 0:t.colliderHelperRoot}afterRoot(e){return _p(this,void 0,void 0,function*(){e.userData.vrmSpringBoneManager=yield this._import(e)})}_import(e){return _p(this,void 0,void 0,function*(){const t=yield this._v1Import(e);if(t!=null)return t;const i=yield this._v0Import(e);return i??null})}_v1Import(e){var t,i,r,s,o;return _p(this,void 0,void 0,function*(){const a=e.parser.json;if(!(((t=a.extensionsUsed)===null||t===void 0?void 0:t.indexOf(qa.EXTENSION_NAME))!==-1))return null;const u=new T1,c=yield e.parser.getDependencies("node"),h=(i=a.extensions)===null||i===void 0?void 0:i[qa.EXTENSION_NAME];if(!h)return null;const d=h.specVersion;if(!nae.has(d))return console.warn(`VRMSpringBoneLoaderPlugin: Unknown ${qa.EXTENSION_NAME} specVersion "${d}"`),null;const f=(r=h.colliders)===null||r===void 0?void 0:r.map((_,m)=>{var g,v,y,x,b;const S=c[_.node],T=_.shape;if(T.sphere)return this._importSphereCollider(S,{offset:new z().fromArray((g=T.sphere.offset)!==null&&g!==void 0?g:[0,0,0]),radius:(v=T.sphere.radius)!==null&&v!==void 0?v:0});if(T.capsule)return this._importCapsuleCollider(S,{offset:new z().fromArray((y=T.capsule.offset)!==null&&y!==void 0?y:[0,0,0]),radius:(x=T.capsule.radius)!==null&&x!==void 0?x:0,tail:new z().fromArray((b=T.capsule.tail)!==null&&b!==void 0?b:[0,0,0])});throw new Error(`VRMSpringBoneLoaderPlugin: The collider #${m} has no valid shape`)}),p=(s=h.colliderGroups)===null||s===void 0?void 0:s.map((_,m)=>{var g;return{colliders:((g=_.colliders)!==null&&g!==void 0?g:[]).map(y=>{const x=f==null?void 0:f[y];if(x==null)throw new Error(`VRMSpringBoneLoaderPlugin: The colliderGroup #${m} attempted to use a collider #${y} but not found`);return x}),name:_.name}});return(o=h.springs)===null||o===void 0||o.forEach((_,m)=>{var g;const v=_.joints,y=(g=_.colliderGroups)===null||g===void 0?void 0:g.map(S=>{const T=p==null?void 0:p[S];if(T==null)throw new Error(`VRMSpringBoneLoaderPlugin: The spring #${m} attempted to use a colliderGroup ${S} but not found`);return T}),x=_.center!=null?c[_.center]:void 0;let b;v.forEach(S=>{if(b){const T=b.node,P=c[T],E=S.node,M=c[E],O={hitRadius:b.hitRadius,dragForce:b.dragForce,gravityPower:b.gravityPower,stiffness:b.stiffness,gravityDir:b.gravityDir!=null?new z().fromArray(b.gravityDir):void 0},L=this._importJoint(P,M,O,y);x&&(L.center=x),u.addJoint(L)}b=S})}),u.setInitState(),u})}_v0Import(e){var t,i,r;return _p(this,void 0,void 0,function*(){const s=e.parser.json;if(!(((t=s.extensionsUsed)===null||t===void 0?void 0:t.indexOf("VRM"))!==-1))return null;const a=(i=s.extensions)===null||i===void 0?void 0:i.VRM,l=a==null?void 0:a.secondaryAnimation;if(!l)return null;const u=l==null?void 0:l.boneGroups;if(!u)return null;const c=new T1,h=yield e.parser.getDependencies("node"),d=(r=l.colliderGroups)===null||r===void 0?void 0:r.map(f=>{var p;const _=h[f.node];return{colliders:((p=f.colliders)!==null&&p!==void 0?p:[]).map((g,v)=>{var y,x,b;const S=new z(0,0,0);return g.offset&&S.set((y=g.offset.x)!==null&&y!==void 0?y:0,(x=g.offset.y)!==null&&x!==void 0?x:0,g.offset.z?-g.offset.z:0),this._importSphereCollider(_,{offset:S,radius:(b=g.radius)!==null&&b!==void 0?b:0})})}});return u==null||u.forEach((f,p)=>{const _=f.bones;_&&_.forEach(m=>{var g,v,y,x;const b=h[m],S=new z;f.gravityDir?S.set((g=f.gravityDir.x)!==null&&g!==void 0?g:0,(v=f.gravityDir.y)!==null&&v!==void 0?v:0,(y=f.gravityDir.z)!==null&&y!==void 0?y:0):S.set(0,-1,0);const T=f.center!=null?h[f.center]:void 0,P={hitRadius:f.hitRadius,dragForce:f.dragForce,gravityPower:f.gravityPower,stiffness:f.stiffiness,gravityDir:S},E=(x=f.colliderGroups)===null||x===void 0?void 0:x.map(M=>{const O=d==null?void 0:d[M];if(O==null)throw new Error(`VRMSpringBoneLoaderPlugin: The spring #${p} attempted to use a colliderGroup ${M} but not found`);return O});b.traverse(M=>{var O;const L=(O=M.children[0])!==null&&O!==void 0?O:null,C=this._importJoint(M,L,P,E);T&&(C.center=T),c.addJoint(C)})})}),e.scene.updateMatrixWorld(),c.setInitState(),c})}_importJoint(e,t,i,r){const s=new eae(e,t,i,r);if(this.jointHelperRoot){const o=new Yoe(s);this.jointHelperRoot.add(o),o.renderOrder=this.jointHelperRoot.renderOrder}return s}_importSphereCollider(e,t){const{offset:i,radius:r}=t,s=new U2({offset:i,radius:r}),o=new b1(s);if(e.add(o),this.colliderHelperRoot){const a=new x1(o);this.colliderHelperRoot.add(a),a.renderOrder=this.colliderHelperRoot.renderOrder}return o}_importCapsuleCollider(e,t){const{offset:i,radius:r,tail:s}=t,o=new N2({offset:i,radius:r,tail:s}),a=new b1(o);if(e.add(a),this.colliderHelperRoot){const l=new x1(a);this.colliderHelperRoot.add(l),l.renderOrder=this.colliderHelperRoot.renderOrder}return a}}qa.EXTENSION_NAME="VRMC_springBone";class iae{get name(){return"VRMLoaderPlugin"}constructor(e,t){var i,r,s,o,a,l,u,c,h,d;this.parser=e;const f=t==null?void 0:t.helperRoot,p=t==null?void 0:t.autoUpdateHumanBones;this.expressionPlugin=(i=t==null?void 0:t.expressionPlugin)!==null&&i!==void 0?i:new Eg(e),this.firstPersonPlugin=(r=t==null?void 0:t.firstPersonPlugin)!==null&&r!==void 0?r:new Vse(e),this.humanoidPlugin=(s=t==null?void 0:t.humanoidPlugin)!==null&&s!==void 0?s:new $se(e,{helperRoot:f,autoUpdateHumanBones:p}),this.lookAtPlugin=(o=t==null?void 0:t.lookAtPlugin)!==null&&o!==void 0?o:new D2(e,{helperRoot:f}),this.metaPlugin=(a=t==null?void 0:t.metaPlugin)!==null&&a!==void 0?a:new uoe(e),this.mtoonMaterialPlugin=(l=t==null?void 0:t.mtoonMaterialPlugin)!==null&&l!==void 0?l:new Lu(e),this.materialsHDREmissiveMultiplierPlugin=(u=t==null?void 0:t.materialsHDREmissiveMultiplierPlugin)!==null&&u!==void 0?u:new Pd(e),this.materialsV0CompatPlugin=(c=t==null?void 0:t.materialsV0CompatPlugin)!==null&&c!==void 0?c:new Soe(e),this.springBonePlugin=(h=t==null?void 0:t.springBonePlugin)!==null&&h!==void 0?h:new qa(e,{colliderHelperRoot:f,jointHelperRoot:f}),this.nodeConstraintPlugin=(d=t==null?void 0:t.nodeConstraintPlugin)!==null&&d!==void 0?d:new Ya(e,{helperRoot:f})}beforeRoot(){return gp(this,void 0,void 0,function*(){yield this.materialsV0CompatPlugin.beforeRoot(),yield this.mtoonMaterialPlugin.beforeRoot()})}loadMesh(e){return gp(this,void 0,void 0,function*(){return yield this.mtoonMaterialPlugin.loadMesh(e)})}getMaterialType(e){const t=this.mtoonMaterialPlugin.getMaterialType(e);return t??null}extendMaterialParams(e,t){return gp(this,void 0,void 0,function*(){yield this.materialsHDREmissiveMultiplierPlugin.extendMaterialParams(e,t),yield this.mtoonMaterialPlugin.extendMaterialParams(e,t)})}afterRoot(e){return gp(this,void 0,void 0,function*(){yield this.metaPlugin.afterRoot(e),yield this.humanoidPlugin.afterRoot(e),yield this.expressionPlugin.afterRoot(e),yield this.lookAtPlugin.afterRoot(e),yield this.firstPersonPlugin.afterRoot(e),yield this.springBonePlugin.afterRoot(e),yield this.nodeConstraintPlugin.afterRoot(e),yield this.mtoonMaterialPlugin.afterRoot(e);const t=e.userData.vrmMeta,i=e.userData.vrmHumanoid;if(t&&i){const r=new hoe({scene:e.scene,expressionManager:e.userData.vrmExpressionManager,firstPerson:e.userData.vrmFirstPerson,humanoid:i,lookAt:e.userData.vrmLookAt,meta:t,materials:e.userData.vrmMToonMaterials,springBoneManager:e.userData.vrmSpringBoneManager,nodeConstraintManager:e.userData.vrmNodeConstraintManager});e.userData.vrm=r}})}}function M1(n){if(Object.values(n).forEach(e=>{e!=null&&e.isTexture&&e.dispose()}),n.isShaderMaterial){const e=n.uniforms;e&&Object.values(e).forEach(t=>{const i=t.value;i!=null&&i.isTexture&&i.dispose()})}n.dispose()}function rae(n){const e=n.geometry;e&&e.dispose();const t=n.skeleton;t&&t.dispose();const i=n.material;i&&(Array.isArray(i)?i.forEach(r=>M1(r)):i&&M1(i))}function sae(n){n.traverse(rae)}function oae(n){const e=new Map;n.traverse(t=>{if(t.type!=="SkinnedMesh")return;const i=t,s=i.geometry.getAttribute("skinIndex");let o=e.get(s);if(!o){const a=[],l=[],u={},c=s.array;for(let h=0;h<c.length;h++){const d=c[h];u[d]===void 0&&(u[d]=a.length,a.push(i.skeleton.bones[d]),l.push(i.skeleton.boneInverses[d])),c[h]=u[d]}s.copyArray(c),s.needsUpdate=!0,o=new Hd(a,l),e.set(s,o)}i.bind(o,new Qe)})}function aae(n){const e=new Map;n.traverse(t=>{var i,r,s,o;if(!t.isMesh)return;const a=t,l=a.geometry,u=l.index;if(u==null)return;const c=e.get(l);if(c!=null){a.geometry=c;return}const h=new kn;h.name=l.name,h.morphTargetsRelative=l.morphTargetsRelative,l.groups.forEach(_=>{h.addGroup(_.start,_.count,_.materialIndex)}),h.boundingBox=(r=(i=l.boundingBox)===null||i===void 0?void 0:i.clone())!==null&&r!==void 0?r:null,h.boundingSphere=(o=(s=l.boundingSphere)===null||s===void 0?void 0:s.clone())!==null&&o!==void 0?o:null,h.setDrawRange(l.drawRange.start,l.drawRange.count),h.userData=l.userData,e.set(l,h);const d=[],f=[];{const _=u.array,m=new _.constructor(_.length);let g=0;for(let v=0;v<_.length;v++){const y=_[v];let x=d[y];x==null&&(d[y]=g,f[g]=y,x=g,g++),m[v]=x}h.setIndex(new Nt(m,1,!1))}Object.keys(l.attributes).forEach(_=>{const m=l.attributes[_];if(m.isInterleavedBufferAttribute)throw new Error("removeUnnecessaryVertices: InterleavedBufferAttribute is not supported");const g=m.array,{itemSize:v,normalized:y}=m,x=new g.constructor(f.length*v);f.forEach((b,S)=>{for(let T=0;T<v;T++)x[S*v+T]=g[b*v+T]}),h.setAttribute(_,new Nt(x,v,y))});let p=!0;Object.keys(l.morphAttributes).forEach(_=>{h.morphAttributes[_]=[];const m=l.morphAttributes[_];for(let g=0;g<m.length;g++){const v=m[g];if(v.isInterleavedBufferAttribute)throw new Error("removeUnnecessaryVertices: InterleavedBufferAttribute is not supported");const y=v.array,{itemSize:x,normalized:b}=v,S=new y.constructor(f.length*x);f.forEach((T,P)=>{for(let E=0;E<x;E++)S[P*x+E]=y[T*x+E]}),p=p&&S.every(T=>T===0),h.morphAttributes[_][g]=new Nt(S,x,b)}}),p&&(h.morphAttributes={}),a.geometry=h}),Array.from(e.keys()).forEach(t=>{t.dispose()})}function lae(n){var e;((e=n.meta)===null||e===void 0?void 0:e.metaVersion)==="0"&&(n.scene.rotation.y=Math.PI)}class hc{constructor(){}}hc.deepDispose=sae;hc.removeUnnecessaryJoints=oae;hc.removeUnnecessaryVertices=aae;hc.rotateVRM0=lae;function w1(n,e){if(e===_Q)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(e===Ry||e===QO){let t=n.getIndex();if(t===null){const o=[],a=n.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)o.push(l);n.setIndex(o),t=n.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n}const i=t.count-2,r=[];if(e===Ry)for(let o=1;o<=i;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<i;o++)o%2===0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(r),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}class V2 extends Cc{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new fae(t)}),this.register(function(t){return new bae(t)}),this.register(function(t){return new Sae(t)}),this.register(function(t){return new Eae(t)}),this.register(function(t){return new mae(t)}),this.register(function(t){return new gae(t)}),this.register(function(t){return new _ae(t)}),this.register(function(t){return new vae(t)}),this.register(function(t){return new dae(t)}),this.register(function(t){return new yae(t)}),this.register(function(t){return new pae(t)}),this.register(function(t){return new xae(t)}),this.register(function(t){return new cae(t)}),this.register(function(t){return new Tae(t)}),this.register(function(t){return new Mae(t)})}load(e,t,i,r){const s=this;let o;this.resourcePath!==""?o=this.resourcePath:this.path!==""?o=this.path:o=Ny.extractUrlBase(e),this.manager.itemStart(e);const a=function(u){r?r(u):console.error(u),s.manager.itemError(e),s.manager.itemEnd(e)},l=new P2(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(u){try{s.parse(u,o,function(c){t(c),s.manager.itemEnd(e)},a)}catch(c){a(c)}},i,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){let s;const o={},a={},l=new TextDecoder;if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(l.decode(new Uint8Array(e,0,4))===G2){try{o[bt.KHR_BINARY_GLTF]=new wae(e)}catch(h){r&&r(h);return}s=JSON.parse(o[bt.KHR_BINARY_GLTF].content)}else s=JSON.parse(l.decode(e));else s=e;if(s.asset===void 0||s.asset.version[0]<2){r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const u=new kae(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});u.fileLoader.setRequestHeader(this.requestHeader);for(let c=0;c<this.pluginCallbacks.length;c++){const h=this.pluginCallbacks[c](u);a[h.name]=h,o[h.name]=!0}if(s.extensionsUsed)for(let c=0;c<s.extensionsUsed.length;++c){const h=s.extensionsUsed[c],d=s.extensionsRequired||[];switch(h){case bt.KHR_MATERIALS_UNLIT:o[h]=new hae;break;case bt.KHR_DRACO_MESH_COMPRESSION:o[h]=new Aae(s,this.dracoLoader);break;case bt.KHR_TEXTURE_TRANSFORM:o[h]=new Pae;break;case bt.KHR_MESH_QUANTIZATION:o[h]=new Cae;break;default:d.indexOf(h)>=0&&a[h]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+h+'".')}}u.setExtensions(o),u.setPlugins(a),u.parse(i,r)}parseAsync(e,t){const i=this;return new Promise(function(r,s){i.parse(e,t,r,s)})}}function uae(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const bt={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class cae{constructor(e){this.parser=e,this.name=bt.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,r=t.length;i<r;i++){const s=t[i];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let r=t.cache.get(i);if(r)return r;const s=t.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let u;const c=new We(16777215);l.color!==void 0&&c.fromArray(l.color);const h=l.range!==void 0?l.range:0;switch(l.type){case"directional":u=new R2(c),u.target.position.set(0,0,-1),u.add(u.target);break;case"point":u=new _se(c),u.distance=h;break;case"spot":u=new mse(c),u.distance=h,l.spot=l.spot||{},l.spot.innerConeAngle=l.spot.innerConeAngle!==void 0?l.spot.innerConeAngle:0,l.spot.outerConeAngle=l.spot.outerConeAngle!==void 0?l.spot.outerConeAngle:Math.PI/4,u.angle=l.spot.outerConeAngle,u.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,u.target.position.set(0,0,-1),u.add(u.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return u.position.set(0,0,0),u.decay=2,To(u,l),l.intensity!==void 0&&(u.intensity=l.intensity),u.name=t.createUniqueName(l.name||"light_"+e),r=Promise.resolve(u),t.cache.add(i,r),r}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,s=i.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(l){return i._getNodeRef(t.cache,a,l)})}}class hae{constructor(){this.name=bt.KHR_MATERIALS_UNLIT}getMaterialType(){return Hs}extendParams(e,t,i){const r=[];e.color=new We(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}s.baseColorTexture!==void 0&&r.push(i.assignTexture(e,"map",s.baseColorTexture,nt))}return Promise.all(r)}}class dae{constructor(e){this.parser=e,this.name=bt.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return s!==void 0&&(t.emissiveIntensity=s),Promise.resolve()}}class fae{constructor(e){this.parser=e,this.name=bt.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Jo}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(o.clearcoatFactor!==void 0&&(t.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&s.push(i.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&s.push(i.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(s.push(i.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Ze(a,a)}return Promise.all(s)}}class pae{constructor(e){this.parser=e,this.name=bt.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Jo}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.iridescenceFactor!==void 0&&(t.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&s.push(i.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(t.iridescenceIOR=o.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&s.push(i.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class mae{constructor(e){this.parser=e,this.name=bt.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Jo}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new We(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];return o.sheenColorFactor!==void 0&&t.sheenColor.fromArray(o.sheenColorFactor),o.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&s.push(i.assignTexture(t,"sheenColorMap",o.sheenColorTexture,nt)),o.sheenRoughnessTexture!==void 0&&s.push(i.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class gae{constructor(e){this.parser=e,this.name=bt.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Jo}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.transmissionFactor!==void 0&&(t.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&s.push(i.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class _ae{constructor(e){this.parser=e,this.name=bt.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Jo}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&s.push(i.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=new We(a[0],a[1],a[2]),Promise.all(s)}}class vae{constructor(e){this.parser=e,this.name=bt.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Jo}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}}class yae{constructor(e){this.parser=e,this.name=bt.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Jo}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&s.push(i.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=new We(a[0],a[1],a[2]),o.specularColorTexture!==void 0&&s.push(i.assignTexture(t,"specularColorMap",o.specularColorTexture,nt)),Promise.all(s)}}class xae{constructor(e){this.parser=e,this.name=bt.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Jo}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.anisotropyStrength!==void 0&&(t.anisotropy=o.anisotropyStrength),o.anisotropyRotation!==void 0&&(t.anisotropyRotation=o.anisotropyRotation),o.anisotropyTexture!==void 0&&s.push(i.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}}class bae{constructor(e){this.parser=e,this.name=bt.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,r=i.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class Sae{constructor(e){this.parser=e,this.name=bt.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=i.textureLoader;if(a.uri){const u=i.options.manager.getHandler(a.uri);u!==null&&(l=u)}return this.detectSupport().then(function(u){if(u)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class Eae{constructor(e){this.parser=e,this.name=bt.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=i.textureLoader;if(a.uri){const u=i.options.manager.getHandler(a.uri);u!==null&&(l=u)}return this.detectSupport().then(function(u){if(u)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class Tae{constructor(e){this.name=bt.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const r=i.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const l=r.byteOffset||0,u=r.byteLength||0,c=r.count,h=r.byteStride,d=new Uint8Array(a,l,u);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(c,h,d,r.mode,r.filter).then(function(f){return f.buffer}):o.ready.then(function(){const f=new ArrayBuffer(c*h);return o.decodeGltfBuffer(new Uint8Array(f),c,h,d,r.mode,r.filter),f})})}else return null}}class Mae{constructor(e){this.name=bt.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||i.mesh===void 0)return null;const r=t.meshes[i.mesh];for(const u of r.primitives)if(u.mode!==Hi.TRIANGLES&&u.mode!==Hi.TRIANGLE_STRIP&&u.mode!==Hi.TRIANGLE_FAN&&u.mode!==void 0)return null;const o=i.extensions[this.name].attributes,a=[],l={};for(const u in o)a.push(this.parser.getDependency("accessor",o[u]).then(c=>(l[u]=c,l[u])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(u=>{const c=u.pop(),h=c.isGroup?c.children:[c],d=u[0].count,f=[];for(const p of h){const _=new Qe,m=new z,g=new Xe,v=new z(1,1,1),y=new tse(p.geometry,p.material,d);for(let x=0;x<d;x++)l.TRANSLATION&&m.fromBufferAttribute(l.TRANSLATION,x),l.ROTATION&&g.fromBufferAttribute(l.ROTATION,x),l.SCALE&&v.fromBufferAttribute(l.SCALE,x),y.setMatrixAt(x,_.compose(m,g,v));for(const x in l)x!=="TRANSLATION"&&x!=="ROTATION"&&x!=="SCALE"&&p.geometry.setAttribute(x,l[x]);Ft.prototype.copy.call(y,p),this.parser.assignFinalMaterial(y),f.push(y)}return c.isGroup?(c.clear(),c.add(...f),c):f[0]}))}}const G2="glTF",ah=12,A1={JSON:1313821514,BIN:5130562};class wae{constructor(e){this.name=bt.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,ah),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==G2)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-ah,s=new DataView(e,ah);let o=0;for(;o<r;){const a=s.getUint32(o,!0);o+=4;const l=s.getUint32(o,!0);if(o+=4,l===A1.JSON){const u=new Uint8Array(e,ah+o,a);this.content=i.decode(u)}else if(l===A1.BIN){const u=ah+o;this.body=e.slice(u,u+a)}o+=a}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Aae{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=bt.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},u={};for(const c in o){const h=Hy[c]||c.toLowerCase();a[h]=o[c]}for(const c in e.attributes){const h=Hy[c]||c.toLowerCase();if(o[c]!==void 0){const d=i.accessors[e.attributes[c]],f=Ou[d.componentType];u[h]=f.name,l[h]=d.normalized===!0}}return t.getDependency("bufferView",s).then(function(c){return new Promise(function(h){r.decodeDracoFile(c,function(d){for(const f in d.attributes){const p=d.attributes[f],_=l[f];_!==void 0&&(p.normalized=_)}h(d)},a,u)})})}}class Pae{constructor(){this.name=bt.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class Cae{constructor(){this.name=bt.KHR_MESH_QUANTIZATION}}class H2 extends Wd{constructor(e,t,i,r){super(e,t,i,r)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=i[s+o];return t}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=a*2,u=a*3,c=r-t,h=(i-t)/c,d=h*h,f=d*h,p=e*u,_=p-u,m=-2*f+3*d,g=f-d,v=1-m,y=g-d+h;for(let x=0;x!==a;x++){const b=o[_+x+a],S=o[_+x+l]*c,T=o[p+x+a],P=o[p+x]*c;s[x]=v*b+y*S+m*T+g*P}return s}}const Rae=new Xe;class Iae extends H2{interpolate_(e,t,i,r){const s=super.interpolate_(e,t,i,r);return Rae.fromArray(s).normalize().toArray(s),s}}const Hi={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Ou={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},P1={9728:Dn,9729:mi,9984:Cy,9985:jO,9986:Fp,9987:pl},C1={33071:Ki,33648:dm,10497:ic},Nv={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Hy={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},_o={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Lae={CUBICSPLINE:void 0,LINEAR:sc,STEP:Td},Uv={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Oae(n){return n.DefaultMaterial===void 0&&(n.DefaultMaterial=new vS({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Ks})),n.DefaultMaterial}function Sa(n,e,t){for(const i in t.extensions)n[i]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function To(n,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Dae(n,e,t){let i=!1,r=!1,s=!1;for(let u=0,c=e.length;u<c;u++){const h=e[u];if(h.POSITION!==void 0&&(i=!0),h.NORMAL!==void 0&&(r=!0),h.COLOR_0!==void 0&&(s=!0),i&&r&&s)break}if(!i&&!r&&!s)return Promise.resolve(n);const o=[],a=[],l=[];for(let u=0,c=e.length;u<c;u++){const h=e[u];if(i){const d=h.POSITION!==void 0?t.getDependency("accessor",h.POSITION):n.attributes.position;o.push(d)}if(r){const d=h.NORMAL!==void 0?t.getDependency("accessor",h.NORMAL):n.attributes.normal;a.push(d)}if(s){const d=h.COLOR_0!==void 0?t.getDependency("accessor",h.COLOR_0):n.attributes.color;l.push(d)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(u){const c=u[0],h=u[1],d=u[2];return i&&(n.morphAttributes.position=c),r&&(n.morphAttributes.normal=h),s&&(n.morphAttributes.color=d),n.morphTargetsRelative=!0,n})}function Fae(n,e){if(n.updateMorphTargets(),e.weights!==void 0)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,r=t.length;i<r;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Nae(n){let e;const t=n.extensions&&n.extensions[bt.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+Bv(t.attributes):e=n.indices+":"+Bv(n.attributes)+":"+n.mode,n.targets!==void 0)for(let i=0,r=n.targets.length;i<r;i++)e+=":"+Bv(n.targets[i]);return e}function Bv(n){let e="";const t=Object.keys(n).sort();for(let i=0,r=t.length;i<r;i++)e+=t[i]+":"+n[t[i]]+";";return e}function zy(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function Uae(n){return n.search(/\.jpe?g($|\?)/i)>0||n.search(/^data\:image\/jpeg/)===0?"image/jpeg":n.search(/\.webp($|\?)/i)>0||n.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const Bae=new Qe;class kae{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new uae,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,r=!1,s=-1;typeof navigator<"u"&&(i=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||i||r&&s<98?this.textureLoader=new fse(this.options.manager):this.textureLoader=new xse(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new P2(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:i,userData:{}};Sa(s,a,r),To(a,r),Promise.all(i._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(i[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const r=i.clone(),s=(o,a)=>{const l=this.associations.get(o);l!=null&&this.associations.set(a,l);for(const[u,c]of o.children.entries())s(c,a.children[u])};return s(i,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const r=e(t[i]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&i.push(s)}return i}getDependency(e,t){const i=e+":"+t;let r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e);break}this.cache.add(i,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this,r=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(r.map(function(s,o){return i.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[bt.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){i.load(Ny.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const r=t.byteLength||0,s=t.byteOffset||0;return i.slice(s,s+r)})}loadAccessor(e){const t=this,i=this.json,r=this.json.accessors[e];if(r.bufferView===void 0&&r.sparse===void 0){const o=Nv[r.type],a=Ou[r.componentType],l=r.normalized===!0,u=new a(r.count*o);return Promise.resolve(new Nt(u,o,l))}const s=[];return r.bufferView!==void 0?s.push(this.getDependency("bufferView",r.bufferView)):s.push(null),r.sparse!==void 0&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=Nv[r.type],u=Ou[r.componentType],c=u.BYTES_PER_ELEMENT,h=c*l,d=r.byteOffset||0,f=r.bufferView!==void 0?i.bufferViews[r.bufferView].byteStride:void 0,p=r.normalized===!0;let _,m;if(f&&f!==h){const g=Math.floor(d/f),v="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+g+":"+r.count;let y=t.cache.get(v);y||(_=new u(a,g*f,r.count*f/c),y=new Kre(_,f/c),t.cache.add(v,y)),m=new _S(y,l,d%f/c,p)}else a===null?_=new u(r.count*l):_=new u(a,d,r.count*l),m=new Nt(_,l,p);if(r.sparse!==void 0){const g=Nv.SCALAR,v=Ou[r.sparse.indices.componentType],y=r.sparse.indices.byteOffset||0,x=r.sparse.values.byteOffset||0,b=new v(o[1],y,r.sparse.count*g),S=new u(o[2],x,r.sparse.count*l);a!==null&&(m=new Nt(m.array.slice(),m.itemSize,m.normalized));for(let T=0,P=b.length;T<P;T++){const E=b[T];if(m.setX(E,S[T*l]),l>=2&&m.setY(E,S[T*l+1]),l>=3&&m.setZ(E,S[T*l+2]),l>=4&&m.setW(E,S[T*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return m})}loadTexture(e){const t=this.json,i=this.options,s=t.textures[e].source,o=t.images[s];let a=this.textureLoader;if(o.uri){const l=i.manager.getHandler(o.uri);l!==null&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,i){const r=this,s=this.json,o=s.textures[e],a=s.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const u=this.loadImageSource(t,i).then(function(c){c.flipY=!1,c.name=o.name||a.name||"",c.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(c.name=a.uri);const d=(s.samplers||{})[o.sampler]||{};return c.magFilter=P1[d.magFilter]||mi,c.minFilter=P1[d.minFilter]||pl,c.wrapS=C1[d.wrapS]||ic,c.wrapT=C1[d.wrapT]||ic,r.associations.set(c,{textures:e}),c}).catch(function(){return null});return this.textureCache[l]=u,u}loadImageSource(e,t){const i=this,r=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(h=>h.clone());const o=r.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",u=!1;if(o.bufferView!==void 0)l=i.getDependency("bufferView",o.bufferView).then(function(h){u=!0;const d=new Blob([h],{type:o.mimeType});return l=a.createObjectURL(d),l});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const c=Promise.resolve(l).then(function(h){return new Promise(function(d,f){let p=d;t.isImageBitmapLoader===!0&&(p=function(_){const m=new jn(_);m.needsUpdate=!0,d(m)}),t.load(Ny.resolveURL(h,s.path),p,void 0,f)})}).then(function(h){return u===!0&&a.revokeObjectURL(l),h.userData.mimeType=o.mimeType||Uae(o.uri),h}).catch(function(h){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),h});return this.sourceCache[e]=c,c}assignTexture(e,t,i,r){const s=this;return this.getDependency("texture",i.index).then(function(o){if(!o)return null;if(i.texCoord!==void 0&&i.texCoord>0&&(o=o.clone(),o.channel=i.texCoord),s.extensions[bt.KHR_TEXTURE_TRANSFORM]){const a=i.extensions!==void 0?i.extensions[bt.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[bt.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return r!==void 0&&(o.colorSpace=r),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const r=t.attributes.tangent===void 0,s=t.attributes.color!==void 0,o=t.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new E2,ss.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,l.sizeAttenuation=!1,this.cache.add(a,l)),i=l}else if(e.isLine){const a="LineBasicMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new Ml,ss.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,this.cache.add(a,l)),i=l}if(r||s||o){let a="ClonedMaterial:"+i.uuid+":";r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=i.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(i))),i=l}e.material=i}getMaterialType(){return vS}loadMaterial(e){const t=this,i=this.json,r=this.extensions,s=i.materials[e];let o;const a={},l=s.extensions||{},u=[];if(l[bt.KHR_MATERIALS_UNLIT]){const h=r[bt.KHR_MATERIALS_UNLIT];o=h.getMaterialType(),u.push(h.extendParams(a,s,t))}else{const h=s.pbrMetallicRoughness||{};if(a.color=new We(1,1,1),a.opacity=1,Array.isArray(h.baseColorFactor)){const d=h.baseColorFactor;a.color.fromArray(d),a.opacity=d[3]}h.baseColorTexture!==void 0&&u.push(t.assignTexture(a,"map",h.baseColorTexture,nt)),a.metalness=h.metallicFactor!==void 0?h.metallicFactor:1,a.roughness=h.roughnessFactor!==void 0?h.roughnessFactor:1,h.metallicRoughnessTexture!==void 0&&(u.push(t.assignTexture(a,"metalnessMap",h.metallicRoughnessTexture)),u.push(t.assignTexture(a,"roughnessMap",h.metallicRoughnessTexture))),o=this._invokeOne(function(d){return d.getMaterialType&&d.getMaterialType(e)}),u.push(Promise.all(this._invokeAll(function(d){return d.extendMaterialParams&&d.extendMaterialParams(e,a)})))}s.doubleSided===!0&&(a.side=qi);const c=s.alphaMode||Uv.OPAQUE;if(c===Uv.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,c===Uv.MASK&&(a.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&o!==Hs&&(u.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new Ze(1,1),s.normalTexture.scale!==void 0)){const h=s.normalTexture.scale;a.normalScale.set(h,h)}return s.occlusionTexture!==void 0&&o!==Hs&&(u.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&o!==Hs&&(a.emissive=new We().fromArray(s.emissiveFactor)),s.emissiveTexture!==void 0&&o!==Hs&&u.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,nt)),Promise.all(u).then(function(){const h=new o(a);return s.name&&(h.name=s.name),To(h,s),t.associations.set(h,{materials:e}),s.extensions&&Sa(r,h,s),h})}createUniqueName(e){const t=It.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,i=this.extensions,r=this.primitiveCache;function s(a){return i[bt.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return R1(l,a,t)})}const o=[];for(let a=0,l=e.length;a<l;a++){const u=e[a],c=Nae(u),h=r[c];if(h)o.push(h.promise);else{let d;u.extensions&&u.extensions[bt.KHR_DRACO_MESH_COMPRESSION]?d=s(u):d=R1(new kn,u,t),r[c]={primitive:u,promise:d},o.push(d)}}return Promise.all(o)}loadMesh(e){const t=this,i=this.json,r=this.extensions,s=i.meshes[e],o=s.primitives,a=[];for(let l=0,u=o.length;l<u;l++){const c=o[l].material===void 0?Oae(this.cache):this.getDependency("material",o[l].material);a.push(c)}return a.push(t.loadGeometries(o)),Promise.all(a).then(function(l){const u=l.slice(0,l.length-1),c=l[l.length-1],h=[];for(let f=0,p=c.length;f<p;f++){const _=c[f],m=o[f];let g;const v=u[f];if(m.mode===Hi.TRIANGLES||m.mode===Hi.TRIANGLE_STRIP||m.mode===Hi.TRIANGLE_FAN||m.mode===void 0)g=s.isSkinnedMesh===!0?new b2(_,v):new _i(_,v),g.isSkinnedMesh===!0&&g.normalizeSkinWeights(),m.mode===Hi.TRIANGLE_STRIP?g.geometry=w1(g.geometry,QO):m.mode===Hi.TRIANGLE_FAN&&(g.geometry=w1(g.geometry,Ry));else if(m.mode===Hi.LINES)g=new zd(_,v);else if(m.mode===Hi.LINE_STRIP)g=new bg(_,v);else if(m.mode===Hi.LINE_LOOP)g=new nse(_,v);else if(m.mode===Hi.POINTS)g=new ise(_,v);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+m.mode);Object.keys(g.geometry.morphAttributes).length>0&&Fae(g,s),g.name=t.createUniqueName(s.name||"mesh_"+e),To(g,s),m.extensions&&Sa(r,g,m),t.assignFinalMaterial(g),h.push(g)}for(let f=0,p=h.length;f<p;f++)t.associations.set(h[f],{meshes:e,primitives:f});if(h.length===1)return s.extensions&&Sa(r,h[0],s),h[0];const d=new Ri;s.extensions&&Sa(r,d,s),t.associations.set(d,{meshes:e});for(let f=0,p=h.length;f<p;f++)d.add(h[f]);return d})}loadCamera(e){let t;const i=this.json.cameras[e],r=i[i.type];if(!r){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return i.type==="perspective"?t=new si(Kt.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):i.type==="orthographic"&&(t=new mS(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),To(t,i),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],i=[];for(let r=0,s=t.joints.length;r<s;r++)i.push(this._loadNodeShallow(t.joints[r]));return t.inverseBindMatrices!==void 0?i.push(this.getDependency("accessor",t.inverseBindMatrices)):i.push(null),Promise.all(i).then(function(r){const s=r.pop(),o=r,a=[],l=[];for(let u=0,c=o.length;u<c;u++){const h=o[u];if(h){a.push(h);const d=new Qe;s!==null&&d.fromArray(s.array,u*16),l.push(d)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[u])}return new Hd(a,l)})}loadAnimation(e){const t=this.json,i=this,r=t.animations[e],s=r.name?r.name:"animation_"+e,o=[],a=[],l=[],u=[],c=[];for(let h=0,d=r.channels.length;h<d;h++){const f=r.channels[h],p=r.samplers[f.sampler],_=f.target,m=_.node,g=r.parameters!==void 0?r.parameters[p.input]:p.input,v=r.parameters!==void 0?r.parameters[p.output]:p.output;_.node!==void 0&&(o.push(this.getDependency("node",m)),a.push(this.getDependency("accessor",g)),l.push(this.getDependency("accessor",v)),u.push(p),c.push(_))}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(u),Promise.all(c)]).then(function(h){const d=h[0],f=h[1],p=h[2],_=h[3],m=h[4],g=[];for(let v=0,y=d.length;v<y;v++){const x=d[v],b=f[v],S=p[v],T=_[v],P=m[v];if(x===void 0)continue;x.updateMatrix&&(x.updateMatrix(),x.matrixAutoUpdate=!0);const E=i._createAnimationTracks(x,b,S,T,P);if(E)for(let M=0;M<E.length;M++)g.push(E[M])}return new gm(s,void 0,g)})}createNodeMesh(e){const t=this.json,i=this,r=t.nodes[e];return r.mesh===void 0?null:i.getDependency("mesh",r.mesh).then(function(s){const o=i._getNodeRef(i.meshCache,r.mesh,s);return r.weights!==void 0&&o.traverse(function(a){if(a.isMesh)for(let l=0,u=r.weights.length;l<u;l++)a.morphTargetInfluences[l]=r.weights[l]}),o})}loadNode(e){const t=this.json,i=this,r=t.nodes[e],s=i._loadNodeShallow(e),o=[],a=r.children||[];for(let u=0,c=a.length;u<c;u++)o.push(i.getDependency("node",a[u]));const l=r.skin===void 0?Promise.resolve(null):i.getDependency("skin",r.skin);return Promise.all([s,Promise.all(o),l]).then(function(u){const c=u[0],h=u[1],d=u[2];d!==null&&c.traverse(function(f){f.isSkinnedMesh&&f.bind(d,Bae)});for(let f=0,p=h.length;f<p;f++)c.add(h[f]);return c})}_loadNodeShallow(e){const t=this.json,i=this.extensions,r=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=t.nodes[e],o=s.name?r.createUniqueName(s.name):"",a=[],l=r._invokeOne(function(u){return u.createNodeMesh&&u.createNodeMesh(e)});return l&&a.push(l),s.camera!==void 0&&a.push(r.getDependency("camera",s.camera).then(function(u){return r._getNodeRef(r.cameraCache,s.camera,u)})),r._invokeAll(function(u){return u.createNodeAttachment&&u.createNodeAttachment(e)}).forEach(function(u){a.push(u)}),this.nodeCache[e]=Promise.all(a).then(function(u){let c;if(s.isBone===!0?c=new S2:u.length>1?c=new Ri:u.length===1?c=u[0]:c=new Ft,c!==u[0])for(let h=0,d=u.length;h<d;h++)c.add(u[h]);if(s.name&&(c.userData.name=s.name,c.name=o),To(c,s),s.extensions&&Sa(i,c,s),s.matrix!==void 0){const h=new Qe;h.fromArray(s.matrix),c.applyMatrix4(h)}else s.translation!==void 0&&c.position.fromArray(s.translation),s.rotation!==void 0&&c.quaternion.fromArray(s.rotation),s.scale!==void 0&&c.scale.fromArray(s.scale);return r.associations.has(c)||r.associations.set(c,{}),r.associations.get(c).nodes=e,c}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],r=this,s=new Ri;i.name&&(s.name=r.createUniqueName(i.name)),To(s,i),i.extensions&&Sa(t,s,i);const o=i.nodes||[],a=[];for(let l=0,u=o.length;l<u;l++)a.push(r.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let c=0,h=l.length;c<h;c++)s.add(l[c]);const u=c=>{const h=new Map;for(const[d,f]of r.associations)(d instanceof ss||d instanceof jn)&&h.set(d,f);return c.traverse(d=>{const f=r.associations.get(d);f!=null&&h.set(d,f)}),h};return r.associations=u(s),s})}_createAnimationTracks(e,t,i,r,s){const o=[],a=e.name?e.name:e.uuid,l=[];_o[s.path]===_o.weights?e.traverse(function(d){d.morphTargetInfluences&&l.push(d.name?d.name:d.uuid)}):l.push(a);let u;switch(_o[s.path]){case _o.weights:u=gl;break;case _o.rotation:u=_l;break;case _o.position:case _o.scale:default:switch(i.itemSize){case 1:u=gl;break;case 2:case 3:u=lc;break}break}const c=r.interpolation!==void 0?Lae[r.interpolation]:sc,h=this._getArrayFromAccessor(i);for(let d=0,f=l.length;d<f;d++){const p=new u(l[d]+"."+_o[s.path],t.array,h,c);c==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(p),o.push(p)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const i=zy(t.constructor),r=new Float32Array(t.length);for(let s=0,o=t.length;s<o;s++)r[s]=t[s]*i;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(i){const r=this instanceof _l?Iae:H2;return new r(this.times,this.values,this.getValueSize()/3,i)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function Vae(n,e,t){const i=e.attributes,r=new to;if(i.POSITION!==void 0){const a=t.json.accessors[i.POSITION],l=a.min,u=a.max;if(l!==void 0&&u!==void 0){if(r.set(new z(l[0],l[1],l[2]),new z(u[0],u[1],u[2])),a.normalized){const c=zy(Ou[a.componentType]);r.min.multiplyScalar(c),r.max.multiplyScalar(c)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const a=new z,l=new z;for(let u=0,c=s.length;u<c;u++){const h=s[u];if(h.POSITION!==void 0){const d=t.json.accessors[h.POSITION],f=d.min,p=d.max;if(f!==void 0&&p!==void 0){if(l.setX(Math.max(Math.abs(f[0]),Math.abs(p[0]))),l.setY(Math.max(Math.abs(f[1]),Math.abs(p[1]))),l.setZ(Math.max(Math.abs(f[2]),Math.abs(p[2]))),d.normalized){const _=zy(Ou[d.componentType]);l.multiplyScalar(_)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}n.boundingBox=r;const o=new fs;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,n.boundingSphere=o}function R1(n,e,t){const i=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(l){n.setAttribute(a,l)})}for(const o in i){const a=Hy[o]||o.toLowerCase();a in n.attributes||r.push(s(i[o],a))}if(e.indices!==void 0&&!n.index){const o=t.getDependency("accessor",e.indices).then(function(a){n.setIndex(a)});r.push(o)}return To(n,e),Vae(n,e,t),Promise.all(r).then(function(){return e.targets!==void 0?Dae(n,e.targets,t):n})}const Gae=.5,Hae=.05,I1=5,L1=new z,O1=new Xe,D1=new Zo;class zae extends cc{constructor(t,i){super(t,i);rt(this,"smoothFactor",4);rt(this,"userLimitAngle",90);rt(this,"userTarget");rt(this,"enableSaccade");rt(this,"_saccadeYaw",0);rt(this,"_saccadePitch",0);rt(this,"_saccadeTimer",0);rt(this,"_yawDamped",0);rt(this,"_pitchDamped",0);rt(this,"_tempFirstPersonBoneQuat",new Xe);this.enableSaccade=!0}update(t){if(this.target&&this.autoUpdate){this.lookAt(this.target.getWorldPosition(L1));const i=this._yaw,r=this._pitch;let s=i,o=r;if(this.userTarget){this.lookAt(this.userTarget.getWorldPosition(L1)),(this.userLimitAngle<Math.abs(this._yaw)||this.userLimitAngle<Math.abs(this._pitch))&&(this._yaw=i,this._pitch=r);const a=1-Math.exp(-this.smoothFactor*t);this._yawDamped+=(this._yaw-this._yawDamped)*a,this._pitchDamped+=(this._pitch-this._pitchDamped)*a;const l=1-Kt.smoothstep(Math.sqrt(i*i+r*r),30,90);s=Kt.lerp(i,.6*this._yawDamped,l),o=Kt.lerp(r,.6*this._pitchDamped,l),D1.set(-this._pitchDamped*Kt.DEG2RAD,this._yawDamped*Kt.DEG2RAD,0,cc.EULER_ORDER),O1.setFromEuler(D1);const u=this.humanoid.getRawBoneNode("head");this._tempFirstPersonBoneQuat.copy(u.quaternion),u.quaternion.slerp(O1,.4),u.updateMatrixWorld()}this.enableSaccade&&(Gae<this._saccadeTimer&&Math.random()<Hae&&(this._saccadeYaw=(2*Math.random()-1)*I1,this._saccadePitch=(2*Math.random()-1)*I1,this._saccadeTimer=0),this._saccadeTimer+=t,s+=this._saccadeYaw,o+=this._saccadePitch,this.applier.applyYawPitch(s,o)),this._needsUpdate=!1}this._needsUpdate&&(this._needsUpdate=!1,this.applier.applyYawPitch(this._yaw,this._pitch))}revertFirstPersonBoneQuat(){this.userTarget&&this.humanoid.getNormalizedBoneNode("head").quaternion.copy(this._tempFirstPersonBoneQuat)}}class Wae extends D2{get name(){return"VRMLookAtSmootherLoaderPlugin"}async afterRoot(e){await super.afterRoot(e);const t=e.userData.vrmHumanoid,i=e.userData.vrmLookAt;if(t!=null&&i!=null){const r=new zae(t,i.applier);r.copy(i),e.userData.vrmLookAt=r}}}const F1=2048;class Xae{constructor(e){rt(this,"audio");rt(this,"analyser");rt(this,"timeDomainData");this.audio=e,this.analyser=e.createAnalyser(),this.timeDomainData=new Float32Array(F1)}update(){this.analyser.getFloatTimeDomainData(this.timeDomainData);let e=0;for(let t=0;t<F1;t++)e=Math.max(e,Math.abs(this.timeDomainData[t]));return e=1/(1+Math.exp(-45*e+5)),e<.1&&(e=0),{volume:e}}async playFromArrayBuffer(e,t){const i=await this.audio.decodeAudioData(e),r=this.audio.createBufferSource();r.buffer=i,r.connect(this.audio.destination),r.connect(this.analyser),r.start(),t&&r.addEventListener("ended",t)}async playFromURL(e,t){const r=await(await fetch(e)).arrayBuffer();this.playFromArrayBuffer(r,t)}}class jae{constructor(e,t){rt(this,"_lookAtTarget");this._lookAtTarget=new Ft,t.add(this._lookAtTarget),e.lookAt&&(e.lookAt.target=this._lookAtTarget)}}const $ae=.12,Yae=5;class qae{constructor(e){rt(this,"_expressionManager");rt(this,"_remainingTime");rt(this,"_isOpen");rt(this,"_isAutoBlink");this._expressionManager=e,this._remainingTime=0,this._isAutoBlink=!0,this._isOpen=!0}setEnable(e){return this._isAutoBlink=e,this._isOpen?0:this._remainingTime}update(e){if(this._remainingTime>0){this._remainingTime-=e;return}if(this._isOpen&&this._isAutoBlink){this.close();return}this.open()}close(){this._isOpen=!1,this._remainingTime=$ae,this._expressionManager.setValue("blink",1)}open(){this._isOpen=!0,this._remainingTime=Yae,this._expressionManager.setValue("blink",0)}}class Kae{constructor(e,t){rt(this,"_autoLookAt");rt(this,"_autoBlink");rt(this,"_expressionManager");rt(this,"_currentEmotion");rt(this,"_currentLipSync");this._autoLookAt=new jae(e,t),this._currentEmotion="neutral",this._currentLipSync=null,e.expressionManager&&(this._expressionManager=e.expressionManager,this._autoBlink=new qae(e.expressionManager))}playEmotion(e){var i,r,s;if(this._currentEmotion!="neutral"&&((i=this._expressionManager)==null||i.setValue(this._currentEmotion,0)),e=="neutral"){(r=this._autoBlink)==null||r.setEnable(!0),this._currentEmotion=e;return}const t=((s=this._autoBlink)==null?void 0:s.setEnable(!1))||0;this._currentEmotion=e,setTimeout(()=>{var o;(o=this._expressionManager)==null||o.setValue(e,1)},t*1e3)}lipSync(e,t){var i;this._currentLipSync&&((i=this._expressionManager)==null||i.setValue(this._currentLipSync.preset,0)),this._currentLipSync={preset:e,value:t}}update(e){var t;if(this._autoBlink&&this._autoBlink.update(e),this._currentLipSync){const i=this._currentEmotion==="neutral"?this._currentLipSync.value*.5:this._currentLipSync.value*.25;(t=this._expressionManager)==null||t.setValue(this._currentLipSync.preset,i)}}}class Zae{constructor(e,t){rt(this,"_expressionController");this._expressionController=new Kae(e,t)}playEmotion(e){this._expressionController.playEmotion(e)}lipSync(e,t){this._expressionController.lipSync(e,t)}update(e){this._expressionController.update(e)}}class Jae{constructor(e){rt(this,"vrm");rt(this,"mixer");rt(this,"emoteController");rt(this,"_lookAtTargetParent");rt(this,"_lipSync");this._lookAtTargetParent=e,this._lipSync=new Xae(new AudioContext)}async loadVRM(e){const t=new V2;t.register(s=>new iae(s,{lookAtPlugin:new Wae(s)}));const i=await t.loadAsync(e),r=this.vrm=i.userData.vrm;r.scene.name="VRMRoot",hc.rotateVRM0(r),this.mixer=new Dse(r.scene),this.emoteController=new Zae(r,this._lookAtTargetParent)}unLoadVrm(){this.vrm&&(hc.deepDispose(this.vrm.scene),this.vrm=null)}async loadAnimation(e){const{vrm:t,mixer:i}=this;if(t==null||i==null)throw new Error("You have to load VRM first");const r=e.createAnimationClip(t);i.clipAction(r).play()}async speak(e){await new Promise(t=>{var i;(i=this._lipSync)==null||i.playFromArrayBuffer(e,()=>{t(!0)})})}update(e){var t,i,r,s;if(this._lipSync){const{volume:o}=this._lipSync.update();(t=this.emoteController)==null||t.lipSync("aa",o)}(i=this.emoteController)==null||i.update(e),(r=this.mixer)==null||r.update(e),(s=this.vrm)==null||s.update(e)}}class Qae{constructor(){rt(this,"duration");rt(this,"restHipsPosition");rt(this,"humanoidTracks");rt(this,"expressionTracks");rt(this,"lookAtTrack");this.duration=0,this.restHipsPosition=new z,this.humanoidTracks={translation:new Map,rotation:new Map},this.expressionTracks=new Map,this.lookAtTrack=null}createAnimationClip(e){const t=[];if(t.push(...this.createHumanoidTracks(e)),e.expressionManager!=null&&t.push(...this.createExpressionTracks(e.expressionManager)),e.lookAt!=null){const i=this.createLookAtTrack("lookAtTargetParent.quaternion");i!=null&&t.push(i)}return new gm("Clip",this.duration,t)}createHumanoidTracks(e){var s,o;const t=e.humanoid,i=e.meta.metaVersion,r=[];for(const[a,l]of this.humanoidTracks.rotation.entries()){const u=(s=t.getNormalizedBoneNode(a))==null?void 0:s.name;if(u!=null){const c=new lc(`${u}.quaternion`,l.times,l.values.map((h,d)=>i==="0"&&d%2===0?-h:h));r.push(c)}}for(const[a,l]of this.humanoidTracks.translation.entries()){const u=(o=t.getNormalizedBoneNode(a))==null?void 0:o.name;if(u!=null){const c=this.restHipsPosition.y,d=t.getNormalizedAbsolutePose().hips.position[1]/c,f=l.clone();f.values=f.values.map((p,_)=>(i==="0"&&_%3!==1?-p:p)*d),f.name=`${u}.position`,r.push(f)}}return r}createExpressionTracks(e){const t=[];for(const[i,r]of this.expressionTracks.entries()){const s=e.getExpressionTrackName(i);if(s!=null){const o=r.clone();o.name=s,t.push(o)}}return t}createLookAtTrack(e){if(this.lookAtTrack==null)return null;const t=this.lookAtTrack.clone();return t.name=e,t}}function N1(n,e){const t=n.length,i=[];let r=[],s=0;for(let o=0;o<t;o++){const a=n[o];s<=0&&(s=e,r=[],i.push(r)),r.push(a),s--}return i}const ele=new Qe,tle=new z,U1=new Xe,B1=new Xe,nle=new Xe;class ile{constructor(e,t){rt(this,"parser");this.parser=e}get name(){return"VRMC_vrm_animation"}async afterRoot(e){var d;const t=e.parser.json,i=t.extensionsUsed;if(i==null||i.indexOf(this.name)==-1)return;const r=(d=t.extensions)==null?void 0:d[this.name];if(r==null)return;const s=this._createNodeMap(r),o=await this._createBoneWorldMatrixMap(e,r),a=r.humanoid.humanBones.hips.node,u=(await e.parser.getDependency("node",a)).getWorldPosition(new z),h=e.animations.map((f,p)=>{const _=t.animations[p],m=this._parseAnimation(f,_,s,o);return m.restHipsPosition=u,m});e.userData.vrmAnimations=h}_createNodeMap(e){var l,u,c,h;const t=new Map,i=new Map;let r;const s=(l=e.humanoid)==null?void 0:l.humanBones;s&&Object.entries(s).forEach(([d,f])=>{const{node:p}=f;t.set(p,d)});const o=(u=e.expressions)==null?void 0:u.preset;o&&Object.entries(o).forEach(([d,f])=>{const{node:p}=f;i.set(p,d)});const a=(c=e.expressions)==null?void 0:c.custom;return a&&Object.entries(a).forEach(([d,f])=>{const{node:p}=f;i.set(p,d)}),r=((h=e.lookAt)==null?void 0:h.node)??null,{humanoidIndexToName:t,expressionsIndexToName:i,lookAtIndex:r}}async _createBoneWorldMatrixMap(e,t){var s;e.scene.updateWorldMatrix(!1,!0);const i=await e.parser.getDependencies("node"),r=new Map;for(const[o,{node:a}]of Object.entries(t.humanoid.humanBones)){const l=i[a];r.set(o,l.matrixWorld),o==="hips"&&r.set("hipsParent",((s=l.parent)==null?void 0:s.matrixWorld)??ele)}return r}_parseAnimation(e,t,i,r){const s=e.tracks,o=t.channels,a=new Qae;return a.duration=e.duration,o.forEach((l,u)=>{const{node:c,path:h}=l.target,d=s[u];if(c==null)return;const f=i.humanoidIndexToName.get(c);if(f!=null){let _=By[f];for(;_!=null&&r.get(_)==null;)_=By[_];if(_??(_="hipsParent"),h==="translation"){const m=r.get("hipsParent"),g=N1(d.values,3).flatMap(y=>tle.fromArray(y).applyMatrix4(m).toArray()),v=d.clone();v.values=new Float32Array(g),a.humanoidTracks.translation.set(f,v)}else if(h==="rotation"){const m=r.get(f),g=r.get(_);U1.setFromRotationMatrix(m).normalize().invert(),B1.setFromRotationMatrix(g).normalize();const v=N1(d.values,4).flatMap(x=>nle.fromArray(x).premultiply(B1).multiply(U1).toArray()),y=d.clone();y.values=new Float32Array(v),a.humanoidTracks.rotation.set(f,y)}else throw new Error(`Invalid path "${h}"`);return}const p=i.expressionsIndexToName.get(c);if(p!=null){if(h==="translation"){const _=d.times,m=new Float32Array(d.values.length/3);for(let v=0;v<m.length;v++)m[v]=d.values[3*v];const g=new gl(`${p}.weight`,_,m);a.expressionTracks.set(p,g)}else throw new Error(`Invalid path "${h}"`);return}if(c===i.lookAtIndex)if(h==="rotation")a.lookAtTrack=d;else throw new Error(`Invalid path "${h}"`)}),a}}const z2=new V2;z2.register(n=>new ile(n));async function rle(n){return(await z2.loadAsync(n)).userData.vrmAnimations[0]??null}const k1={type:"change"},kv={type:"start"},V1={type:"end"};class sle extends Ko{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new z,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Vl.ROTATE,MIDDLE:Vl.DOLLY,RIGHT:Vl.PAN},this.touches={ONE:Gl.ROTATE,TWO:Gl.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(k){k.addEventListener("keydown",fe),this._domElementKeyEvents=k},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",fe),this._domElementKeyEvents=null},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(k1),i.update(),s=r.NONE},this.update=function(){const k=new z,pe=new Xe().setFromUnitVectors(e.up,new z(0,1,0)),Ee=pe.clone().invert(),se=new z,De=new Xe,Ne=new z,Ue=2*Math.PI;return function(){const Re=i.object.position;k.copy(Re).sub(i.target),k.applyQuaternion(pe),a.setFromVector3(k),i.autoRotate&&s===r.NONE&&E(T()),i.enableDamping?(a.theta+=l.theta*i.dampingFactor,a.phi+=l.phi*i.dampingFactor):(a.theta+=l.theta,a.phi+=l.phi);let Ve=i.minAzimuthAngle,ft=i.maxAzimuthAngle;return isFinite(Ve)&&isFinite(ft)&&(Ve<-Math.PI?Ve+=Ue:Ve>Math.PI&&(Ve-=Ue),ft<-Math.PI?ft+=Ue:ft>Math.PI&&(ft-=Ue),Ve<=ft?a.theta=Math.max(Ve,Math.min(ft,a.theta)):a.theta=a.theta>(Ve+ft)/2?Math.max(Ve,a.theta):Math.min(ft,a.theta)),a.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,a.phi)),a.makeSafe(),a.radius*=u,a.radius=Math.max(i.minDistance,Math.min(i.maxDistance,a.radius)),i.enableDamping===!0?i.target.addScaledVector(c,i.dampingFactor):i.target.add(c),k.setFromSpherical(a),k.applyQuaternion(Ee),Re.copy(i.target).add(k),i.object.lookAt(i.target),i.enableDamping===!0?(l.theta*=1-i.dampingFactor,l.phi*=1-i.dampingFactor,c.multiplyScalar(1-i.dampingFactor)):(l.set(0,0,0),c.set(0,0,0)),u=1,h||se.distanceToSquared(i.object.position)>o||8*(1-De.dot(i.object.quaternion))>o||Ne.distanceToSquared(i.target)>0?(i.dispatchEvent(k1),se.copy(i.object.position),De.copy(i.object.quaternion),Ne.copy(i.target),h=!1,!0):!1}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",I),i.domElement.removeEventListener("pointerdown",H),i.domElement.removeEventListener("pointercancel",Z),i.domElement.removeEventListener("wheel",le),i.domElement.removeEventListener("pointermove",K),i.domElement.removeEventListener("pointerup",Z),i._domElementKeyEvents!==null&&(i._domElementKeyEvents.removeEventListener("keydown",fe),i._domElementKeyEvents=null)};const i=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=r.NONE;const o=1e-6,a=new QA,l=new QA;let u=1;const c=new z;let h=!1;const d=new Ze,f=new Ze,p=new Ze,_=new Ze,m=new Ze,g=new Ze,v=new Ze,y=new Ze,x=new Ze,b=[],S={};function T(){return 2*Math.PI/60/60*i.autoRotateSpeed}function P(){return Math.pow(.95,i.zoomSpeed)}function E(k){l.theta-=k}function M(k){l.phi-=k}const O=function(){const k=new z;return function(Ee,se){k.setFromMatrixColumn(se,0),k.multiplyScalar(-Ee),c.add(k)}}(),L=function(){const k=new z;return function(Ee,se){i.screenSpacePanning===!0?k.setFromMatrixColumn(se,1):(k.setFromMatrixColumn(se,0),k.crossVectors(i.object.up,k)),k.multiplyScalar(Ee),c.add(k)}}(),C=function(){const k=new z;return function(Ee,se){const De=i.domElement;if(i.object.isPerspectiveCamera){const Ne=i.object.position;k.copy(Ne).sub(i.target);let Ue=k.length();Ue*=Math.tan(i.object.fov/2*Math.PI/180),O(2*Ee*Ue/De.clientHeight,i.object.matrix),L(2*se*Ue/De.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(O(Ee*(i.object.right-i.object.left)/i.object.zoom/De.clientWidth,i.object.matrix),L(se*(i.object.top-i.object.bottom)/i.object.zoom/De.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function D(k){i.object.isPerspectiveCamera?u/=k:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom*k)),i.object.updateProjectionMatrix(),h=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function B(k){i.object.isPerspectiveCamera?u*=k:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/k)),i.object.updateProjectionMatrix(),h=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function W(k){d.set(k.clientX,k.clientY)}function U(k){v.set(k.clientX,k.clientY)}function $(k){_.set(k.clientX,k.clientY)}function J(k){f.set(k.clientX,k.clientY),p.subVectors(f,d).multiplyScalar(i.rotateSpeed);const pe=i.domElement;E(2*Math.PI*p.x/pe.clientHeight),M(2*Math.PI*p.y/pe.clientHeight),d.copy(f),i.update()}function j(k){y.set(k.clientX,k.clientY),x.subVectors(y,v),x.y>0?D(P()):x.y<0&&B(P()),v.copy(y),i.update()}function F(k){m.set(k.clientX,k.clientY),g.subVectors(m,_).multiplyScalar(i.panSpeed),C(g.x,g.y),_.copy(m),i.update()}function X(k){k.deltaY<0?B(P()):k.deltaY>0&&D(P()),i.update()}function re(k){let pe=!1;switch(k.code){case i.keys.UP:k.ctrlKey||k.metaKey||k.shiftKey?M(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):C(0,i.keyPanSpeed),pe=!0;break;case i.keys.BOTTOM:k.ctrlKey||k.metaKey||k.shiftKey?M(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):C(0,-i.keyPanSpeed),pe=!0;break;case i.keys.LEFT:k.ctrlKey||k.metaKey||k.shiftKey?E(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):C(i.keyPanSpeed,0),pe=!0;break;case i.keys.RIGHT:k.ctrlKey||k.metaKey||k.shiftKey?E(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):C(-i.keyPanSpeed,0),pe=!0;break}pe&&(k.preventDefault(),i.update())}function ce(){if(b.length===1)d.set(b[0].pageX,b[0].pageY);else{const k=.5*(b[0].pageX+b[1].pageX),pe=.5*(b[0].pageY+b[1].pageY);d.set(k,pe)}}function ve(){if(b.length===1)_.set(b[0].pageX,b[0].pageY);else{const k=.5*(b[0].pageX+b[1].pageX),pe=.5*(b[0].pageY+b[1].pageY);_.set(k,pe)}}function ae(){const k=b[0].pageX-b[1].pageX,pe=b[0].pageY-b[1].pageY,Ee=Math.sqrt(k*k+pe*pe);v.set(0,Ee)}function Y(){i.enableZoom&&ae(),i.enablePan&&ve()}function ne(){i.enableZoom&&ae(),i.enableRotate&&ce()}function he(k){if(b.length==1)f.set(k.pageX,k.pageY);else{const Ee=ue(k),se=.5*(k.pageX+Ee.x),De=.5*(k.pageY+Ee.y);f.set(se,De)}p.subVectors(f,d).multiplyScalar(i.rotateSpeed);const pe=i.domElement;E(2*Math.PI*p.x/pe.clientHeight),M(2*Math.PI*p.y/pe.clientHeight),d.copy(f)}function xe(k){if(b.length===1)m.set(k.pageX,k.pageY);else{const pe=ue(k),Ee=.5*(k.pageX+pe.x),se=.5*(k.pageY+pe.y);m.set(Ee,se)}g.subVectors(m,_).multiplyScalar(i.panSpeed),C(g.x,g.y),_.copy(m)}function be(k){const pe=ue(k),Ee=k.pageX-pe.x,se=k.pageY-pe.y,De=Math.sqrt(Ee*Ee+se*se);y.set(0,De),x.set(0,Math.pow(y.y/v.y,i.zoomSpeed)),D(x.y),v.copy(y)}function w(k){i.enableZoom&&be(k),i.enablePan&&xe(k)}function V(k){i.enableZoom&&be(k),i.enableRotate&&he(k)}function H(k){i.enabled!==!1&&(b.length===0&&(i.domElement.setPointerCapture(k.pointerId),i.domElement.addEventListener("pointermove",K),i.domElement.addEventListener("pointerup",Z)),A(k),k.pointerType==="touch"?me(k):ee(k))}function K(k){i.enabled!==!1&&(k.pointerType==="touch"?we(k):ge(k))}function Z(k){G(k),b.length===0&&(i.domElement.releasePointerCapture(k.pointerId),i.domElement.removeEventListener("pointermove",K),i.domElement.removeEventListener("pointerup",Z)),i.dispatchEvent(V1),s=r.NONE}function ee(k){let pe;switch(k.button){case 0:pe=i.mouseButtons.LEFT;break;case 1:pe=i.mouseButtons.MIDDLE;break;case 2:pe=i.mouseButtons.RIGHT;break;default:pe=-1}switch(pe){case Vl.DOLLY:if(i.enableZoom===!1)return;U(k),s=r.DOLLY;break;case Vl.ROTATE:if(k.ctrlKey||k.metaKey||k.shiftKey){if(i.enablePan===!1)return;$(k),s=r.PAN}else{if(i.enableRotate===!1)return;W(k),s=r.ROTATE}break;case Vl.PAN:if(k.ctrlKey||k.metaKey||k.shiftKey){if(i.enableRotate===!1)return;W(k),s=r.ROTATE}else{if(i.enablePan===!1)return;$(k),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(kv)}function ge(k){switch(s){case r.ROTATE:if(i.enableRotate===!1)return;J(k);break;case r.DOLLY:if(i.enableZoom===!1)return;j(k);break;case r.PAN:if(i.enablePan===!1)return;F(k);break}}function le(k){i.enabled===!1||i.enableZoom===!1||s!==r.NONE||(k.preventDefault(),i.dispatchEvent(kv),X(k),i.dispatchEvent(V1))}function fe(k){i.enabled===!1||i.enablePan===!1||re(k)}function me(k){switch(Q(k),b.length){case 1:switch(i.touches.ONE){case Gl.ROTATE:if(i.enableRotate===!1)return;ce(),s=r.TOUCH_ROTATE;break;case Gl.PAN:if(i.enablePan===!1)return;ve(),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(i.touches.TWO){case Gl.DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;Y(),s=r.TOUCH_DOLLY_PAN;break;case Gl.DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;ne(),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(kv)}function we(k){switch(Q(k),s){case r.TOUCH_ROTATE:if(i.enableRotate===!1)return;he(k),i.update();break;case r.TOUCH_PAN:if(i.enablePan===!1)return;xe(k),i.update();break;case r.TOUCH_DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;w(k),i.update();break;case r.TOUCH_DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;V(k),i.update();break;default:s=r.NONE}}function I(k){i.enabled!==!1&&k.preventDefault()}function A(k){b.push(k)}function G(k){delete S[k.pointerId];for(let pe=0;pe<b.length;pe++)if(b[pe].pointerId==k.pointerId){b.splice(pe,1);return}}function Q(k){let pe=S[k.pointerId];pe===void 0&&(pe=new Ze,S[k.pointerId]=pe),pe.set(k.pageX,k.pageY)}function ue(k){const pe=k.pointerId===b[0].pointerId?b[1]:b[0];return S[pe.pointerId]}i.domElement.addEventListener("contextmenu",I),i.domElement.addEventListener("pointerdown",H),i.domElement.addEventListener("pointercancel",Z),i.domElement.addEventListener("wheel",le,{passive:!1}),this.update()}}class ole{constructor(){rt(this,"isReady");rt(this,"model");rt(this,"_renderer");rt(this,"_clock");rt(this,"_scene");rt(this,"_camera");rt(this,"_cameraControls");rt(this,"update",()=>{requestAnimationFrame(this.update);const e=this._clock.getDelta();this.model&&this.model.update(e),this._renderer&&this._camera&&this._renderer.render(this._scene,this._camera)});this.isReady=!1;const e=new qre;this._scene=e;const t=new R2(16777215,.6);t.position.set(1,1,1).normalize(),e.add(t);const i=new yse(16777215,.4);e.add(i),this._clock=new bse,this._clock.start()}loadVrm(e){var t;(t=this.model)!=null&&t.vrm&&this.unloadVRM(),this.model=new Jae(this._camera||new Ft),this.model.loadVRM(e).then(async()=>{var r;if(!((r=this.model)!=null&&r.vrm))return;this.model.vrm.scene.traverse(s=>{s.frustumCulled=!1}),this._scene.add(this.model.vrm.scene);const i=await rle("vrm/idle_loop.vrma");i&&this.model.loadAnimation(i),requestAnimationFrame(()=>{this.resetCamera()})})}unloadVRM(){var e,t;(e=this.model)!=null&&e.vrm&&(this._scene.remove(this.model.vrm.scene),(t=this.model)==null||t.unLoadVrm())}setup(e){var s,o;const t=e.parentElement,i=(t==null?void 0:t.clientWidth)||e.width,r=(t==null?void 0:t.clientHeight)||e.height;this._renderer=new x2({canvas:e,alpha:!0,antialias:!0}),this._renderer.outputEncoding=ko,this._renderer.setSize(i,r),this._renderer.setPixelRatio(window.devicePixelRatio),this._camera=new si(20,i/r,.1,20),this._camera.position.set(0,1.3,1.5),(s=this._cameraControls)==null||s.target.set(0,1.3,0),(o=this._cameraControls)==null||o.update(),this._cameraControls=new sle(this._camera,this._renderer.domElement),this._cameraControls.screenSpacePanning=!0,this._cameraControls.update(),window.addEventListener("resize",()=>{this.resize()}),this.isReady=!0,this.update()}resize(){if(!this._renderer)return;const e=this._renderer.domElement.parentElement;e&&(this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.setSize(e.clientWidth,e.clientHeight),this._camera&&(this._camera.aspect=e.clientWidth/e.clientHeight,this._camera.updateProjectionMatrix()))}resetCamera(){var t,i,r,s,o;const e=(i=(t=this.model)==null?void 0:t.vrm)==null?void 0:i.humanoid.getNormalizedBoneNode("head");if(e){const a=e.getWorldPosition(new z);(r=this._camera)==null||r.position.set(this._camera.position.x,a.y,this._camera.position.z),(s=this._cameraControls)==null||s.target.set(a.x,a.y,a.z),(o=this._cameraControls)==null||o.update()}}}const ale=dt({__name:"VRM",setup(n){const e=Fe(null),t=yl();return Sn(()=>{const i=new ole;t.state.viewer=i,e&&(i.setup(e.value),i.loadVrm("/vrm/AvatarSample_B.vrm"))}),(i,r)=>(Te(),ke(jt,null,[lt(PJ),ze("canvas",{ref_key:"canvas",ref:e},null,512)],64))}});const lle=(n,e)=>{const t=n.__vccOpts||n;for(const[i,r]of e)t[i]=r;return t},ule=lle(ale,[["__scopeId","data-v-390f0382"]]);/*!
  * vue-router v4.2.4
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */const mu=typeof window<"u";function cle(n){return n.__esModule||n[Symbol.toStringTag]==="Module"}const Dt=Object.assign;function Vv(n,e){const t={};for(const i in e){const r=e[i];t[i]=Or(r)?r.map(n):n(r)}return t}const Gh=()=>{},Or=Array.isArray,hle=/\/$/,dle=n=>n.replace(hle,"");function Gv(n,e,t="/"){let i,r={},s="",o="";const a=e.indexOf("#");let l=e.indexOf("?");return a<l&&a>=0&&(l=-1),l>-1&&(i=e.slice(0,l),s=e.slice(l+1,a>-1?a:e.length),r=n(s)),a>-1&&(i=i||e.slice(0,a),o=e.slice(a,e.length)),i=gle(i??e,t),{fullPath:i+(s&&"?")+s+o,path:i,query:r,hash:o}}function fle(n,e){const t=e.query?n(e.query):"";return e.path+(t&&"?")+t+(e.hash||"")}function G1(n,e){return!e||!n.toLowerCase().startsWith(e.toLowerCase())?n:n.slice(e.length)||"/"}function ple(n,e,t){const i=e.matched.length-1,r=t.matched.length-1;return i>-1&&i===r&&dc(e.matched[i],t.matched[r])&&W2(e.params,t.params)&&n(e.query)===n(t.query)&&e.hash===t.hash}function dc(n,e){return(n.aliasOf||n)===(e.aliasOf||e)}function W2(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(const t in n)if(!mle(n[t],e[t]))return!1;return!0}function mle(n,e){return Or(n)?H1(n,e):Or(e)?H1(e,n):n===e}function H1(n,e){return Or(e)?n.length===e.length&&n.every((t,i)=>t===e[i]):n.length===1&&n[0]===e}function gle(n,e){if(n.startsWith("/"))return n;if(!n)return e;const t=e.split("/"),i=n.split("/"),r=i[i.length-1];(r===".."||r===".")&&i.push("");let s=t.length-1,o,a;for(o=0;o<i.length;o++)if(a=i[o],a!==".")if(a==="..")s>1&&s--;else break;return t.slice(0,s).join("/")+"/"+i.slice(o-(o===i.length?1:0)).join("/")}var Cd;(function(n){n.pop="pop",n.push="push"})(Cd||(Cd={}));var Hh;(function(n){n.back="back",n.forward="forward",n.unknown=""})(Hh||(Hh={}));function _le(n){if(!n)if(mu){const e=document.querySelector("base");n=e&&e.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),dle(n)}const vle=/^[^#]+#/;function yle(n,e){return n.replace(vle,"#")+e}function xle(n,e){const t=document.documentElement.getBoundingClientRect(),i=n.getBoundingClientRect();return{behavior:e.behavior,left:i.left-t.left-(e.left||0),top:i.top-t.top-(e.top||0)}}const Tg=()=>({left:window.pageXOffset,top:window.pageYOffset});function ble(n){let e;if("el"in n){const t=n.el,i=typeof t=="string"&&t.startsWith("#"),r=typeof t=="string"?i?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!r)return;e=xle(r,n)}else e=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.pageXOffset,e.top!=null?e.top:window.pageYOffset)}function z1(n,e){return(history.state?history.state.position-e:-1)+n}const Wy=new Map;function Sle(n,e){Wy.set(n,e)}function Ele(n){const e=Wy.get(n);return Wy.delete(n),e}let Tle=()=>location.protocol+"//"+location.host;function X2(n,e){const{pathname:t,search:i,hash:r}=e,s=n.indexOf("#");if(s>-1){let a=r.includes(n.slice(s))?n.slice(s).length:1,l=r.slice(a);return l[0]!=="/"&&(l="/"+l),G1(l,"")}return G1(t,n)+i+r}function Mle(n,e,t,i){let r=[],s=[],o=null;const a=({state:d})=>{const f=X2(n,location),p=t.value,_=e.value;let m=0;if(d){if(t.value=f,e.value=d,o&&o===p){o=null;return}m=_?d.position-_.position:0}else i(f);r.forEach(g=>{g(t.value,p,{delta:m,type:Cd.pop,direction:m?m>0?Hh.forward:Hh.back:Hh.unknown})})};function l(){o=t.value}function u(d){r.push(d);const f=()=>{const p=r.indexOf(d);p>-1&&r.splice(p,1)};return s.push(f),f}function c(){const{history:d}=window;d.state&&d.replaceState(Dt({},d.state,{scroll:Tg()}),"")}function h(){for(const d of s)d();s=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",c)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",c,{passive:!0}),{pauseListeners:l,listen:u,destroy:h}}function W1(n,e,t,i=!1,r=!1){return{back:n,current:e,forward:t,replaced:i,position:window.history.length,scroll:r?Tg():null}}function wle(n){const{history:e,location:t}=window,i={value:X2(n,t)},r={value:e.state};r.value||s(i.value,{back:null,current:i.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function s(l,u,c){const h=n.indexOf("#"),d=h>-1?(t.host&&document.querySelector("base")?n:n.slice(h))+l:Tle()+n+l;try{e[c?"replaceState":"pushState"](u,"",d),r.value=u}catch(f){console.error(f),t[c?"replace":"assign"](d)}}function o(l,u){const c=Dt({},e.state,W1(r.value.back,l,r.value.forward,!0),u,{position:r.value.position});s(l,c,!0),i.value=l}function a(l,u){const c=Dt({},r.value,e.state,{forward:l,scroll:Tg()});s(c.current,c,!0);const h=Dt({},W1(i.value,l,null),{position:c.position+1},u);s(l,h,!1),i.value=l}return{location:i,state:r,push:a,replace:o}}function Ale(n){n=_le(n);const e=wle(n),t=Mle(n,e.state,e.location,e.replace);function i(s,o=!0){o||t.pauseListeners(),history.go(s)}const r=Dt({location:"",base:n,go:i,createHref:yle.bind(null,n)},e,t);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>e.state.value}),r}function Ple(n){return n=location.host?n||location.pathname+location.search:"",n.includes("#")||(n+="#"),Ale(n)}function Cle(n){return typeof n=="string"||n&&typeof n=="object"}function j2(n){return typeof n=="string"||typeof n=="symbol"}const vo={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},$2=Symbol("");var X1;(function(n){n[n.aborted=4]="aborted",n[n.cancelled=8]="cancelled",n[n.duplicated=16]="duplicated"})(X1||(X1={}));function fc(n,e){return Dt(new Error,{type:n,[$2]:!0},e)}function Ps(n,e){return n instanceof Error&&$2 in n&&(e==null||!!(n.type&e))}const j1="[^/]+?",Rle={sensitive:!1,strict:!1,start:!0,end:!0},Ile=/[.+*?^${}()[\]/\\]/g;function Lle(n,e){const t=Dt({},Rle,e),i=[];let r=t.start?"^":"";const s=[];for(const u of n){const c=u.length?[]:[90];t.strict&&!u.length&&(r+="/");for(let h=0;h<u.length;h++){const d=u[h];let f=40+(t.sensitive?.25:0);if(d.type===0)h||(r+="/"),r+=d.value.replace(Ile,"\\$&"),f+=40;else if(d.type===1){const{value:p,repeatable:_,optional:m,regexp:g}=d;s.push({name:p,repeatable:_,optional:m});const v=g||j1;if(v!==j1){f+=10;try{new RegExp(`(${v})`)}catch(x){throw new Error(`Invalid custom RegExp for param "${p}" (${v}): `+x.message)}}let y=_?`((?:${v})(?:/(?:${v}))*)`:`(${v})`;h||(y=m&&u.length<2?`(?:/${y})`:"/"+y),m&&(y+="?"),r+=y,f+=20,m&&(f+=-8),_&&(f+=-20),v===".*"&&(f+=-50)}c.push(f)}i.push(c)}if(t.strict&&t.end){const u=i.length-1;i[u][i[u].length-1]+=.7000000000000001}t.strict||(r+="/?"),t.end?r+="$":t.strict&&(r+="(?:/|$)");const o=new RegExp(r,t.sensitive?"":"i");function a(u){const c=u.match(o),h={};if(!c)return null;for(let d=1;d<c.length;d++){const f=c[d]||"",p=s[d-1];h[p.name]=f&&p.repeatable?f.split("/"):f}return h}function l(u){let c="",h=!1;for(const d of n){(!h||!c.endsWith("/"))&&(c+="/"),h=!1;for(const f of d)if(f.type===0)c+=f.value;else if(f.type===1){const{value:p,repeatable:_,optional:m}=f,g=p in u?u[p]:"";if(Or(g)&&!_)throw new Error(`Provided param "${p}" is an array but it is not repeatable (* or + modifiers)`);const v=Or(g)?g.join("/"):g;if(!v)if(m)d.length<2&&(c.endsWith("/")?c=c.slice(0,-1):h=!0);else throw new Error(`Missing required param "${p}"`);c+=v}}return c||"/"}return{re:o,score:i,keys:s,parse:a,stringify:l}}function Ole(n,e){let t=0;for(;t<n.length&&t<e.length;){const i=e[t]-n[t];if(i)return i;t++}return n.length<e.length?n.length===1&&n[0]===40+40?-1:1:n.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function Dle(n,e){let t=0;const i=n.score,r=e.score;for(;t<i.length&&t<r.length;){const s=Ole(i[t],r[t]);if(s)return s;t++}if(Math.abs(r.length-i.length)===1){if($1(i))return 1;if($1(r))return-1}return r.length-i.length}function $1(n){const e=n[n.length-1];return n.length>0&&e[e.length-1]<0}const Fle={type:0,value:""},Nle=/[a-zA-Z0-9_]/;function Ule(n){if(!n)return[[]];if(n==="/")return[[Fle]];if(!n.startsWith("/"))throw new Error(`Invalid path "${n}"`);function e(f){throw new Error(`ERR (${t})/"${u}": ${f}`)}let t=0,i=t;const r=[];let s;function o(){s&&r.push(s),s=[]}let a=0,l,u="",c="";function h(){u&&(t===0?s.push({type:0,value:u}):t===1||t===2||t===3?(s.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${u}) must be alone in its segment. eg: '/:ids+.`),s.push({type:1,value:u,regexp:c,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),u="")}function d(){u+=l}for(;a<n.length;){if(l=n[a++],l==="\\"&&t!==2){i=t,t=4;continue}switch(t){case 0:l==="/"?(u&&h(),o()):l===":"?(h(),t=1):d();break;case 4:d(),t=i;break;case 1:l==="("?t=2:Nle.test(l)?d():(h(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case 2:l===")"?c[c.length-1]=="\\"?c=c.slice(0,-1)+l:t=3:c+=l;break;case 3:h(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--,c="";break;default:e("Unknown state");break}}return t===2&&e(`Unfinished custom RegExp for param "${u}"`),h(),o(),r}function Ble(n,e,t){const i=Lle(Ule(n.path),t),r=Dt(i,{record:n,parent:e,children:[],alias:[]});return e&&!r.record.aliasOf==!e.record.aliasOf&&e.children.push(r),r}function kle(n,e){const t=[],i=new Map;e=K1({strict:!1,end:!0,sensitive:!1},e);function r(c){return i.get(c)}function s(c,h,d){const f=!d,p=Vle(c);p.aliasOf=d&&d.record;const _=K1(e,c),m=[p];if("alias"in c){const y=typeof c.alias=="string"?[c.alias]:c.alias;for(const x of y)m.push(Dt({},p,{components:d?d.record.components:p.components,path:x,aliasOf:d?d.record:p}))}let g,v;for(const y of m){const{path:x}=y;if(h&&x[0]!=="/"){const b=h.record.path,S=b[b.length-1]==="/"?"":"/";y.path=h.record.path+(x&&S+x)}if(g=Ble(y,h,_),d?d.alias.push(g):(v=v||g,v!==g&&v.alias.push(g),f&&c.name&&!q1(g)&&o(c.name)),p.children){const b=p.children;for(let S=0;S<b.length;S++)s(b[S],g,d&&d.children[S])}d=d||g,(g.record.components&&Object.keys(g.record.components).length||g.record.name||g.record.redirect)&&l(g)}return v?()=>{o(v)}:Gh}function o(c){if(j2(c)){const h=i.get(c);h&&(i.delete(c),t.splice(t.indexOf(h),1),h.children.forEach(o),h.alias.forEach(o))}else{const h=t.indexOf(c);h>-1&&(t.splice(h,1),c.record.name&&i.delete(c.record.name),c.children.forEach(o),c.alias.forEach(o))}}function a(){return t}function l(c){let h=0;for(;h<t.length&&Dle(c,t[h])>=0&&(c.record.path!==t[h].record.path||!Y2(c,t[h]));)h++;t.splice(h,0,c),c.record.name&&!q1(c)&&i.set(c.record.name,c)}function u(c,h){let d,f={},p,_;if("name"in c&&c.name){if(d=i.get(c.name),!d)throw fc(1,{location:c});_=d.record.name,f=Dt(Y1(h.params,d.keys.filter(v=>!v.optional).map(v=>v.name)),c.params&&Y1(c.params,d.keys.map(v=>v.name))),p=d.stringify(f)}else if("path"in c)p=c.path,d=t.find(v=>v.re.test(p)),d&&(f=d.parse(p),_=d.record.name);else{if(d=h.name?i.get(h.name):t.find(v=>v.re.test(h.path)),!d)throw fc(1,{location:c,currentLocation:h});_=d.record.name,f=Dt({},h.params,c.params),p=d.stringify(f)}const m=[];let g=d;for(;g;)m.unshift(g.record),g=g.parent;return{name:_,path:p,params:f,matched:m,meta:Hle(m)}}return n.forEach(c=>s(c)),{addRoute:s,resolve:u,removeRoute:o,getRoutes:a,getRecordMatcher:r}}function Y1(n,e){const t={};for(const i of e)i in n&&(t[i]=n[i]);return t}function Vle(n){return{path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:void 0,beforeEnter:n.beforeEnter,props:Gle(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}}}function Gle(n){const e={},t=n.props||!1;if("component"in n)e.default=t;else for(const i in n.components)e[i]=typeof t=="object"?t[i]:t;return e}function q1(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function Hle(n){return n.reduce((e,t)=>Dt(e,t.meta),{})}function K1(n,e){const t={};for(const i in n)t[i]=i in e?e[i]:n[i];return t}function Y2(n,e){return e.children.some(t=>t===n||Y2(n,t))}const q2=/#/g,zle=/&/g,Wle=/\//g,Xle=/=/g,jle=/\?/g,K2=/\+/g,$le=/%5B/g,Yle=/%5D/g,Z2=/%5E/g,qle=/%60/g,J2=/%7B/g,Kle=/%7C/g,Q2=/%7D/g,Zle=/%20/g;function ES(n){return encodeURI(""+n).replace(Kle,"|").replace($le,"[").replace(Yle,"]")}function Jle(n){return ES(n).replace(J2,"{").replace(Q2,"}").replace(Z2,"^")}function Xy(n){return ES(n).replace(K2,"%2B").replace(Zle,"+").replace(q2,"%23").replace(zle,"%26").replace(qle,"`").replace(J2,"{").replace(Q2,"}").replace(Z2,"^")}function Qle(n){return Xy(n).replace(Xle,"%3D")}function eue(n){return ES(n).replace(q2,"%23").replace(jle,"%3F")}function tue(n){return n==null?"":eue(n).replace(Wle,"%2F")}function bm(n){try{return decodeURIComponent(""+n)}catch{}return""+n}function nue(n){const e={};if(n===""||n==="?")return e;const i=(n[0]==="?"?n.slice(1):n).split("&");for(let r=0;r<i.length;++r){const s=i[r].replace(K2," "),o=s.indexOf("="),a=bm(o<0?s:s.slice(0,o)),l=o<0?null:bm(s.slice(o+1));if(a in e){let u=e[a];Or(u)||(u=e[a]=[u]),u.push(l)}else e[a]=l}return e}function Z1(n){let e="";for(let t in n){const i=n[t];if(t=Qle(t),i==null){i!==void 0&&(e+=(e.length?"&":"")+t);continue}(Or(i)?i.map(s=>s&&Xy(s)):[i&&Xy(i)]).forEach(s=>{s!==void 0&&(e+=(e.length?"&":"")+t,s!=null&&(e+="="+s))})}return e}function iue(n){const e={};for(const t in n){const i=n[t];i!==void 0&&(e[t]=Or(i)?i.map(r=>r==null?null:""+r):i==null?i:""+i)}return e}const rue=Symbol(""),J1=Symbol(""),TS=Symbol(""),eD=Symbol(""),jy=Symbol("");function lh(){let n=[];function e(i){return n.push(i),()=>{const r=n.indexOf(i);r>-1&&n.splice(r,1)}}function t(){n=[]}return{add:e,list:()=>n.slice(),reset:t}}function Mo(n,e,t,i,r){const s=i&&(i.enterCallbacks[r]=i.enterCallbacks[r]||[]);return()=>new Promise((o,a)=>{const l=h=>{h===!1?a(fc(4,{from:t,to:e})):h instanceof Error?a(h):Cle(h)?a(fc(2,{from:e,to:h})):(s&&i.enterCallbacks[r]===s&&typeof h=="function"&&s.push(h),o())},u=n.call(i&&i.instances[r],e,t,l);let c=Promise.resolve(u);n.length<3&&(c=c.then(l)),c.catch(h=>a(h))})}function Hv(n,e,t,i){const r=[];for(const s of n)for(const o in s.components){let a=s.components[o];if(!(e!=="beforeRouteEnter"&&!s.instances[o]))if(sue(a)){const u=(a.__vccOpts||a)[e];u&&r.push(Mo(u,t,i,s,o))}else{let l=a();r.push(()=>l.then(u=>{if(!u)return Promise.reject(new Error(`Couldn't resolve component "${o}" at "${s.path}"`));const c=cle(u)?u.default:u;s.components[o]=c;const d=(c.__vccOpts||c)[e];return d&&Mo(d,t,i,s,o)()}))}}return r}function sue(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function Q1(n){const e=Lt(TS),t=Lt(eD),i=oe(()=>e.resolve(R(n.to))),r=oe(()=>{const{matched:l}=i.value,{length:u}=l,c=l[u-1],h=t.matched;if(!c||!h.length)return-1;const d=h.findIndex(dc.bind(null,c));if(d>-1)return d;const f=eP(l[u-2]);return u>1&&eP(c)===f&&h[h.length-1].path!==f?h.findIndex(dc.bind(null,l[u-2])):d}),s=oe(()=>r.value>-1&&uue(t.params,i.value.params)),o=oe(()=>r.value>-1&&r.value===t.matched.length-1&&W2(t.params,i.value.params));function a(l={}){return lue(l)?e[R(n.replace)?"replace":"push"](R(n.to)).catch(Gh):Promise.resolve()}return{route:i,href:oe(()=>i.value.href),isActive:s,isExactActive:o,navigate:a}}const oue=dt({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Q1,setup(n,{slots:e}){const t=Zs(Q1(n)),{options:i}=Lt(TS),r=oe(()=>({[tP(n.activeClass,i.linkActiveClass,"router-link-active")]:t.isActive,[tP(n.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const s=e.default&&e.default(t);return n.custom?s:Rd("a",{"aria-current":t.isExactActive?n.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:r.value},s)}}}),aue=oue;function lue(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}function uue(n,e){for(const t in e){const i=e[t],r=n[t];if(typeof i=="string"){if(i!==r)return!1}else if(!Or(r)||r.length!==i.length||i.some((s,o)=>s!==r[o]))return!1}return!0}function eP(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const tP=(n,e,t)=>n??e??t,cue=dt({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:e,slots:t}){const i=Lt(jy),r=oe(()=>n.route||i.value),s=Lt(J1,0),o=oe(()=>{let u=R(s);const{matched:c}=r.value;let h;for(;(h=c[u])&&!h.components;)u++;return u}),a=oe(()=>r.value.matched[o.value]);Ii(J1,oe(()=>o.value+1)),Ii(rue,a),Ii(jy,r);const l=Fe();return et(()=>[l.value,a.value,n.name],([u,c,h],[d,f,p])=>{c&&(c.instances[h]=u,f&&f!==c&&u&&u===d&&(c.leaveGuards.size||(c.leaveGuards=f.leaveGuards),c.updateGuards.size||(c.updateGuards=f.updateGuards))),u&&c&&(!f||!dc(c,f)||!d)&&(c.enterCallbacks[h]||[]).forEach(_=>_(u))},{flush:"post"}),()=>{const u=r.value,c=n.name,h=a.value,d=h&&h.components[c];if(!d)return nP(t.default,{Component:d,route:u});const f=h.props[c],p=f?f===!0?u.params:typeof f=="function"?f(u):f:null,m=Rd(d,Dt({},p,e,{onVnodeUnmounted:g=>{g.component.isUnmounted&&(h.instances[c]=null)},ref:l}));return nP(t.default,{Component:m,route:u})||m}}});function nP(n,e){if(!n)return null;const t=n(e);return t.length===1?t[0]:t}const hue=cue;function due(n){const e=kle(n.routes,n),t=n.parseQuery||nue,i=n.stringifyQuery||Z1,r=n.history,s=lh(),o=lh(),a=lh(),l=Za(vo);let u=vo;mu&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const c=Vv.bind(null,Y=>""+Y),h=Vv.bind(null,tue),d=Vv.bind(null,bm);function f(Y,ne){let he,xe;return j2(Y)?(he=e.getRecordMatcher(Y),xe=ne):xe=Y,e.addRoute(xe,he)}function p(Y){const ne=e.getRecordMatcher(Y);ne&&e.removeRoute(ne)}function _(){return e.getRoutes().map(Y=>Y.record)}function m(Y){return!!e.getRecordMatcher(Y)}function g(Y,ne){if(ne=Dt({},ne||l.value),typeof Y=="string"){const H=Gv(t,Y,ne.path),K=e.resolve({path:H.path},ne),Z=r.createHref(H.fullPath);return Dt(H,K,{params:d(K.params),hash:bm(H.hash),redirectedFrom:void 0,href:Z})}let he;if("path"in Y)he=Dt({},Y,{path:Gv(t,Y.path,ne.path).path});else{const H=Dt({},Y.params);for(const K in H)H[K]==null&&delete H[K];he=Dt({},Y,{params:h(H)}),ne.params=h(ne.params)}const xe=e.resolve(he,ne),be=Y.hash||"";xe.params=c(d(xe.params));const w=fle(i,Dt({},Y,{hash:Jle(be),path:xe.path})),V=r.createHref(w);return Dt({fullPath:w,hash:be,query:i===Z1?iue(Y.query):Y.query||{}},xe,{redirectedFrom:void 0,href:V})}function v(Y){return typeof Y=="string"?Gv(t,Y,l.value.path):Dt({},Y)}function y(Y,ne){if(u!==Y)return fc(8,{from:ne,to:Y})}function x(Y){return T(Y)}function b(Y){return x(Dt(v(Y),{replace:!0}))}function S(Y){const ne=Y.matched[Y.matched.length-1];if(ne&&ne.redirect){const{redirect:he}=ne;let xe=typeof he=="function"?he(Y):he;return typeof xe=="string"&&(xe=xe.includes("?")||xe.includes("#")?xe=v(xe):{path:xe},xe.params={}),Dt({query:Y.query,hash:Y.hash,params:"path"in xe?{}:Y.params},xe)}}function T(Y,ne){const he=u=g(Y),xe=l.value,be=Y.state,w=Y.force,V=Y.replace===!0,H=S(he);if(H)return T(Dt(v(H),{state:typeof H=="object"?Dt({},be,H.state):be,force:w,replace:V}),ne||he);const K=he;K.redirectedFrom=ne;let Z;return!w&&ple(i,xe,he)&&(Z=fc(16,{to:K,from:xe}),F(xe,xe,!0,!1)),(Z?Promise.resolve(Z):M(K,xe)).catch(ee=>Ps(ee)?Ps(ee,2)?ee:j(ee):$(ee,K,xe)).then(ee=>{if(ee){if(Ps(ee,2))return T(Dt({replace:V},v(ee.to),{state:typeof ee.to=="object"?Dt({},be,ee.to.state):be,force:w}),ne||K)}else ee=L(K,xe,!0,V,be);return O(K,xe,ee),ee})}function P(Y,ne){const he=y(Y,ne);return he?Promise.reject(he):Promise.resolve()}function E(Y){const ne=ce.values().next().value;return ne&&typeof ne.runWithContext=="function"?ne.runWithContext(Y):Y()}function M(Y,ne){let he;const[xe,be,w]=fue(Y,ne);he=Hv(xe.reverse(),"beforeRouteLeave",Y,ne);for(const H of xe)H.leaveGuards.forEach(K=>{he.push(Mo(K,Y,ne))});const V=P.bind(null,Y,ne);return he.push(V),ae(he).then(()=>{he=[];for(const H of s.list())he.push(Mo(H,Y,ne));return he.push(V),ae(he)}).then(()=>{he=Hv(be,"beforeRouteUpdate",Y,ne);for(const H of be)H.updateGuards.forEach(K=>{he.push(Mo(K,Y,ne))});return he.push(V),ae(he)}).then(()=>{he=[];for(const H of w)if(H.beforeEnter)if(Or(H.beforeEnter))for(const K of H.beforeEnter)he.push(Mo(K,Y,ne));else he.push(Mo(H.beforeEnter,Y,ne));return he.push(V),ae(he)}).then(()=>(Y.matched.forEach(H=>H.enterCallbacks={}),he=Hv(w,"beforeRouteEnter",Y,ne),he.push(V),ae(he))).then(()=>{he=[];for(const H of o.list())he.push(Mo(H,Y,ne));return he.push(V),ae(he)}).catch(H=>Ps(H,8)?H:Promise.reject(H))}function O(Y,ne,he){a.list().forEach(xe=>E(()=>xe(Y,ne,he)))}function L(Y,ne,he,xe,be){const w=y(Y,ne);if(w)return w;const V=ne===vo,H=mu?history.state:{};he&&(xe||V?r.replace(Y.fullPath,Dt({scroll:V&&H&&H.scroll},be)):r.push(Y.fullPath,be)),l.value=Y,F(Y,ne,he,V),j()}let C;function D(){C||(C=r.listen((Y,ne,he)=>{if(!ve.listening)return;const xe=g(Y),be=S(xe);if(be){T(Dt(be,{replace:!0}),xe).catch(Gh);return}u=xe;const w=l.value;mu&&Sle(z1(w.fullPath,he.delta),Tg()),M(xe,w).catch(V=>Ps(V,12)?V:Ps(V,2)?(T(V.to,xe).then(H=>{Ps(H,20)&&!he.delta&&he.type===Cd.pop&&r.go(-1,!1)}).catch(Gh),Promise.reject()):(he.delta&&r.go(-he.delta,!1),$(V,xe,w))).then(V=>{V=V||L(xe,w,!1),V&&(he.delta&&!Ps(V,8)?r.go(-he.delta,!1):he.type===Cd.pop&&Ps(V,20)&&r.go(-1,!1)),O(xe,w,V)}).catch(Gh)}))}let B=lh(),W=lh(),U;function $(Y,ne,he){j(Y);const xe=W.list();return xe.length?xe.forEach(be=>be(Y,ne,he)):console.error(Y),Promise.reject(Y)}function J(){return U&&l.value!==vo?Promise.resolve():new Promise((Y,ne)=>{B.add([Y,ne])})}function j(Y){return U||(U=!Y,D(),B.list().forEach(([ne,he])=>Y?he(Y):ne()),B.reset()),Y}function F(Y,ne,he,xe){const{scrollBehavior:be}=n;if(!mu||!be)return Promise.resolve();const w=!he&&Ele(z1(Y.fullPath,0))||(xe||!he)&&history.state&&history.state.scroll||null;return Kn().then(()=>be(Y,ne,w)).then(V=>V&&ble(V)).catch(V=>$(V,Y,ne))}const X=Y=>r.go(Y);let re;const ce=new Set,ve={currentRoute:l,listening:!0,addRoute:f,removeRoute:p,hasRoute:m,getRoutes:_,resolve:g,options:n,push:x,replace:b,go:X,back:()=>X(-1),forward:()=>X(1),beforeEach:s.add,beforeResolve:o.add,afterEach:a.add,onError:W.add,isReady:J,install(Y){const ne=this;Y.component("RouterLink",aue),Y.component("RouterView",hue),Y.config.globalProperties.$router=ne,Object.defineProperty(Y.config.globalProperties,"$route",{enumerable:!0,get:()=>R(l)}),mu&&!re&&l.value===vo&&(re=!0,x(r.location).catch(be=>{}));const he={};for(const be in vo)Object.defineProperty(he,be,{get:()=>l.value[be],enumerable:!0});Y.provide(TS,ne),Y.provide(eD,ix(he)),Y.provide(jy,l);const xe=Y.unmount;ce.add(Y),Y.unmount=function(){ce.delete(Y),ce.size<1&&(u=vo,C&&C(),C=null,l.value=vo,re=!1,U=!1),xe()}}};function ae(Y){return Y.reduce((ne,he)=>ne.then(()=>E(he)),Promise.resolve())}return ve}function fue(n,e){const t=[],i=[],r=[],s=Math.max(e.matched.length,n.matched.length);for(let o=0;o<s;o++){const a=e.matched[o];a&&(n.matched.find(u=>dc(u,a))?i.push(a):t.push(a));const l=n.matched[o];l&&(e.matched.find(u=>dc(u,l))||r.push(l))}return[t,i,r]}const pue=[{path:"/live2d",component:MJ},{path:"/vrm",component:ule},{path:"/",redirect:"/vrm"}],mue=due({history:Ple(),routes:pue});const MS=PN(r8);MS.use(l8);MS.use(mue);MS.mount("#app");
